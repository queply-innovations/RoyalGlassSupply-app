import{j as e,bs as y,bu as N,bv as i,bw as g,bx as v,by as r,cI as S,m as w,r as u}from"./index-a900e2ee.js";import{u as _,g as P,f}from"./index-c1554a1e.js";function I({columns:n,data:x,invoice:s,subtotal:b,discount:d,deliveryCharge:h,totalDue:m,amountPaid:a,isBalancePayment:t,user:c}){var p;const l=_({data:x,columns:n,getCoreRowModel:P(),defaultColumn:{size:200,minSize:50,maxSize:500}});return console.log(c),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-gray-400",children:e.jsxs(y,{children:[e.jsx(N,{children:l.getHeaderGroups().map(j=>e.jsx(i,{className:"border border-gray-400",children:j.headers.map(o=>e.jsx(g,{style:{width:`${o.getSize()}px`},className:"text-black",children:o.isPlaceholder?null:f(o.column.columnDef.header,o.getContext())},o.id))},j.id))}),e.jsxs(v,{className:"[&_tr:last-child]:border-x",children:[(p=l.getRowModel().rows)!=null&&p.length?l.getRowModel().rows.map(j=>e.jsx(i,{className:"border border-gray-400 text-black",children:j.getVisibleCells().map(o=>e.jsx(r,{className:"py-1",children:f(o.column.columnDef.cell,o.getContext())},o.id))},j.id)):e.jsx(i,{className:"border border-gray-400 text-black",children:e.jsx(r,{className:"py-2 text-center text-xs font-bold tracking-wider",colSpan:4,children:t?"Balance Payment":"No items to display"},"empty-cell")},"empty-row"),s&&b&&!t&&e.jsx(e.Fragment,{children:e.jsxs(i,{className:"border-0 text-black",children:[e.jsx(r,{colSpan:2},"none"),e.jsx(r,{colSpan:1,className:"border-b border-l border-gray-400 py-1 text-xs font-medium",children:e.jsx("span",{className:"flex w-full justify-end",children:"Subtotal"})},"subtotal-label"),e.jsx(r,{colSpan:1,className:"border-b border-r border-gray-400 py-1",children:e.jsx("span",{className:"text-left text-xs",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(b)})},"subtotal-value")]})}),s&&d&&e.jsx(e.Fragment,{children:e.jsxs(i,{className:"border-0 text-black",children:[e.jsx(r,{colSpan:2},"none"),e.jsx(r,{colSpan:1,className:"border-b border-l border-gray-400 py-1 text-xs font-medium",children:e.jsx("span",{className:"flex w-full justify-end",children:"Discount"})},"discount-label"),e.jsx(r,{colSpan:1,className:"border-b border-r border-gray-400 py-1",children:e.jsxs("span",{className:"text-left text-xs",children:["-"," ",Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d)]})},"discount-value")]})}),s&&h&&e.jsx(e.Fragment,{children:e.jsxs(i,{className:"border-0 text-black",children:[e.jsx(r,{colSpan:2},"none"),e.jsx(r,{colSpan:1,className:"border-b border-l border-gray-400 py-1 text-xs font-medium",children:e.jsx("span",{className:"flex w-full justify-end",children:"Delivery fee"})},"deliveryCharge-label"),e.jsx(r,{colSpan:1,className:"border-b border-r border-gray-400 py-1",children:e.jsx("span",{className:"text-left text-xs",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(h)})},"deliveryCharge-value")]})}),s&&m&&e.jsx(e.Fragment,{children:e.jsxs(i,{className:"border-0 text-black",children:[e.jsx(r,{colSpan:2},"none"),e.jsx(r,{colSpan:1,className:"border-b border-l border-gray-400 py-1 text-xs font-bold",children:e.jsx("span",{className:"flex w-full justify-end",children:t?"Balance":"Total due"})},"totalDue-label"),e.jsx(r,{colSpan:1,className:"border-b border-r border-gray-400 py-1",children:e.jsx("span",{className:"text-left text-xs font-bold",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m)})},"totalDue-value")]})}),s&&a&&e.jsx(e.Fragment,{children:e.jsxs(i,{className:"border-0 text-black",children:[e.jsx(r,{colSpan:2},"none"),e.jsx(r,{colSpan:1,className:"border-b border-l border-gray-400 py-1 text-xs font-medium",children:e.jsx("span",{className:"flex w-full justify-end",children:"Amount paid"})},"amountPaid-label"),e.jsx(r,{colSpan:1,className:"border-b border-r border-gray-400 py-1",children:e.jsx("span",{className:"text-left text-xs",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a)})},"amountPaid-value")]})})]})]})}),s&&e.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[e.jsx("hr",{className:"w-full border-gray-400"}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 text-xs",children:[e.jsxs("p",{children:["Issued by: ",c.firstname+" "+c.lastname]}),e.jsx("p",{children:"Prepared by:"}),e.jsx("p",{children:"Released/checked by:"})]})]})]})}const F=({queue:n,itemsDatabase:x,fullData:s})=>{const{data:b}=S();function d(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a)}const h=[{size:50,accessorKey:"quantity",header:()=>e.jsx("div",{className:"text-xs font-bold",children:"QTY"}),cell:({row:a})=>{const t=a.original.id,c=x.find(l=>l.product_price_id===t);return e.jsx("span",{className:"text-xs",children:c.quantity})}},{size:800,accessorKey:"name",header:()=>e.jsx("div",{className:"text-xs font-bold",children:"Item"}),cell:({row:a})=>e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"text-xs font-bold",children:a.original.product.name}),a.original.product.brand?e.jsxs("span",{className:"text-xs",children:["(",a.original.product.brand,")"]}):null,e.jsx("span",{className:"text-xs",children:a.original.product.size}),e.jsx("span",{className:"text-xs",children:a.original.product.color})]})},{size:170,accessorKey:"price",header:()=>e.jsx("div",{className:"text-xs font-bold",children:"Price"}),cell:({row:a})=>{const t=a.original.id,c=x.find(p=>p.product_price_id===t),l=b.find(p=>p.product.id===a.original.product.id);return e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"text-xs",children:d(c.product_price)}),l!=null&&l.sale_discount?e.jsxs("span",{className:"text-xs font-light",children:["(",d((l==null?void 0:l.sale_discount)??0),")"]}):null]})}},{size:170,id:"total_price",accessorKey:"total_price",header:()=>e.jsx("div",{className:"text-xs font-bold",children:"Subtotal"}),cell:({row:a})=>{const t=a.original.id,c=x.find(l=>l.product_price_id===t);return e.jsx("div",{className:"text-xs",children:e.jsx("span",{children:d(c.total_price)})})}}],{auth:m}=w();return e.jsx(e.Fragment,{children:e.jsx(I,{user:m.user,data:n,columns:h,invoice:!0,subtotal:s.subtotal,discount:s.total_discount>0?s.total_discount:void 0,deliveryCharge:s.delivery_charge>0?s.delivery_charge:void 0,totalDue:s.total_amount_due,amountPaid:s.paid_amount>0?s.paid_amount:void 0,isBalancePayment:s.payment_method==="balance_payment"})})},k=({})=>{const[n,x]=u.useState(),[s,b]=u.useState(),[d,h]=u.useState(),[m,a]=u.useState(),[t,c]=u.useState();return console.log(window.api.receive()),u.useEffect(()=>{async function l(){b(await window.api.receive())}l()},[]),u.useEffect(()=>{s&&(x(s.fullData),h(new Date(s.fullData.updated_at)),a(s.invoiceItems),c(s.invoiceItemsDatabase))},[s]),e.jsx(e.Fragment,{children:n&&m&&d&&e.jsx("div",{className:"flex h-full w-screen flex-col p-3",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsxs("h3",{children:["Date issued: ",e.jsx("span",{className:"font-bold",children:d.toLocaleDateString([],{year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("h3",{children:["Invoice number: ",e.jsxs("span",{className:"font-bold",children:[" ",n.code," "]})]})]}),e.jsxs("h3",{children:["Billed to: ",e.jsx("span",{className:"font-bold",children:n.customer.firstname+" "+n.customer.lastname})]})]}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx(F,{queue:m,itemsDatabase:t,fullData:n})})]})})})};export{k as PrintForm};
