import{p as pe,t as Os,r as h,v as ia,w as oa,x as da,y as Ie,m as le,z as ss,D as xa,E as ma,G as ua,H as ot,I as ha,J as fa,K as pa,L as ja,O as ga,Q as Na,R as ya,U as dt,V as va,W as xt,X as mt,Y as Rs,Z as ba,$ as ge,j as e,B as b,a0 as Ae,M as ae,a1 as wa,a2 as ut,a3 as Ke,b as ts,a4 as ye,a5 as ve,a6 as be,a7 as we,a8 as de,a9 as V,aa as ht,ab as _a,ac as Ks,ad as Sa,ae as Ca,af as P,ag as ws,ah as ka,ai as Qe,aj as Fa,d as gs,ak as ft,al as pt,am as jt,an as gt,ao as J,ap as ee,aq as se,ar as te,as as $,at as G,au as Xs,av as Zs,aw as We,ax as w,ay as qe,az as Nt,aA as yt,aB as Ia,aC as Pa,aD as Ta,aE as ne,aF as Me,aG as Oe,aH as _s,aI as Re,aJ as Us,aK as os,aL as Ye,C as He,aM as K,aN as I,aO as vt,aP as Ue,aQ as Se,aR as je,aS as Ce,aT as ls,aU as $e,aV as Ve,aW as Ge,aX as Ee,aY as Te,aZ as Ss,a_ as bt,a$ as wt,b0 as Ns,b1 as Js,b2 as Aa,b3 as Da,b4 as za,T as _t,b5 as Ea,b6 as Wa,b7 as Ze,b8 as ds,b9 as xs,ba as ms,bb as us,bc as St,bd as Ma,be as Oa,bf as Ra,bg as Ka,bh as Ua,bi as ue,bj as Be,bk as Ls,bl as Cs,bm as et,bn as La,bo as qa,bp as Ha,bq as $a,br as Va,bs as Ba,bt as Ct,bu as Qa,bv as kt,bw as cs,bx as Ft,by as It,bz as xe,bA as Ya,bB as Ga,bC as Xa,bD as Za,bE as Pt,bF as Ja,bG as Tt,bH as ks,u as At,bI as Dt,bJ as hs,bK as st,bL as tt,bM as at,bN as qs,bO as el,bP as lt,bQ as sl,bR as tl,bS as Hs,bT as al,bU as ll,bV as rl,bW as Je,_ as zt,h as Et,i as Wt,k as Mt,bX as Ot,l as Rt,bY as rt,bZ as Es,b_ as $s,b$ as nl,c0 as cl,c1 as Kt,c2 as il,c3 as ol,c4 as Vs,c5 as dl,c6 as Fs,c7 as xl,c8 as ml,c9 as ul,ca as hl,cb as fl,o as Ut,A as Lt,cc as qt}from"./index-ab6bdded.js";import{cd as zc}from"./index-ab6bdded.js";import{M as me,f as ce,a as _e,P as ke,T as rs,b as pl,u as Ht,A as jl,C as Xe,N as Bs,c as as,g as Qs,d as gl}from"./useInventoryProductCalculations-f1b4d858.js";import{a as Y,I as Q,D as X,A as D,b as z,c as E,u as oe,f as Nl,d as ie,P as Ys}from"./timeUtils-c181079f.js";import{F as Gs,B as es,M as yl,R as fs}from"./ReportCard-2e8992f0.js";import{P as vl}from"./PosTable-8a606966.js";import"./index-79da26b4.js";const bl=()=>{const t=pe(),{warehouses:s}=Os(),[a,l]=h.useState({id:s.length+1||0,code:"",name:"",location:""}),r=d=>{const{name:m,value:u}=d.target;l(x=>({...x,[m]:u}))},c={onSuccess:async()=>{await t.invalidateQueries({queryKey:["warehouses"]}),l({id:s.length+1||0,code:"",name:"",location:""})},onError:d=>{console.error("Warehouse Data failed",d)}},{mutateAsync:n}=Y({mutationKey:["removeWarehouse"],mutationFn:ia,...c}),{mutateAsync:i}=Y({mutationKey:["addWarehouse"],mutationFn:oa,...c}),{mutateAsync:o}=Y({mutationKey:["updateWarehouse"],mutationFn:da,...c});return{value:a,setValue:l,handleChange:r,removeWarehouseMutation:n,addWarehouseMutation:i,updateWarehouseMutation:o}},wl=()=>{const t=pe(),{transfers:s}=Ie(),{auth:a}=le(),{warehouses:l}=ss(),r=s[0]?s[s.length-1].id+1:1,[c,n]=h.useState(!1),[i,o]=h.useState(!1),[d,m]=h.useState(null),[u,x]=h.useState(null),[y,f]=h.useState(null),[N,j]=h.useState(),[p,g]=h.useState(),[v,F]=h.useState(),[_,k]=h.useState({});h.useEffect(()=>{k(O=>({...O,approval_status:"pending",created_by:a.user.id,transfer_schedule:""}))},[]);const T=()=>{const O=Object.keys(_).map(A=>({text:A})),R=O.length===6||O.length>6;if(R){const A=_.source!==_.destination;if(A){const Z=_.transfer_schedule!=="";return Z?[Z,""]:[Z,"Please fill up transfer schedule"]}else return[A,"You cannot have the same source and destination"]}else return[R,"Please fill up all fields"]},C=O=>{n(!0),x(null),m(null),k(R=>({...R,[O.target.name]:O.target.value}))},M=O=>{if(n(!0),x(null),m(null),O){f(O);const R=O.$H<10?"0"+O.$H.toString():O.$H.toString(),A=O.$m<10?"0"+O.$m.toString():O.$m.toString(),Z=O.$s<10?"0"+O.$s.toString():O.$s.toString();k(B=>({...B,transfer_schedule:_.transfer_schedule+" "+R+":"+A+":"+Z}))}else f(null),k(R=>({...R,transfer_schedule:_.transfer_schedule.split(" ")[0]}))},U=(O,R)=>{var A,Z,B,Pe;n(!0),x(null),m(null),k(he=>({...he,[O]:R})),console.log(O,R),O==="source"&&R==1?(j((A=l.find(he=>he.id===R))==null?void 0:A.code),g((Z=l.find(he=>he.id===R+1))==null?void 0:Z.code),k(he=>({...he,destination:R+1}))):O==="source"&&R==2?(j((B=l.find(he=>he.id===R))==null?void 0:B.code),g((Pe=l.find(he=>he.id===R-1))==null?void 0:Pe.code),k(he=>({...he,destination:R-1}))):O==="transfer_schedule"&&(F(R.replace(/-/g,"")),f(R))},W=async()=>{if(console.log(N,p,v),console.log(_),N&&p&&v){const O="TRF-"+N+"-"+p+"-"+v+"-"+r;k(R=>({...R,code:O}))}};h.useEffect(()=>{async function O(){if(_.code){const R=T();if(o(!0),R[0])return S(_);m(R[1]),o(!1)}}O()},[_.code]);const L={onSuccess:async()=>{await t.invalidateQueries({predicate:O=>["transfers","transfer_products"].includes(O.queryKey[0])}),o(!1),n(!1),x("Transfer info has been added")},onError:O=>{console.error(O),m(O.message),o(!1)}},{mutateAsync:S,isPending:re}=Y({mutationKey:["addTransfer"],mutationFn:xa,...L});return{transfer:_,lastId:r,isChanged:c,isSubmitting:i,isPending:re,error:d,success:u,dateDisplay:y,handleSubmit:W,handleChange:C,handleChangeSelect:U,handleChangeDateTime:M,addTransferMutation:S}},$t=()=>{const t=pe(),[s,a]=h.useState({}),l=(o,d)=>{a(m=>({...m,[o]:d}))},r=async o=>{if(console.log("Submitting: ",o),o.action==="add")return await n(o.data);if(o.action==="update")return await i({id:o.id,data:o.data});{const d="No data to submit. Function requires at least one parameter.";return console.error(d),{status:400,data:d}}},c={onSuccess:async()=>{await t.invalidateQueries({queryKey:["inventory"]})},onError:o=>{console.error("Inventory Data failed",o)}},{mutateAsync:n}=Y({mutationKey:["addInventory"],mutationFn:ma,...c}),{mutateAsync:i}=Y({mutationKey:["patchInventory"],mutationFn:ua,...c});return{value:s,setValue:a,handleChange:l,handleSubmit:r}},_l=()=>{const t=pe(),{transfers:s,transferProducts:a,selectedTransfer:l}=Ie(),r=a.filter(q=>q.transfer_id===l.id),{auth:c}=le(),{warehouses:n}=ss(),[i,o]=h.useState(!1),[d,m]=h.useState(!1);h.useState(!1);const[u,x]=h.useState(!1);h.useState(!1);const[y,f]=h.useState(!1),{data:N}=ot(),[j,p]=h.useState(0),[g,v]=h.useState(!1),[F,_]=h.useState(!1),[k,T]=h.useState(null),[C,M]=h.useState(null),[U,W]=h.useState(new Date),[L,S]=h.useState(new Date),[re,O]=h.useState(""),[R,A]=h.useState(),Z=s[s.length-1].id+1,[B,Pe]=h.useState({});if(h.useEffect(()=>{l&&(Pe({id:l.id,code:l.code,created_by:l.created_by.id,source:l.source.id,destination:l.destination.id,transfer_schedule:l.transfer_schedule,approval_status:l.approval_status,approved_by:l.approved_by?l.approved_by.id:null,transfer_status:l.transfer_status,date_received:l.date_received,received_by:l.received_by?l.received_by.id:null,notes:l.notes}),W(new Date(l.transfer_schedule)),l.date_received?S(new Date(l.date_received)):S(new Date(l.transfer_schedule)))},[l]),B.code==""){const q=B.transfer_schedule.split(" ")[0].split("-").join(""),fe="TRF-"+l.source.code+"-"+l.destination.code+"-"+q+"-"+Z;Pe(Le=>({...Le,code:fe}))}const he=()=>{const q=B.source!==B.destination;if(q){const fe=B.transfer_status==="arrived"?!!(B.received_by&&B.date_received):!0;if(fe)return[fe,""];{const Le=`Fields you need to fill: ${B.received_by?"":"received by"} 
									${!B.date_received&&!B.received_by?" and ":""}
									${B.date_received?"":"date received"}`;return[fe,Le]}}else return[q,"You cannot have the same source and destination"]},Ts=q=>{v(!0),M(null),T(null),Pe(fe=>({...fe,[q.target.name]:q.target.value}))},ps=(q,fe)=>{v(!0),M(null),T(null),O(q),A(fe),q==="transfer_schedule"?W(fe):S(fe)};h.useEffect(()=>{async function q(){if(re&&R){const fe=R.getFullYear()+"-"+(R.getMonth()+1)+"-"+R.getDate()+" "+R.getHours()+":"+R.getMinutes()+":"+R.getSeconds();Pe(Le=>({...Le,[re]:fe}))}}q()},[U,L]);const js=(q,fe)=>{console.log(q,fe),v(!0),M(null),T(null),Pe(Le=>({...Le,[q]:fe}))};h.useEffect(()=>{B.approval_status==="approved"?Pe(q=>({...q,approved_by:c.user.id})):B.approval_status==="rejected"&&f(!0)},[B.approval_status]),h.useEffect(()=>{B.transfer_status==="arrived"?o(!0):o(!1)},[B.transfer_status]),h.useEffect(()=>{if(d){async function q(){const Le={code:"INV-"+n.filter(ca=>ca.id===B.destination)[0].code+"-TRA-"+l.code.split("-")[3]+"-"+(Number(N.length)+1).toString(),warehouse_id:B.destination,created_by:B.created_by,date_received:B.date_received,type:"transfer",transfer_id:B.id,notes:B.notes},na=await ns(Le);p(na.data.data.id)}q()}},[d]);async function As(){await ja(r,j).then(async q=>{_(!1),v(!1),M("Transfer info has been edited")}).catch(q=>{throw console.error("Error updating inventory products:",q),q})}h.useEffect(()=>{j!=0&&As()},[j]);const H=async()=>{const q=he();if(_(!0),q[0])if(i)await De(B);else return await De(B);else T(q[1]),_(!1)},Fe={onSuccess:async()=>{if(await t.invalidateQueries({queryKey:["transfers"]}),i)m(!0);else{if(y)return await zs(r);_(!1),v(!1),M("Transfer info has been edited")}},onError:q=>{console.error(q),T(q.message),_(!1)}},{mutateAsync:De}=Y({mutationKey:["transfers"],mutationFn:ha,...Fe}),ze={onSuccess:async()=>{await t.invalidateQueries({queryKey:["inventory"]}),x(!0)},onError:q=>{console.error(q),T(q.message),_(!1)}},{mutateAsync:ns}=Y({mutationKey:["addInventory"],mutationFn:fa,...ze}),Ds={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfer_products"]}),_(!1),v(!1),M("Transfer info has been edited")},onError:q=>{console.error(q),T(q.message),_(!1)}},{mutateAsync:zs}=Y({mutationKey:["initInventoryProduct"],mutationFn:pa,...Ds});return{transfer:B,selectedTransfer:l,lastId:Z,isChanged:g,isSubmitting:F,error:k,success:C,dateDisplay:U,dateDisplayArrived:L,handleSubmit:H,handleChange:Ts,handleChangeSelect:js,handleChangeDateTime:ps,editTransferMutation:De}},Is=()=>{const t=pe(),[s,a]=h.useState({}),l=(d,m)=>{a(u=>({...u,[d]:m}))},r=async d=>{if(console.log("Submitting: ",d),d.action==="add")return await n(d.data);if(d.action==="update")return await i({id:d.id,data:d.data});{const m="No data to submit. Function requires at least one parameter.";return console.error(m),{status:400,data:m}}},c={onSuccess:async()=>{await t.invalidateQueries({predicate:d=>["productPrices","pendingProductPrices","approvedProductPrices","productPricesTEST"].includes(d.queryKey[0])}),a({})},onError:d=>{console.error("Product Prices Data failed",d)}},{mutateAsync:n}=Y({mutationKey:["addProductListing"],mutationFn:ga,...c}),{mutateAsync:i}=Y({mutationKey:["patchProductListing"],mutationFn:Na,...c}),{mutateAsync:o}=Y({mutationKey:["deleteProductListing"],mutationFn:ya,...c});return{value:s,setValue:a,handleChange:l,handleSubmit:r,addProductPricesMutation:n,patchProductPricesMutation:i,deleteProductPricesMutation:o}},Ps=()=>{const t=pe(),{transfers:s,transferProducts:a,selectedProduct:l,selectedTransfer:r,addProd:c}=Ie();le();const{data:n,isLoading:i}=dt(),{data:o}=va(),{data:d,isLoading:m}=ot(),u=d.filter(H=>H.warehouse.id===r.source.id&&o.some(Fe=>Fe.inventory_id===H.id)),[x,y]=h.useState([]),[f,N]=h.useState(0),[j,p]=h.useState(""),[g,v]=h.useState(l.id?l.product.name:""),[F,_]=h.useState(0),[k,T]=h.useState(0),[C,M]=h.useState(!1),[U,W]=h.useState(!1),[L,S]=h.useState(null),[re,O]=h.useState(null),[R,A]=h.useState({});function Z(){l.id?A(H=>({...H,id:l.id,transfer_id:l.transfer_id,unit:l.unit,source_inventory:f})):A(H=>({...H,id:a.length+1,transfer_id:r.id}))}h.useEffect(()=>{A(c?H=>({...H,id:a.length+1,transfer_id:r.id}):{id:l.id,transfer_id:l.transfer_id,product_id:l.product.id,total_quantity:l.total_quantity,capital_price:l.capital_price,unit:l.unit,source_inventory:l.source_inventory})},[]),h.useEffect(()=>{if(!c){const H=o.find(Fe=>Fe.id===l.source_inventory);_(H!=null&&H.remaining_stocks_count?H.remaining_stocks_count:0),T(H!=null&&H.damage_count?H.damage_count:0),N(l.source_inventory)}},[o]);const B=(H,Fe)=>{M(!0),O(null),S(null),A(De=>({...De,[H.target.name]:Number(H.target.value)}))},Pe=(H,Fe,De)=>{if(M(!0),O(null),S(null),H==="product_id"&&De!=null){const ze=x[De];v(ze.product.name);const ns=ze.capital_price,Ds=ze.unit,zs=Number(Fe);A(q=>({...q,[H]:zs,capital_price:ns,unit:Ds,source_inventory:f})),_(ze.remaining_stocks_count?ze.remaining_stocks_count:0),T(ze.damage_count)}else if(H==="inventory_id"){p(Fe.toString());const ze=u==null?void 0:u.filter(ns=>ns.id===Fe)[0].id;N(ze),v(""),R.capital_price&&(Z(),A({}))}};h.useEffect(()=>{o.length!=0&&y(o.filter(H=>H.inventory_id===f&&H.remaining_stocks_count&&H.remaining_stocks_count>0))},[f]);const he=()=>{const Fe=Object.keys(R).map(De=>({text:De})).length===7;return Fe?R.total_quantity>F?[!1,"Quantity input is greater than the current stock quantity."]:[!0,""]:[Fe,"Please fill up all fields"]},Ts=async()=>{W(!0);const H=he();if(H[0])return c?await js(R):await As(R);S(H[1]),W(!1)},ps={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfer_products"]}),W(!1),M(!1),O(c?"Transfer product has been added":"Transfer product has been edited")},onError:H=>{console.error(H),S(H.message),W(!1)}},{mutateAsync:js}=Y({mutationKey:["transfer_product"],mutationFn:xt,...ps}),{mutateAsync:As}=Y({mutationKey:["transfer_product"],mutationFn:mt,...ps});return{product:R,allProducts:n,allInventoryProducts:o,isInventoryLoading:m,isAllProductsLoading:i,inventoryID:f,invCode:j,prodName:g,filteredInventoriesSrc:u,filteredProductsSrc:x,quantityLimit:F,damagedCount:k,isChanged:C,isSubmitting:U,error:L,success:re,handleSubmit:Ts,handleChange:B,handleChangeSelect:Pe,addProductMutation:js}},Sl=()=>{const{selectedReturn:t}=Rs(),[s,a]=h.useState(!1),[l,r]=h.useState(null),[c,n]=h.useState(null),[i,o]=h.useState({id:t.id,code:t.code,invoice_id:t.invoice.id,issued_by:t.issued_by.id,refundable_amount:t.refundable_amount,voucher_id:t.voucher?t.voucher.id:null,refund_status:"done",created_at:t.created_at,updated_at:t.updated_at}),d=async()=>{a(!0),await u(i)},m={onSuccess:async()=>{a(!1),n("Return info has been edited")},onError:x=>{console.error(x),r(x.response.data.message),a(!1)}},{mutateAsync:u}=Y({mutationKey:["returns"],mutationFn:ba,...m});return{selectedReturn:t,isSubmitting:s,error:l,success:c,handleSubmit:d}};/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=ge("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=ge("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=ge("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=ge("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=ge("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=ge("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=ge("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=ge("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=ge("CircleOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.35 2.69A10 10 0 0 1 21.3 15.65",key:"1pfsoa"}],["path",{d:"M19.08 19.08A10 10 0 1 1 4.92 4.92",key:"1ablyi"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=ge("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=ge("MapPinned",[["path",{d:"M18 8c0 4.5-6 9-6 9s-6-4.5-6-9a6 6 0 0 1 12 0",key:"yrbn30"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M8.835 14H5a1 1 0 0 0-.9.7l-2 6c-.1.1-.1.2-.1.3 0 .6.4 1 1 1h18c.6 0 1-.4 1-1 0-.1 0-.2-.1-.3l-2-6a1 1 0 0 0-.9-.7h-3.835",key:"112zkj"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=ge("MoveRight",[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=ge("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=ge("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=ge("ShoppingBasket",[["path",{d:"m15 11-1 9",key:"5wnq3a"}],["path",{d:"m19 11-4-7",key:"cnml18"}],["path",{d:"M2 11h20",key:"3eubbj"}],["path",{d:"m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4",key:"yiazzp"}],["path",{d:"M4.5 15.5h15",key:"13mye1"}],["path",{d:"m5 11 4-7",key:"116ra9"}],["path",{d:"m9 11 1 9",key:"1ojof7"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=ge("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Dl=({isUpdate:t=!1,onClose:s,isDelete:a})=>{const{warehouseSelected:l}=Os(),{value:r,setValue:c,handleChange:n,addWarehouseMutation:i,updateWarehouseMutation:o,removeWarehouseMutation:d}=bl();h.useEffect(()=>{(t||a)&&c(l)},[t,a,l,c]);const[m,u]=h.useState(!1),[x,y]=h.useState(null),[f,N]=h.useState(null),j=async()=>{u(!0);try{await new Promise(p=>setTimeout(p,1e3)),t&&(await o(r),u(!1),y("Warehouse updated successfully"),s()),a?(await d(r.id),u(!1),y("Warehouse deleted successfully"),s()):!t&&!a&&(await i(r),u(!1),y("Warehouse added successfully"),s())}catch(p){console.error("Warehouse data submission failed",p),u(!1),N(p.message)}};return e.jsx(e.Fragment,{children:a?e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:p=>{p.preventDefault(),j()},children:e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx(b,{type:"submit",fill:"red",children:a?"Delete Warehouse":"Add Warehouse"})})})}):e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:p=>{p.preventDefault(),j()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse ID"}),e.jsx(Q,{name:"id",value:(r==null?void 0:r.id)||0,type:"number",disabled:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Code"}),e.jsx(Q,{name:"code",placeholder:"Warehouse Code",value:(r==null?void 0:r.code)||"",onChange:n,maxLength:3})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Name"}),e.jsx(Q,{name:"name",placeholder:"Warehouse Name",value:(r==null?void 0:r.name)||"",onChange:n,required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Location"}),e.jsx(Q,{name:"location",placeholder:"Warehouse Location",type:"string",value:(r==null?void 0:r.location)||"",onChange:n,required:!0})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[x&&e.jsx("div",{className:"font-bold text-green-700",children:x}),f&&e.jsx("div",{className:"font-bold text-red-700",children:f}),m?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:s,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",children:t?"Update Warehouse":"Add Warehouse"})]})})]})})]})})})})},zl=({openModal:t})=>{const{warehouses:s,setWarehouseSelected:a,isFetching:l,progress:r}=Os(),c=[{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE ID"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.id})},{accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:i})=>e.jsx("div",{className:"items-center",children:e.jsxs(b,{onClick:()=>i.toggleSorting(i.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["WAREHOUSE NAME ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.name})},{accessorKey:"code",header:()=>e.jsx("div",{className:"text-center",children:"code"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.code})},{accessorKey:"location",header:()=>e.jsx("div",{className:"text-center",children:"LOCATION"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.location})},{id:"actions",header:()=>e.jsx("div",{className:"flex flex-row justify-center",children:"ACTIONS"}),cell:({row:i})=>{const o=i.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(b,{fill:"empty",textColor:"black",onClick:()=>n(o),className:"flex flex-row items-center gap-2",children:[e.jsx(Gs,{})," Edit"]})})}}],n=i=>{a(i),t(i,"edit")};return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:c,filterWhat:"location",dataType:"",isLoading:l,openModal:void 0})})},nc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Warehouse",children:e.jsxs(wa,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(zl,{openModal:c})})}),e.jsx(me,{isOpen:t,onClose:a,title:l==="edit"?"Edit Warehouse":l==="remove"?"Remove Warehouse":"Add Warehouse",children:e.jsx(Dl,{onClose:a,isUpdate:l==="edit",isDelete:l==="remove"})})]})})})},El=({openModal:t})=>{const{invoices:s}=ut(),a=Ke(),l=[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx(e.Fragment,{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:r})=>e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{className:"font-bold",children:r.original.code})})},{accessorKey:"warehouse.code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Warehouse"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"payment_method",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Type"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:r})=>{const c=r.original.payment_method.split("_").join(" ");return e.jsx(e.Fragment,{children:e.jsx("span",{className:"capitalize",children:c})})}},{accessorKey:"is_paid",header:({})=>e.jsx("span",{children:"Balance Amount"}),cell:({row:r})=>{const c=r.original.is_paid;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"group relative flex w-fit items-center justify-center",children:c===1?e.jsx("span",{children:"——"}):c===0?e.jsx("span",{className:"",children:ce(r.original.balance_amount)}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})})}},{accessorKey:"total_amount_due",header:({column:r})=>e.jsx("span",{children:"Total Amount"}),cell:({row:r})=>ce(r.original.total_amount_due)},{id:"actions",cell:({row:r})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>{a(`/transaction/items/${r.original.id}`)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Tl,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View Invoice"})]})]})]})}),enableGlobalFilter:!1}];return e.jsx(e.Fragment,{children:e.jsx(X,{columns:l,data:s.sort((r,c)=>{const n=new Date(r.updated_at??r.created_at);return new Date(c.updated_at??c.created_at).getTime()-n.getTime()}),filterWhat:"code",dataType:"Invoices"})})},cc=({})=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i),console.log("modalAction:",l)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Transactions",children:e.jsx(ht,{children:e.jsx(_a,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(El,{openModal:c})})})})})})})},Wl=({items:t})=>{const s=[{id:"orderItem",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Item #"}),cell:({row:a})=>e.jsxs("div",{className:"flex flex-row gap-2 ",children:[a.original.product.brand?e.jsx(e.Fragment,{children:e.jsxs("span",{children:["(",a.original.product.brand,")"]})}):null,e.jsx("span",{className:"font-bold",children:a.original.product.name}),e.jsx("span",{className:"",children:a.original.product.size}),e.jsx("span",{className:"",children:a.original.product.color})]}),size:200},{id:"quantity",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Quantity"}),cell:({row:a})=>e.jsx("div",{className:"flex ",children:a.original.quantity})},{id:"price",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Price"}),cell:({row:a})=>e.jsx("div",{className:"flex ",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a.original.product_price??0)})}];return e.jsx(e.Fragment,{children:e.jsx(X,{columns:s,data:t,dataType:"orderItem",filterWhat:"price",hideFilter:!0})})},ic=({})=>{const t=Ke(),{id:s}=Ks(),{data:a,isLoading:l}=Sa(Number(s)),{invoiceItems:r,isLoading:c}=Ca(Number(s)),n=()=>{t(-1)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Transaction Items",children:e.jsxs("div",{className:"flex h-full max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:[e.jsxs("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:[e.jsxs(P,{onClick:()=>n(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(ws,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]}),e.jsxs("div",{className:"flex flex-row gap-8",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Inventory code:"}),e.jsx("span",{children:l?"Loading...":a==null?void 0:a.code})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Created at:"}),e.jsx("span",{children:l?"Loading...":Nl(a==null?void 0:a.created_at)})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Issued By:"}),e.jsx("span",{children:l?"Loading...":(a==null?void 0:a.issued_by.firstname)+" "+(a==null?void 0:a.issued_by.lastname)})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Customer:"}),e.jsx("span",{className:"capitalize",children:l?"Loading...":(a==null?void 0:a.customer.firstname)+" "+(a==null?void 0:a.customer.lastname)})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Total Amount Due:"}),e.jsx("span",{children:l?"Loading...":ce(a==null?void 0:a.total_amount_due)})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Warehouse:"}),e.jsx("span",{children:l?"Loading...":a==null?void 0:a.warehouse.code})]})]}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Balance Amount:"}),e.jsx("span",{children:l?"Loading...":ce(a==null?void 0:a.balance_amount)})]})})]})]}),e.jsx("div",{children:!c&&e.jsx(e.Fragment,{children:e.jsx(Wl,{items:r})})})]})})})},Ml=(t,s)=>{const a=pe(),[l,r]=h.useState(""),[c,n]=h.useState(""),[i,o]=h.useState({firstname:t.firstname,lastname:t.lastname,username:t.username,email:t.email,contact_no:t.contact_no,position:t.position,user_id:t.id,role_id:0});h.useEffect(()=>{s&&o(k=>{var T;return{...k,role_id:(T=s.find(C=>C.title===t.position))==null?void 0:T.id}})},[s]);const[d,m]=h.useState(!1),[u,x]=h.useState(!1),[y,f]=h.useState(null),[N,j]=h.useState(null),p=(k,T)=>{m(!0),j(null),f(null),o(C=>({...C,[k]:T}))},g=k=>{m(!0),j(null),k.target.name==="position"?o(T=>{var C;return{...T,[k.target.name]:k.target.value,role_id:(C=s.find(M=>M.title===k.target.value))==null?void 0:C.id}}):k.target.name==="new_password"?r(k.target.value):k.target.name==="confirm_password"?n(k.target.value):o(T=>({...T,[k.target.name]:k.target.value}))};h.useEffect(()=>{l!=c?f("Passwords don't match"):f(null)},[l,c]);const v=async()=>{var k,T;((k=i.contact_no)==null?void 0:k.length)>11||((T=i.contact_no)==null?void 0:T.length)<11?f("Contact number must be 11 digits"):(x(!0),l!==""&&c!==""&&o(C=>({...C,password:c})))};h.useEffect(()=>{u&&_(i)},[i,u]);const F={onSuccess:async()=>{await a.invalidateQueries({queryKey:["users"]}),x(!1),m(!1),j("User info has been updated")},onError:k=>{console.error(k),f(k.message),x(!1)}},{mutateAsync:_}=Y({mutationKey:["editUser"],mutationFn:ka,...F});return{user:i,isChanged:d,isSubmitting:u,password:l,compPassword:c,error:y,setError:f,success:N,handleSubmit:v,handleChangeSelect:p,handleChange:g,editUserMutation:_}},Ol=()=>{const t=pe(),{users:s}=Qe(),{roles:a}=Qe();s[s.length-1].id+1;const[l,r]=h.useState({});h.useEffect(()=>{r(v=>({...v,active_status:"active"}))},[]);const[c,n]=h.useState(!1),[i,o]=h.useState(!1),[d,m]=h.useState(null),[u,x]=h.useState(null),y=()=>{var _,k;const F=Object.keys(l).map(T=>({text:T})).length===10;if(F){const T=l.password===l.password_confirmation;if(!T)return[T,"Passwords do not match"];const C=!(((_=l.contact_no)==null?void 0:_.length)>11||((k=l.contact_no)==null?void 0:k.length)<11);return C?[F&&T&&C,""]:[C,"Please input a valid contact number"]}else{const T=!!l.position;return T?[F,"Please correctly fill up all fields"]:[T,"Please choose a position"]}},f=v=>{n(!0),x(null),m(null),r(F=>({...F,[v.target.name]:v.target.value}))},N=(v,F)=>{n(!0),x(null),m(null),r(_=>{var k;return{..._,[v]:F,role_id:(k=a.find(T=>T.title===F))==null?void 0:k.id}})},j=async()=>{const v=y();if(o(!0),v[0])return await g(l);m(v[1]),o(!1)},p={onSuccess:async()=>{await t.invalidateQueries({queryKey:["users"]}),o(!1),n(!1),x("User info has been added")},onError:v=>{console.error(v),m(v.response.data.message),o(!1)}},{mutateAsync:g}=Y({mutationKey:["addUser"],mutationFn:Fa,...p});return{user:l,isChanged:c,isSubmitting:i,error:d,setError:m,success:u,handleSubmit:j,handleChange:f,handleChangeSelect:N,addUserMutation:g}},Rl=()=>{const t=pe(),{roles:s,selectedUser:a}=Qe(),l=s.filter(U=>U.title===a.position),[r,c]=h.useState([]),[n,i]=h.useState([]),[o,d]=h.useState([]),{data:m}=gs({queryKey:["all-permissions"],queryFn:()=>jt(),refetchOnWindowFocus:!1});h.useEffect(()=>{const U=m;U&&i(U)},[m]);const{isFetching:u,data:x}=gs({queryKey:["permissions"],queryFn:()=>gt(l[0].id),refetchOnWindowFocus:!1});h.useEffect(()=>{const U=x;U&&(c(U),d(U))},[x]);const[y,f]=h.useState(!1),[N,j]=h.useState(!1),[p,g]=h.useState(null),[v,F]=h.useState(null),_=(U,W)=>{f(!0),F(null),g(null),d(U?[...o,{id:null,role_id:l,permission_id:W}]:o.filter(L=>L.permission_id!==W))},k=async()=>{if(j(!0),o.length>r.length){const U=o.filter(W=>W.id===null);if(U.length>1)U.forEach(async W=>{await C(W)});else return await C(U)}else if(o.length<r.length){const U=r.filter(W=>o.find(L=>L.permission_id===W.permission_id)===void 0);if(U.length>1)U.forEach(async W=>{await M(W)});else return await M(U[0])}else j(!1),f(!1),F("No changes made")},T={onSuccess:async()=>{await t.invalidateQueries({queryKey:["all-permissions"]}),j(!1),f(!1),F("Role permissions have been updated")},onError:U=>{console.error(U),g(U.message),j(!1)}},{mutateAsync:C}=Y({mutationKey:["addpermission"],mutationFn:ft,...T}),{mutateAsync:M}=Y({mutationKey:["deletepermission"],mutationFn:pt,...T});return{permissions:r,allPermissions:n,permissionChange:o,isChanged:y,isSubmitting:N,error:p,success:v,handleSubmit:k,handleChange:_}},Kl=()=>{const t=pe(),{roles:s}=Qe(),[a,l]=h.useState(),[r,c]=h.useState(0);h.useState();const[n,i]=h.useState([]),[o,d]=h.useState([]),[m,u]=h.useState([]),{data:x}=gs({queryKey:["all-permissions"],queryFn:()=>jt(),refetchOnWindowFocus:!1});h.useEffect(()=>{const W=x;W&&d(W)},[x]);const[y,f]=h.useState(!1),[N,j]=h.useState(!1),[p,g]=h.useState(null),[v,F]=h.useState(null),_=(W,L)=>{F(null),g(null),l(s.find(S=>S.title===L)),c(s.find(S=>S.title===L).id)};h.useEffect(()=>{async function W(){const L=await gt(r);i(L),u(L)}W()},[r]);const k=(W,L)=>{f(!0),F(null),g(null),u(W?[...m,{id:null,role_id:r,permission_id:L}]:m.filter(S=>S.permission_id!==L))},T=async()=>{if(j(!0),m.length>n.length){const W=m.filter(L=>L.id===null);if(W.length>1)W.forEach(async L=>{await M(L)});else return await M(W[0])}else if(m.length<n.length){const W=n.filter(L=>m.find(S=>S.permission_id===L.permission_id)===void 0);if(W.length>1)W.forEach(async L=>{await U(L)});else return await U(W[0])}else j(!1),f(!1),F("No changes made")},C={onSuccess:async()=>{await t.invalidateQueries({queryKey:["all-permissions"]}),j(!1),f(!1),F("Role permissions have been updated")},onError:W=>{console.error(W),g(W.message),j(!1)}},{mutateAsync:M}=Y({mutationKey:["addpermission"],mutationFn:ft,...C}),{mutateAsync:U}=Y({mutationKey:["deletepermission"],mutationFn:pt,...C});return{roles:s,roleSelect:a,permissions:n,allPermissions:o,permissionChange:m,roleId:r,isChanged:y,isSubmitting:N,error:p,success:v,handleSubmit:T,handleChange:k,handleChangeSelect:_}},Ul=({openModal:t})=>{const{users:s,isFetching:a,progress:l,progress2:r,setSelectedUser:c}=Qe(),n=m=>{c(m),t(m,"edit")},i=m=>{c(m),t(m,"editPerms")},o=()=>{t({},"add")},d=[{accessorKey:"lastname",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{m.toggleSorting(m.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["LAST NAME ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.lastname})},{accessorKey:"firstname",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>m.toggleSorting(m.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["FIRST NAME ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.firstname})},{accessorKey:"position",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>m.toggleSorting(m.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["ROLE ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.position})},{accessorKey:"username",header:()=>e.jsx("div",{className:"text-center",children:"USERNAME"}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.username})},{accessorKey:"email",header:()=>e.jsx("div",{className:"text-center",children:"EMAIL ADDRESS"}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.email})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:m})=>{const u=m.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>n(u),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit User"})]}),e.jsxs(V,{onClick:()=>i(u),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit User Permission"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:d,filterWhat:"username",dataType:"User",openModal:o,isLoading:a})})},Ll=({onClose:t})=>{const{user:s,isChanged:a,isSubmitting:l,error:r,setError:c,success:n,handleSubmit:i,handleChange:o,handleChangeSelect:d}=Ol(),{roles:m}=Qe(),u=m==null?void 0:m.filter(x=>x.title!=="super_admin");return u&&u.map(x=>x.title.replace("_"," ")),n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:x=>{x.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User ID"}),e.jsx(Q,{name:"id",value:s.id,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User First Name"}),e.jsx(Q,{name:"firstname",placeholder:"User First Name",value:s.firstname||"",onChange:o,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Last Name"}),e.jsx(Q,{name:"lastname",placeholder:"User Last Name",value:s.lastname||"",onChange:o,required:!0})]})]}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Email Address"}),e.jsx(Q,{name:"email",placeholder:"User Email Address",type:"email",value:s.email||"",onChange:o,onKeyDown:x=>{x.code==="Space"?(x.preventDefault(),c("Space not allowed")):c(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Contact Number"}),e.jsx(Q,{name:"contact_no",placeholder:"User Contact Number",type:"number",value:s.contact_no||"",onChange:o,onKeyDown:x=>{x.code==="Space"?(x.preventDefault(),c("Space not allowed")):c(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Position"}),e.jsxs(J,{onValueChange:x=>d("position",x),children:[e.jsx(ee,{name:"position",className:"flex flex-row items-center gap-3 truncate text-md rounded-md bg-slate-100",children:e.jsx(se,{placeholder:s.position?s.position.charAt(0).toUpperCase()+s.position.slice(1):"Choose position..."})}),e.jsx(te,{className:"bg-white font-medium text-md",children:m.length>0?m.map(x=>{if(x.title!=="super_admin")return e.jsx($,{value:x.title,children:x.title.charAt(0).toUpperCase()+x.title.slice(1).replace("_"," ")},x.id)}):e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]})]}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Username"}),e.jsx(Q,{name:"username",placeholder:"User Username",type:"string",value:s.username||"",onChange:o,onKeyDown:x=>{x.code==="Space"?(x.preventDefault(),c("Space not allowed")):c(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Password"}),e.jsx(Q,{name:"password",placeholder:"User Password",type:"password",value:s.password||"",onChange:o,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Confirm Password"}),e.jsx(Q,{name:"password_confirmation",placeholder:"Confirm Password",type:"password",value:s.password_confirmation||"",onChange:o,required:!0})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),a&&e.jsx(b,{type:"submit",fill:"green",onClick:i,children:l?"Submitting":"Add User"})]})})]})})]})})})},ql=({onClose:t})=>{const{selectedUser:s,roles:a}=Qe(),{auth:l}=le(),{user:r,isChanged:c,isSubmitting:n,password:i,compPassword:o,error:d,setError:m,success:u,handleSubmit:x,handleChange:y,handleChangeSelect:f}=Ml(s,a),[N,j]=h.useState(!1),p=()=>{j(!N)},[g,v]=h.useState(!1),F=()=>{v(!g)};return u&&setTimeout(()=>{t()},1e3),e.jsxs(e.Fragment,{children:[s.id===l.user.id&&e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-6 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-6 font-bold text-red-700 text-start",children:["Warning: Be careful! You are editing your own account.",e.jsx("br",{}),"You are at risk of locking yourself out."]})}),e.jsx("form",{onSubmit:async _=>{_.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"id",children:"User ID"}),e.jsx(Q,{type:"text",name:"id",placeholder:"User ID",className:"inputbox",value:r.user_id,disabled:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"First name"}),e.jsx(Q,{type:"text",name:"firstname",placeholder:"First name",className:"inputbox rounded-md bg-slate-100",value:r.firstname,onChange:y})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Last name"}),e.jsx(Q,{type:"text",name:"lastname",placeholder:"Last name",className:"inputbox rounded-md bg-slate-100",value:r.lastname,onChange:y})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"username",children:"Username"}),e.jsx(Q,{type:"text",name:"username",placeholder:"Username",className:"inputbox rounded-md bg-slate-100",value:r.username,onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Email address"}),e.jsx(Q,{type:"email",name:"email",placeholder:"Email address",className:"inputbox rounded-md bg-slate-100",value:r.email,onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Contact number"}),e.jsx(Q,{type:"number",name:"contact_no",placeholder:"09XXXXXXXXX",className:"inputbox rounded-md bg-slate-100",value:r.contact_no,onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"position",children:"Position"}),e.jsxs(J,{onValueChange:_=>f("position",_),children:[e.jsx(ee,{name:"position",className:"flex flex-row items-center gap-3 truncate text-md rounded-md bg-slate-100",children:e.jsx(se,{placeholder:r.position?r.position.charAt(0).toUpperCase()+r.position.slice(1):"Choose position..."})}),e.jsx(te,{className:"bg-white font-medium text-md",children:a.length>0?a.map(_=>{if(_.title!=="super_admin")return e.jsx($,{value:_.title,children:_.title.charAt(0).toUpperCase()+_.title.slice(1)},_.id)}):e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-6 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Change password (optional)"}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx(Q,{type:N?"text":"password",name:"new_password",placeholder:"New pasword",className:"inputbox rounded-md bg-slate-100",value:i||"",onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}}),N?e.jsx(Xs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:p}):e.jsx(Zs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:p})]})]}),e.jsxs("div",{className:"flex flex-col col-span-6 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Confirm new password"}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx(Q,{type:g?"text":"password",name:"confirm_password",placeholder:"Confirm password",className:"inputbox rounded-md bg-slate-100",value:o,onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}}),g?e.jsx(Xs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:F}):e.jsx(Zs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:F})]})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[u&&e.jsx("div",{className:"font-bold text-green-700",children:u}),d&&e.jsx("div",{className:"font-bold text-red-700",children:d}),n?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),c&&i===o&&e.jsx(b,{type:"submit",fill:c?"green":null,disabled:!c,onClick:x,children:n?"Submitting":"Edit User"})]})})]})})]})})]})},Hl=({onClose:t})=>{const{selectedUser:s}=Qe(),{permissions:a,allPermissions:l,permissionChange:r,isChanged:c,isSubmitting:n,error:i,success:o,handleChange:d,handleSubmit:m}=Rl(),{auth:u}=le(),x=l.filter(j=>Object.keys(j).some(p=>!j.title.includes("view".toLowerCase())&&j.title.includes("users".toLowerCase()))),y=l.filter(j=>Object.keys(j).some(p=>!j.title.includes("view".toLowerCase())&&!j.title.includes("transfer".toLowerCase())&&j.title.includes("product".toLowerCase())||j.title.includes("catalog".toLowerCase()))),f=l.filter(j=>Object.keys(j).some(p=>!j.title.includes("view".toLowerCase())&&j.title.includes("transfer".toLowerCase()))),N=l.filter(j=>Object.keys(j).some(p=>j.title.includes("view".toLowerCase())));return o&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto flex h-72 w-full flex-row divide-x",children:[e.jsxs("div",{className:"flex w-60 flex-none flex-col p-2 pt-8",children:[e.jsx("h3",{className:"ml-4 pb-1 text-xs font-semibold text-slate-500/80",children:"Roles"}),e.jsx("div",{className:"w-full",children:e.jsx(P,{variant:"ghost",className:"w-full justify-start capitalize text-slate-700 bg-slate-300/40",children:s.position.split("_").join(" ")},s.id+s.position)}),e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-slate-500/80",children:"After saving changes, affected users must log out and log back in to apply the changes."}),s.position===u.role&&e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-red-500/80",children:"You are editing your current role. Review your changes carefully."}),e.jsxs("div",{className:"mt-auto w-full space-y-3",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[o&&e.jsx("p",{className:"text-green-600",children:o}),i&&e.jsx("p",{className:"text-red-600",children:i})]}),c&&e.jsx(P,{type:"submit",className:"w-full disabled:cursor-not-allowed",disabled:!!n,onClick:m,children:n?"Saving...":"Save changes"})]})]}),e.jsx(We,{className:"w-full",type:"auto",style:{"--border":"216 12% 84%"},children:e.jsxs("div",{className:`mx-auto flex w-full max-w-[700px] flex-1 flex-col gap-8 p-6 pt-8 ${n?"pointer-events-none opacity-50":null}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"User Management"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:x.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):x.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:`${s.position!=="admin"&&"cursor-pointer"} text-sm capitalize text-slate-700`,children:j.title.split("_").join(" ")}),e.jsx(qe,{id:j.title,name:j.title,value:j.id,disabled:s.position==="admin",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(p=>p.permission_id===j.id),onCheckedChange:p=>d(p,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Products"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:y.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):y.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(qe,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(p=>p.permission_id===j.id),onCheckedChange:p=>d(p,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Transfers"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:f.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):f.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(qe,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(p=>p.permission_id===j.id),onCheckedChange:p=>d(p,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Views"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:N.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):N.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(qe,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(p=>p.permission_id===j.id),onCheckedChange:p=>d(p,j.id)})]},j.id))})]})]})})]})})},oc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"User Information",children:e.jsxs(Nt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Ul,{openModal:c})})}),e.jsx(me,{isOpen:t,onClose:a,title:l==="edit"?"Edit User":l==="add"?"Add User":"Edit User Role Permissions",children:e.jsxs(e.Fragment,{children:[l==="add"&&e.jsx(Ll,{onClose:a}),l==="edit"&&e.jsx(ql,{onClose:a}),l==="editPerms"&&e.jsx(Hl,{onClose:a})]})})]})})})},$l=()=>{const t=pe(),{selectedSupplier:s,setSelectedSupplier:a}=yt(),[l,r]=h.useState({});h.useEffect(()=>{s&&r(s)},[s]);const[c,n]=h.useState({}),[i,o]=h.useState(!1),[d,m]=h.useState(!1),[u,x]=h.useState(null),[y,f]=h.useState(null),N=k=>{var T,C,M,U;if(k){const W=Object.keys(l).map(S=>({text:S})),L=W.length===3||W.length>3;if(L){const S=!(((T=l.contact_no)==null?void 0:T.length)>11||((C=l.contact_no)==null?void 0:C.length)<11);return S?[S,""]:[S,"Contact number must be 11 digits"]}else return[L,"Please fill up all fields"]}else{const W=Object.keys(c).map(S=>({text:S})),L=W.length===3||W.length>3;if(L){const S=!(((M=c.contact_no)==null?void 0:M.length)>11||((U=c.contact_no)==null?void 0:U.length)<11);return S?[S,""]:[S,"Contact number must be 11 digits"]}else return[L,"Please fill up all fields"]}},j=(k,T)=>{o(!0),f(null),x(null),T?r(C=>({...C,[k.target.name]:k.target.value})):n(C=>({...C,[k.target.name]:k.target.value}))},p=async k=>{const T=N(k);if(m(!0),T[0])return k?await v(l):await _(c);x(T[1]),m(!1),console.log(c)},g={onSuccess:async()=>{await t.invalidateQueries({queryKey:["supplier"]}),m(!1),o(!1),f("Supplier info has been edited")},onError:k=>{console.error(k),x(k.message),m(!1)}},{mutateAsync:v}=Y({mutationKey:["updateSupplier"],mutationFn:Ia,...g}),F={onSuccess:async()=>{await t.invalidateQueries({queryKey:["supplier"]}),m(!1),o(!1),f("Supplier info has been added")},onError:k=>{console.error(k),x(k.message),m(!1)}},{mutateAsync:_}=Y({mutationKey:["addSupplier"],mutationFn:Pa,...F});return{supplier:l,selectedSupplier:s,newSupplier:c,isChanged:i,isSubmitting:d,error:u,success:y,handleSubmit:p,handleChange:j,editSupplierMutation:v}},Vl=({onClose:t,isUpdate:s})=>{const{supplier:a,newSupplier:l,isSubmitting:r,error:c,success:n,isChanged:i,handleChange:o,handleSubmit:d}=$l();return n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:m=>{m.preventDefault()},children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"name",children:"Supplier Name"}),e.jsx(Q,{type:"text",name:"name",placeholder:"Supplier Name",value:s?a.name||"":l.name||"",className:"inputbox rounded-md bg-slate-100",onChange:m=>o(m,s),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"contact_no",children:"Supplier Contact Number"}),e.jsx(Q,{type:"text",name:"contact_no",placeholder:"Supplier Contact Number",className:"inputbox rounded-md bg-slate-100",value:s?a.contact_no||"":l.contact_no||"",onChange:m=>o(m,s),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"address",children:"Supplier Address"}),e.jsx(Q,{type:"text",name:"address",placeholder:"Supplier Address",className:"inputbox rounded-md bg-slate-100",value:s?a.address||"":l.address||"",onChange:m=>o(m,s),required:!0})]})]}),e.jsx("div",{className:"flex flex-col mt-4 gap-5",children:e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),c&&e.jsx("div",{className:"font-bold text-red-700",children:c}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:i?"green":"default",disabled:!i,onClick:()=>d(s),children:r?"Submitting":s?"Edit Supplier":"Add Supplier"})]})})]})})})]})})},Bl=({openModal:t})=>{const{suppliers:s,isFetching:a,progress:l,setSelectedSupplier:r}=yt(),c=()=>{t({},"add")},n=o=>{r(o),t(o,"edit")},i=[{accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:o})=>e.jsx("div",{className:"text-center",children:e.jsxs(b,{onClick:()=>o.toggleSorting(o.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row ml-auto mr-auto items-center",children:["NAME ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.name})},{accessorKey:"contact_no",header:()=>e.jsx("div",{className:"text-center",children:"CONTACT NUMBER"}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.contact_no})},{accessorKey:"address",header:()=>e.jsx("div",{className:"text-center",children:"ADDRESS"}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.address})},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"ACTION"}),cell:({row:o})=>{const d=o.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(b,{fill:"empty",textColor:"black",onClick:()=>n(d),className:"flex flex-row items-center gap-2",children:[e.jsx(Gs,{})," Edit"]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:i,filterWhat:"address",dataType:"Supplier",openModal:c,isLoading:a})})},dc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Supplier",children:e.jsxs(Ta,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Bl,{openModal:c})})}),e.jsx(me,{isOpen:t,onClose:a,title:l==="edit"?"Edit Supplier":"Add Supplier",children:e.jsx(e.Fragment,{children:e.jsx(Vl,{onClose:a,isUpdate:l==="edit"})})})]})})})},Ql=({handleEditProduct:t,handleDeleteProduct:s})=>[{accessorKey:"serial_no",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Serial Number"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{id:"name",accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"notes",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Notes"})},{id:"actions",cell:({row:l})=>{const r=l.original;return e.jsx("div",{className:"flex flex-row justify-end text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>t(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsx("span",{className:"font-medium",children:"Edit"})]}),e.jsxs(V,{onClick:()=>s(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-red-50 hover:text-red-700 focus:bg-red-50 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(rs,{size:16,strokeWidth:2.25})}),e.jsx("span",{className:"font-medium",children:"Delete"})]})]})]})})},enableGlobalFilter:!1}],Yl=({handleProdPriceDetails:t,handleEditProdPrice:s,handleDeleteProdPrice:a})=>[{id:"name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"inventory_product.inventory.code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Inventory"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Capital"}),cell:({row:r})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(r.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:r.original.capital_price?c:"—"})})}},{accessorKey:"markup_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Markup"}),cell:({row:r})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(r.original.markup_price||0),n=ne(r.original.markup_price/r.original.capital_price*100,{precision:3}).value;return e.jsxs("div",{className:"flex items-center uppercase",children:[e.jsx("span",{children:c}),e.jsxs("span",{className:"text-gray-500",children:[" (",n,"%)"]})]})}},{accessorKey:"sale_discount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Discount"}),cell:({row:r})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(r.original.sale_discount||0);return e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:r.original.on_sale?c:e.jsx("div",{className:"group relative flex w-fit items-center",children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(_s,{size:20,strokeWidth:2,className:"text-gray-700"})}),e.jsx(Re,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:"Not on sale"})})]})})})})}},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Price"}),cell:({row:r})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(r.original.price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:r.original.price?c:"—"})})}},{accessorKey:"inventory_product.remaining_stocks_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Remaining"}),cell:({row:r})=>{const c=r.original.inventory_product.remaining_stocks_count??0,n=r.original.inventory_product.stocks_count*.2,i=r.original.inventory_product.stocks_count*.5;return e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx("span",{className:`${n>=c?"font-bold text-red-700":i>=c?"font-semibold text-amber-700":""}`,children:c})}),e.jsx(Re,{children:n>=c?"Remaining stocks are low!":i>=c?"Remaining stocks are below 50%":"Remaining stocks are above 50%"})]})}},{id:"actions",cell:({row:r})=>{const c=r.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>t(c),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(V,{onClick:()=>s(c),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>a(c),className:"flex flex-row items-center gap-3 rounded-md p-2 focus:bg-red-100 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(rs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Delete"})]})]})]})})},enableGlobalFilter:!1}],Gl=({openModal:t})=>{const{auth:s}=le(),{data:a,isLoading:l,setSelectedProduct:r}=Us(),c=()=>{t({},"add")},n=o=>{r(o),t(o,"edit")},i=o=>{r(o),t(o,"delete")};return e.jsx(e.Fragment,{children:e.jsx(X,{columns:(s==null?void 0:s.role)==="super_admin"||(s==null?void 0:s.role)==="admin"?Ql({handleEditProduct:n,handleDeleteProduct:i}):pl,data:a.sort((o,d)=>d.id-o.id),filterWhat:"name",dataType:"Product",openModal:c,isLoading:l})})},Xl=({openModal:t,isModalOpen:s,filterWarehouse:a})=>{const{data:l,isLoading:r,setSelectedProductPrice:c}=os(),n=d=>{c(d),t(d,"details")},i=d=>{c(d),t(d,"edit")},o=d=>{c(d),t(d,"delete")};return e.jsx(e.Fragment,{children:e.jsx(Ye,{children:e.jsx(X,{columns:Yl({handleProdPriceDetails:n,handleEditProdPrice:i,handleDeleteProdPrice:o}),data:a?l.filter(d=>d.warehouse.id===a).sort((d,m)=>{let u=new Date(d.updated_at??d.created_at);return new Date(m.updated_at??m.created_at).getTime()-u.getTime()}):l.sort((d,m)=>{let u=new Date(d.updated_at??d.created_at);return new Date(m.updated_at??m.created_at).getTime()-u.getTime()}),filterWhat:"name",dataType:"Listing",isLoading:r})})})},Zl=()=>{const{selectedProductPrice:t}=os();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Unit"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.inventory_product.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Inventory"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.inventory_product.inventory.code})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Capital price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup percent"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[ne(t.markup_price/t.capital_price*100,{precision:3}).value,"%"]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.markup_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Cost"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.cost)})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sale discount"}),e.jsx("p",{className:"text-sm",children:t.on_sale===1?Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.sale_discount):"—"}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex flex-none flex-row items-center justify-end gap-1 pb-[0.1rem] pr-1",children:[t.on_sale===1?e.jsx(He,{size:14,strokeWidth:3.5,className:"text-green-600"}):e.jsx(_s,{size:14,strokeWidth:3.5,className:"text-gray-600"}),e.jsx("div",{className:"text-xs font-semibold leading-4 text-gray-900",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.price)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.created_by.firstname+" "+t.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(t.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(t.updated_at)})]})]})]})})},vs=(t,s,a=2)=>ne(s/t*100,{precision:a}).value,Ms=(t,s,a=2)=>ne(ne(t).multiply(s/100),{precision:a}).value,bs=(t,s,a=2)=>ne(ne(t).add(s),{precision:a}).value,Xt=(t,s,a=2)=>ne(ne(t).subtract(s),{precision:a}).value,Jl=({onClose:t})=>{const{selectedProductPrice:s}=os(),{deleteProductPricesMutation:a}=Is(),[l,r]=h.useState(!1),c=()=>{r(!0),a(s.id).then(n=>{K.success(n.message),t()}).catch(n=>{K.error(n.message?n.message:"Failed to delete product listing.")}).finally(()=>{r(!1)})};return e.jsxs("div",{className:"flex max-w-md flex-col gap-4",children:[e.jsxs("h2",{className:"text-sm font-medium text-slate-800",children:["Are you sure you would like to delete this item? This action"," ",e.jsx("strong",{children:"cannot"}),"  be undone."]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||"No brand"})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:s.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsx("p",{className:"text-sm",children:s.warehouse.code})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.price)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Markup Price"}),e.jsx("p",{className:"text-sm",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.markup_price)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx("p",{className:"text-sm",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.price)})]})]}),e.jsxs("div",{className:"mt-4 flex flex-row justify-end gap-4",children:[e.jsx(b,{fill:"red",type:"submit",onClick:c,disabled:l,className:"py-2 text-sm font-bold disabled:cursor-not-allowed disabled:opacity-50",children:l?"Deleting...":"Yes, delete"}),e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),disabled:l,className:"py-2 text-sm font-bold text-slate-700 hover:text-white disabled:cursor-not-allowed disabled:opacity-50",children:"No, cancel"})]})]})},er=({onClose:t})=>{const{value:s,handleChange:a,handleSubmit:l}=Ht(),{selectedProduct:r}=Us(),[c,n]=h.useState(!1),[i,o]=h.useState(null),[d,m]=h.useState(),u=(x,y,f,N)=>{f.test(x.target.value)?(x.target.value=x.target.value,a(y,x.target.value),m(void 0)):m({type:y,error:N})};return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async x=>{n(!c),x.preventDefault(),l({action:"update",id:r.id,data:s}).then(()=>{n(!1),K.success("Product updated successfully."),t()}).catch(y=>{n(!1),y.response.data.message?K.error(y.response.data.message):K.error("Failed to update product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"serial_no",className:"text-sm font-bold text-gray-600",children:"Serial number"}),e.jsx(I,{id:"serial_no",name:"serial_no",type:"text",maxLength:100,required:!0,placeholder:"Serial number...",value:s.serial_no!==void 0?s.serial_no:(r==null?void 0:r.serial_no)||"",onChange:x=>{u(x,"serial_no",/^[a-zA-Z0-9-]{0,100}$/,"Must only contain A-Z, 0-9, and -")}}),e.jsx("span",{hidden:!(d&&d.type==="serial_no"),className:"text-xs font-bold text-red-600",children:d==null?void 0:d.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"name",className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx(I,{id:"name",name:"name",type:"text",maxLength:100,required:!0,placeholder:"Product name...",value:s.name!==void 0?s.name:(r==null?void 0:r.name)||"",onChange:x=>{u(x,"name",/^[0-9a-zA-Z\s\-.,/+:_=]{0,100}$/,"Must only contain alphanumeric and limited special characters")}})," ",e.jsx("span",{hidden:!(d&&d.type==="name"),className:"max-w-[225px] text-xs font-bold text-red-600",children:d==null?void 0:d.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"brand",className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx(I,{id:"brand",name:"brand",type:"text",maxLength:100,required:!0,placeholder:"Brand...",value:s.brand!==void 0?s.brand:(r==null?void 0:r.brand)||"",onChange:x=>{u(x,"brand",/^[0-9a-zA-Z\s\-.,/+:_=]{0,100}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(d&&d.type==="brand"),className:"max-w-[225px] text-xs font-bold text-red-600",children:d==null?void 0:d.error})]}),e.jsx("hr",{className:"col-span-12 my-3 border-t border-slate-200"}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"size",className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx(I,{id:"size",name:"size",type:"text",maxLength:100,required:!0,placeholder:"e.g. medium...",value:s.size!==void 0?s.size:(r==null?void 0:r.size)||"",onChange:x=>{u(x,"size",/^[0-9a-zA-Z\s\-.,/+:_="']{0,100}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(d&&d.type==="size"),className:"max-w-[225px] text-xs font-bold text-red-600",children:d==null?void 0:d.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"color",className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx(I,{id:"color",name:"color",type:"text",maxLength:40,required:!0,placeholder:"e.g. white...",value:s.color!==void 0?s.color:(r==null?void 0:r.color)||"",onChange:x=>{u(x,"color",/^[0-9a-zA-Z\s\-.,/+:_="']{0,40}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(d&&d.type==="color"),className:"max-w-[225px] text-xs font-bold text-red-600",children:d==null?void 0:d.error})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(I,{id:"notes",name:"notes",type:"text",placeholder:"Type product notes here...",defaultValue:s.notes!==void 0?s.notes:(r==null?void 0:r.notes)||"",onBlur:x=>a("notes",x.target.value)})]})]}),e.jsxs("div",{className:"ml-auto flex flex-row gap-4 whitespace-nowrap",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:c||d!==void 0||s.name===""||s.serial_no==="",className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Applying...":"Apply changes"})]}),i&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:i})})]})})})},sr=({onClose:t})=>{const{selectedProduct:s,setSelectedProduct:a,isDeletable:l}=Us(),{handleDeleteProduct:r}=Ht();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[42rem] max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"col-span-8 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:(s==null?void 0:s.brand)||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.color})]}),(s==null?void 0:s.notes)&&e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.notes})]})]}),e.jsx("hr",{className:"h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("p",{className:`max-w-[50%] text-sm ${l!==void 0&&!l&&"text-red-700"}`,children:l!==void 0?l?"This product can be deleted. Are you sure you want to proceed? This action cannot be undone.":"This product cannot be deleted because it is associated with existing product price and inventory items.":"Checking if the product can be deleted..."}),e.jsxs("div",{className:"mt-auto flex-none space-x-4",children:[l&&e.jsx(b,{className:"flex-1 cursor-pointer bg-red-600 py-2 text-sm font-bold text-white hover:bg-red-700 disabled:pointer-events-none disabled:opacity-50",disabled:!l,onClick:()=>{s&&r(s.id).then(()=>{K.success("Product deleted successfully."),a(void 0),t()}).catch(()=>{K.error("An error occurred while deleting the product.")})},children:"Yes, delete"}),e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:l?"No, cancel":"Close"})]})]})]})})},xc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Products",children:e.jsxs(vt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Gl,{openModal:c})})}),e.jsx(me,{isOpen:t,onClose:a,closeOnOverlayClick:l==="delete",title:l==="add"?"Add Product":l==="edit"?"Edit Product":l==="delete"?"Delete Product":"",children:e.jsxs(e.Fragment,{children:[l==="add"&&e.jsx(jl,{onClose:a}),l==="edit"&&e.jsx(er,{onClose:a}),l==="delete"&&e.jsx(sr,{onClose:a})]})})]})})})},tr=({onClose:t})=>{var N,j;le();const{selectedProductPrice:s}=os(),{value:a,handleChange:l,handleSubmit:r}=Is(),[c,n]=h.useState(!1),[i,o]=h.useState(null),[d,m]=h.useState(vs(s.capital_price,s.markup_price,3)),[u,x]=h.useState(s.markup_price),y=p=>{const g=Number(p.target.value);m(g),x(Ms(s.capital_price,g))},f=p=>{const g=ne(p.target.value).value;x(g),m(vs(s.capital_price,g,3))};return h.useEffect(()=>{l("markup_price",u),l("cost",bs(s.capital_price,u))},[d,u]),h.useEffect(()=>{l("price",Xt(a.cost??s.cost,a.sale_discount??s.sale_discount))},[a.cost,a.sale_discount]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async p=>{n(!c),p.preventDefault(),r({action:"update",id:s.id,data:a}).then(()=>{n(!c),K.success("Product price edited successfully"),t()}).catch(()=>{n(!c),o("Failed to add product listing"),K.error("Failed to add product listing")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-4 gap-y-5 font-medium text-gray-700",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:s.inventory_product.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Inventory"}),e.jsx("p",{className:"text-sm",children:s.inventory_product.inventory.code})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",disabled:!0,className:"pl-7",value:ne(s.capital_price).value}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_percent",className:"text-sm font-bold text-gray-600",children:"Markup percent"}),e.jsx(I,{id:"markup_percent",name:"markup_percent",type:"number",inputMode:"numeric",min:0,step:.001,required:!0,value:d||"",onChange:y,onBlur:p=>{p.target.value=ne(d,{precision:3}).value.toString()}}),e.jsx("span",{className:"absolute bottom-0 right-0 mr-2 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"%"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_price",className:"text-sm font-bold text-gray-600",children:"Markup price"}),e.jsx(I,{id:"markup_price",name:"markup_price",type:"number",min:0,step:.01,className:"pl-7",value:u||"",onChange:f,onBlur:p=>{p.target.value=Number(u).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"cost",className:"text-sm font-bold text-gray-600",children:"Cost"}),e.jsx(I,{id:"cost",name:"cost",type:"number",min:0,required:!0,className:"pl-7",readOnly:!0,value:bs(s.capital_price,u).toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"sale_discount",className:"text-sm font-bold text-gray-600",children:"Sale discount"}),e.jsx(I,{id:"sale_discount",name:"sale_discount",type:"number",inputMode:"numeric",min:0,step:.01,max:a.cost!==void 0?a.cost:s.cost,disabled:a.on_sale===void 0?s.on_sale===0:a.on_sale===0,required:!0,className:"pl-7",value:a.sale_discount??((N=s.sale_discount)==null?void 0:N.toFixed(2))??"",onChange:p=>{l("sale_discount",ne(p.target.value).value)},onBlur:p=>{p.target.value=Number(a.sale_discount!==void 0?a.sale_discount:s.sale_discount).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"}),e.jsxs("div",{className:"absolute right-0 top-1/2 mr-2 flex flex-none translate-y-1/4 flex-row items-center justify-start gap-2",children:[e.jsx(I,{name:"on_sale",id:"on_sale",type:"checkbox",checked:a.on_sale===void 0?s.on_sale===1:a.on_sale===1,className:"h-4 w-fit",onChange:p=>{const g=document.getElementById("sale_discount");l("on_sale",p.target.checked?1:0),!p.target.checked&&(l("sale_discount",0),g&&(g.value="0.00"))}}),e.jsx(w,{htmlFor:"on_sale",className:"text-xs font-bold text-slate-700",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"price",className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx(I,{id:"price",name:"price",type:"number",min:0,step:.01,required:!0,readOnly:!0,className:"pl-7",value:((j=a.price)==null?void 0:j.toFixed(2))||s.price.toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm",children:ie(s.updated_at)})]})]}),e.jsx("div",{className:"col-span-12 flex w-full justify-between whitespace-nowrap pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:c,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Applying changes...":"Apply changes"})]})}),i&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:i})})]})})})},mc=()=>{const{warehouses:t}=ss(),[s,a]=h.useState(0),{isOpen:l,openModal:r,closeModal:c}=oe(),[n,i]=h.useState(""),o=(d,m)=>{i(m),r()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Product Listings",children:e.jsx(vt,{children:e.jsxs(ht,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:d=>a(Number(d)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx($,{value:"0",children:"All"},"all"),t.map(d=>e.jsxs($,{value:d.id.toString(),children:[d.name," (",d.code,")"]},d.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Xl,{openModal:o,isModalOpen:l,filterWarehouse:s>0?s:void 0})})]}),e.jsx(me,{title:n==="details"?"Listing Details":n==="edit"?"Edit Listing":n==="delete"?"Delete Listing":"",isOpen:l,onClose:c,closeOnOverlayClick:n==="details",children:e.jsxs(e.Fragment,{children:[n==="details"&&e.jsx(Zl,{}),n==="edit"&&e.jsx(tr,{onClose:c}),n==="delete"&&e.jsx(Jl,{onClose:c})]})})]})})})})},ar=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:l,setSelectedTransfer:r}=Ie();le(),Ke();function c(u){window.api.transferSend({transfer:u,products:a.filter(x=>x.transfer_id===u.id)})}const n=u=>{r(u),t(u,"details")},i=u=>{r(u),t(u,"edit")},o=u=>{r(u),t(u,"products")},d=()=>{t({},"add")},m=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["TRANSFER CODE"," ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>e.jsx("div",{className:"text-center",children:u.original.code?u.original.code:"N/A"})},{accessorKey:"source",header:()=>e.jsx("div",{className:"text-center",children:"SOURCE-DESTINATION"}),cell:({row:u})=>{const x=u.original.source,y=u.original.destination;return e.jsxs("div",{className:"text-center",children:[x.code,"-",y.code]})}},{id:"transfer_products",header:()=>e.jsx("div",{className:"text-center",children:"PRODUCTS ADDED?"}),cell:()=>e.jsx("div",{className:"flex justify-center",children:a.length>0?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"})})},{accessorKey:"transfer_status",sortingFn:"text",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["TRANSFER STATUS"," ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>e.jsx("div",{className:"text-center",children:u.original.transfer_status?u.original.transfer_status:"N/A"})},{accessorKey:"transfer_schedule",sortingFn:"datetime",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["SCHEDULE"," ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>{const x=u.getValue("transfer_schedule");if(x.toString()!=="0000-00-00"){const y={year:"numeric",month:"long",day:"numeric"},f=new Date(x).toLocaleDateString([],y);return e.jsx("div",{className:"text-center",children:f})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"date_received",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["DATE RECEIVED"," ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>{const x=u.getValue("date_received");if(x){const y={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},f=new Date(x).toLocaleDateString([],y);return e.jsx("div",{className:"text-center",children:f})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"approval_status",header:()=>e.jsx("div",{className:"text-center",children:"APPROVAL STATUS"}),cell:({row:u})=>e.jsx("div",{className:"mx-auto flex items-center justify-center",children:u.original.approval_status.toLowerCase()==="approved"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):u.original.approval_status.toLowerCase()==="rejected"?e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:u})=>{const x=u.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>n(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Details"})]}),e.jsxs(V,{onClick:()=>i(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit Transfer"})]}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>o(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:x.transfer_status!="arrived"&&x.approval_status!="rejected"?e.jsx(ke,{size:16,strokeWidth:2.25}):e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Products"})]}),x.transfer_status=="enroute"||x.transfer_status=="arrived"&&e.jsxs(V,{onClick:()=>c(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Gt,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Print Transfer"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:m,filterWhat:"approval_status",dataType:"Transfer",openModal:d,isLoading:l})})},lr=({onClose:t})=>{const{selectedTransfer:s}=Ie();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Source"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.source.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.destination.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer schedule"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_schedule.toString()==="0000-00-00 00:00:00"?"N/A":ie(s.transfer_schedule)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Received by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.received_by?s.received_by.firstname+" "+s.received_by.lastname:"N/A"})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Date received"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.date_received?ie(s.date_received):"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approved_by?s.approved_by.firstname+" "+s.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.updated_at)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.notes?s.notes:"N/A"})]})})]})})},rr=()=>{var a,l;const{newTransfer:t,handleChange:s}=Ue();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-span-5 flex flex-col gap-1",children:[e.jsx(w,{htmlFor:"source",className:"text-sm font-bold text-slate-800",children:"Source"}),e.jsxs(J,{name:"source",value:((a=t.source)==null?void 0:a.toString())??"",onValueChange:r=>{s("source",Number(r)),s("destination",r==="1"?2:1)},required:!0,children:[e.jsx(ee,{name:"source",id:"source",className:"flex flex-row items-center gap-3 truncate bg-white text-sm font-medium",children:e.jsx(se,{placeholder:"Select warehouse..."})}),e.jsxs(te,{className:"text-sm font-medium text-slate-700",children:[e.jsx($,{value:"1",children:"Cagayan de Oro"}),e.jsx($,{value:"2",children:"Iligan"})]})]})]}),e.jsx("div",{className:"col-span-1 mt-3 flex h-full items-center justify-center",children:e.jsx(Cl,{size:20,strokeWidth:2,className:"text-slate-800"})}),e.jsxs("div",{className:"col-span-5 flex flex-col gap-1",children:[e.jsx(w,{htmlFor:"destination",className:"text-sm font-bold text-slate-800",children:"Destination"}),e.jsxs(J,{name:"destination",value:((l=t.destination)==null?void 0:l.toString())??"",onValueChange:r=>{s("destination",Number(r)),s("source",r==="1"?2:1)},required:!0,children:[e.jsx(ee,{name:"destination",id:"destination",className:"flex flex-row items-center gap-3 truncate bg-white text-sm font-medium",children:e.jsx(se,{placeholder:"Select warehouse..."})}),e.jsxs(te,{className:"text-sm font-medium text-slate-700",children:[e.jsx($,{value:"1",children:"Cagayan de Oro"}),e.jsx($,{value:"2",children:"Iligan"})]})]})]})]})},nr=()=>{const{newTransfer:t,handleChange:s}=Ue();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-span-11 flex flex-col gap-1",children:[e.jsx(w,{htmlFor:"transfer_schedule",className:"text-sm font-bold text-slate-800",children:"Schedule"}),e.jsxs(Se,{children:[e.jsx(je,{id:"transfer_schedule",name:"transfer_schedule",asChild:!0,children:e.jsxs(P,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Bt,{className:"mr-2 h-4 w-4"}),t.transfer_schedule?new Date(t.transfer_schedule).toLocaleString("en-PH",{dateStyle:"full"}):e.jsx("span",{children:"Pick a date..."})]})}),e.jsx(Ce,{className:"w-auto p-0",children:e.jsx(ls,{required:!0,mode:"single",disabled:{before:new Date},selected:new Date(t.transfer_schedule??""),onDayClick:a=>{const l=new Date(a).toISOString();s("transfer_schedule",l)},initialFocus:!0})})]})]})})},Zt=({tabState:t})=>{var o;const{inventoriesList:s,inventoriesLoading:a,selectedInventory:l,setSelectedInventory:r,newTransfer:c}=Ue(),[n,i]=h.useState(!1);return e.jsxs("div",{className:`${t==="details"?"col-span-11":"col-span-8"} flex flex-col gap-1`,children:[e.jsx(w,{htmlFor:"inventory",className:"text-sm font-bold text-slate-800",children:"Inventory"}),e.jsxs(Se,{open:n,onOpenChange:i,children:[e.jsx(je,{asChild:!0,children:e.jsxs(P,{id:"inventory",variant:"outline",role:"combobox","aria-expanded":n,className:"justify-between",disabled:c.source===void 0||a||t==="items",children:[a?"Loading...":l?(o=s.find(d=>d.id===l.id))==null?void 0:o.code:"Select inventory...",e.jsx(Xe,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Ce,{className:"max-h-[300px] w-[568px] overflow-auto p-0",children:e.jsxs($e,{defaultValue:(l==null?void 0:l.id.toString())??"",children:[e.jsx(Ve,{placeholder:"Search inventory...",className:"text-sm font-medium"}),e.jsx(Ge,{className:"p-4 text-center text-sm font-medium",children:"No inventory found."}),e.jsx(Ee,{children:s.map(d=>e.jsxs(Te,{className:"flex justify-between text-sm",value:d.id.toString(),onSelect:()=>{r(d),i(!1)},children:[e.jsx("span",{className:"font-semibold",children:d.code}),e.jsxs("span",{className:"inline-block text-xs font-bold text-slate-600",children:["Created:"," ",new Date(d.created_at??"").toLocaleDateString("en-PH",{dateStyle:"long"})]})]},d.id))})]})})]})]})},cr=({activeView:t,setActiveView:s,setEditProduct:a})=>{const{selectedInventory:l}=Ue();return e.jsx("div",{className:"col-span-3 col-start-10 flex h-full items-end",children:e.jsx(P,{variant:"secondary",disabled:!l,className:"w-full text-sm font-bold text-slate-800 hover:bg-slate-300",onClick:t==="table"?()=>{s("form"),a(null)}:()=>s("table"),children:e.jsx("span",{children:t==="table"?e.jsxs("span",{className:"flex gap-2",children:[e.jsx(Ys,{size:20})," ",e.jsx("span",{children:"Add an item"})]}):e.jsxs("span",{className:"flex gap-2",children:[e.jsx(Vt,{size:20})," ",e.jsx("span",{children:"Cancel"})]})})})})},ir=({onClose:t})=>{const{newTransfer:s,handleChange:a,setActiveTab:l}=Ue();return e.jsx("div",{className:"flex flex-col gap-5",children:e.jsxs("div",{className:"grid grid-cols-11 gap-4",children:[e.jsx(rr,{}),e.jsx(Zt,{tabState:"details"}),e.jsx(nr,{}),e.jsxs("div",{className:"col-span-11 flex flex-col gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-slate-800",children:"Notes"}),e.jsx(Ss,{id:"notes",placeholder:"Type the notes for this transfer...",className:"text-sm",value:s.notes??"",onChange:r=>a("notes",r.target.value)})]}),e.jsxs("div",{className:"col-span-11 flex justify-end gap-4",children:[e.jsx(b,{fill:"default",className:"py-2 text-sm font-bold text-slate-900",onClick:()=>t(),children:"Cancel"}),e.jsx(b,{fill:"green",className:"py-2 text-sm font-bold disabled:cursor-not-allowed disabled:opacity-50",disabled:!s.source||!s.destination||!s.transfer_schedule,onClick:()=>l("items"),children:"Proceed to add items"})]})]})})},Jt=({selectedProduct:t,setSelectedProduct:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex w-1/2 flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",value:(t==null?void 0:t.capital_price)||0,onBlur:()=>{},onChange:a=>{s(l=>({...l,capital_price:a.target.value}))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]})}),or=({selectedProduct:t})=>{const{inventoryProducts:s,inventoryProductsLoading:a}=Ue();return e.jsx(e.Fragment,{children:a?e.jsx(je,{asChild:!0,children:e.jsx(P,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:!0,children:e.jsx(G,{className:"h-4 w-4 animate-spin"})})}):e.jsx(je,{asChild:!0,children:e.jsxs(P,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:s.length===0,children:[s.length>0?t?t.product_name:"Select product...":"No products",e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})})})},dr=({selectedProduct:t,setSelectedProduct:s})=>{const{inventoryProducts:a,handleChange:l,newTransfer:r}=Ue(),[c,n]=h.useState(!1);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(Se,{open:c,onOpenChange:n,children:[e.jsx(or,{selectedProduct:t}),e.jsx(Ce,{className:"min-w-[53rem] p-0 text-sm font-medium text-slate-700",children:e.jsxs($e,{children:[e.jsx(Ve,{placeholder:"Product name or serial number..."}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:a.map(i=>e.jsx(Te,{className:"cursor-pointer justify-between rounded-sm border-b",value:i.product.id+"_"+i.product.name+"_"+i.product.brand+"_"+i.id,onSelect:()=>{s({id:i.id,product_id:i.product.id,product_name:`${i.product.name} • ${i.product.brand} • ${i.product.size} • ${i.product.color}`,unit:i.unit,source_inventory:i.inventory_id,total_quantity:1,capital_price:i.capital_price}),n(!1)},children:`${i.product.name} • ${i.product.brand} • ${i.product.size} • ${i.product.color}`},i==null?void 0:i.id))})})]})})]})]})})},ea=({selectedProduct:t,setSelectedProduct:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex w-1/2 flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks Count"}),e.jsx(I,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:(t==null?void 0:t.total_quantity)||0,required:!0,onChange:a=>{s(l=>({...l,total_quantity:a.target.value}))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500"})]})}),xr=({setActiveView:t,editProduct:s})=>{const{newTransfer:a,handleChange:l}=Ue(),[r,c]=h.useState(s||null),n=i=>{i.preventDefault();const o=[...a.transferItems];let d=o.findIndex(m=>m.id===r.id);d!==-1?o[d]={...o[d],...r}:o.push({...r}),l("transferItems",o),t("table")};return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:n,children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsx(dr,{selectedProduct:r,setSelectedProduct:c}),e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-row justify-between gap-2",children:[e.jsx(Jt,{selectedProduct:r,setSelectedProduct:c}),e.jsx(ea,{selectedProduct:r,setSelectedProduct:c})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(b,{type:"submit",fill:"green",className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:"Add Item to Queue"})})]})})})},mr=({onClose:t})=>{const{newTransfer:s,handleChange:a}=Ue(),[l,r]=h.useState(null),{addTransferMutation:c,isPending:n,success:i}=wl(),o=[{id:"select",header:({table:x})=>e.jsx("input",{type:"checkbox",checked:x.getIsAllPageRowsSelected(),onChange:y=>x.toggleAllPageRowsSelected(!!y.target.checked),"aria-label":"Select all"}),cell:({row:x})=>e.jsx("input",{type:"checkbox",checked:x.getIsSelected(),onChange:y=>x.toggleSelected(!!y.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:x})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>x.toggleSorting(x.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",x.getIsSorted()==="asc"?e.jsx(D,{}):x.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:x})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:x.original.product_name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:x})=>e.jsx("div",{className:"text-center",children:x.original.total_quantity})},{accessorKey:"capital price",header:()=>e.jsx("div",{className:"text-center",children:"Capital Price"}),cell:({row:x})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(x.original.capital_price)})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:x})=>{const y=x.original;return e.jsxs("div",{className:"flex flex-row justify-center gap-3 text-xs font-normal uppercase",children:[e.jsx(Ye,{children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(ke,{onClick:()=>{m("form"),r(y)},size:20,className:" text-yellow-500"})}),e.jsx(Re,{children:e.jsx("p",{children:"Edit"})})]})}),e.jsx(Ye,{children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(rs,{onClick:()=>{const f=s.transferItems.filter(N=>N.id!==y.id);a("transferItems",f)},size:20,className:"text-red-500"})}),e.jsx(Re,{children:e.jsx("p",{children:"Remove"})})]})})]})}}],[d,m]=h.useState("table"),u=async()=>{c(s).catch(x=>{K.error(x.response.data.message)})};return h.useEffect(()=>{i&&(K(i,{position:"top-right",closeOnClick:!0,type:"success"}),t())},[i]),e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"absolute left-[45%] top-[43%] z-50",children:e.jsx(Ae,{})}),e.jsxs("div",{className:`flex flex-col gap-4 ${n?"blur-sm":""}`,children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsx(Zt,{tabState:"items"}),e.jsx(cr,{activeView:d,setActiveView:m,setEditProduct:r})]}),d==="table"&&e.jsx("div",{className:"h-[400px] w-full bg-slate-100",children:e.jsx(X,{data:s.transferItems,columns:o,dataType:"Transfer Products",isLoading:!1,hideFilter:!0,filterWhat:""})}),d==="form"&&e.jsx("div",{className:"h-[200px] w-full ",children:e.jsx(xr,{setActiveView:m,editProduct:l})}),e.jsx("div",{className:`flex flex-col items-end ${d==="form"?"hidden":""}`,children:e.jsx(b,{disabled:s.transferItems.length<=0||n,onClick:u,fill:"green",className:"disabled:opacity-50",children:"Submit Request"})})]})]})},ur=({onClose:t})=>{const{newTransfer:s,activeTab:a,setActiveTab:l}=Ue();return e.jsx(e.Fragment,{children:e.jsxs(bt,{value:a,onValueChange:r=>l(r),className:"w-full",children:[e.jsxs(wt,{className:"mb-4 flex w-full",children:[e.jsx(Ns,{value:"details",className:"flex-1 font-semibold",children:"Details"}),e.jsx(Ns,{value:"items",className:"flex-1 font-semibold",disabled:!s.source||!s.destination||!s.transfer_schedule,children:"Items"})]}),e.jsx(Js,{value:"details",className:"min-w-[540px]",children:e.jsx(ir,{onClose:t})}),e.jsx(Js,{value:"items",className:"min-w-[860px]",children:e.jsx(mr,{onClose:t})})]})})},hr=({selectedProduct:t,products:s})=>{const{isInventoryLoading:a}=Ps();return e.jsx(e.Fragment,{children:a?e.jsx(je,{asChild:!0,children:e.jsx(P,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:!0,children:e.jsx(G,{className:"h-4 w-4 animate-spin"})})}):e.jsx(je,{asChild:!0,children:e.jsxs(P,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:s.length===0,children:[s.length>0||!a?t?t.product_name:"Select product...":"No products",e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})})})},fr=({selectedProduct:t,setSelectedProduct:s})=>{const[a,l]=h.useState(!1),{filteredProductsSrc:r,filteredInventoriesSrc:c,handleChangeSelect:n,isInventoryLoading:i}=Ps(),{selectedTransfer:o}=Ie(),d=c.find(m=>(m==null?void 0:m.warehouse.id)===o.source.id);return h.useEffect(()=>{d&&!i&&n("inventory_id",d.id)},[d,i]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(Se,{open:a,onOpenChange:l,children:[e.jsx(hr,{selectedProduct:t,products:r}),e.jsx(Ce,{className:"min-w-[53rem] p-0 text-sm font-medium text-slate-700",children:e.jsxs($e,{children:[e.jsx(Ve,{placeholder:"Product name or serial number..."}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:r.map(m=>e.jsx(Te,{className:"cursor-pointer justify-between rounded-sm border-b",value:m.product.id+"_"+m.product.name+"_"+m.product.brand+"_"+m.id,onSelect:()=>{s({id:m.id,product_id:m.product.id,product_name:`${m.product.name} • ${m.product.brand} • ${m.product.size} • ${m.product.color}`,unit:m.unit,source_inventory:m.inventory_id,total_quantity:1,capital_price:m.capital_price}),l(!1)},children:`${m.product.name} • ${m.product.brand} • ${m.product.size} • ${m.product.color}`},m==null?void 0:m.id))})})]})})]})]})})},pr=({onClose:t})=>{var k,T;const[s,a]=h.useState(null),[l,r]=h.useState({isDeleting:!1,product:null}),[c,n]=h.useState(),i=pe(),o=[{id:"select",header:({table:C})=>e.jsx("input",{type:"checkbox",checked:C.getIsAllPageRowsSelected(),onChange:M=>C.toggleAllPageRowsSelected(!!M.target.checked),"aria-label":"Select all"}),cell:({row:C})=>e.jsx("input",{type:"checkbox",checked:C.getIsSelected(),onChange:M=>C.toggleSelected(!!M.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:C})=>e.jsx("div",{children:e.jsxs(P,{onClick:()=>C.toggleSorting(C.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",C.getIsSorted()==="asc"?e.jsx(D,{}):C.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:C})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:C.original.product.name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:C})=>e.jsx("div",{className:"text-center",children:C.original.total_quantity})},{accessorKey:"capital price",header:()=>e.jsx("div",{className:"text-center",children:"Capital Price"}),cell:({row:C})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(C.original.capital_price)})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:C})=>{const M=C.original;return e.jsxs("div",{className:"flex flex-row justify-center gap-3 text-xs font-normal uppercase",children:[e.jsx(Ye,{children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(ke,{onClick:()=>{_("form"),a(M),n({...M,product_name:`${M.product.name} • ${M.product.brand} • ${M.product.size} • ${M.product.color}`})},size:20,className:" text-yellow-500"})}),e.jsx(Re,{children:e.jsx("p",{children:"Edit"})})]})}),e.jsx(Ye,{children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(rs,{onClick:()=>{r({isDeleting:!0,product:M})},size:20,className:"text-red-500"})}),e.jsx(Re,{children:e.jsx("p",{children:"Remove"})})]})})]})}}],{mutateAsync:d,isPending:m}=Y({mutationKey:["transfer_product"],mutationFn:xt,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),K("Product has been added",{position:"top-right",closeOnClick:!0,type:"success"}),_("table")},onError:C=>{console.error(C)}}),{mutateAsync:u,isPending:x}=Y({mutationKey:["transfer_product"],mutationFn:mt,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),K("Product has been edited",{position:"top-right",closeOnClick:!0,type:"success"}),a(void 0),_("table")},onError:C=>{console.error(C)}}),{mutateAsync:y,isPending:f}=Y({mutationKey:["transfer_product"],mutationFn:Aa,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),r(C=>({...C,isDeleting:!1})),K("Product has been removed",{position:"top-right",closeOnClick:!0,type:"success"})},onError:C=>{console.error(C)}}),{filteredInventoriesSrc:N}=Ps(),{transferProducts:j,selectedTransfer:p}=Ie(),g=j.filter(C=>C.transfer_id===p.id),v=N.find(C=>(C==null?void 0:C.warehouse.id)===p.source.id),[F,_]=h.useState("table");return h.useEffect(()=>{F==="table"&&n(void 0)},[F]),e.jsxs(e.Fragment,{children:[(m||f||x)&&e.jsx("div",{className:"absolute left-[45%] top-[43%] z-50",children:e.jsx(Ae,{})}),e.jsx(yl,{isOpen:l.isDeleting,onClose:()=>{r(C=>({...C,isDeleting:!1}))},children:e.jsxs("div",{className:"",children:[e.jsxs("p",{className:"text-center font-semibold",children:["Are you sure you want to delete"," ",(T=(k=l==null?void 0:l.product)==null?void 0:k.product)==null?void 0:T.name," from this transfer?"]}),e.jsx("p",{className:"pt-2 text-center text-sm opacity-80",children:"This process cannot be undone."}),e.jsxs("div",{className:"flex gap-2 pt-3",children:[e.jsx(P,{onClick:()=>{r(C=>({...C,isDeleting:!1}))},className:"w-full bg-red-400 hover:bg-red-800",disabled:f,children:"Cancel"}),e.jsx(P,{onClick:()=>{y({id:l.product.id})},disabled:f,className:"w-full bg-green-400 hover:bg-green-800",children:f?e.jsx(Da,{type:"spin",width:20,className:"relative top-[22px]"}):"Confirm"})]})]})}),e.jsxs("div",{className:`flex flex-col gap-4 ${m||f||x?"blur-sm":""}`,children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsxs("div",{children:[e.jsx(w,{className:"text-sm font-bold text-slate-800",children:"Inventory"}),e.jsx(P,{id:"inventory",variant:"outline",className:"w-fit justify-between",disabled:!0,children:v!=null&&v.code?v==null?void 0:v.code:"Loading..."})]}),e.jsx("div",{className:"col-span-3 col-start-10 flex h-full items-end",children:e.jsx(P,{variant:"secondary",onClick:()=>{F==="form"&&_("table"),F==="table"&&_("form")},disabled:!(v!=null&&v.code),className:`w-full text-sm font-bold text-slate-800 hover:bg-slate-300 ${F==="table"&&"hidden"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[F=="table"&&e.jsxs(e.Fragment,{children:[e.jsx(Ys,{}),e.jsx("span",{children:"Add Item"})]}),F=="form"&&e.jsxs(e.Fragment,{children:[e.jsx(Vt,{}),e.jsx("span",{children:"Cancel"})]})]})})})]}),F==="table"&&e.jsx("div",{className:"h-[400px] w-full bg-slate-100",children:e.jsx(X,{data:g,columns:o,dataType:"Transfer Products",isLoading:!1,hideFilter:!0,filterWhat:""})}),F==="form"&&e.jsxs("div",{className:"flex h-[200px] w-full flex-col",children:[e.jsx(fr,{selectedProduct:c,setSelectedProduct:n}),e.jsxs("div",{className:"mt-5 flex gap-3",children:[e.jsx(ea,{selectedProduct:c,setSelectedProduct:n}),e.jsx(Jt,{selectedProduct:c,setSelectedProduct:n})]}),e.jsx(P,{variant:"secondary",onClick:()=>{if(s){u({...c,transfer_id:p.id});return}d({...c,transfer_id:p.id})},disabled:!(c||x||m),className:"mt-5 w-full text-sm font-bold text-slate-800 hover:bg-slate-300",children:e.jsx("p",{children:s?"Apply changes":"Add Product"})})]})]})]})},jr=({onClose:t})=>e.jsx(e.Fragment,{children:e.jsx(pr,{onClose:t})}),sa=({onClose:t})=>{var T,C,M,U,W,L,S,re,O,R;const{transfer:s,lastId:a,isChanged:l,isSubmitting:r,error:c,success:n,dateDisplay:i,dateDisplayArrived:o,handleSubmit:d,handleChange:m,handleChangeSelect:u,handleChangeDateTime:x}=_l(),{selectedTransfer:y,transferProducts:f}=Ie(),{warehouses:N}=ss(),{users:j}=za(),{auth:p}=le();h.useEffect(()=>{console.log(s)},[s]);const g=e.jsxs(e.Fragment,{children:[e.jsx(J,{onValueChange:A=>u("approval_status",A),name:"approval_status",value:s.approval_status||"",children:e.jsxs(ee,{name:"approval_status",value:y.approval_status||"",children:[e.jsx(se,{placeholder:s.approval_status?s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1):"Choose status..."}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx($,{value:"pending",className:"text-sm font-medium text-slate-700",children:"Pending"},"pending"),e.jsx($,{value:"approved",className:"text-sm font-medium text-slate-700",children:"Approved"},"approved"),e.jsx($,{value:"rejected",className:"text-sm font-medium text-slate-700",children:"Rejected"},"rejected")]})]})}),f.filter(A=>A.transfer_id===s.id).length===0&&e.jsxs("div",{className:"align-center group flex",children:[e.jsx(Ws,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsx("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-7 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:"No products have been added yet."})]}),f.filter(A=>A.transfer_id===y.id).length===0&&e.jsxs("div",{className:"align-center group flex",children:[e.jsx(Ws,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsx("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-7 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:"No products have been added yet."})]})]}),v=e.jsxs(J,{onValueChange:A=>u("source",Number(A)),name:"source",children:[e.jsx(ee,{name:"source",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsxs(e.Fragment,{children:[(T=N[s.source-1])==null?void 0:T.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","• ",(C=N[s.source-1])==null?void 0:C.code," •"," ",(M=N[s.source-1])==null?void 0:M.location]})]})})}),e.jsx(te,{className:"bg-white font-medium",children:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):N.map((A,Z)=>e.jsxs($,{value:A.id.toString(),className:`text-sm font-medium text-slate-700 
								${A.id===s.source&&"selected"}`,children:[A.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+A.code+" • "+A.location})]},Z))})]}),F=e.jsxs(J,{onValueChange:A=>u("destination",Number(A)),name:"destination",children:[e.jsx(ee,{name:"destination",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsxs(e.Fragment,{children:[(U=N[s.destination-1])==null?void 0:U.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","• ",(W=N[s.destination-1])==null?void 0:W.code," •"," ",(L=N[s.destination-1])==null?void 0:L.location]})]})})}),e.jsx(te,{className:"bg-white font-medium",children:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):N.map((A,Z)=>e.jsxs($,{value:A.id.toString(),className:`text-sm font-medium text-slate-700 
								${A.id===s.destination&&"selected"}`,children:[A.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+A.code+" • "+A.location})]},A.code))})]}),_=e.jsx(J,{onValueChange:A=>u("transfer_status",A),name:"transfer_status",value:s.transfer_status||"",children:e.jsxs(ee,{name:"transfer_status",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:[e.jsx(se,{placeholder:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"Choose status..."}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx($,{value:"loading",className:"text-sm font-medium text-slate-700",children:"Loading"},"loading"),e.jsx($,{value:"en route",className:"text-sm font-medium text-slate-700",children:"En route"},"en route"),e.jsx($,{value:"arrived",className:"text-sm font-medium text-slate-700",children:"Arrived"},"arrived")]})]})}),k=e.jsxs(J,{onValueChange:A=>u("received_by",Number(A)),name:"received_by",children:[e.jsx(ee,{name:"received_by",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:j.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsx(e.Fragment,{children:s.received_by?j[Number(s.received_by)-1].firstname+" "+j[Number(s.received_by)-1].lastname:"Choose user..."})})}),e.jsx(te,{className:"bg-white font-medium",children:j.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):j.map((A,Z)=>e.jsx($,{value:A.id.toString(),className:`text-sm font-medium text-slate-700 
								${s.received_by&&A.id===s.received_by&&"selected"}`,children:A.firstname+" "+A.lastname},Z))})]});return n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:A=>{A.preventDefault()},children:[e.jsxs("div",{className:"flex max-w-3xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer Code"}),e.jsx("p",{className:"text-sm",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Source"}),v]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Destination"}),F]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4 pb-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:y.created_by.firstname+" "+y.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Approval status"}),e.jsxs("p",{className:"flex flex-row gap-2 text-sm",children:[((S=s.approval_status)==null?void 0:S.toLowerCase())==="approved"&&e.jsxs(e.Fragment,{children:[s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1),e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"})]}),((re=s.approval_status)==null?void 0:re.toLowerCase())==="rejected"&&e.jsxs(e.Fragment,{children:[s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1),e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"})]}),((O=s.approval_status)==null?void 0:O.toLowerCase())==="pending"&&p.rolePermissions.some(A=>A.permission_id===22)&&((R=s.approval_status)==null?void 0:R.toLowerCase())==="pending"&&g]})]}),s.approved_by&&s.approval_status!="pending"&&e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-600",children:[s.approval_status==="approved"&&"Approved by",s.approval_status==="rejected"&&"Rejected by"]}),e.jsx("p",{className:"flex flex-row text-sm",children:j.length>0?j[s.approved_by-1].firstname+" "+j[s.approved_by-1].lastname:e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]}),s.approval_status=="approved"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-8 gap-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer status"}),e.jsx("p",{className:"text-sm",children:_})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer schedule"}),e.jsx("div",{className:"text-sm",children:e.jsxs(Se,{children:[e.jsx(je,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(P,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ys,{size:18,strokeWidth:1.5}),s.transfer_schedule?s.transfer_schedule.split(" ")[0]:"Choose date..."]})}),e.jsx(Ce,{className:"w-auto p-0",children:e.jsx(ls,{mode:"single",initialFocus:!0,required:!0,onDayClick:A=>{const Z=new Date(A),B=`${Z.getFullYear()}-${(Z.getMonth()+1).toString().padStart(2,"0")}-${Z.getDate().toString().padStart(2,"0")}`;u("transfer_schedule",B)},selected:s.transfer_schedule?new Date(s.transfer_schedule.split(" ")[0]):new Date})})]})})]}),s.transfer_status==="arrived"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Received by"}),e.jsx("p",{className:"text-sm",children:k})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsx("div",{className:"text-sm",children:e.jsxs(Se,{children:[e.jsx(je,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(P,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ys,{size:18,strokeWidth:1.5}),s.date_received?s.date_received.split(" ")[0]:"Choose date..."]})}),e.jsx(Ce,{className:"w-auto p-0",children:e.jsx(ls,{mode:"single",initialFocus:!0,required:!0,onDayClick:A=>{const Z=new Date(A),B=`${Z.getFullYear()}-${(Z.getMonth()+1).toString().padStart(2,"0")}-${Z.getDate().toString().padStart(2,"0")}`;u("date_received",B)},selected:s.date_received?new Date(s.date_received.split(" ")[0]):new Date(s.transfer_schedule.split(" ")[0])})})]})})]})]})]})}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex w-full flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(Ss,{name:"notes",value:s.notes||"",placeholder:"Add notes here....",onChange:m})]})})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"col-span-5 flex flex-col items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),c&&e.jsx("div",{className:"font-bold text-red-700",children:c}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"col-span-5 flex flex-col items-end gap-3",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:l?"green":null,disabled:!l,onClick:d,children:r?"Submitting":"Edit Transfer"})]})})]})})]})})},uc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Transfer",children:e.jsxs(_t,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border",children:e.jsx(ar,{openModal:c})})}),e.jsx(me,{title:l==="details"?"Transfer Details":l==="edit"?"Edit Transfer":l==="add"?"Add Transfer":"Transfer Products",isOpen:t,onClose:a,closeOnOverlayClick:l==="details",children:e.jsxs(e.Fragment,{children:[l==="details"&&e.jsx(lr,{onClose:a}),l==="edit"&&e.jsx(sa,{onClose:a}),l==="add"&&e.jsx(Ea,{children:e.jsx(ur,{onClose:a})}),l==="products"&&e.jsx(jr,{onClose:a})]})})]})})})},gr=()=>{const t=pe(),[s,a]=h.useState({}),l=(i,o)=>{a(d=>({...d,[i]:o}))},r=async i=>(console.log("Submitting: ",i),await n(i)),c={onSuccess:async()=>{await t.invalidateQueries({queryKey:["customers"]}),a({})},onError:i=>{console.error("Error adding customer:",i.message)}},{mutateAsync:n}=Y({mutationKey:["addCustomer"],mutationFn:Wa,...c});return{value:s,setValue:a,handleChange:l,handleSubmit:r}},Nr=({onClose:t})=>{const{value:s,setValue:a,handleChange:l,handleSubmit:r}=gr(),{setSelectedCustomer:c}=Ze();h.useEffect(()=>{a(m=>({...m}))},[]);const[n,i]=h.useState(!1),[o,d]=h.useState(null);return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async m=>{i(!n),m.preventDefault();const u=await r(s);(u==null?void 0:u.status)===201?(i(!n),c(u.data.data),t(),console.log(u.data)):(i(!n),d("Failed to add inventory"))},children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-2 ",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"firstname",children:"First Name"}),e.jsx(I,{id:"firstname",name:"firstname",required:!0,type:"text",placeholder:"First Name",onChange:m=>l("firstname",m.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"lastname",children:"Last Name"}),e.jsx(I,{id:"lastname",name:"lastname",required:!0,type:"text",placeholder:"Last Name",onChange:m=>l("lastname",m.target.value)})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"address",children:"Address"}),e.jsxs("div",{className:"relative flex flex-col ",children:[e.jsx(Il,{color:"#2D2D2D",className:"absolute top-0 translate-x-3 translate-y-1/2",size:20}),e.jsx(I,{id:"address",name:"address",type:"text",placeholder:"Address",defaultValue:"",className:"pl-10",onChange:m=>l("address",m.target.value),required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"contact_no",children:"Contact Number"}),e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx(Pl,{color:"#2D2D2D",className:"absolute top-0 translate-x-3 translate-y-1/2",size:20}),e.jsx(I,{required:!0,id:"contact_no",name:"contact_no",type:"text",inputMode:"numeric",placeholder:"Contact Number",className:"pl-10",defaultValue:"",max:11,maxLength:11,onChange:m=>l("contact_no",m.target.value)})]})]})]}),e.jsxs("div",{className:"flex flex-row justify-end gap-4",children:[e.jsx(b,{onClick:()=>t(),type:"reset",className:'hover:text-white"  py-2 text-sm font-bold text-slate-700',children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:n||Object.keys(s).length<=2,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Submitting...":"Add Customer"})]}),o&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-semibold text-red-600",children:o})})]})})})},yr=({})=>{const{data:t,isLoading:s,selectedCustomer:a,setSelectedCustomer:l,openSearchCustomer:r,setOpenSearchCustomer:c,setSearchFullName:n}=Ze(),[i,o]=h.useState(""),[d,m]=h.useState(""),{isOpen:u,closeModal:x,openModal:y}=oe();function f(){n(i)}return h.useEffect(()=>{if(d!==""){const N=t.find(j=>j.id===parseInt(d));N&&l(N)}},[d]),e.jsxs(e.Fragment,{children:[e.jsx(ds,{open:r,onOpenChange:c,children:e.jsxs(xs,{children:[e.jsx(ms,{className:"items-start",children:e.jsx(us,{children:"Search Customer"})}),e.jsx("form",{className:"flex flex-col",onSubmit:N=>{N.preventDefault(),f()},children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(I,{placeholder:"Enter customer name",onChange:N=>{o(N.target.value)},className:"w-[90%]"}),e.jsx(P,{type:"submit",size:"icon",children:s?e.jsx(G,{className:"animate-spin"}):e.jsx(St,{size:18})})]})}),t.length!==0&&!s&&e.jsx(e.Fragment,{children:e.jsxs(J,{onValueChange:m,children:[e.jsx(ee,{className:"h-15 text-left ",children:e.jsx(se,{placeholder:"Select Customer"})}),e.jsx(te,{children:e.jsx(Ma,{children:t.map((N,j)=>e.jsx($,{value:N.id.toString(),onClick:()=>{o("")},children:e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("span",{className:"w-full font-bold",children:[N.firstname," ",N.lastname]}),e.jsxs("span",{className:"w-full",children:[N.contact_no," •"," ",N.address]})]})},j))})})]})}),e.jsxs(Oa,{className:"flex flex-row gap-2",children:[e.jsx(P,{variant:"outline",className:"flex-1 font-medium",onClick:()=>{c(!1),y()},children:"Add new customer"}),e.jsx(P,{className:"flex-1",onClick:()=>{c(!1)},children:"Close"})]})]})}),e.jsx(me,{isOpen:u,onClose:x,title:"Add Customer",children:e.jsx(Nr,{onClose:x})})]})},ta=()=>{const t=pe(),[s,a]=h.useState({}),l=(d,m)=>{a(u=>({...u,[d]:m}))},r=d=>{a(m=>({...m,...d}))},c={onSuccess:async()=>{await t.invalidateQueries({queryKey:["invoices"]}),a({}),K.success("Submitted successfully!",{autoClose:3e3})},onError:d=>{console.error("Invoices Data failed",d.message)}},{mutateAsync:n}=Y({mutationKey:["addInvoice"],mutationFn:Ra,...c}),{mutateAsync:i}=Y({mutationKey:["updateInvoice"],mutationFn:Ka,...c}),{mutateAsync:o}=Y({mutationKey:["removeInvoice"],mutationFn:Ua,...c});return{value:s,setValue:a,selectChange:r,handleChange:l,addInvoiceMutation:n,updateInvoiceMutation:i,removeInvoiceMutation:o}},vr=()=>{const{currentInvoiceItemsQueue:t}=ue();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Items"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.length>0?e.jsx(e.Fragment,{children:t.length}):0})]})})},br=()=>{const{invoiceItemsDatabase:t}=ue();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Subtotal"}),e.jsx(w,{className:"font-bold text-slate-700",children:ce(t.reduce((s,a)=>s+(a.total_price??0),0))})]})})},wr=()=>{const{currentInvoicePos:t}=ue();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Discount"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.total_discount?ce(t.total_discount):"₱0.00"})]})})},_r=()=>{const{currentInvoicePos:t}=ue();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Delivery Charge"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.delivery_charge?ce(t.delivery_charge):"₱0.00"})]})})},Sr=()=>{const{currentInvoicePos:t}=ue(),s=t.total_amount_due;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex w-full flex-col justify-between gap-2 py-2",children:e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx(w,{className:"text-lg font-bold text-gray-700",children:"Total"}),e.jsx(w,{className:"text-lg font-bold text-black",children:ce(s??0)})]})})})},Cr=()=>{const{currentInvoicePos:t}=ue();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Paid Amount"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.paid_amount?ce(t.paid_amount):"₱0.00"})]})})},kr=()=>{var s,a;const{currentInvoicePos:t}=ue();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Payment Type"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:(s=t.type)==null?void 0:s.replace("_"," ")})]}),t.type!=="exit"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Payment Method"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:(a=t.payment_method)==null?void 0:a.replace("_"," ")})]}),t.payment_method!=="cash"&&t.payment_method!==""&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Reference Number"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:t.reference_no})]})})]})]})},nt=()=>{const{currentInvoicePos:t}=ue();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-col justify-between gap-2 border-t-2 border-dashed py-2",children:[e.jsx(kr,{}),t.payment_method!=="purchase_order"&&e.jsx(Cr,{}),e.jsxs("div",{className:"flex flex-row justify-between",children:[(t.change_amount??0)<0?e.jsx("span",{className:"text-lg font-bold text-gray-700",children:"Balance"}):e.jsx("span",{className:"text-lg font-bold text-gray-700",children:"Change"}),e.jsx("span",{className:"text-lg font-bold text-black",children:ce(t.change_amount??0)})]})]})})},Fr=()=>{const{currentInvoicePos:t,setCurrentInvoicePos:s}=ue(),{selectedCustomer:a}=Ze();return h.useEffect(()=>{t.payment_method==="balance_payment"&&s({...t,subtotal:(a==null?void 0:a.total_balance)??0,total_amount_due:(a==null?void 0:a.total_balance)??0})},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"my-2 flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Remaining Balance"}),e.jsx(w,{className:"font-bold text-slate-700",children:a!=null&&a.total_balance?ce(a.total_balance??0):"₱0.00"})]})})},Ir=({})=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{handleInvoicePosChange:a,currentInvoicePos:l}=ue(),{selectedCustomer:r,vouchers:c,selectedVoucher:n,setSelectedVoucher:i}=Ze(),[o,d]=h.useState(l.total_discount??0),m=()=>{a("total_discount",o),t({open:!1,title:""})};return e.jsx(ds,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(xs,{children:[e.jsxs(ms,{className:"items-start",children:[e.jsx(us,{children:"Add Discount Amount"}),e.jsx(Ls,{children:"Contact admininstrator for approval"})]}),e.jsxs("form",{className:"flex flex-col gap-2 ",onSubmit:u=>{u.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(I,{className:"pl-8",value:o,type:"number",onChange:u=>{d(Number(u.target.value)),i(void 0)},onBlur:u=>{u.target.value=o.toString()}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Claim voucher"}),e.jsxs(J,{disabled:Object.keys(r).length===0,value:n?n==null?void 0:n.id.toString():"",onValueChange:u=>{const x=c==null?void 0:c.find(y=>y.id===Number(u));d((x==null?void 0:x.discounted_price)??0),i(x??void 0)},children:[e.jsx(ee,{className:"w-full",children:e.jsx(se,{placeholder:"Select voucher..."})}),e.jsx(te,{children:c==null?void 0:c.map(u=>e.jsxs($,{value:`${u.id}`,children:[e.jsx("span",{className:"font-bold",children:u.code})," • ",e.jsx("span",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(u.discounted_price??0)})]},u.id))})]})]}),e.jsx(Cs,{asChild:!0,children:e.jsx(P,{className:"w-full ",type:"submit",onClick:()=>{m()},children:"Apply"})})]})]})})},Pr=({})=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{handleInvoicePosChange:a,currentInvoicePos:l}=ue(),[r,c]=h.useState(l.paid_amount??0),n=()=>{a("paid_amount",r),t({open:!1,title:""})};return e.jsx(ds,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(xs,{children:[e.jsxs(ms,{className:"items-start",children:[e.jsx(us,{children:"Add Paid Amount"}),e.jsx(Ls,{children:"Input the exact amount paid by the customer"})]}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:i=>{i.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(I,{className:"pl-8",defaultValue:r,type:"number",onChange:i=>{c(Number(i.target.value))}})]}),e.jsx(Cs,{asChild:!0,children:e.jsx(P,{className:"w-full ",type:"submit",onClick:()=>{n()},children:"Apply"})})]})]})})},Tr=({})=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{selectedCustomer:a}=Ze(),{handleInvoicePosChange:l,currentInvoicePos:r,setCurrentInvoiceItemsQueue:c,setInvoiceItemsDatabase:n}=ue(),[i,o]=h.useState(r.type??"payment");return h.useEffect(()=>{r.type==="exit"&&l("payment_method","exit")},[r.type]),e.jsx(ds,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(xs,{children:[e.jsxs(ms,{className:"items-start",children:[e.jsx(us,{children:"Select Payment Type"}),e.jsxs(Ls,{children:["Payment Type:"," ",r.type==="payment"?"Payment":"Exit"]})]}),e.jsx(bt,{id:"type",value:i,onValueChange:d=>{l("type",d),o(d)},children:e.jsxs(wt,{className:"flex h-12 flex-row gap-1 p-2",children:[e.jsx(Ns,{value:"payment",className:`data-[state=active]:bg-primary h-10 w-full rounded-md font-medium
                                text-slate-800 hover:bg-slate-200 data-[state=active]:text-white`,children:"Payment"}),e.jsx(Ns,{value:"exit",className:`data-[state=active]:bg-primary h-10 w-full rounded-md font-medium
                                text-slate-800 hover:bg-slate-200 data-[state=active]:text-white`,children:"Exit"})]})}),r.type==="payment"&&e.jsxs("div",{className:"grid columns-4 grid-cols-2 gap-2",children:[e.jsx(P,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="cash"&&"bg-primary text-white"}`,onClick:()=>{l("payment_method","cash")},children:"Cash"}),e.jsx(P,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="cheque"&&"bg-primary text-white"}`,onClick:()=>{l("payment_method","cheque")},children:"Cheque"}),e.jsx(P,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="e-wallet"&&"bg-primary text-white"}`,onClick:()=>{l("payment_method","e-wallet")},children:"E-Wallet"}),e.jsx(P,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="purchase_order"&&"bg-primary text-white"}`,onClick:()=>{l("payment_method","purchase_order")},children:"Purchase Order"}),e.jsx(P,{variant:"outline",disabled:!(a!=null&&a.total_balance),className:`h-16 font-medium ${r.payment_method==="balance_payment"&&"bg-primary text-white"}`,onClick:()=>{c([]),n([]),l("payment_method","balance_payment")},children:"Balance Payment"})]}),e.jsx("div",{children:(r.payment_method==="cheque"||r.payment_method==="voucher"||r.payment_method==="e-wallet"||r.payment_method==="purchase_order")&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-col justify-between gap-2",children:[e.jsx(w,{children:"Input Reference Code:"}),e.jsx(I,{placeholder:"Reference Code"})]})})}),e.jsx(Cs,{asChild:!0,children:e.jsx(P,{type:"button",onClick:()=>{t({open:!1,title:""})},children:"Close"})})]})})},Ar=()=>{const{auth:t}=le(),{searchFilterItems:s}=Be(),a=Ke();return e.jsx(e.Fragment,{children:e.jsx("div",{children:t.role==="admin"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row items-center justify-between px-2 py-4 ",children:[e.jsxs("span",{className:"flex flex-col font-bold text-slate-700",children:["Warehouse"," ",e.jsx("span",{className:"font-medium text-slate-800",children:s.warehouse_id===1?"Cagayan De Oro":"Iligan"})]}),e.jsx(P,{onClick:()=>{a("/pos")},size:"icon",children:e.jsx(et,{size:18})})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row justify-between p-2 bg-white",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"flex flex-row items-center gap-2 font-bold uppercase text-slate-800",children:s.warehouse_id===1?"Cagayan De Oro Branch":"Iligan Branch"}),e.jsx("span",{className:"font-medium capitalize text-slate-900",children:t.user.firstname+" "+t.user.lastname})]}),e.jsx(P,{className:"hover:cursor-default",size:"icon",children:e.jsx(et,{size:18})})]})})})})},Dr=({})=>{const{selectedCustomer:t,setOpenSearchCustomer:s}=Ze();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex max-w-2xl flex-col gap-1 border-y-[1px] border-slate-200 bg-white px-2 py-4 pb-5",children:e.jsxs("div",{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(w,{className:"text-[16px] font-bold text-slate-700",children:"Customer"}),Object.keys(t).length===0?e.jsx("span",{className:"text-sm font-medium",children:"Select Customer"}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2 pt-2 ",children:[e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs(w,{className:"font-medium text-normal text-slate-800",children:["Full Name:"," "]}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.firstname+" "+t.lastname})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx(w,{className:"font-medium text-normal text-slate-800",children:"Address:"}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.address})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx(w,{className:"font-medium text-normal text-slate-800",children:"Contact Number:"}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.contact_no})]})]})})]}),e.jsx(P,{onClick:()=>s(!0),size:"icon",children:e.jsx(St,{size:18})})]})})})},zr=({})=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{currentInvoicePos:a}=ue();ta();const{selectedCustomer:l}=Ze();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-1 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(P,{className:"flex-1",onClick:()=>{t({open:!0,title:"delivery_charge"})},disabled:a.payment_method==="balance_payment",children:"Set Delivery"}),e.jsx(P,{className:"flex-1",onClick:()=>{t({open:!0,title:"discount"})},disabled:a.payment_method==="balance_payment",children:"Set Discount"})]}),e.jsx(P,{onClick:()=>{t({open:!0,title:"payment_type"}),console.log("Options:",s)},children:"Set Payment Type"}),e.jsx(P,{onClick:()=>{t({open:!0,title:"paid_amount"}),console.log("Options:",s)},children:"Add Paid Amount"}),e.jsx("hr",{className:"my-1 w-full"}),e.jsx(P,{className:"w-full disabled:cursor-not-allowed",onClick:()=>{t({open:!0,title:"checkout_discount"})},disabled:Object.keys(l).length===0||a.type==="payment"&&a.payment_method!=="purchase_order"&&a.payment_method!=="balance_payment"&&(a.change_amount??0)<0,children:"Checkout with Discount"}),e.jsx(P,{className:"w-full disabled:cursor-not-allowed",onClick:()=>{t({open:!0,title:"checkout"})},disabled:Object.keys(l).length===0||a.type==="payment"&&a.payment_method!=="purchase_order"&&a.payment_method!=="balance_payment"&&(a.change_amount??0)<0,children:"Checkout"})]})})},aa=()=>{const{currentInvoicePos:t}=ue();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-full flex-col justify-between p-4 px-2",children:e.jsx("div",{className:"flex flex-col gap-2",children:t.payment_method!=="balance_payment"?e.jsxs(e.Fragment,{children:[e.jsx(vr,{}),e.jsx(br,{}),e.jsx(wr,{}),e.jsx(_r,{}),e.jsx(Sr,{}),e.jsx(nt,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(Fr,{}),e.jsx(nt,{})]})})})})},Er=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-pos-primary-background flex h-screen w-full max-w-[375px] flex-col gap-2 overflow-auto p-5",children:e.jsxs("div",{className:"flex flex-col rounded-md bg-white p-2 px-4",children:[e.jsx(Ar,{}),e.jsx(yr,{}),e.jsx(Dr,{}),e.jsx(aa,{}),e.jsx(zr,{})]})})}),Wr=()=>{const{dialogOptions:t}=Be();return e.jsxs(e.Fragment,{children:[t.title==="payment_type"&&e.jsx(Tr,{}),t.title==="discount"&&e.jsx(Ir,{}),t.title==="paid_amount"&&e.jsx(Pr,{}),t.title==="checkout"&&e.jsx(ct,{}),t.title==="checkout_discount"&&e.jsx(ct,{}),t.title==="delivery_charge"&&e.jsx(Mr,{})]})},ct=()=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{invoiceItemsDatabase:a,currentInvoiceItemsQueue:l,fullData:r,setFullData:c,currentInvoicePos:n,setCurrentInvoicePos:i}=ue(),[o,d]=h.useState("confirming"),{addInvoiceMutation:m}=ta(),{selectedVoucher:u,setSelectedVoucher:x}=Ze();async function y(){d("submitting"),console.log("Invoice:",n);const j=n;j.invoice_items=a.map(p=>({...p,product_id:p.product_id})),await m(j).then(p=>{u&&Ba(u.id).then(()=>x(void 0)),c(p.data),d("success"),K.success("Transaction successful.",{autoClose:3e3})}).catch(()=>{d("confirming"),K.error("Transaction failed. Please try again.",{autoClose:3e3})})}h.useEffect(()=>{s.title==="checkout_discount"?i(j=>({...j,status:"pending"})):i(j=>({...j,status:"approved"}))},[s.title]);const f=Ke();function N(){window.api.send({fullData:r,invoiceItems:l,invoiceItemsDatabase:a})}return e.jsx(La,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(qa,{children:[e.jsxs(Ha,{className:"items-start",children:[e.jsx($a,{children:o!=="success"?`${s.title==="checkout"?"Checkout":"Checkout with Discount"}`:"Transaction successful"}),o!=="success"&&e.jsx(Va,{children:"Confirm the details of this transaction"})]}),o!=="success"?e.jsx(aa,{}):e.jsxs("div",{className:"my-4 w-full space-y-2 text-center",children:[e.jsx(Fl,{size:80,className:"mx-auto text-green-500"}),e.jsx("h3",{className:"text-base font-medium text-slate-700",children:"Transaction has been successully submitted!"})]}),e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(P,{variant:"outline",className:`font-medium ${o!=="confirming"&&"hidden"} flex-1`,type:"reset",onClick:()=>{t({open:!1,title:""})},children:"Cancel"}),o==="success"?e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(P,{className:"flex-1",onClick:()=>{f(0)},children:"New transaction"}),e.jsx(P,{className:"flex-1",type:"submit",onClick:j=>{j.preventDefault(),N()},children:"Print invoice"})]}):e.jsx(P,{className:"flex-1",disabled:o==="submitting",type:"submit",onClick:j=>{j.preventDefault(),d("submitting"),y()},children:o==="confirming"?"Confirm transaction":o==="submitting"?"Submitting...":""})]})]})})},Mr=()=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{handleInvoicePosChange:a,currentInvoicePos:l}=ue(),[r,c]=h.useState(l.delivery_charge??0),n=()=>{a("delivery_charge",r),t({open:!1,title:""})};return e.jsx(ds,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(xs,{children:[e.jsx(ms,{className:"items-start",children:e.jsx(us,{children:"Add Delivery Charge"})}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:i=>{i.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(I,{className:"pl-8",defaultValue:r,type:"number",onChange:i=>{c(Number(i.target.value))}})]}),e.jsx(Cs,{asChild:!0,children:e.jsx(P,{className:"w-full ",type:"submit",onClick:()=>{n()},children:"Apply"})})]})]})})},Or=({})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center",children:[e.jsx(Al,{width:150,height:150,color:"#888888",strokeWidth:-1}),e.jsx("span",{className:"max-w-[300px] text-center text-[#888]",children:"Start entering products / product code / serial number / brand"})]})}),Rr=({})=>{const{currentInvoiceItemsQueue:t,handleInvoicePosChange:s,handleInvoiceItemQuantity:a,removeInvoiceItem:l,invoiceItemsDatabase:r}=ue();console.log(),h.useEffect(()=>{s("subtotal",t.reduce((n,i)=>n+i.total_price,0))},[t]);const c=[{id:"orderItem",enableResizing:!1,enableHiding:!1,header:()=>e.jsx("div",{className:"flex justify-center",children:"Item #"}),cell:({row:n})=>e.jsx("div",{className:"flex justify-center",children:n.index+1}),size:100},{accessorKey:"name",enableHiding:!1,header:()=>e.jsx("div",{className:"justify-center",children:"Product"}),cell:({row:n})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"text-sm font-bold",children:n.original.product.name}),e.jsx("span",{className:"font-medium",children:n.original.product.size})]}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[n.original.product.brand?e.jsx("span",{className:"",children:n.original.product.brand}):e.jsx("span",{className:"font-light",children:"(No Brand)"}),e.jsxs("span",{className:"",children:["• ",n.original.product.color]})]})]}),size:350},{enableHiding:!1,accessorKey:"quantity",header:()=>e.jsx("div",{className:"flex justify-center",children:"Quantity"}),size:150,cell:({row:n})=>{const i=n.index,o=n.original.inventory_product.approved_stocks-n.original.inventory_product.sold_count||0;return e.jsx("div",{className:"flex justify-center ",children:e.jsxs("div",{className:"flex flex-row border drop-shadow-sm",children:[e.jsx(P,{className:"rounded-sm bg-red-300 hover:bg-red-500 disabled:opacity-100",onClick:()=>{a(i,o,r[n.index].quantity-1)},disabled:r[n.index].quantity===1,children:e.jsx("span",{children:"-"})}),e.jsx(I,{id:"quantity",className:"w-20 rounded-none text-center drop-shadow-none",type:"number",defaultValue:r[i].quantity,onChange:d=>{console.log(d.target.value),setTimeout(()=>{a(i,o,Number(d.target.value))},1e3)}}),e.jsx(P,{className:"rounded-sm bg-slate-500 hover:bg-slate-700 disabled:bg-slate-200",onClick:()=>{a(i,o,r[n.index].quantity+1)},disabled:r[n.index].quantity>=o,children:e.jsx("span",{children:"+"})})]})})}},{id:"item_capital_price",size:125,header:()=>e.jsx("div",{className:"justify-center",children:"Capital Price"}),cell:({row:n})=>e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx("span",{children:ce(n.original.capital_price)})})},{accessorKey:"price",enableHiding:!1,header:()=>e.jsx("div",{className:"justify-center",children:"Product Price"}),cell:({row:n})=>e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{children:ce(n.original.price)}),n.original.on_sale?e.jsxs("span",{className:"text-sm font-light",children:["(",ce(n.original.sale_discount??0),")"]}):null]})},{id:"item_total_capital_price",size:125,header:()=>e.jsx("div",{className:"justify-center",children:"Total Capital Price"}),cell:({row:n})=>e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx("span",{children:ce(n.original.capital_price*r[n.index].quantity)})})},{id:"total_price",enableHiding:!1,accessorKey:"total_price",header:()=>e.jsx("div",{className:"justify-center",children:"Subtotal"}),cell:({row:n})=>e.jsx("div",{className:"",children:e.jsx("span",{children:ce(r[n.index].quantity*n.original.price)})}),size:250},{enableHiding:!1,id:"actions",size:100,cell:({row:n})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsx(P,{className:"bg-red-500 hover:bg-red-700",onClick:()=>{l(n.index)},children:e.jsx(rs,{color:"#FFF"})})})}];return e.jsx("div",{className:"h-full overflow-y-scroll",children:t.length===0?e.jsx(e.Fragment,{children:e.jsx(Or,{})}):e.jsx(vl,{data:t,columns:c})})},Kr=()=>{const t=["","Product name","Price","Qty","Total"],{selectedInvoiceCode:s}=ut(),{data:a}=os();return console.log(s),e.jsx(e.Fragment,{children:e.jsxs(Ct,{children:[e.jsxs(Qa,{children:["Select items the customer wants to return for invoice"," "]}),e.jsx(kt,{children:e.jsx(cs,{id:"tHeaderRow",className:"hover:bg-white",children:t.map(l=>e.jsx(Ft,{className:"whitespace-nowrap px-5 py-3 text-left text-xs font-bold uppercase",children:l},l+"_head"))},"tHeaderRow")}),e.jsx(It,{children:s.invoice_items.length>0&&s.invoice_items.map((l,r)=>e.jsxs(cs,{className:"text-sm font-medium text-gray-700",children:[e.jsx(xe,{className:"p-3 pr-0",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4",name:"return",id:"return"})}),e.jsx(xe,{className:"text-sm font-medium text-gray-700",children:l==null?void 0:l.product.name},(l==null?void 0:l.product.name)+"Product Name"),e.jsx(xe,{children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{children:ce(a.find(c=>c.id===l.product_price_id).cost)}),a.find(c=>c.id===l.product_price_id).on_sale?e.jsxs("span",{className:"text-muted-foreground",children:["(",ce(a.find(c=>c.id===l.product_price_id).sale_discount),")"]}):null]})}),e.jsx(xe,{children:l==null?void 0:l.quantity}),e.jsx(xe,{children:ce(l==null?void 0:l.total_price)})]},(l==null?void 0:l.id)+"row"))}),e.jsx(Ya,{children:e.jsxs(cs,{children:[e.jsx(xe,{colSpan:4,className:"text-right",children:"Total:"}),e.jsx(xe,{children:ce(s.paid_amount)})]})})]})})},Ur=()=>{const[t,s]=h.useState(""),{sellableItems:a,fetchingProducts:l}=Be(),{currentInvoiceItemsQueue:r,setCurrentInvoiceItemsQueue:c,invoiceItemsDatabase:n,setInvoiceItemsDatabase:i,currentInvoicePos:o}=ue();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative z-20 pb-10",children:e.jsx("div",{className:"absolute box-content flex w-full ",children:e.jsxs($e,{className:"rounded-lg border p-1 shadow-md",children:[e.jsx(Ve,{value:t,onValueChange:s,placeholder:l?"Loading Products":"Enter Product Name",disabled:a.length===0||o.payment_method==="balance_payment"}),e.jsx(Ga,{className:"",children:t?e.jsx(e.Fragment,{children:a.filter(d=>d.inventory_product.approved_stocks>(d.inventory_product.sold_count??0)).map((d,m)=>{var x;const u=d.inventory_product.approved_stocks-d.inventory_product.sold_count;return e.jsx(Te,{onSelect:()=>{const y=r.findIndex(f=>f.inventory_product.product.id===d.inventory_product.product.id);y!==-1&&(n[y].quantity+=1,s("")),y===-1&&(c([...r,d]),i([...n,{product_id:d.product.id,product_price_id:d.inventory_product.product_price.id,product_price:d.inventory_product.product_price.price,quantity:1,unit:d.unit,item_discount:0,price:d.price,created_by:d.created_by,active_status:d.active_status,created_at:d.created_at,updated_at:d.updated_at,total_price:d.price,source_inventory:d.warehouse.id}]),s(""))},value:`${d.product.id} ${d.id} ${d.product.name} ${d.product.serial_no} ${d.product.brand} ${d.product.color}`,children:e.jsxs("div",{className:"flex flex-1 flex-row justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"font-bold",children:d.product.name}),e.jsx("span",{className:"font-medium",children:(x=d.product.size)==null?void 0:x.replace("inch",'"')})]}),e.jsxs("div",{className:"flex flex-row gap-1",children:[d.product.brand?e.jsxs("span",{className:"text-[12px]",children:["(",d.product.brand,")"]}):e.jsx("span",{className:"text-[12px]",children:"(No Brand)"}),e.jsxs("span",{className:"",children:["• ",d.product.color]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-bold ",children:ce(d.price)}),e.jsxs("span",{className:"font-medium",children:[u," ",u>1?"items":"item"]})]})]})},m)})}):null})]})})})})},hc=({})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex h-full flex-row",children:[e.jsx(Bs,{}),e.jsxs("div",{className:"flex h-full w-screen flex-row",children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx(Ur,{}),e.jsx(Rr,{})]}),e.jsx(Er,{}),e.jsx(Wr,{})]})]})}),Lr=({openModal:t})=>{const{transactions:s,isFetching:a,progress:l}=Xa(),r=[{id:"select",header:({table:c})=>e.jsx("input",{type:"checkbox",checked:c.getIsAllPageRowsSelected(),onChange:n=>c.toggleAllPageRowsSelected(!!n.target.checked),"aria-label":"Select all"}),cell:({row:c})=>e.jsx("input",{type:"checkbox",checked:c.getIsSelected(),onChange:n=>c.toggleSelected(!!n.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"Product ID"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.id})},{accessorKey:"price",header:()=>e.jsx("div",{className:"text-center",children:"Price"}),cell:({row:c})=>{const n=parseFloat(c.getValue("amount")),i=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n);return e.jsx("div",{className:"text-center",children:i})}},{accessorKey:"product_name",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["PRODUCT NAME ",c.getIsSorted()==="asc"?e.jsx(D,{}):c.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.product_name})},{accessorKey:"dimensions",header:()=>e.jsx("div",{className:"text-center",children:"DIMENSIONS"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.dimensions})},{accessorKey:"serial",header:()=>e.jsx("div",{className:"text-center",children:"SERIAL"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.serial})},{accessorKey:"sku",header:()=>e.jsx("div",{className:"text-center",children:"SKU"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.sku})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"INVENTORY STATUS"}),cell:({row:c})=>{const n=c.getValue("status"),i=n==="LOW"?"bg-red-500":n==="MEDIUM"?"bg-amber-500":"bg-lime-600";return e.jsx("div",{className:`flex w-full flex-1 flex-col text-center ${i}`,children:c.getValue("status")})}},{accessorKey:"type",header:()=>e.jsx("div",{className:"text-center",children:"ORDER TYPE"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.type})},{accessorKey:"quantity",header:()=>e.jsx("div",{className:"text-center",children:"QUANTITY"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.quantity})}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:r,filterWhat:"serial",dataType:"Transaction",openModal:()=>t,isLoading:a})})},fc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Transaction",children:e.jsx(Za,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Lr,{openModal:c})})})})})})},qr=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:l,progress:r,setSelectedTransfer:c}=Ie(),n=a.map(f=>({transfer_id:f.transfer_id})),o=s.filter(f=>{if(n.some(N=>N.transfer_id===f.id))return f}).filter(f=>{if(f.approval_status==="pending")return f}),{auth:d}=le(),m=f=>{c(f),t(f,"details")},u=f=>{c(f),t(f,"edit")},x=f=>{c(f),t(f,"products")},y=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:f})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>f.toggleSorting(f.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["TRANSFER CODE ",f.getIsSorted()==="asc"?e.jsx(D,{}):f.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:f})=>e.jsx("div",{children:f.original.code?f.original.code:"N/A"})},{accessorKey:"source",header:()=>e.jsx("div",{className:"text-center",children:"SOURCE-DESTINATION"}),cell:({row:f})=>{const N=f.original.source,j=f.original.destination;return e.jsxs("div",{className:"text-center",children:[N.code,"-",j.code]})}},{accessorKey:"transfer_status",sortingFn:"text",enableSorting:!0,header:({column:f})=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(b,{onClick:()=>f.toggleSorting(f.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center z-10",children:["TRANSFER STATUS ",f.getIsSorted()==="asc"?e.jsx(D,{}):f.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:f})=>e.jsx("div",{className:"text-center",children:f.original.transfer_status?f.original.transfer_status:"N/A"})},{accessorKey:"transfer_schedule",sortingFn:"datetime",enableSorting:!0,header:({column:f})=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(b,{onClick:()=>f.toggleSorting(f.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center z-10",children:["SCHEDULE ",f.getIsSorted()==="asc"?e.jsx(D,{}):f.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:f})=>{const N=f.getValue("transfer_schedule");if(N.toString()!=="0000-00-00 00:00:00"){const j={year:"numeric",month:"long",day:"numeric"},p=new Date(N).toLocaleDateString([],j);return e.jsx("div",{className:"text-center",children:p})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"approval_status",header:()=>e.jsx("div",{className:"text-center",children:"APPROVAL STATUS"}),cell:({row:f})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:f.original.approval_status.toLowerCase()==="approved"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):f.original.approval_status.toLowerCase()==="rejected"?e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:f})=>{var j;const N=f.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>m(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),((j=d.role)==null?void 0:j.toLowerCase())!="encoder"&&e.jsxs(V,{onClick:()=>u(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:N.transfer_status!="arrived"&&N.approval_status!="rejected"?e.jsx(ke,{size:16,strokeWidth:2.25}):e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>x(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:N.transfer_status!="arrived"&&N.approval_status!="rejected"?e.jsx(ke,{size:16,strokeWidth:2.25}):e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Products"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:o,columns:y,filterWhat:"approval_status",dataType:"",openModal:void 0,isLoading:l})})},Hr=({onClose:t})=>{const{selectedTransfer:s}=Ie();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Source"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.source.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.destination.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer schedule"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_schedule.toString()==="0000-00-00 00:00:00"?"N/A":ie(s.transfer_schedule)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Received by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.received_by?s.received_by.firstname+" "+s.received_by.lastname:"N/A"})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Date received"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.date_received?ie(s.date_received):"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approved_by?s.approved_by.firstname+" "+s.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.updated_at)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.notes?s.notes:"N/A"})]})})]})})},$r=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:l,selectedTransfer:r,setSelectedTransfer:c,selectedProduct:n,setSelectedProduct:i,addProd:o,setAddProd:d}=Ie();le();const m=a.filter(f=>f.transfer_id===r.id),u=f=>{i(f),d(!1),t(f,"edit")},x=()=>{d(!0),t({},"add")},y=[{id:"select",header:({table:f})=>e.jsx("input",{type:"checkbox",checked:f.getIsAllPageRowsSelected(),onChange:N=>f.toggleAllPageRowsSelected(!!N.target.checked),"aria-label":"Select all"}),cell:({row:f})=>e.jsx("input",{type:"checkbox",checked:f.getIsSelected(),onChange:N=>f.toggleSelected(!!N.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:f})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>f.toggleSorting(f.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",f.getIsSorted()==="asc"?e.jsx(D,{}):f.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:f})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:f.original.product.name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:f})=>e.jsx("div",{className:"text-center",children:f.original.total_quantity})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"text-center",children:"UNIT"}),cell:({row:f})=>e.jsx("div",{className:"text-center",children:f.original.unit})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:f})=>{const N=f.original;return r.transfer_status!="arrived"&&r.approval_status!="rejected"&&e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsx(b,{fill:"yellow",textColor:"black",onClick:()=>u(N),children:"Edit Product"})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:m,columns:y,filterWhat:"product_name",dataType:"Transfer Products",openModal:r.transfer_status!="arrived"&&r.approval_status!="rejected"?x:void 0,isLoading:l})})},it=({onClose:t})=>{const{addProd:s,selectedProduct:a}=Ie(),{product:l,allProducts:r,allInventoryProducts:c,inventoryID:n,invCode:i,prodName:o,filteredProductsSrc:d,filteredInventoriesSrc:m,quantityLimit:u,damagedCount:x,isChanged:y,isSubmitting:f,error:N,success:j,handleSubmit:p,handleChange:g,handleChangeSelect:v}=Ps(),F=l.capital_price?l.capital_price:0,_=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(F);j&&setTimeout(()=>{t()},1e3);const[k,T]=h.useState(s?i:"Loading...");return h.useEffect(()=>{m.length>0&&!s&&l.source_inventory&&T(m.filter(C=>C.id===l.source_inventory)[0].code)},[l.source_inventory,m]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:C=>{C.preventDefault()},children:e.jsxs("div",{className:"flex max-w-6xl flex-col gap-5",children:[e.jsxs("div",{className:"grid grid-cols-12 justify-center gap-3",children:[e.jsxs("div",{className:"col-span-3 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer Product"}),e.jsx(Q,{name:"id",value:l.id,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"col-span-3 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer ID"}),e.jsx(Q,{name:"created_by",placeholder:"User ID",value:l.transfer_id,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Inventory source:"}),e.jsxs(J,{onValueChange:C=>v("inventory_id",C),required:!0,name:"inventory_id",value:k!="Loading..."?s?i:k:"",children:[e.jsx(ee,{name:"inventory_id",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:s?i||"Choose inventory...":k})}),e.jsx(te,{className:"bg-white font-medium",children:m.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):m.map((C,M)=>e.jsx($,{value:C.code,className:"text-sm font-medium text-slate-700",children:C.code},M))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 justify-center gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Product to transfer:"}),e.jsxs(J,{onValueChange:C=>v("product_id",Number(C.split("-")[0]),Number(C.split("-")[1])),required:!0,name:"product_id",disabled:!n,children:[e.jsx(ee,{name:"product_id",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:s?n?"Choose product...":"Select inventory first":k!="Loading..."?o==""?"Choose product...":o:"Loading..."})}),e.jsx(te,{className:"bg-white font-medium",children:d.length<=0?!s&&k!="Loading..."?e.jsx("div",{className:"flex h-12 w-full items-center justify-center px-2",children:"No items in selected inventory."}):e.jsx("div",{className:"px-2",children:" Loading... "}):d.map((C,M)=>e.jsx($,{value:C.product.id?C.product.id.toString()+"-"+M.toString():"",className:`text-sm font-medium text-slate-700
												${!s&&C.product.id==a.product.id&&"selected"}`,children:C.product.name},M))})]})]}),e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Capital Price:"}),e.jsx(Q,{name:"capital_price",type:"string",value:_,disabled:!0,readOnly:!0})]})]}),e.jsxs("div",{className:"flex flex-row justify-center gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"TOTAL QUANTITY"}),e.jsx(Q,{name:"total_quantity",type:"string",value:l.total_quantity||"",placeholder:`Available stocks: ${u}`,disabled:!l.capital_price,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"UNIT"}),e.jsx(Q,{name:"unit",type:"string",value:l.unit||"",placeholder:"box, pieces, etc.",disabled:!0,readOnly:!0})]}),l.total_quantity!=0&&x!=0&&l.total_quantity==u&&e.jsxs("div",{className:"group mb-2 grid content-end",children:[e.jsx(Ws,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsxs("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-2 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:["Some damaged goods (",x," ",l.unit,") are included in the transfer."]})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"col-span-5 flex flex-col items-start",children:[j&&e.jsx("div",{className:"font-bold text-green-700",children:j}),N&&e.jsx("div",{className:"font-bold text-red-700",children:N}),f?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"col-span-5 flex flex-col items-end gap-3",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),y&&e.jsx(b,{type:"submit",fill:y?"green":null,disabled:!y,onClick:p,children:f?"Submitting":s?"Add Product":"Edit Product"})]})})]})})]})})})},Vr=({onClose:t})=>{const{isOpen:s,openModal:a,closeModal:l}=oe(),[r,c]=h.useState("");le();const n=(i,o)=>{a(),c(o)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx($r,{openModal:n})}),e.jsx(me,{title:r==="edit"?"Edit Transfer Product":"Add Transfer Product",isOpen:s,onClose:l,children:e.jsxs(e.Fragment,{children:[r==="edit"&&e.jsx(it,{onClose:l}),r==="add"&&e.jsx(it,{onClose:l})]})})]})},pc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Transfer",children:e.jsxs(_t,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(qr,{openModal:c})})}),e.jsx(me,{title:l==="details"?"Transfer Details":l==="edit"?"Edit Transfer":"Transfer Products",isOpen:t,onClose:a,closeOnOverlayClick:l==="details",children:e.jsxs(e.Fragment,{children:[l==="details"&&e.jsx(Hr,{onClose:a}),l==="edit"&&e.jsx(sa,{onClose:a}),l==="products"&&e.jsx(Vr,{onClose:a})]})})]})})})},Br=({openModal:t})=>{const{invoices:s,isFetching:a,users:l,userSales:r,setSelectedInvoice:c}=Pt(),n=o=>{c(o.invoices),t(o,"details")},i=[{accessorKey:"issued_by",sortingFn:"text",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["FULL NAME ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.invoices[0].issued_by.firstname+" "+o.original.invoices[0].issued_by.lastname})},{id:"total_sales",sortingFn:"basic",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["NUMBER OF SALES ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.invoices.length})},{id:"amount_sales",sortingFn:"basic",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TOTAL AMOUNT OF SALES ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>{const m=o.original.invoices.filter(x=>x.status==="approved").reduce((x,y)=>x+y.paid_amount,0),u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m);return e.jsx("div",{className:"text-center",children:u})}},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:o})=>{const d=o.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>n(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:r,columns:i,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:a})})},Qr=({onClose:t})=>{const{invoices:s,selectedInvoice:a,isFetching:l}=Pt(),r=a[0],c=[{id:"select",header:({table:n})=>e.jsx("input",{type:"checkbox",checked:n.getIsAllPageRowsSelected(),onChange:i=>n.toggleAllPageRowsSelected(!!i.target.checked),"aria-label":"Select all"}),cell:({row:n})=>e.jsx("input",{type:"checkbox",checked:n.getIsSelected(),onChange:i=>n.toggleSelected(!!i.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"or_no",sortingFn:"alphanumeric",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{n.toggleSorting(n.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["OR NUMBER ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.or_no})},{accessorKey:"created_at",sortingFn:"datetime",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{n.toggleSorting(n.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["CREATED AT ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>{const i=n.getValue("created_at");if(i.toString()!=="0000-00-00 00:00:00"){const o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},d=new Date(i).toLocaleDateString([],o);return e.jsx("div",{className:"text-center",children:d})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"warehouse",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE CODE"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.warehouse.code})},{id:"customer",header:()=>e.jsx("div",{className:"text-center",children:"CUSTOMER NAME"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.customer.firstname+" "+n.original.customer.lastname})},{accessorKey:"type",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{n.toggleSorting(n.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TRANSACTION TYPE ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.type})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"STATUS"}),cell:({row:n})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:n.original.status.toLowerCase()==="approved"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):n.original.status.toLowerCase()==="rejected"?e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})},{accessorKey:"subtotal",header:()=>e.jsx("div",{className:"text-center",children:" SUBTOTAL "}),cell:({row:n})=>{const i=n.original.subtotal,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_discount",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL DISCOUNT "}),cell:({row:n})=>{const i=n.original.total_discount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_tax",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL TAX "}),cell:({row:n})=>{const i=n.original.total_tax,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"delivery_charge",header:()=>e.jsx("div",{className:"text-center",children:" DELIVERY CHARGE "}),cell:({row:n})=>{const i=n.original.delivery_charge,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_amount_due",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL AMOUNT DUE "}),cell:({row:n})=>{const i=n.original.total_amount_due,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"paid_amount",header:()=>e.jsx("div",{className:"text-center",children:" PAID AMOUNT "}),cell:({row:n})=>{const i=n.original.paid_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"change_amount",header:()=>e.jsx("div",{className:"text-center",children:" CHANGE AMOUNT "}),cell:({row:n})=>{const i=n.original.change_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"payment_method",header:()=>e.jsx("div",{className:"text-center",children:" PAYMENT METHOD "}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.payment_method||"N/A"})},{accessorKey:"reference_no",header:({column:n})=>e.jsx("div",{className:"text-center",children:"REF #"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.reference_no||"--"})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl max-h-96 flex-col gap-4",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Issuer: ",r.issued_by.firstname+" "+r.issued_by.lastname]}),e.jsx("div",{className:"overflow-x-hidden",children:e.jsx(X,{data:a,columns:c,filterWhat:"or_no",dataType:"",openModal:void 0,isLoading:l})})]})})},jc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"User Sales",children:e.jsxs(Ja,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Br,{openModal:c})})}),e.jsx(me,{isOpen:t,onClose:a,title:l==="details"?"Invoice Details":"",closeOnOverlayClick:l==="details",children:e.jsx(e.Fragment,{children:l==="details"&&e.jsx(Qr,{onClose:a})})})]})})})},Yr=()=>{const{roles:t,roleSelect:s,permissions:a,allPermissions:l,permissionChange:r,roleId:c,isChanged:n,isSubmitting:i,error:o,success:d,handleChange:m,handleChangeSelect:u,handleSubmit:x}=Kl(),{auth:y}=le(),f=l.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&g.title.includes("users".toLowerCase()))),N=l.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&!g.title.includes("transfer".toLowerCase())&&g.title.includes("product".toLowerCase())||g.title.includes("capital".toLowerCase()))),j=l.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&g.title.includes("transfer".toLowerCase()))),p=l.filter(g=>Object.keys(g).some(v=>g.title.includes("view".toLowerCase())));return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto flex h-full max-h-full w-full flex-row divide-x",children:[e.jsxs("div",{className:"flex w-60 flex-none flex-col p-2 pt-8",children:[e.jsx("h3",{className:"ml-4 pb-1 text-xs font-semibold text-slate-500/80",children:"Roles"}),e.jsx("div",{className:"w-full",children:t?t.map(g=>g.title!=="super_admin"&&e.jsx(P,{variant:"ghost",className:`w-full justify-start capitalize text-slate-700 ${(s==null?void 0:s.title)===g.title&&"bg-slate-300/40"}`,onClick:()=>u("roles",g.title),children:g.title.split("_").join(" ")},g.id+g.title)):e.jsx("div",{className:"flex h-16 w-full items-center justify-center text-slate-500",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})})}),e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-slate-500/80",children:"After saving changes, affected users must log out and log back in to apply the changes."}),(s==null?void 0:s.title)===y.role&&e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-red-500/80",children:"You are editing your current role. Review your changes carefully."}),e.jsxs("div",{className:"mt-auto w-full space-y-3",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[d&&e.jsx("p",{className:"text-green-600",children:d}),o&&e.jsx("p",{className:"text-red-600",children:o})]}),n&&e.jsx(P,{type:"submit",className:"w-full disabled:cursor-not-allowed",disabled:!!i,onClick:x,children:i?"Saving...":"Save changes"})]})]}),s?e.jsx(We,{className:"w-full",type:"auto",style:{"--border":"216 12% 84%"},children:e.jsxs("div",{className:`mx-auto flex w-full max-w-[700px] flex-1 flex-col gap-8 p-6 pt-8 ${!s||i?"pointer-events-none opacity-50":null}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"User Management"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:f.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):f.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:`${!((s==null?void 0:s.title)==="super_admin"||(s==null?void 0:s.title)==="admin")&&"cursor-pointer"} text-sm capitalize text-slate-700`,children:g.title.split("_").join(" ")}),e.jsx(qe,{id:g.title,name:g.title,value:g.id,disabled:(s==null?void 0:s.title)==="super_admin"||(s==null?void 0:s.title)==="admin",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Products"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:N.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):N.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(qe,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Transfers"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:j.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):j.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(qe,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Views"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:p.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):p.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(qe,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]})]})}):e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsx("p",{className:"text-lg font-medium text-slate-700/50",children:"Select a role to view and modify permissions"})})]})})},gc=()=>e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Role Permissions",children:e.jsx(Nt,{children:e.jsx("div",{className:"flex h-full max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(Yr,{})})})})})}),Gr=({handleViewItems:t,handleViewDetails:s,handleEditInventory:a})=>[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"warehouse.code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["WHS"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"date_received",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Received"})},{accessorKey:"transfer_id",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Transer Id"}),cell:({row:r})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{children:r.original.transfer_id?r.original.transfer_id:"—"})})},{accessorKey:"created_by",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Created by"}),cell:({row:r})=>e.jsx("div",{className:"uppercase",children:e.jsxs("span",{className:"max-w-[25ch] truncate",children:[r.original.created_by.firstname," ",r.original.created_by.lastname]})})},{accessorKey:"notes",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Notes"}),cell:({row:r})=>e.jsx("div",{children:e.jsx("p",{className:"max-w-[25ch] truncate",children:r.original.notes?r.original.notes:"—"})})},{id:"actions",cell:({row:r})=>{const c=r.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>{t(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Tt,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View items"})]}),e.jsxs(V,{onClick:()=>{s(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(V,{onClick:()=>{a(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]})]})]})})},enableGlobalFilter:!1}],Xr=({openModal:t,filterWarehouse:s,setTotalInventories:a})=>{const[l,r]=h.useState([]),{data:c,isLoading:n,setSelectedInventory:i}=ks(),o=Ke();h.useEffect(()=>{r(s?c.filter(y=>y.warehouse.id===s):c),a(c.length)},[c,s]);const d=()=>{t({},"add")},m=y=>{i(y),t(y,"edit")},u=y=>{i(y),o(`/inventory/items/${y.id}`)},x=y=>{i(y),t(y,"view_details")};return e.jsx(e.Fragment,{children:e.jsx(X,{columns:Gr({handleViewItems:u,handleViewDetails:x,handleEditInventory:m}),data:l.sort((y,f)=>{let N=new Date(y.updated_at??y.created_at);return new Date(f.updated_at??f.created_at).getTime()-N.getTime()}),filterWhat:"code",dataType:"Inventory",openModal:d,isLoading:n})})},Zr=({FormValue:t,handleChange:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"date_received",className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsxs(Se,{children:[e.jsx(je,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(P,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ys,{size:18,strokeWidth:1.5}),t.date_received?t.date_received:"Choose date..."]})}),e.jsx(Ce,{className:"w-auto p-0",children:e.jsx(ls,{mode:"single",initialFocus:!0,required:!0,onDayClick:a=>{const l=new Date(a),r=`${l.getFullYear()}-${(l.getMonth()+1).toString().padStart(2,"0")}-${l.getDate().toString().padStart(2,"0")}`;s("date_received",r)},selected:t.date_received?new Date(t.date_received):new Date})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(I,{id:"notes",name:"notes",type:"text",defaultValue:t.notes?t.notes:void 0,maxLength:1e3,placeholder:"Notes...",onChange:a=>s("notes",a.target.value)})]})]})}),la=(t,s,a)=>{const l=a||new Date,r=l.getFullYear()+"-"+("0"+(l.getMonth()+1)).slice(-2)+"-"+("0"+l.getDate()).slice(-2),c=t.slice(0,3),n=s.toString().padStart(4,"0");return`${c}-${r}-${n}`.toUpperCase()},Jr=({onClose:t,totalInventories:s,warehouses:a})=>{const{auth:l}=le(),{value:r,setValue:c,handleChange:n,handleSubmit:i}=$t(),[o,d]=h.useState(!1),[m,u]=h.useState(null);h.useEffect(()=>{n("created_by",l.user.id),n("type","supplier")},[]);const[x,y]=h.useState();return h.useEffect(()=>{if(x){const f=la(x,s+1);n("code",f)}},[x]),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:async f=>{f.preventDefault(),r.date_received===void 0?u("Please select a date for date received."):(d(!o),i({action:"add",data:r}).then(()=>{d(!1),K.success("Inventory added successfully."),t()}).catch(N=>{d(!1),N.response.data.message?K.error(N.response.data.message):K.error("Failed to add inventory.")}))},children:[e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"code",className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx(I,{id:"code",name:"code",type:"text",value:r.code||"",readOnly:!0,placeholder:"Code..."})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"warehouse",className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs(J,{onValueChange:f=>{var N;n("warehouse_id",Number(f)),y((N=a.find(j=>j.id===Number(f)))==null?void 0:N.code)},required:!0,children:[e.jsx(ee,{name:"warehouse",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:"Choose warehouse..."})}),e.jsx(te,{className:"bg-white font-medium",children:a.map((f,N)=>e.jsxs($,{value:f.id.toString(),className:"text-sm font-medium text-slate-700",children:[f.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+f.code+" • "+f.location})]},N))})]})]})]}),e.jsx("hr",{className:"col-span-12 my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"flex flex-col justify-center gap-1",children:e.jsx(Zr,{FormValue:r,handleChange:n})})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:o||Object.keys(r).length<=2||!x,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:o?"Submitting...":"Add inventory"})]})}),m&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-semibold text-red-600",children:m})})]})})},en=({onClose:t})=>{const{selectedInventory:s}=ks(),{transfers:a,isFetching:l}=At(),r=a.find(c=>c.id===s.transfer_id);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx("p",{className:"text-sm",children:s.code})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Type"}),e.jsx("p",{className:"text-sm capitalize",children:s.type})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"ID"}),e.jsx("p",{className:"text-sm",children:s.id})]}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs("p",{className:"text-sm",children:[s.warehouse.name," (",s.warehouse.code,")"]})]}),s.type==="transfer"&&e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer Code"}),e.jsx("p",{className:"text-sm capitalize",children:l?"Loading...":r==null?void 0:r.code})]}),e.jsxs("div",{className:`flex flex-col justify-center gap-1 ${s.type==="supplier"?"col-span-7":"col-span-3"}`,children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsx("p",{className:"text-sm capitalize",children:s.date_received?s.date_received:"—"})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx("p",{className:"text-sm capitalize",children:s.notes?s.notes:"—"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsxs("p",{className:"text-sm capitalize",children:[s.created_by.firstname," ",s.created_by.lastname]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm capitalize",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm capitalize",children:s.updated_at?ie(s.updated_at):"—"})]})]})]})})},sn=({onClose:t,warehouses:s})=>{const{selectedInventory:a}=ks(),{value:l,handleChange:r,handleSubmit:c}=$t(),{transfers:n,isFetching:i}=At(),[o,d]=h.useState(!1),[m,u]=h.useState(!1),[x,y]=h.useState(null),f=p=>n.find(g=>p===g.id),[N,j]=h.useState();return h.useEffect(()=>{if(N){const p=la(N,a.id,new Date(a.created_at));r("code",p)}},[N]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async p=>{u(!m),p.preventDefault(),c({action:"update",id:a.id,data:l}).then(()=>{u(!1),K.success("Inventory updated successfully."),t()}).catch(g=>{u(!1),g.response.data.message?K.error(g.response.data.message):K.error("Failed to update inventory.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"code",className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx(I,{id:"code",name:"code",type:"text",value:l.code||a.code||"",readOnly:!0,placeholder:"Code..."})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"warehouse",className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs(J,{onValueChange:p=>{var g;r("warehouse_id",Number(p)),j((g=s.find(v=>v.id===Number(p)))==null?void 0:g.code)},defaultValue:a.warehouse.id.toString(),required:!0,children:[e.jsx(ee,{name:"warehouse",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:"Choose warehouse..."})}),e.jsx(te,{className:"bg-white font-medium",children:s.map((p,g)=>e.jsxs($,{value:p.id.toString(),className:"text-sm font-medium text-slate-700",children:[p.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+p.code+" • "+p.location})]},g))})]})]})]}),e.jsx("hr",{className:"col-span-12 my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"type",className:"text-sm font-bold text-gray-600",children:"Type"}),e.jsxs(J,{defaultValue:a.type,onValueChange:p=>r("type",p),children:[e.jsx(ee,{name:"type",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm capitalize",children:e.jsx(se,{placeholder:"Choose type..."})}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx($,{value:"supplier",className:"text-sm font-medium text-slate-700",children:"Supplier"}),e.jsx($,{value:"transfer",className:"text-sm font-medium text-slate-700",children:"Transfer"})]})]})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"date_received",className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsxs(Se,{children:[e.jsx(je,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(P,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ys,{size:18,strokeWidth:1.5}),l.date_received?l.date_received:a.date_received]})}),e.jsx(Ce,{className:"w-auto p-0",children:e.jsx(ls,{mode:"single",initialFocus:!0,required:!0,month:l.date_received?new Date(l.date_received):new Date(a.date_received),onDayClick:p=>{const g=new Date(p),v=`${g.getFullYear()}-${(g.getMonth()+1).toString().padStart(2,"0")}-${g.getDate().toString().padStart(2,"0")}`;r("date_received",v)},selected:l.date_received?new Date(l.date_received):new Date(a.date_received)})})]})]}),(a.type==="transfer"||l.type==="transfer")&&e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"transfer_id",className:"text-sm font-bold text-gray-600",children:"Transfer Item"}),e.jsxs(Se,{open:o,onOpenChange:d,children:[e.jsx(je,{className:"relative my-2 w-full",asChild:!0,children:e.jsxs(P,{role:"combobox",className:"my-0 w-full justify-between text-sm text-slate-700",variant:"outline",children:[n?l.transfer_id?(()=>{const p=f(l.transfer_id);return e.jsx("div",{className:"flex items-baseline gap-4",children:p==null?void 0:p.code})})():a.transfer_id?(()=>{const p=f(a.transfer_id);return e.jsx("div",{className:"flex items-baseline gap-4",children:p?p.code:"Loading..."})})():"Select inventory item...":"Loading...",e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Ce,{className:"w-[462px] p-0 text-sm font-medium text-slate-700",children:e.jsxs($e,{children:[e.jsx(Ve,{id:"transfer_id",name:"transfer_id",placeholder:"Transfer code..."}),i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:n.map(p=>e.jsxs(Te,{value:p.id.toString()+p.code,onSelect:()=>{r("transfer_id",p.id),d(!1)},className:"cursor-pointer justify-between rounded-sm",children:[e.jsx("span",{children:p.code}),e.jsxs("span",{className:"text-xs font-semibold text-slate-700/50",children:[p.approval_status," • ",p.source.code,"->",p.destination.code," • ",p.transfer_status]})]},p.id))})})]})})]})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(I,{id:"notes",name:"notes",type:"text",defaultValue:l.notes?l.notes:a.notes?a.notes:void 0,maxLength:1e3,placeholder:"Notes...",onChange:p=>r("notes",p.target.value)})]})]}),e.jsx("div",{className:"flex w-full flex-row pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4 whitespace-nowrap",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:m||Object.keys(l).length===0,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying changes...":"Apply changes"})]})}),x&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:x})})]})})})},Nc=()=>{const{warehouses:t}=ss(),[s,a]=h.useState(0),[l,r]=h.useState(0),{openModal:c,isOpen:n,closeModal:i}=oe(),[o,d]=h.useState(""),m=(u,x)=>{d(x),c()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Inventory",children:e.jsxs(Dt,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:u=>a(Number(u)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx($,{value:"0",children:"All"},"all"),t.map(u=>e.jsxs($,{value:u.id.toString(),children:[u.name," (",u.code,")"]},u.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Xr,{filterWarehouse:s>0?s:void 0,openModal:m,setTotalInventories:r})})]}),e.jsx(me,{isOpen:n,onClose:i,title:o==="add"?"Add Inventory":o==="view_details"?"Details":o==="edit"?"Edit Inventory":"",closeOnOverlayClick:o==="view_details",children:e.jsxs(e.Fragment,{children:[o==="add"&&e.jsx(Jr,{warehouses:t,totalInventories:l,onClose:i}),o==="view_details"&&e.jsx(en,{onClose:i}),o==="edit"&&e.jsx(sn,{warehouses:t,onClose:i})]})})]})})})},tn=({handleViewDetails:t,handleEditInventoryProduct:s,handleApproveInventoryProduct:a,handleDeleteInventoryProduct:l})=>[{id:"product_name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Name"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Cap. Price"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:c.original.capital_price?n:"—"})})}},{accessorKey:"stocks_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Stocks"})},{accessorKey:"approved_stocks",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Approved"})},{accessorKey:"sold_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Sold"})},{accessorKey:"remaining_stocks_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Remaining"}),cell:({row:c})=>{const n=c.original.remaining_stocks_count??0,i=c.original.stocks_count*.2,o=c.original.stocks_count*.5;return e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx("span",{className:`${i>=n?"font-bold text-red-700":o>=n?"font-semibold text-amber-700":""}`,children:n})}),e.jsx(Re,{children:i>=n?"Remaining stocks are low!":o>=n?"Remaining stocks are below 50%":"Remaining stocks are above 50%"})]})}},{accessorKey:"status",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Status"}),cell:({row:c})=>e.jsx(Me,{children:e.jsxs("div",{className:"group relative flex w-fit items-center",children:[e.jsx(Oe,{children:c.original.approved_stocks>0?e.jsx(is,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-gray-600"})}),e.jsx(Re,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:c.original.approved_stocks>0?"Approved":"Pending"})})]})})},{id:"actions",cell:({row:c})=>{const n=c.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>{t(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(V,{onClick:()=>{s(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsxs(V,{onClick:()=>a(n),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(is,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve stocks"})]}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>l(n),className:"flex flex-row items-center gap-3 rounded-md p-2 focus:bg-red-100 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(rs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Delete"})]})]})]})})},enableGlobalFilter:!1}],an=({openModal:t,inventory:s})=>{const{data:a,isLoading:l,setSelectedInventoryProduct:r}=hs(),c=()=>{t({},"add")},n=m=>{r(m),t(m,"view_details")},i=m=>{r(m),t(m,"edit")},o=m=>{r(m),t(m,"approve")},d=m=>{r(m),t(m,"delete")};return e.jsxs(Ye,{children:[e.jsxs(b,{fill:l?"default":"primary",onClick:()=>{window.api.invSend({inventory:s,products:a})},className:"ml-4 mt-2 flex h-8 flex-row disabled:cursor-not-allowed disabled:opacity-40",children:[e.jsx(Gt,{size:26,strokeWidth:2})," Print Inventory Details"]}),e.jsx(X,{columns:tn({handleViewDetails:n,handleEditInventoryProduct:i,handleApproveInventoryProduct:o,handleDeleteInventoryProduct:d}),data:a||[],filterWhat:"product_name",dataType:"Items",openModal:c,isLoading:l})]})},ln=({setInventoryProductsQueue:t,inventoryId:s,products:a,productsLoading:l,suppliers:r,suppliersLoading:c,currentId:n,handleNavigation:i,selectedProduct:o})=>{var k,T,C,M,U,W,L;const{auth:d}=le(),m=!!((k=d.rolePermissions)!=null&&k.find(S=>S.permission_id===7)),{value:u,handleChange:x}=as(),[y,f]=h.useState(!1),[N,j]=h.useState(!1),[p,g]=h.useState(null),v=Ke();h.useEffect(()=>{console.log(d.rolePermissions),x("inventory_id",s),x("unit","pcs"),o&&(x("product_id",o.data.product_id),x("supplier_id",o.data.supplier_id),x("capital_price",o.data.capital_price),x("unit",o.data.unit),x("stocks_count",o.data.stocks_count),x("damage_count",o.data.damage_count),x("total_count",o.data.total_count)),!o&&!m&&x("capital_price",0)},[]);const[F,_]=h.useState();return h.useEffect(()=>{const S=Qs(u.stocks_count||0,u.damage_count||0);_(S),x("total_count",S)},[u.damage_count,u.stocks_count,F]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:S=>{S.preventDefault(),u.product_id===void 0?g("Please select a product first."):u.supplier_id===void 0?g("Please select a supplier first."):(t(o?re=>[...re.filter(O=>O.id!==o.id),{id:o.id,data:u}]:re=>[...re,{id:n+1,data:u}]),i())},children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-8 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(Se,{open:y,onOpenChange:f,children:[e.jsx(je,{id:"product_id",className:"relative w-full",asChild:!0,autoFocus:!0,children:e.jsxs(P,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[u.product_id?e.jsx(e.Fragment,{children:(()=>{const S=a.find(re=>re.id===u.product_id);return e.jsxs("div",{className:"flex w-full flex-row items-baseline gap-4",children:[e.jsx("span",{children:S==null?void 0:S.name}),e.jsxs("div",{className:"flex gap-4 truncate text-xs font-semibold",children:[(S==null?void 0:S.brand)&&e.jsx("span",{children:`Brand: ${S==null?void 0:S.brand}`}),(S==null?void 0:S.size)&&e.jsx("span",{children:`Size: ${S==null?void 0:S.size}`}),(S==null?void 0:S.color)&&e.jsx("span",{children:`Color: ${S==null?void 0:S.color}`})]})]})})()}):e.jsx("span",{children:"Select a product..."}),e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Ce,{className:"min-w-[756px] p-0 text-sm font-medium text-slate-700",children:e.jsxs($e,{children:[e.jsx(Ve,{placeholder:"Product name or serial number..."}),l&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsxs(We,{className:"max-h-[200px] overflow-y-scroll",children:[e.jsx(Ee,{forceMount:!0,children:e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{v("/products"),j(!1)},forceMount:!0,children:[e.jsx("span",{children:"Add new product..."}),e.jsx(st,{size:16,strokeWidth:2.25,className:"text-slate-700/50"})]},"create-new-product")}),e.jsx(tt,{}),e.jsx(Ee,{children:a.map((S,re)=>e.jsx(Te,{className:"cursor-pointer justify-between rounded-sm border-b",value:S.id+"_"+S.name+"_"+S.serial_no,onSelect:()=>{x("product_id",S.id),f(!1)},children:`${S.name} • ${S.brand} • ${S.size} • ${S.color}`},re))})]})]})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(Se,{open:N,onOpenChange:j,children:[e.jsx(je,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(P,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[u.supplier_id?e.jsx(e.Fragment,{children:(()=>{const S=r.find(re=>re.id===u.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:S==null?void 0:S.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:S==null?void 0:S.address})]})})()}):e.jsx("span",{children:"Select a supplier..."}),e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Ce,{className:"min-w-[315px] p-0 text-sm font-medium text-slate-700",children:e.jsxs($e,{children:[e.jsx(Ve,{placeholder:"Supplier name or address..."}),c&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsxs(We,{className:"max-h-[200px] overflow-y-scroll",children:[e.jsx(Ee,{forceMount:!0,children:e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{v("/supplier"),j(!1)},children:[e.jsx("span",{children:"Add new supplier..."}),e.jsx(st,{size:16,strokeWidth:2.25,className:"text-slate-700/50"})]},"create-new-supplier")}),e.jsx(tt,{}),e.jsx(Ee,{children:r.map((S,re)=>e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{x("supplier_id",S.id),j(!1)},children:[e.jsx("span",{children:S.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:S.address})]},re))})]})]})})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"relative col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",disabled:!m,value:u.capital_price||"",onBlur:S=>{u.capital_price!==void 0&&(S.target.value=Number(S.target.value).toFixed(2))},onChange:S=>{x("capital_price",Number(Number(S.target.value).toFixed(2)))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(I,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,value:u.unit||"",onChange:S=>x("unit",S.target.value)})]}),e.jsxs("div",{className:`${(T=d.role)!=null&&T.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(I,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:(C=u.stocks_count)==null?void 0:C.toFixed(0),required:!0,onChange:S=>{x("stocks_count",Number(Number(S.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:`${(M=d.role)!=null&&M.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(I,{id:"damage_count",name:"damage_count",type:"number",min:0,max:u.stocks_count??0,step:1,required:!0,value:(U=u.damage_count)==null?void 0:U.toFixed(0),onChange:S=>x("damage_count",Number(Number(S.target.value).toFixed(0)))})]}),e.jsxs("div",{className:`${(W=d.role)!=null&&W.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(I,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,readOnly:!0,value:F??"0",className:`${F&&F<0&&"text-red-600"}`})]}),((L=d.role)==null?void 0:L.includes("admin"))&&e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(I,{id:"total_count",name:"total_count",type:"number",min:0,max:u.stocks_count??0,step:1,value:u.approved_stocks!==void 0?String(u.approved_stocks):"",onChange:S=>x("approved_stocks",S.target.value),onBlur:S=>{x("approved_stocks",Number(S.target.value))}})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsx("div",{className:"ml-auto flex flex-row gap-4",children:e.jsx(b,{type:"submit",fill:"green",disabled:u.product_id===void 0||u.supplier_id===void 0,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:o?"Save changes":"Add item to queue"})})}),p&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:p})})]})})})},rn=["","Name","Brand","Size","Color","Supplier","Capital price","Unit","Stocks","Damaged","Total","Approved"],nn=({data:t,products:s,suppliers:a,handleEditItem:l,handleRemoveItem:r,handleSubmit:c,onClose:n})=>{const[i,o]=h.useState(!1),[d,m]=h.useState(null),u=()=>{o(!0),c({action:"add",data:t.map(x=>x==null?void 0:x.data)}).then(()=>{K.success("Items added to inventory."),o(!1),n()}).catch(x=>{m("Error adding items to inventory"),x.response.data.message?K.error(x.response.data.message):K.error("Error adding items to inventory.")})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative flex h-full flex-col",children:e.jsxs(Ye,{children:[e.jsxs(We,{type:"always",className:"flex-1 rounded-md border border-gray-200 bg-white",style:{"--border":"216 12% 84%"},children:[t.length<=0&&e.jsx("div",{className:"absolute z-10 flex h-full w-full items-center justify-center",children:e.jsx("p",{className:"text-lg font-medium text-gray-500/50",children:"No items in queue"})}),e.jsx(at,{orientation:"horizontal",className:"z-50 h-3"}),e.jsx(at,{orientation:"vertical",className:"z-50 h-3",style:{"--border":"216 12% 84%"},asChild:!0}),e.jsxs(Ct,{children:[e.jsx(kt,{children:e.jsx(cs,{id:"tHeaderRow",className:"hover:bg-white",children:rn.map(x=>e.jsx(Ft,{className:"whitespace-nowrap px-5 py-3 text-xs font-bold uppercase",children:x},x+"_head"))},"tHeaderRow")}),e.jsx(It,{className:"[&>*:nth-child(even)]:bg-white [&>*:nth-child(odd)]:bg-gray-50",children:t.length>0&&t.map(x=>{var y,f,N,j,p;return e.jsxs(cs,{className:"text-sm font-medium text-gray-700",children:[e.jsx(xe,{className:"p-3 pr-0",children:e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-200/70 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white font-medium",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>{x!=null&&x.id&&l(x)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2})}),e.jsx("span",{children:"Edit"})]},(x==null?void 0:x.id)+"edit"),e.jsxs(V,{onClick:()=>{x!=null&&x.id&&r(x.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 focus:bg-red-50 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(gl,{size:16,strokeWidth:2})}),e.jsx("span",{children:"Remove"})]},(x==null?void 0:x.id)+"remove")]})]})})},(x==null?void 0:x.id)+"action"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.product_id?(y=s.find(g=>g.id===x.data.product_id))==null?void 0:y.name:x==null?void 0:x.data.product_id},(x==null?void 0:x.id)+"product_id"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.product_id?(f=s.find(g=>g.id===x.data.product_id))==null?void 0:f.brand:"No brand"},(x==null?void 0:x.id)+"product_brand"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.product_id?(N=s.find(g=>g.id===x.data.product_id))==null?void 0:N.size:"No data"},(x==null?void 0:x.id)+"product_size"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.product_id?(j=s.find(g=>g.id===x.data.product_id))==null?void 0:j.color:"No data"},(x==null?void 0:x.id)+"product_color"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.supplier_id?(p=a.find(g=>g.id===x.data.supplier_id))==null?void 0:p.name:x==null?void 0:x.data.supplier_id},(x==null?void 0:x.id)+"supplier_id"),e.jsx(xe,{className:"px-5 py-3",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((x==null?void 0:x.data.capital_price)||0)},(x==null?void 0:x.id)+"capital_price"),e.jsx(xe,{className:"px-5 py-3",children:x==null?void 0:x.data.unit},(x==null?void 0:x.id)+"unit"),e.jsx(xe,{className:"px-5 py-3",children:x==null?void 0:x.data.stocks_count},(x==null?void 0:x.id)+"stocks_count"),e.jsx(xe,{className:"px-5 py-3",children:x==null?void 0:x.data.damage_count},(x==null?void 0:x.id)+"damage_count"),e.jsx(xe,{className:"px-5 py-3",children:x==null?void 0:x.data.total_count},(x==null?void 0:x.id)+"total_count"),e.jsx(xe,{className:"px-5 py-3",children:x==null?void 0:x.data.approved_stocks},(x==null?void 0:x.id)+"approved_stocks")]},(x==null?void 0:x.id)+"row")})})]})]}),e.jsxs("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:[d&&e.jsx("div",{className:"flex w-full flex-row items-center justify-start gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:d})}),e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>n(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:t.length<=0||i,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",onClick:x=>{x.preventDefault(),u()},children:t.length<=1?"Add item to inventory":`Add ${t.length} items to inventory`})]})]})]})})})},cn={hidden:{opacity:0,x:"-100%"},animate:{opacity:1,x:"0%",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,x:"-100%",transition:{duration:.3,ease:"easeInOut"}}},on={hidden:{opacity:0,x:"100%"},animate:{opacity:1,x:"0%",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,x:"100%",transition:{duration:.3,ease:"easeInOut"}}},dn=({onClose:t,inventoryId:s})=>{le();const{data:a,isLoading:l}=dt(),{suppliers:r,isFetching:c}=qs(),{handleSubmit:n}=as(),[i,o]=h.useState([]),[d,m]=h.useState({}),[u,x]=h.useState("main"),y=()=>{m({}),x(u==="main"?"form":"main")},f=j=>{m(j),x("form")},N=j=>{o(p=>p.filter(g=>g.id!==j))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:u==="main"?"ml-auto":"",children:e.jsx(P,{className:"flex flex-row items-center gap-2 bg-gray-200 text-sm font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",onClick:()=>{y()},children:e.jsxs(e.Fragment,{children:[u==="main"?e.jsx(Ys,{size:20,strokeWidth:2.5}):e.jsx(ws,{size:20,strokeWidth:2.5}),u==="main"?"Add an item":"Back"]})})}),e.jsx("div",{className:`relative min-w-[850px] overflow-x-clip transition-all duration-300 
					${u==="form"?"min-h-[330px]":"min-h-[540px]"}`,children:e.jsx(el,{initial:!1,children:u==="main"?e.jsx(lt.div,{variants:cn,initial:"hidden",animate:"animate",exit:"exit",className:"absolute h-full w-full overflow-x-auto antialiased",children:e.jsx(nn,{data:i,products:a,suppliers:r,handleEditItem:f,handleRemoveItem:N,handleSubmit:n,onClose:t})},"main"):e.jsx(lt.div,{variants:on,initial:"hidden",animate:"animate",exit:"exit",className:"absolute max-h-[406px] w-full p-1",children:e.jsx(ln,{setInventoryProductsQueue:o,inventoryId:s,products:a,productsLoading:l,suppliers:r,suppliersLoading:c,currentId:i.reduce((j,p)=>p.id>j?p.id:j,0),handleNavigation:y,selectedProduct:Object.keys(d).length?d:void 0})},"form")})})]})})},xn=({onClose:t})=>{var p,g;const{auth:s}=le(),a=!!((p=s.rolePermissions)!=null&&p.find(v=>v.permission_id===7)),{selectedInventoryProduct:l}=hs(),{value:r,handleChange:c,handleSubmit:n}=as(),{suppliers:i,isFetching:o}=qs(),[d,m]=h.useState(!1),[u,x]=h.useState(!1),[y,f]=h.useState(null),[N,j]=h.useState();return h.useEffect(()=>{const v=Qs(r.stocks_count??l.stocks_count,r.damage_count??l.damage_count);j(v),c("total_count",v)},[r.damage_count,r.stocks_count,N]),e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:async v=>{x(!u),v.preventDefault(),n({action:"update",id:l.id,data:r}).then(()=>{x(!1),K.success("Inventory product updated successfully."),t()}).catch(()=>{x(!1),K.error("Failed to update inventory product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:l.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:l.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:l.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:l.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:l.product.color})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(Se,{open:d,onOpenChange:m,children:[e.jsx(je,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(P,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[r.supplier_id?e.jsx(e.Fragment,{children:(()=>{const v=i.find(F=>F.id===r.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:v==null?void 0:v.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:v==null?void 0:v.address})]})})()}):e.jsx("span",{children:l.supplier_id.name}),e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Ce,{className:"p-0 text-sm font-medium text-slate-700",children:e.jsxs($e,{children:[e.jsx(Ve,{placeholder:"Supplier name or address..."}),i===void 0&&o&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:i.map((v,F)=>e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{c("supplier_id",v.id),m(!1)},children:[e.jsx("span",{children:v.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:v.address})]},F))})})]})})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",readOnly:!a,defaultValue:l==null?void 0:l.capital_price.toFixed(2),onBlur:v=>{v.target.value=Number(v.target.value).toFixed(2)},onChange:v=>{const F=Number(v.target.value).toFixed(2);c("capital_price",Number(F))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(I,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,defaultValue:l==null?void 0:l.unit,onChange:v=>c("unit",v.target.value)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(I,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:((g=r.stocks_count)==null?void 0:g.toFixed(0))??(l==null?void 0:l.stocks_count)??0,onChange:v=>{c("stocks_count",Number(Number(v.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(I,{id:"damage_count",name:"damage_count",type:"number",min:0,max:r.stocks_count??l.stocks_count,step:1,required:!0,value:r.damage_count!==void 0?String(r.damage_count):String(l==null?void 0:l.damage_count)||"",onBlur:v=>{v.target.value=Number(v.target.value).toFixed(0)},onChange:v=>c("damage_count",Number(Number(v.target.value).toFixed(0)))})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(I,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,value:N||0,className:`${N&&N<0&&"text-red-600"}`,readOnly:!0})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:u,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:u?"Applying...":"Apply changes"})]})}),y&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:y})})]})})})},mn=()=>{const{selectedInventoryProduct:t}=hs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:t.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:t.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:t.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:t.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:t.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:t.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:t.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:t.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:t.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Status"}),e.jsx("p",{className:"text-sm",children:t.status?"Approved":"Pending"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx("p",{className:"text-sm",children:t.approved_stocks})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unapproved stocks"}),e.jsx("p",{className:"text-sm",children:t.remaining_unapproved_stocks})]})]})]})})},un=({onClose:t})=>{const{selectedInventoryProduct:s}=hs(),{value:a,handleChange:l,handleSubmit:r}=as(),[c,n]=h.useState(!1),i=o=>{o.preventDefault(),n(!0),r({action:"update",id:s.id,data:a}).then(()=>{K.success("Inventory product successfully approved."),n(!1),t()}).catch(d=>{var m,u;K.error((u=(m=d==null?void 0:d.response)==null?void 0:m.data)==null?void 0:u.message),n(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[24rem] max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.capital_price)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:s.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:s.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:s.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:s.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:s.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:s.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:s.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("form",{className:"grid w-full grid-flow-row grid-cols-11 gap-3",onSubmit:i,children:[e.jsxs("div",{className:"relative col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approved_stocks",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(I,{id:"approved_stocks",name:"approved_stocks",type:"number",min:0,step:1,max:s.remaining_unapproved_stocks,required:!0,autoFocus:!0,value:a.approved_stocks!==void 0?String(a.approved_stocks):"",onChange:o=>{l("approved_stocks",o.target.value)},onBlur:o=>{l("approved_stocks",Number(o.target.value))}}),e.jsxs("span",{className:"absolute bottom-0 right-0 -translate-x-4 -translate-y-2 pb-[2px] text-sm font-medium text-slate-700",children:["/ ",s.remaining_unapproved_stocks]})]}),e.jsx("div",{className:"col-span-1 flex items-center pt-6",children:e.jsx(Yt,{size:24,strokeWidth:2,className:"mx-auto text-slate-600"})}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"prev_approved_stocks",className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx(I,{id:"prev_approved_stocks",name:"prev_approved_stocks",type:"number",readOnly:!0,value:s.approved_stocks||0})]}),e.jsx("div",{className:"col-span-11 flex w-full justify-between whitespace-nowrap pt-3",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:c,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Approving...":"Approve"})]})})]})]})})},hn=({onClose:t})=>{const{selectedInventoryProduct:s}=hs(),{deleteInventoryProductMutation:a}=as(),[l,r]=h.useState(!1),c=()=>{r(!0),a(s.id).then(n=>{K.success(n.message),t()}).catch(n=>{K.error(n.message?n.message:"Failed to delete inventory product.")}).finally(()=>{r(!1)})};return e.jsxs("div",{className:"flex max-w-md flex-col gap-4",children:[e.jsxs("h2",{className:"text-sm font-medium text-slate-800",children:["Are you sure you would like to delete this item? This action"," ",e.jsx("strong",{children:"cannot"}),"  be undone."]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s.supplier_id.name})]})]}),e.jsxs("div",{className:"mt-4 flex flex-row justify-end gap-4",children:[e.jsx(b,{fill:"red",type:"submit",onClick:c,disabled:l,className:"py-2 text-sm font-bold disabled:cursor-not-allowed disabled:opacity-50",children:l?"Deleting...":"Yes, delete"}),e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),disabled:l,className:"py-2 text-sm font-bold text-slate-700 hover:text-white disabled:cursor-not-allowed disabled:opacity-50",children:"No, cancel"})]})]})},yc=()=>{const{id:t}=Ks(),{data:s,isLoading:a}=sl(Number(t)),l=Ke(),r=()=>{l(-1)},{openModal:c,isOpen:n,closeModal:i}=oe(),[o,d]=h.useState(""),m=(u,x)=>{d(x),c()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Inventory items",children:e.jsxs(tl,{inventoryId:Number(t),children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:[e.jsxs(P,{onClick:()=>r(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(ws,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Inventory code:"}),e.jsx("span",{children:a?"Loading...":s==null?void 0:s.code})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(an,{openModal:m,inventory:s})})]}),e.jsx(me,{isOpen:n,onClose:i,closeOnOverlayClick:o==="view_details",title:o==="add"?"Add Items":o==="edit"?"Edit Item":o==="view_details"?"Item Details":o==="approve"?"Approve Item":o==="delete"?"Delete Item":"",children:e.jsxs(e.Fragment,{children:[o==="add"&&e.jsx(dn,{inventoryId:Number(t),onClose:i}),o==="view_details"&&e.jsx(mn,{}),o==="edit"&&e.jsx(xn,{onClose:i}),o==="approve"&&e.jsx(un,{onClose:i}),o==="delete"&&e.jsx(hn,{onClose:i})]})})]})})})},fn=()=>{const t=pe(),{selectedExpenses:s}=Hs(),[a,l]=h.useState({id:s.id,title:s.title,date_of_operation:s.date_of_operation,amount:s.amount,notes:s.notes,created_by:s.created_by.id,created_at:s.created_at,updated_at:s.updated_at}),[r,c]=h.useState(!1),[n,i]=h.useState(!1),[o,d]=h.useState(null),[m,u]=h.useState(null),x=()=>Object.keys(a).map(g=>({text:g})).length>=8?a.amount?a.title?[!0,""]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"],y=p=>{c(!0),u(null),d(null),l(g=>({...g,[p.target.name]:p.target.value}))},f=async()=>{const p=x();i(!0),p[0]?await j(a):(d(p[1]),i(!1))},N={onSuccess:async()=>{await t.invalidateQueries({queryKey:["expenses"]}),i(!1),c(!1),u("Expenses info has been edited")},onError:p=>{console.error(p),d(p.message),i(!1)}},{mutateAsync:j}=Y({mutationKey:["editExpenses"],mutationFn:al,...N});return{expensesEdit:a,isChanged:r,isSubmitting:n,error:o,success:m,handleSubmit:f,handleChange:y,editExpensesMutation:j}},pn=()=>{const t=pe(),{expenses:s,dateToday:a}=Hs(),l=s.length+1,{auth:r}=le(),[c,n]=h.useState({id:l,title:"",date_of_operation:a,amount:0,notes:"",created_by:r.user.id,created_at:"",updated_at:""}),[i,o]=h.useState(!1),[d,m]=h.useState(!1),[u,x]=h.useState(null),[y,f]=h.useState(null),N=()=>Object.keys(c).map(_=>({text:_})).length>=5?c.amount?c.title?[!0,""]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"],j=F=>{o(!0),f(null),x(null),n(_=>({..._,[F.target.name]:F.target.value}))},p=async()=>{const F=N();m(!0),F[0]?await v(c):(x(F[1]),m(!1))},g={onSuccess:async()=>{await t.invalidateQueries({queryKey:["expenses"]}),m(!1),o(!1),f("Expenses info has been added")},onError:F=>{console.error(F),x(F.message),m(!1)}},{mutateAsync:v}=Y({mutationKey:["addExpenses"],mutationFn:ll,...g});return{dateToday:a,expensesAdd:c,isChanged:i,isSubmitting:d,error:u,success:y,handleSubmit:p,handleChange:j,addExpensesMutation:v}},jn=({openModal:t})=>{const{expenses:s,isFetching:a,selectedExpenses:l,setSelectedExpenses:r,dateToday:c}=Hs(),n=()=>{t({},"add")},i=m=>{r(m[0]),t(m,"edit")},o=[{accessorKey:"date_of_operation",sortingFn:"datetime",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{m.toggleSorting(m.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["DATE OF OPERATION ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>{const u=m.getValue("date_of_operation");if(u.toString()!=="0000-00-00"){const x={year:"numeric",month:"long",day:"numeric"},y=new Date(u).toLocaleDateString([],x);return e.jsx("div",{className:"text-center",children:y})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"title",header:({column:m})=>e.jsx("div",{className:"text-center",children:" TITLE "}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.title})},{accessorKey:"amount",header:({column:m})=>e.jsx("div",{className:"text-center",children:" AMOUNT "}),cell:({row:m})=>{const u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m.original.amount);return e.jsx("div",{className:"text-center",children:u})}},{accessorKey:"notes",header:({column:m})=>e.jsx("div",{className:"text-center",children:" NOTES "}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.notes})},{accessorKey:"created_by",header:({column:m})=>e.jsx("div",{className:"text-center",children:" CREATED BY "}),cell:({row:m})=>e.jsxs("div",{className:"text-center",children:[m.original.created_by.firstname," ",m.original.created_by.lastname]})},{id:"actions",header:()=>e.jsx("div",{className:"flex flex-row justify-center",children:"ACTIONS"}),cell:({row:m})=>{const u=m.original;if(u.date_of_operation===c)return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(b,{fill:"empty",textColor:"black",onClick:()=>i([u]),className:"flex flex-row items-center gap-2",children:[e.jsx(Gs,{})," Edit"]})})}}],d=s.some(m=>m.date_of_operation===c);return s.sort((m,u)=>{let x=m.date_of_operation,y=u.date_of_operation;return x<y?1:x>y?-1:0}),e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:o,filterWhat:"notes",dataType:"Today's Expenses",openModal:d?void 0:n,isLoading:a})})},gn=({onClose:t})=>{const{expensesEdit:s,isChanged:a,isSubmitting:l,error:r,success:c,handleSubmit:n,handleChange:i}=fn();return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async o=>{o.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Date of Operation"}),e.jsx(Q,{type:"text",name:"date_of_operation",placeholder:"2024-04-06",className:"inputbox rounded-md",value:s.date_of_operation,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"Title"}),e.jsx(Q,{type:"text",name:"title",placeholder:"Title",className:"inputbox rounded-md bg-slate-100",value:s.title,onChange:i,required:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Amount"}),e.jsx(Q,{type:"number",name:"amount",placeholder:"₱500.00",className:"inputbox rounded-md bg-slate-100",value:s.amount,onChange:i,required:!0})]})]}),e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-12 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Notes"}),e.jsx(Ss,{name:"notes",placeholder:"Notes here....",className:"text-base rounded-md bg-slate-100",value:s.notes,onChange:i})]})}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4 text-center",children:[e.jsx("div",{className:"flex flex-col col-span-3 gap-3",children:e.jsx(b,{type:"submit",fill:a?"green":null,disabled:!a,onClick:n,children:l?"Submitting":"Edit Expenses"})}),e.jsxs("div",{className:"flex flex-col col-span-6 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-3 gap-3 items-end",children:e.jsx(b,{type:"reset",fill:"red",onClick:t,children:"Cancel"})})]})]})})})},Nn=({onClose:t})=>{const{expensesAdd:s,isChanged:a,isSubmitting:l,error:r,success:c,handleSubmit:n,handleChange:i,dateToday:o}=pn();return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async d=>{d.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Date of Operation"}),e.jsx(Q,{type:"text",name:"date_of_operation",placeholder:"2024-04-06",className:"inputbox rounded-md",value:o,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"Title"}),e.jsx(Q,{type:"text",name:"title",placeholder:"Title",className:"inputbox rounded-md bg-slate-100",value:s.title||"",onChange:i,required:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Amount"}),e.jsx(Q,{type:"number",name:"amount",placeholder:"₱500.00",className:"inputbox rounded-md bg-slate-100",value:s.amount||"",onChange:i,required:!0})]})]}),e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-12 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Notes"}),e.jsx(Ss,{name:"notes",placeholder:"Notes here....",className:"text-base rounded-md bg-slate-100",value:s.notes||"",onChange:i})]})}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),a&&e.jsx(b,{type:"submit",fill:a?"green":null,disabled:!a,onClick:n,children:l?"Submitting":"Add Expenses"})]})})]})})]})})})},vc=()=>{const{openModal:t,isOpen:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{r(i),t()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Expenses",children:e.jsxs(rl,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(jn,{openModal:c})})}),e.jsx(me,{isOpen:s,onClose:a,title:l==="add"?"Add Expenses":"Edit Expenses",children:e.jsxs(e.Fragment,{children:[l==="edit"&&e.jsx(gn,{onClose:a}),l==="add"&&e.jsx(Nn,{onClose:a})]})})]})})})},yn=()=>{const{reports:t,isReportsFetching:s}=Je(),a=[(t==null?void 0:t.new_customers)??0,(t==null?void 0:t.returning_customers)??0],l={series:[(t==null?void 0:t.new_customers)??0,(t==null?void 0:t.returning_customers)??0],labels:["New customers","Returning customers"],colors:["#3b82f6","#1e3a8a"],legend:{show:!0,fontFamily:"sans-serif",fontSize:"14px",fontWeight:500,itemMargin:{vertical:4}},dataLabels:{enabled:!0,dropShadow:{top:2,blur:3,opacity:.5},style:{fontFamily:"Inter",fontSize:"12px",fontWeight:600}},tooltip:{style:{fontFamily:"Inter",fontSize:"14px"}},plotOptions:{pie:{donut:{size:"50%"}}},chart:{animations:{speed:600}}};return e.jsx(e.Fragment,{children:s?e.jsxs("div",{className:"flex h-72 w-full animate-pulse justify-center p-4",children:[e.jsx("div",{className:"mx-auto h-full w-72 rounded-2xl bg-slate-200"}),e.jsx("div",{className:"h-20 w-44 rounded-2xl bg-slate-200"})]}):e.jsx(zt,{series:a,options:l,type:"donut",height:"100%",width:"100%"})})},vn=()=>e.jsx(e.Fragment,{children:e.jsxs(Et,{className:"flex min-h-[24rem] flex-col gap-4",children:[e.jsxs(Wt,{className:"flex flex-none flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(Mt,{className:"text-base font-bold",children:"Customers"}),e.jsx(Ot,{className:"text-sm font-medium",children:"Shows new and returning customers for the selected date range"})]}),e.jsx(Rt,{className:"flex-1",children:e.jsx(yn,{})})]})}),bn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(fs,{title:"Profit",tooltip:"Calculated by subtracting the sum of capital and expenses from sales.",bgClassName:`${t!=null&&t.total_profit?t.total_profit>=0?"bg-blue-50":"bg-red-50":"bg-blue-50"}`,textColorClassName:`${t!=null&&t.total_profit?t.total_profit>=0?"text-blue-800":"text-red-800":"text-blue-800"}`,children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-blue-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_profit)??0)})})})},wn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(fs,{title:"Sales",tooltip:"Calculated by adding up the total amount due in paid transactions.",bgClassName:"bg-green-50",textColorClassName:"text-green-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-green-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_sales)??0)})})})},_n=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(fs,{title:"Capital",tooltip:"Calculated capital of sold products.",bgClassName:"bg-orange-50",textColorClassName:"text-orange-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-orange-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_overall_capital)??0)})})})},Sn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(fs,{title:"Expenses",tooltip:"Calculated by adding up the operational expenses.",bgClassName:"bg-violet-50",textColorClassName:"text-violet-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-violet-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_expenses)??0)})})})},Cn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(fs,{title:"Collectibles",tooltip:"Total amount owed from customers for non-payment type transactions.",bgClassName:"bg-stone-50",textColorClassName:"text-stone-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-stone-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_collectibles)??0)})})})};function kn({className:t}){const{dateRange:s,setDateRange:a}=Je();return e.jsx("div",{className:rt("grid gap-2",t),children:e.jsxs(Se,{children:[e.jsx(je,{asChild:!0,children:e.jsxs(P,{id:"date",variant:"outline",className:rt("w-[300px] justify-start text-left font-medium",!s&&"text-muted-foreground"),children:[e.jsx(Bt,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?e.jsxs(e.Fragment,{children:[Es(s.from,"LLL dd, y")," —"," ",Es(s.to,"LLL dd, y")]}):Es(s.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(Ce,{className:"w-auto p-0",align:"start",children:e.jsx(ls,{initialFocus:!0,mode:"range",defaultMonth:s!=null&&s.to?new Date(s.to.getFullYear(),s.to.getMonth()-1,1):new Date,selected:s,onSelect:a,classNames:{day:"text-sm flex items-center justify-center w-full h-full rounded-md font-medium",months:"flex flex-row gap-6"},numberOfMonths:2})})]})})}const Fn=()=>{const{setDateRange:t,isFetching:s}=Je(),a=()=>{t({from:new Date(new Date().setDate(new Date().getDate()-90)),to:new Date})};return e.jsx(P,{variant:"outline",disabled:s,onClick:a,children:"Reset date"})},In=()=>{const{year:t,setYear:s}=$s(),a=h.useMemo(()=>{const l=new Date().getFullYear(),r=2020,c=[];for(let n=r;n<=l;n++)c.push(n);return c.sort((n,i)=>i-n)},[]);return e.jsx(e.Fragment,{children:e.jsxs(J,{value:t.toString(),onValueChange:l=>{s(Number(l))},children:[e.jsx(ee,{className:"w-32 flex-none",children:e.jsx(se,{placeholder:"Choose year...",children:e.jsx("span",{className:"text-slate-600",children:t})})}),e.jsx(te,{children:a.map(l=>e.jsx($,{value:l.toString(),className:"text-sm font-medium",children:l},`${l}-item`))})]})})},Pn=()=>{var l;const{warehouseId:t,setWarehouseId:s}=$s(),{warehouses:a}=ss();return e.jsx(e.Fragment,{children:e.jsxs(J,{value:t==null?void 0:t.toString(),onValueChange:r=>{s(r!=="0"?Number(r):0)},children:[e.jsx(ee,{className:"w-44",children:e.jsx(se,{placeholder:"Select warehouse...",children:e.jsx("span",{className:"text-slate-600",children:((l=a.find(r=>r.id===t))==null?void 0:l.name)??"All"})})}),e.jsxs(te,{children:[e.jsx($,{value:"0",className:"text-sm font-medium",children:"All"},"all-warehouses-item"),a&&a.map(r=>e.jsx($,{value:r.id.toString(),className:"text-sm font-medium",children:r.name},`${r.id}-item`))]})]})})},Tn=()=>{const{reportAnalytics:t,isReportAnalyticsFetching:s}=$s();return e.jsx(e.Fragment,{children:e.jsxs(Et,{className:"flex min-h-[36rem] w-full flex-col gap-4",children:[e.jsxs(Wt,{className:"flex w-full flex-none flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(Mt,{className:"flex w-full flex-row justify-between text-base font-bold",children:"Reports Analytics"}),e.jsxs(Ot,{className:"!mt-1 flex flex-row gap-2 font-bold uppercase",children:[e.jsx(Pn,{}),e.jsx(In,{})]})]}),e.jsx(Rt,{className:"mx-auto w-[99%] flex-1 overflow-hidden",children:s?e.jsx("div",{className:"h-[350px] w-full animate-pulse rounded-2xl bg-slate-200/50"}):e.jsx(zt,{type:"line",height:"100%",width:"100%",series:[{name:"Sales",data:(t==null?void 0:t.map(a=>a.gross_income??0))??[]},{name:"Profit",data:(t==null?void 0:t.map(a=>a.net_profit??0))??[]},{name:"Capital",data:(t==null?void 0:t.map(a=>a.capital??0))??[]},{name:"Expenses",data:(t==null?void 0:t.map(a=>a.expenses??0))??[]},{name:"Collectibles",data:(t==null?void 0:t.map(a=>a.collectibles??0))??[]}],options:{markers:{size:5},stroke:{width:4},colors:["#16a34a","#2563eb","#f59e0b","#7c3aed","#525252"],xaxis:{tooltip:{enabled:!1},categories:(t==null?void 0:t.map(a=>a.Month??""))??[],labels:{style:{fontFamily:"sans-serif",fontSize:"12px",fontWeight:600}}},yaxis:{labels:{style:{fontFamily:"sans-serif",fontSize:"12px",fontWeight:600},formatter:a=>Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a)}},tooltip:{style:{fontFamily:"sans-serif",fontSize:"14px"}},legend:{position:"top",horizontalAlign:"right"},chart:{toolbar:{show:!1}}}})})]})})},bc=()=>e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Reports",children:e.jsx(nl,{children:e.jsx(cl,{children:e.jsx("div",{className:"flex h-full w-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"h-full max-h-full w-full max-w-full overflow-auto",children:e.jsxs("div",{className:"flex w-full max-w-full flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(kn,{}),e.jsx(Fn,{})]}),e.jsx("div",{className:"flex flex-1 flex-col gap-4",children:e.jsxs("div",{className:"flex flex-row gap-2 rounded-lg border p-2 shadow-sm",children:[e.jsx(wn,{}),e.jsx(bn,{}),e.jsx(_n,{}),e.jsx(Sn,{}),e.jsx(Cn,{})]})}),e.jsx(vn,{}),e.jsx(Tn,{})]})})})})})})}),wc=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(Bs,{}),e.jsx("div",{id:"main",className:"flex w-screen flex-row",children:e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[e.jsx("div",{className:"flex w-full flex-row justify-between",children:e.jsx("h1",{className:"text-primary-dark-gray text-2xl font-bold",children:"Return Item"})}),e.jsx(Kr,{})]})})]})}),An=({onClose:t})=>{const{invoices:s,isFetching:a,customers:l,selectedInvoice:r}=Kt(),c=r[0],n=[{id:"select",header:({table:i})=>e.jsx("input",{type:"checkbox",checked:i.getIsAllPageRowsSelected(),onChange:o=>i.toggleAllPageRowsSelected(!!o.target.checked),"aria-label":"Select all"}),cell:({row:i})=>e.jsx("input",{type:"checkbox",checked:i.getIsSelected(),onChange:o=>i.toggleSelected(!!o.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"or_no",sortingFn:"alphanumeric",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["OR NUMBER ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.or_no})},{accessorKey:"created_at",sortingFn:"datetime",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["CREATED AT ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>{const o=i.getValue("created_at");if(o.toString()!=="0000-00-00 00:00:00"){const d={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},m=new Date(o).toLocaleDateString([],d);return e.jsx("div",{className:"text-center",children:m})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"warehouse",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE CODE"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.warehouse.code})},{id:"customer",header:()=>e.jsx("div",{className:"text-center",children:"CUSTOMER NAME"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.customer.firstname+" "+i.original.customer.lastname})},{accessorKey:"type",sortingFn:"text",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TRANSACTION TYPE ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.type})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"STATUS"}),cell:({row:i})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:i.original.status.toLowerCase()==="approved"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):i.original.status.toLowerCase()==="rejected"?e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})},{accessorKey:"subtotal",header:()=>e.jsx("div",{className:"text-center",children:" SUBTOTAL "}),cell:({row:i})=>{const o=i.original.subtotal,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"total_discount",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL DISCOUNT "}),cell:({row:i})=>{const o=i.original.total_discount,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"total_tax",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL TAX "}),cell:({row:i})=>{const o=i.original.total_tax,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"delivery_charge",header:()=>e.jsx("div",{className:"text-center",children:" DELIVERY CHARGE "}),cell:({row:i})=>{const o=i.original.delivery_charge,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"total_amount_due",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL AMOUNT DUE "}),cell:({row:i})=>{const o=i.original.total_amount_due,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"paid_amount",header:()=>e.jsx("div",{className:"text-center",children:" PAID AMOUNT "}),cell:({row:i})=>{const o=i.original.paid_amount,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"change_amount",header:()=>e.jsx("div",{className:"text-center",children:" CHANGE AMOUNT "}),cell:({row:i})=>{const o=i.original.change_amount,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"payment_method",header:()=>e.jsx("div",{className:"text-center",children:" PAYMENT METHOD "}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.payment_method||"N/A"})},{accessorKey:"reference_no",header:({column:i})=>e.jsx("div",{className:"text-center",children:"REF #"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.reference_no||"--"})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl max-h-96 flex-col gap-4",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Issuer: ",c.issued_by.firstname+" "+c.issued_by.lastname]}),e.jsx("div",{className:"overflow-x-hidden",children:e.jsx(X,{data:r,columns:n,filterWhat:"or_no",dataType:"",openModal:void 0,isLoading:a})})]})})},Dn=({openModal:t})=>{const{customersList:s,isFetching:a}=Kt(),l=[{accessorKey:"customer.firstname",id:"customer",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsxs(b,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["NAME"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.firstname+" "+r.original.customer.lastname})},{id:"address",header:()=>e.jsx("div",{children:"ADDRESS"}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.address})},{id:"contact_no",header:()=>e.jsx("div",{children:"CONTACT NO"}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.contact_no})},{accessorKey:"customer.total_balance",id:"total_balance",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(b,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["BALANCE"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.customer.total_balance)})},{accessorKey:"customer.total_credit",id:"total_credit",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(b,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["CREDITS"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.customer.total_credit)})},{accessorKey:"total_transactions",id:"total_transactions",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(b,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["TRANSACTIONS"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:r.original.total_transactions})},{accessorKey:"total_sales",id:"amount_sales",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(b,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["SALES"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.total_sales)})}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s.sort((r,c)=>c.total_sales>r.total_sales?1:-1),columns:l,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:a})})},_c=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Customer Sales",children:e.jsxs(il,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Dn,{openModal:c})})}),e.jsx(me,{isOpen:t,onClose:a,title:l==="details"?"Invoice Details":"",closeOnOverlayClick:l==="details",children:e.jsx(e.Fragment,{children:l==="details"&&e.jsx(An,{onClose:a})})})]})})})},zn=({openModal:t})=>{const{returns:s,selectedReturn:a,setSelectedReturn:l,isFetching:r}=Rs(),c=s.filter(d=>{if(d.refund_status==="pending")return d});le();const n=d=>{l(d),t(d,"details")},i=d=>{l(d),t(d,"edit")},o=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:d})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>d.toggleSorting(d.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["RETURN CODE ",d.getIsSorted()==="asc"?e.jsx(D,{}):d.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.code?d.original.code:"N/A"})},{accessorKey:"invoice",sortingFn:"alphanumeric",enableSorting:!0,header:({column:d})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>d.toggleSorting(d.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["INVOICE CODE ",d.getIsSorted()==="asc"?e.jsx(D,{}):d.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.invoice.code?d.original.invoice.code:"N/A"})},{accessorKey:"customer",sortingFn:"alphanumeric",enableSorting:!0,header:({column:d})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>d.toggleSorting(d.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["CUSTOMER NAME ",d.getIsSorted()==="asc"?e.jsx(D,{}):d.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.invoice.customer.firstname+" "+d.original.invoice.customer.lastname})},{accessorKey:"refundable_amount",sortingFn:"text",enableSorting:!0,header:({column:d})=>e.jsx("div",{className:"flex flex-row justify-center text-center mx-auto",children:" REFUNDABLE AMOUNT "}),cell:({row:d})=>{const m=d.original.refundable_amount,u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m);return e.jsx("div",{className:"text-center",children:u})}},{accessorKey:"refund_status",sortingFn:"text",enableSorting:!0,header:({column:d})=>e.jsx("div",{className:"flex flex-row justify-center text-center mx-auto",children:" REFUND STATUS "}),cell:({row:d})=>e.jsx("div",{className:"flex items-center",children:d.original.refund_status&&e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500 mx-auto"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:d})=>{const m=d.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>n(m),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(V,{onClick:()=>i(m),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve Return/Refund"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:c,columns:o,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:r})})},En=({onClose:t})=>{const{selectedReturn:s}=Rs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-6xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Return Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.code})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.issued_by.firstname+" "+s.issued_by.lastname})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Payment method"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.payment_method.charAt(0).toUpperCase()+s.invoice.payment_method.slice(1)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Reference number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.reference_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Refundable amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.refundable_amount)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-amber-600",children:s.refund_status.charAt(0).toUpperCase()+s.refund_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.updated_at)})]})]})]})})},Wn=({onClose:t})=>{const{selectedReturn:s,success:a,error:l,isSubmitting:r,handleSubmit:c}=Sl();return a&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsx("p",{className:"font-bold text-red-900",children:" Are you sure you want to set this return as done? "}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Return Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.code})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.issued_by.firstname+" "+s.issued_by.lastname})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Payment method"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.payment_method.charAt(0).toUpperCase()+s.invoice.payment_method.slice(1)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Reference number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.reference_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Refundable amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.refundable_amount)})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[a&&e.jsx("div",{className:"font-bold text-green-700",children:a}),l&&e.jsx("div",{className:"font-bold text-red-700",children:l}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-4 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",onClick:c,fill:"green",children:r?"Submitting":"Mark as done"})]})})]})})]})})},Sc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Return",children:e.jsxs(ol,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(zn,{openModal:c})})}),e.jsx(me,{title:l==="details"?"Return Details":"Approve Return",isOpen:t,onClose:a,children:e.jsxs(e.Fragment,{children:[l==="details"&&e.jsx(En,{onClose:a}),l==="edit"&&e.jsx(Wn,{onClose:a})]})})]})})})},Mn=()=>{const{selectedProductPrice:t}=Vs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Unit"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.warehouse.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Capital price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup percent"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[ne(t.markup_price/t.capital_price*100,{precision:3}).value,"%"]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.markup_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Cost"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.cost)})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sale discount"}),e.jsx("p",{className:"text-sm",children:t.on_sale===1?Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.sale_discount):"—"}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex flex-none flex-row items-center justify-end gap-1 pb-[0.1rem] pr-1",children:[t.on_sale===1?e.jsx(He,{size:14,strokeWidth:3.5,className:"text-green-600"}):e.jsx(_s,{size:14,strokeWidth:3.5,className:"text-gray-600"}),e.jsx("div",{className:"text-xs font-semibold leading-4 text-gray-900",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.price)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Active status"}),e.jsxs("span",{className:"flex flex-row items-center gap-2",children:[t.active_status==="active"?e.jsx(is,{size:16,strokeWidth:2.5,className:"text-green-600"}):e.jsx(Qt,{size:16,strokeWidth:2.5,className:"text-gray-600"}),e.jsx("p",{className:"text-sm capitalize text-gray-800",children:t.active_status})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.created_by.firstname+" "+t.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(t.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm capitalize",children:t.approval_status})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.approved_by?t.approved_by.firstname+" "+t.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(t.updated_at)})]})]})]})})},On=({onClose:t})=>{var v,F;const{auth:s}=le(),{selectedProductPrice:a}=Vs(),{value:l,handleChange:r,handleSubmit:c}=Is(),[n,i]=h.useState(!1),[o,d]=h.useState(null),[m,u]=h.useState(a.capital_price),[x,y]=h.useState(vs(a.capital_price,a.markup_price,3)),[f,N]=h.useState(a.markup_price),j=_=>{const k=_.target.value;u(ne(k).value),r("capital_price",ne(k).value),N(Ms(ne(k).value,x||0))},p=_=>{const k=Number(_.target.value);y(k),N(Ms(m,k))},g=_=>{const k=ne(_.target.value).value;N(k),y(vs(m,k,3))};return h.useEffect(()=>{r("capital_price",m),r("markup_price",f),r("cost",bs(m,f))},[m,x,f]),h.useEffect(()=>{r("price",Xt(l.cost??a.cost,l.sale_discount??a.sale_discount))},[l.cost,l.sale_discount]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async _=>{i(!n),_.preventDefault(),c({action:"update",id:a.id,data:l}).then(()=>{i(!n),K.success("Product price edited successfully"),t()}).catch(()=>{i(!n),d("Failed to add product listing"),K.error("Failed to add product listing")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-4 gap-y-5 font-medium text-gray-700",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:a.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:a.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-sm",children:a.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(I,{id:"unit",name:"unit",type:"text",maxLength:20,required:!0,value:l.unit||a.unit,onChange:_=>{r("unit",_.target.value)}})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:a.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:a.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsx("p",{className:"text-sm",children:a.warehouse.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",inputMode:"numeric",min:0,step:.01,required:!0,className:"pl-7",value:m||"",onChange:j,onBlur:_=>{_.target.value=Number(m).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_percent",className:"text-sm font-bold text-gray-600",children:"Markup percent"}),e.jsx(I,{id:"markup_percent",name:"markup_percent",type:"number",inputMode:"numeric",min:0,max:1e3,step:.001,required:!0,value:x||"",onChange:p,onBlur:_=>{_.target.value=ne(x,{precision:3}).value.toString()}}),e.jsx("span",{className:"absolute bottom-0 right-0 mr-2 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"%"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_price",className:"text-sm font-bold text-gray-600",children:"Markup price"}),e.jsx(I,{id:"markup_price",name:"markup_price",type:"number",min:0,max:1e3,step:.01,className:"pl-7",value:f||"",onChange:g,onBlur:_=>{_.target.value=Number(f).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"cost",className:"text-sm font-bold text-gray-600",children:"Cost"}),e.jsx(I,{id:"cost",name:"cost",type:"number",min:0,required:!0,className:"pl-7",readOnly:!0,value:bs(m,f).toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"sale_discount",className:"text-sm font-bold text-gray-600",children:"Sale discount"}),e.jsx(I,{id:"sale_discount",name:"sale_discount",type:"number",inputMode:"numeric",min:0,step:.01,max:l.cost!==void 0?l.cost:a.cost,disabled:l.on_sale===void 0?a.on_sale===0:l.on_sale===0,required:!0,className:"pl-7",value:l.sale_discount??((v=a.sale_discount)==null?void 0:v.toFixed(2))??"",onChange:_=>{r("sale_discount",ne(_.target.value).value)},onBlur:_=>{_.target.value=Number(l.sale_discount!==void 0?l.sale_discount:a.sale_discount).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"}),e.jsxs("div",{className:"absolute right-0 top-1/2 mr-2 flex flex-none translate-y-1/4 flex-row items-center justify-start gap-2",children:[e.jsx(I,{name:"on_sale",id:"on_sale",type:"checkbox",checked:l.on_sale===void 0?a.on_sale===1:l.on_sale===1,className:"h-4 w-fit",onChange:_=>{const k=document.getElementById("sale_discount");r("on_sale",_.target.checked?1:0),!_.target.checked&&(r("sale_discount",0),k&&(k.value="0.00"))}}),e.jsx(w,{htmlFor:"on_sale",className:"text-xs font-bold text-slate-700",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"price",className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx(I,{id:"price",name:"price",type:"number",min:0,step:.01,required:!0,readOnly:!0,className:"pl-7",value:((F=l.price)==null?void 0:F.toFixed(2))||a.price.toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-row items-center justify-start	gap-3",children:[e.jsx(qe,{id:"active_status",name:"active_status",checked:l.active_status?l.active_status==="active":a.active_status==="active",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",onCheckedChange:_=>{r("active_status",_?"active":"inactive")}}),e.jsx(w,{htmlFor:"active_status",className:"text-sm font-bold text-gray-600",children:"Active"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:a.created_by.firstname+" "+a.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm",children:ie(a.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approval_status",className:"text-sm font-bold text-gray-600",children:"Approval status"}),e.jsxs(J,{onValueChange:_=>{r("approval_status",_),_==="approved"?r("approved_by",s.user.id):r("approved_by","")},value:l.approval_status||a.approval_status||"",required:!0,children:[e.jsx(ee,{name:"approval_status",className:"flex flex-row items-center gap-3 bg-white text-sm capitalize",children:e.jsx(se,{placeholder:l.approval_status||a.approval_status||"Select status..."})}),e.jsxs(te,{className:"bg-white",children:[e.jsx($,{className:"rounded-md",value:"pending",children:"Pending"},"pending"),e.jsx($,{className:"rounded-md",value:"approved",children:"Approved"},"approved"),e.jsx($,{className:"rounded-md",value:"rejected",children:"Rejected"},"rejected")]})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Approved by"}),e.jsx("p",{className:"text-sm",children:a.approved_by?a.approved_by.firstname+" "+a.approved_by.lastname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm",children:ie(a.updated_at)})]})]}),e.jsx("div",{className:"col-span-12 flex w-full justify-between whitespace-nowrap pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:n,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Applying changes...":"Apply changes"})]})}),o&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:o})})]})})})},Rn=({handleProdPriceDetails:t,handleEditProdPrice:s,handleApproveProdPrice:a,handleRejectProdPrice:l})=>[{id:"name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"warehouse.code",sortingFn:"basic",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["WHS"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Unit"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Capital"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:c.original.capital_price?n:"—"})})}},{accessorKey:"markup_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Markup"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.markup_price||0),i=ne(c.original.markup_price/c.original.capital_price*100,{precision:3}).value;return e.jsxs("div",{className:"flex items-center uppercase",children:[e.jsx("span",{children:n}),e.jsxs("span",{className:"text-gray-500",children:[" (",i,"%)"]})]})}},{accessorKey:"sale_discount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Discount"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.sale_discount||0);return e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:c.original.on_sale?n:e.jsx("div",{className:"group relative flex w-fit items-center",children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(_s,{size:20,strokeWidth:2,className:"text-gray-700"})}),e.jsx(Re,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:"Not on sale"})})]})})})})}},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Price"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:c.original.price?n:"—"})})}},{accessorKey:"active_status",sortingFn:"basic",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"ml-auto mr-auto flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Active"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:c})=>{const n=c.original.active_status;return e.jsx("div",{className:"group relative mx-auto flex w-fit items-center justify-center",children:e.jsxs(Me,{children:[e.jsx(Oe,{children:n==="active"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(Qt,{size:20,strokeWidth:2,className:"text-gray-600"})}),e.jsx(Re,{children:e.jsx("p",{className:"text-sm font-medium capitalize",children:n})})]})})},enableGlobalFilter:!1},{id:"actions",cell:({row:c})=>{const n=c.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>t(n),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(V,{onClick:()=>s(n),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>{a(n.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(is,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve"})]}),e.jsxs(V,{onClick:()=>{l(n.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(es,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Reject"})]})]})]})})},enableGlobalFilter:!1}],Kn=({openModal:t,isModalOpen:s,filterWarehouse:a})=>{const{data:l,isLoading:r,setSelectedProductPrice:c}=Vs(),n=u=>{c(u),t(u,"details")},i=u=>{c(u),t(u,"edit")},{handleSubmit:o}=Is(),d=u=>{o({action:"update",id:u,data:{approval_status:"approved"}}).then(()=>K.success("Product price approved")).catch(()=>K.error("Failed to approve product price"))},m=u=>{o({action:"update",id:u,data:{approval_status:"rejected"}}).then(()=>K.success("Product price rejected")).catch(()=>K.error("Failed to reject product price"))};return e.jsx(e.Fragment,{children:e.jsx(Ye,{children:e.jsx(X,{columns:Rn({handleProdPriceDetails:n,handleEditProdPrice:i,handleApproveProdPrice:d,handleRejectProdPrice:m}),data:a?l.filter(u=>u.warehouse.id===a):l,filterWhat:"name",dataType:"Listing",isLoading:r})})})},Cc=()=>{const{warehouses:t}=ss(),[s,a]=h.useState(0),{isOpen:l,openModal:r,closeModal:c}=oe(),[n,i]=h.useState(""),o=(d,m)=>{i(m),r()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Listing",children:e.jsxs(dl,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:d=>a(Number(d)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx($,{value:"0",children:"All"},"all"),t.map(d=>e.jsxs($,{value:d.id.toString(),children:[d.name," (",d.code,")"]},d.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Kn,{openModal:o,isModalOpen:l,filterWarehouse:s})})]}),e.jsx(me,{title:n==="details"?"Price Details":n==="edit"?"Edit Price":"",isOpen:l,onClose:c,closeOnOverlayClick:n==="details"||n==="toggle_active_stat",children:e.jsxs(e.Fragment,{children:[n==="details"&&e.jsx(Mn,{}),n==="edit"&&e.jsx(On,{onClose:c})]})})]})})})},Un=({inventories:t,handleViewDetails:s,handleEditInventoryProduct:a,handleApproveInventoryProduct:l})=>[{accessorKey:"inventory_id",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Inventory"}),cell:({row:c})=>{var n;return e.jsx("div",{children:t?(n=t.find(i=>i.id===c.original.inventory_id))==null?void 0:n.code:c.original.inventory_id})}},{id:"product",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Name"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Cap. Price"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:c.original.capital_price?n:"—"})})}},{accessorKey:"total_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Total"})},{accessorKey:"sold_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Sold"})},{accessorKey:"approved_stocks",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Approved"}),cell:({row:c})=>e.jsx("div",{children:e.jsx("span",{children:c.original.approved_stocks??0})})},{id:"actions",cell:({row:c})=>{const n=c.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>{s(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(V,{onClick:()=>{a(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsxs(V,{onClick:()=>{l(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(is,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve stocks"})]})]})]})})},enableGlobalFilter:!1}],Ln=({openModal:t})=>{const{data:s,isLoading:a,setSelectedInventoryProduct:l}=Fs(),{data:r}=ks(),c=o=>{l(o),t(o,"view_details")},n=o=>{l(o),t(o,"edit")},i=o=>{l(o),t(o,"approve")};return e.jsx(e.Fragment,{children:e.jsx(X,{columns:Un({inventories:r,handleViewDetails:c,handleEditInventoryProduct:n,handleApproveInventoryProduct:i}),data:s.sort((o,d)=>d.inventory_id-o.inventory_id),filterWhat:"product",isLoading:a,dataType:"Inventory Product"})})},qn=()=>{const{selectedInventoryProduct:t}=Fs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:(t==null?void 0:t.product.brand)||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.capital_price)??0)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.remaining_stocks_count})]})]})]})})},Hn=({onClose:t})=>{const{selectedInventoryProduct:s}=Fs(),{value:a,handleChange:l,handleSubmit:r}=as(),[c,n]=h.useState(!1),i=o=>{o.preventDefault(),n(!0),r({action:"update",id:s.id,data:a}).then(()=>{K.success("Inventory product successfully approved."),n(!1),t()}).catch(()=>{K.error("Failed to approve inventory product."),n(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[24rem] max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:(s==null?void 0:s.product.brand)||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((s==null?void 0:s.capital_price)||0)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("form",{className:"grid w-full grid-flow-row grid-cols-11 gap-3",onSubmit:i,children:[e.jsxs("div",{className:"relative col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approved_stocks",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(I,{id:"approved_stocks",name:"approved_stocks",type:"number",min:0,step:1,max:(s==null?void 0:s.remaining_unapproved_stocks)??0,required:!0,autoFocus:!0,value:a.approved_stocks!==void 0?String(a.approved_stocks):"",onChange:o=>{l("approved_stocks",o.target.value)},onBlur:o=>{l("approved_stocks",Number(o.target.value))}}),e.jsxs("span",{className:"absolute bottom-0 right-0 -translate-x-4 -translate-y-2 pb-[2px] text-sm font-medium text-slate-700",children:["/ ",s==null?void 0:s.remaining_unapproved_stocks]})]}),e.jsx("div",{className:"col-span-1 flex items-center pt-6",children:e.jsx(Yt,{size:24,strokeWidth:2,className:"mx-auto text-slate-600"})}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"prev_approved_stocks",className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx(I,{id:"prev_approved_stocks",name:"prev_approved_stocks",type:"number",readOnly:!0,value:(s==null?void 0:s.approved_stocks)||0})]}),e.jsx("div",{className:"col-span-11 flex w-full justify-between whitespace-nowrap pt-3",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:c,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Approving...":"Approve"})]})})]})]})})},$n=({onClose:t})=>{var j;const{auth:s}=le(),{selectedInventoryProduct:a}=Fs(),{value:l,handleChange:r,handleSubmit:c}=as(),{suppliers:n,isFetching:i}=qs(),[o,d]=h.useState(!1),[m,u]=h.useState(!1),[x,y]=h.useState(null),[f,N]=h.useState();return h.useEffect(()=>{const p=Qs(l.stocks_count??((a==null?void 0:a.stocks_count)||0),l.damage_count??((a==null?void 0:a.damage_count)||0));N(p),r("total_count",p)},[l.damage_count,l.stocks_count,f]),e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:async p=>{u(!m),p.preventDefault(),c({action:"update",id:a.id,data:l}).then(()=>{u(!1),K.success("Inventory product successfully updated."),t()}).catch(()=>{u(!1),K.error("Failed to update inventory product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsx(I,{id:"product",name:"product",type:"text",readOnly:!0,value:a==null?void 0:a.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_brand",className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx(I,{id:"product_brand",name:"product_brand",type:"text",readOnly:!0,value:a==null?void 0:a.product.brand})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_size",className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx(I,{id:"product_size",name:"product_size",type:"text",readOnly:!0,value:a==null?void 0:a.product.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_color",className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx(I,{id:"product_color",name:"product_color",type:"text",readOnly:!0,value:a==null?void 0:a.product.color})]}),e.jsxs("div",{className:`${s.role==="admin"||s.role==="super_admin"?"col-span-6":"col-span-12"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(Se,{open:o,onOpenChange:d,children:[e.jsx(je,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(P,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[l.supplier_id?e.jsx(e.Fragment,{children:(()=>{const p=n.find(g=>g.id===l.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:p==null?void 0:p.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:p==null?void 0:p.address})]})})()}):e.jsx("span",{children:a==null?void 0:a.supplier_id.name}),e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Ce,{className:"p-0 text-sm font-medium text-slate-700",children:e.jsxs($e,{children:[e.jsx(Ve,{placeholder:"Supplier name or address..."}),n===void 0&&i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:n.map((p,g)=>e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{r("supplier_id",p.id),d(!1)},children:[e.jsx("span",{children:p.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:p.address})]},g))})})]})})]})]}),(s.role==="admin"||s.role==="super_admin")&&e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"status",className:"text-sm font-bold text-gray-600",children:"Status"}),e.jsxs(J,{value:l.status?l.status.toString():a==null?void 0:a.status.toString(),required:!0,onValueChange:p=>r("status",p),children:[e.jsx(ee,{name:"status",id:"status",className:"w-full px-4 text-sm font-bold text-slate-700",children:e.jsx(se,{placeholder:"Select status..."})}),e.jsxs(te,{className:"text-sm font-medium",children:[e.jsx($,{value:"1",children:"Approved"}),e.jsx($,{value:"0",children:"Pending"})]})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",readOnly:s.role!=="admin",defaultValue:a==null?void 0:a.capital_price.toFixed(2),onBlur:p=>{p.target.value=Number(p.target.value).toFixed(2)},onChange:p=>{const g=Number(p.target.value).toFixed(2);r("capital_price",Number(g))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(I,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,defaultValue:a==null?void 0:a.unit,onChange:p=>r("unit",p.target.value)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(I,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:((j=l.stocks_count)==null?void 0:j.toFixed(0))??(a==null?void 0:a.stocks_count)??0,onChange:p=>{r("stocks_count",Number(Number(p.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(I,{id:"damage_count",name:"damage_count",type:"number",min:0,max:l.stocks_count??(a==null?void 0:a.stocks_count),step:1,required:!0,value:l.damage_count!==void 0?String(l.damage_count):String(a==null?void 0:a.damage_count)||"",onBlur:p=>{p.target.value=Number(p.target.value).toFixed(0)},onChange:p=>r("damage_count",Number(Number(p.target.value).toFixed(0)))})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(I,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,value:f||0,className:`${f&&f<0&&"text-red-600"}`,readOnly:!0})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:m,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying...":"Apply changes"})]})}),x&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:x})})]})})})},kc=()=>{const{isOpen:t,openModal:s,closeModal:a}=oe(),[l,r]=h.useState(""),c=(n,i)=>{r(i),s()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Inventory Products",children:e.jsx(xl,{children:e.jsxs(Dt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border",children:e.jsx(Ln,{openModal:c})})}),e.jsx(me,{title:l==="add"?"Add Items":l==="edit"?"Edit Item":l==="view_details"?"Item Details":l==="approve"?"Approve Item":"",isOpen:t,onClose:a,closeOnOverlayClick:l==="view_details",children:e.jsxs(e.Fragment,{children:[l==="view_details"&&e.jsx(qn,{}),l==="edit"&&e.jsx($n,{onClose:a}),l==="approve"&&e.jsx(Hn,{onClose:a})]})})]})})})})},Vn=({handleViewItems:t})=>[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",a.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"invoice.code",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Invoice code"," ",a.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"refundable_amount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Refundable"}),cell:({row:a})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a.original.refundable_amount)})})},{accessorKey:"issued_by",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Issued by"}),cell:({row:a})=>e.jsx("div",{children:e.jsx("span",{children:a.original.issued_by?`${a.original.issued_by.firstname} ${a.original.issued_by.lastname}`:"—"})})},{accessorKey:"created_at",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Issued at"}),cell:({row:a})=>e.jsx("div",{children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.DateTimeFormat("en-PH",{year:"numeric",month:"long",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(new Date(a.original.created_at))})})},{id:"actions",cell:({row:a})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),e.jsxs(V,{onClick:()=>{t(a.original.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Tt,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View items"})]})]})]})}),enableGlobalFilter:!1}],Bn=()=>{const{data:t,isFetching:s}=ml(),a=Ke(),l=r=>{a(`/returns/${r}`)};return e.jsx(e.Fragment,{children:e.jsx(X,{columns:Vn({handleViewItems:l}),data:t?t.sort((r,c)=>new Date(c.created_at).getTime()-new Date(r.created_at).getTime()):[],isLoading:s,dataType:"Returns",filterWhat:"code"})})},Fc=()=>e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Returns",children:e.jsx(ul,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Bn,{})})})})})}),Qn=()=>[{id:"product",accessorKey:"invoice_item.product.name",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Product"}),cell:({row:s})=>e.jsx("div",{children:e.jsx("span",{className:"max-w-[20ch] truncate",children:s.original.invoice_item.product.name})})},{accessorKey:"invoice_item.product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"invoice_item.product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"invoice_item.product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"invoice_item.product.serial_no",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Serial"})},{accessorKey:"quantity",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"QTY"})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Unit"})},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Selling price"}),cell:({row:s})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s.original.price)})})},{id:"subtotal",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Subtotal"}),cell:({row:s})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format((s.original.price??0)*(s.original.quantity??0))})})}],Yn=()=>{const{data:t,isFetching:s}=hl();return e.jsx(e.Fragment,{children:e.jsx(X,{columns:Qn(),data:t??[],isLoading:s,dataType:"Return Items",filterWhat:"product"})})},Ic=()=>{const{id:t}=Ks(),s=Ke(),a=()=>{s(-1)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Return items",children:e.jsx(fl,{returnTransactionId:Number(t??0),children:e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsx("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:e.jsxs(P,{onClick:()=>a(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(ws,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]})}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Yn,{})})]})})})})},Gn=async()=>await Ut.post(`${Lt.INVOICE}/searches-filters-sorts`,{filter:{status:"pending"}},{headers:qt()}).then(t=>t.data.data).catch(t=>{throw console.error("Error fetching pending invoices:",t),t}),Xn=async t=>Ut.put(`${Lt.INVOICE}/${t}`,{status:"approved"},{headers:qt()}).then(s=>s.data).catch(s=>{throw console.error("Error approving invoice:",s),s}),ra=({openModal:t,setSelectedInvoice:s,viewFrom:a})=>{const{data:l,isLoading:r}=gs({queryKey:["pending-invoices"],queryFn:Gn}),c=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["INVOICE CODE"," ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.code?n.original.code:"N/A"})},{accessorKey:"customer",sortingFn:"alphanumeric",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["CUSTOMER NAME"," ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:`${n.original.customer.firstname} ${n.original.customer.lastname}`})},{accessorKey:"discount_amount",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"DISCOUNT AMOUNT"}),cell:({row:n})=>{const i=n.original.total_discount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"subtotal",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"SUBTOTAL"}),cell:({row:n})=>{const i=n.original.subtotal,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_amount_due",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"TOTAL AMOUNT DUE"}),cell:({row:n})=>{const i=n.original.total_amount_due,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"paid_amount",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"PAID AMOUNT"}),cell:({row:n})=>{const i=n.original.paid_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:n})=>{const i=n.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(ye,{children:[e.jsx(ve,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(_e,{size:16,strokeWidth:2.25})}),e.jsxs(be,{className:"relative z-50 w-44 bg-white",children:[e.jsx(we,{className:"text-center",children:"Actions"}),e.jsx(de,{className:"bg-gray-200"}),a==="dashboard"?e.jsxs(V,{onClick:()=>{s(i),t()},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"w-15 flex items-center justify-center",children:e.jsx(Ne,{size:20,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}):e.jsxs(V,{onClick:()=>{s(i),t()},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"w-15 flex items-center justify-center",children:e.jsx(kl,{size:25,strokeWidth:2.25})}),e.jsx("span",{children:"Approve Invoice"})]})]})]})})}}];return e.jsx(X,{data:l||[],columns:c,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:r})},Zn=({selectedInvoice:t,closeModal:s})=>{const a=pe(),{mutate:l,isPending:r}=Y({mutationKey:["approve-invoice"],mutationFn:Xn,onSuccess:c=>{a.invalidateQueries({queryKey:["pending-invoices"]}),K.success("Invoice has been approved"),s()},onError:c=>{K.error("There was something wrong in approving the invoice")}});return e.jsxs("div",{className:"flex flex-col items-center justify-center ",children:[e.jsxs("h1",{className:"font-bold",children:["Are you sure you want to approve ",t.code]}),e.jsx("p",{className:" opacity-70",children:"This process cannot be undone."}),e.jsxs("div",{className:"mt-5 flex gap-3 self-end pb-0",children:[e.jsx(b,{className:"bg-red-500 hover:bg-red-600 disabled:opacity-50",onClick:s,disabled:r,children:"Cancel"}),e.jsx(b,{className:"bg-green-500 hover:bg-green-600 disabled:opacity-50",onClick:()=>{l(t.id)},disabled:r,children:r?"Approving...":"Confirm"})]})]})},Pc=()=>{const{isOpen:t,closeModal:s,openModal:a}=oe(),[l,r]=h.useState(void 0);return e.jsxs(e.Fragment,{children:[e.jsx(me,{title:"approve invoice",isOpen:t,onClose:s,closeOnOverlayClick:!0,children:e.jsx(Zn,{selectedInvoice:l,closeModal:s})}),e.jsxs("div",{className:"flex h-screen w-screen flex-row",children:[e.jsx(Bs,{}),e.jsx("div",{className:"flex max-h-full w-full flex-col gap-4 overflow-y-auto p-6 pt-12 text-slate-700",children:e.jsxs("div",{className:"mx-auto w-full max-w-[1024px] space-y-6",children:[e.jsx("div",{className:"flex w-full flex-row items-start justify-between",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Pending Invoices"})}),e.jsx("div",{className:"rounded-md bg-white",children:e.jsx(ra,{openModal:a,setSelectedInvoice:r})})]})})]})]})},Jn=({selectedInvoice:t})=>{const s=[{accessorKey:"product_name",sortingFn:"alphanumeric",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",a.getIsSorted()==="asc"?e.jsx(D,{}):a.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:a.original.product?`${a.original.product.name} ${a.original.product.brand} ${a.original.product.size}`:"N/A"})},{accessorKey:"capital_price",sortingFn:"alphanumeric",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["CAPITAL PRICE"," ",a.getIsSorted()==="asc"?e.jsx(D,{}):a.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a.original.inventory_product.capital_price)})},{accessorKey:"selling_price",sortingFn:"alphanumeric",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["SELLING PRICE"," ",a.getIsSorted()==="asc"?e.jsx(D,{}):a.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a.original.inventory_product.product_price.price)})},{accessorKey:"quantity",sortingFn:"alphanumeric",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["QUANTITY"," ",a.getIsSorted()==="asc"?e.jsx(D,{}):a.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:a.original.quantity})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.code?t.code:"N/A"})]})}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:e.jsxs("div",{className:"relative col-span-6 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Inventory Items"}),e.jsx(X,{data:(t==null?void 0:t.invoice_items)||[],columns:s,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0})]})}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sub Total"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.subtotal)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Total Amount Due"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.total_amount_due)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Paid Amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.paid_amount)})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Total Discount"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.total_discount)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:`${t.issued_by.firstname} ${t.issued_by.lastname}`})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[ie(t.created_at),"se"]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:"Pending"})]})]})]})})},Tc=()=>{const{openModal:t,isOpen:s,closeModal:a}=oe(),[l,r]=h.useState(void 0);return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Invoice",children:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(ra,{openModal:t,setSelectedInvoice:r,viewFrom:"dashboard"})})}),e.jsx(me,{title:"Invoice Details",isOpen:s,onClose:a,closeOnOverlayClick:!1,children:e.jsx(Jn,{selectedInvoice:l})})]})})})};export{_c as Customers,vc as ExpensesPage,Nc as Inventory,yc as InventoryItemsPage,cc as Invoice,ic as InvoiceItems,zc as Login,kc as PendingInventoryProduct,Tc as PendingInvoices,Cc as PendingProductPrice,Sc as PendingReturn,pc as PendingTransfer,hc as PointOfSalePage,Pc as PosPendingInvoices,wc as PosReturnsPage,mc as ProductPrices,xc as Products,bc as Reports,Ic as ReturnItems,Fc as Returns,gc as RolePermissions,dc as Supplier,fc as Transaction,uc as Transfer,oc as UserInfo,jc as UserSales,nc as Warehouse};
