import{p as fe,t as As,r as p,v as Vt,w as $t,x as Bt,y as Pe,m as se,z as Ke,D as Qt,E as Yt,G as Gt,H as et,I as Xt,J as Zt,K as Jt,L as ea,O as sa,Q as ta,R as st,U as aa,V as la,W as ra,X as Ts,Y as na,Z as _e,j as e,B as _,$ as Ae,M as ne,a0 as ca,a1 as tt,a2 as Te,b as Be,a3 as Ne,a4 as ye,a5 as ve,a6 as be,a7 as he,a8 as B,a9 as at,aa as ia,ab as Ds,ac as da,ad as oa,ae as M,af as ps,ag as xa,ah as Oe,ai as ma,d as Is,aj as lt,ak as rt,al as nt,am as ct,an as X,ao as Z,ap as J,aq as ee,ar as V,as as G,at as qs,au as Hs,av as Re,aw as w,ax as ze,ay as it,az as dt,aA as ua,aB as ha,aC as pa,aD as ce,aE as Qe,aF as Ye,aG as fs,aH as Ge,aI as zs,aJ as js,aK as gs,C as Ee,aL as Q,aM as k,aN as ot,aO as Ce,aP as ke,aQ as Fe,aR as Xe,aS as Ns,aT as fa,T as xt,aU as ja,aV as Ue,aW as ns,aX as cs,aY as is,aZ as ds,a_ as mt,a$ as ga,b0 as Na,b1 as ya,b2 as va,b3 as ba,b4 as me,b5 as We,b6 as Es,b7 as ys,b8 as wa,b9 as _a,ba as Vs,bb as $s,bc as Sa,bd as Ca,be as ka,bf as Fa,bg as Ia,bh as Pa,bi as ut,bj as Aa,bk as ht,bl as ss,bm as pt,bn as ft,bo as oe,bp as Ta,bq as Ze,br as Je,bs as Da,bt as Me,bu as za,bv as Ea,bw as jt,bx as Wa,by as gt,bz as vs,u as Nt,bA as ts,bB as Ve,bC as yt,bD as bs,bE as Bs,bF as Qs,bG as Ys,bH as Ws,bI as Ma,bJ as Gs,bK as Oa,bL as Ra,bM as Ms,bN as Ka,bO as Ua,bP as La,bQ as Le,_ as vt,h as bt,i as wt,k as _t,bR as St,l as Ct,bS as Xs,bT as Fs,bU as Os,bV as qa,bW as Ha,bX as kt,bY as Va,bZ as $a,b_ as Rs,b$ as Ba,c0 as ws,c1 as Qa,c2 as Ya,c3 as Ga,c4 as Xa,c5 as Za}from"./index-460140f2.js";import{c6 as Xn}from"./index-460140f2.js";import{M as pe,f as ie,a as we,P as Se,T as Ft,b as Ja,u as It,A as el,N as Pt,C as as,c as es,g as Ks,d as sl}from"./useInventoryProductCalculations-ebe095ab.js";import{a as Y,I as H,D as te,A as D,b as z,c as E,u as xe,f as tl,d as de,P as al}from"./timeUtils-853545c6.js";import{F as Us,B as $e,R as os}from"./ReportCard-f63dabac.js";import{P as ll}from"./PosTable-1573517a.js";import"./index-ff61ddef.js";const rl=()=>{const t=fe(),{warehouses:s}=As(),[a,l]=p.useState({id:s.length+1||0,code:"",name:"",location:""}),r=o=>{const{name:m,value:u}=o.target;l(x=>({...x,[m]:u}))},n={onSuccess:async()=>{await t.invalidateQueries({queryKey:["warehouses"]}),l({id:s.length+1||0,code:"",name:"",location:""})},onError:o=>{console.error("Warehouse Data failed",o)}},{mutateAsync:c}=Y({mutationKey:["removeWarehouse"],mutationFn:Vt,...n}),{mutateAsync:i}=Y({mutationKey:["addWarehouse"],mutationFn:$t,...n}),{mutateAsync:d}=Y({mutationKey:["updateWarehouse"],mutationFn:Bt,...n});return{value:a,setValue:l,handleChange:r,removeWarehouseMutation:c,addWarehouseMutation:i,updateWarehouseMutation:d}},nl=()=>{const t=fe(),{transfers:s}=Pe(),{auth:a}=se(),{warehouses:l}=Ke(),r=s[0]?s[s.length-1].id+1:1,[n,c]=p.useState(!1),[i,d]=p.useState(!1),[o,m]=p.useState(null),[u,x]=p.useState(null),[y,f]=p.useState(null),[N,g]=p.useState(),[h,j]=p.useState(),[C,T]=p.useState(),[v,S]=p.useState({});p.useEffect(()=>{S(W=>({...W,approval_status:"pending",created_by:a.user.id,transfer_schedule:""}))},[]);const F=()=>{const W=Object.keys(v).map(ae=>({text:ae})),K=W.length===6||W.length>6;if(K){const ae=v.source!==v.destination;if(ae){const A=v.transfer_schedule!=="";return A?[A,""]:[A,"Please fill up transfer schedule"]}else return[ae,"You cannot have the same source and destination"]}else return[K,"Please fill up all fields"]},I=W=>{c(!0),x(null),m(null),S(K=>({...K,[W.target.name]:W.target.value}))},q=W=>{if(c(!0),x(null),m(null),W){f(W);const K=W.$H<10?"0"+W.$H.toString():W.$H.toString(),ae=W.$m<10?"0"+W.$m.toString():W.$m.toString(),A=W.$s<10?"0"+W.$s.toString():W.$s.toString();S(le=>({...le,transfer_schedule:v.transfer_schedule+" "+K+":"+ae+":"+A}))}else f(null),S(K=>({...K,transfer_schedule:v.transfer_schedule.split(" ")[0]}))},R=(W,K)=>{var ae,A,le,$;c(!0),x(null),m(null),S(re=>({...re,[W]:K})),console.log(W,K),W==="source"&&K==1?(g((ae=l.find(re=>re.id===K))==null?void 0:ae.code),j((A=l.find(re=>re.id===K+1))==null?void 0:A.code),S(re=>({...re,destination:K+1}))):W==="source"&&K==2?(g((le=l.find(re=>re.id===K))==null?void 0:le.code),j(($=l.find(re=>re.id===K-1))==null?void 0:$.code),S(re=>({...re,destination:K-1}))):W==="transfer_schedule"&&(T(K.replace(/-/g,"")),f(K))},P=async()=>{if(console.log(N,h,C),console.log(v),N&&h&&C){const W="TRF-"+N+"-"+h+"-"+C+"-"+r;S(K=>({...K,code:W}))}};p.useEffect(()=>{async function W(){if(console.log(i),v.code){const K=F();if(d(!0),K[0])return O(v);m(K[1]),d(!1)}}W()},[v.code]);const b={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfers"]}),d(!1),c(!1),x("Transfer info has been added")},onError:W=>{console.error(W),m(W.message),d(!1)}},{mutateAsync:O}=Y({mutationKey:["addTransfer"],mutationFn:Qt,...b});return{transfer:v,lastId:r,isChanged:n,isSubmitting:i,error:o,success:u,dateDisplay:y,handleSubmit:P,handleChange:I,handleChangeSelect:R,handleChangeDateTime:q,addTransferMutation:O}},At=()=>{const t=fe(),[s,a]=p.useState({}),l=(d,o)=>{a(m=>({...m,[d]:o}))},r=async d=>{if(console.log("Submitting: ",d),d.action==="add")return await c(d.data);if(d.action==="update")return await i({id:d.id,data:d.data});{const o="No data to submit. Function requires at least one parameter.";return console.error(o),{status:400,data:o}}},n={onSuccess:async()=>{await t.invalidateQueries({queryKey:["inventory"]})},onError:d=>{console.error("Inventory Data failed",d)}},{mutateAsync:c}=Y({mutationKey:["addInventory"],mutationFn:Yt,...n}),{mutateAsync:i}=Y({mutationKey:["patchInventory"],mutationFn:Gt,...n});return{value:s,setValue:a,handleChange:l,handleSubmit:r}},cl=()=>{const t=fe(),{transfers:s,transferProducts:a,selectedTransfer:l}=Pe(),r=a.filter(L=>L.transfer_id===l.id),{auth:n}=se(),{warehouses:c}=Ke(),[i,d]=p.useState(!1),[o,m]=p.useState(!1);p.useState(!1);const[u,x]=p.useState(!1);p.useState(!1);const[y,f]=p.useState(!1),{data:N}=et(),[g,h]=p.useState(0),[j,C]=p.useState(!1),[T,v]=p.useState(!1),[S,F]=p.useState(null),[I,q]=p.useState(null),[R,P]=p.useState(new Date),[b,O]=p.useState(new Date),[W,K]=p.useState(""),[ae,A]=p.useState(),le=s[s.length-1].id+1,[$,re]=p.useState({});if(p.useEffect(()=>{l&&(re({id:l.id,code:l.code,created_by:l.created_by.id,source:l.source.id,destination:l.destination.id,transfer_schedule:l.transfer_schedule,approval_status:l.approval_status,approved_by:l.approved_by?l.approved_by.id:null,transfer_status:l.transfer_status,date_received:l.date_received,received_by:l.received_by?l.received_by.id:null,notes:l.notes}),P(new Date(l.transfer_schedule)),l.date_received?O(new Date(l.date_received)):O(new Date(l.transfer_schedule)))},[l]),$.code==""){const L=$.transfer_schedule.split(" ")[0].split("-").join(""),ue="TRF-"+l.source.code+"-"+l.destination.code+"-"+L+"-"+le;re(De=>({...De,code:ue}))}const xs=()=>{const L=$.source!==$.destination;if(L){const ue=$.transfer_status==="arrived"?!!($.received_by&&$.date_received):!0;if(ue)return[ue,""];{const De=`Fields you need to fill: ${$.received_by?"":"received by"} 
									${!$.date_received&&!$.received_by?" and ":""}
									${$.date_received?"":"date received"}`;return[ue,De]}}else return[L,"You cannot have the same source and destination"]},ms=L=>{C(!0),q(null),F(null),re(ue=>({...ue,[L.target.name]:L.target.value}))},_s=(L,ue)=>{C(!0),q(null),F(null),K(L),A(ue),L==="transfer_schedule"?P(ue):O(ue)};p.useEffect(()=>{async function L(){if(W&&ae){const ue=ae.getFullYear()+"-"+(ae.getMonth()+1)+"-"+ae.getDate()+" "+ae.getHours()+":"+ae.getMinutes()+":"+ae.getSeconds();re(De=>({...De,[W]:ue}))}}L()},[R,b]);const U=(L,ue)=>{console.log(L,ue),C(!0),q(null),F(null),re(De=>({...De,[L]:ue}))};p.useEffect(()=>{$.approval_status==="approved"?re(L=>({...L,approved_by:n.user.id})):$.approval_status==="rejected"&&f(!0)},[$.approval_status]),p.useEffect(()=>{$.transfer_status==="arrived"?d(!0):d(!1)},[$.transfer_status]),p.useEffect(()=>{if(o){async function L(){const De={code:"INV-"+c.filter(Ht=>Ht.id===$.destination)[0].code+"-TRA-"+l.code.split("-")[3]+"-"+(Number(N.length)+1).toString(),warehouse_id:$.destination,created_by:$.created_by,date_received:$.date_received,type:"transfer",transfer_id:$.id,notes:$.notes},qt=await Cs(De);h(qt.data.data.id)}L()}},[o]);async function je(){await ea(r,g).then(async L=>{v(!1),C(!1),q("Transfer info has been edited")}).catch(L=>{throw console.error("Error updating inventory products:",L),L})}p.useEffect(()=>{g!=0&&je()},[g]);const qe=async()=>{const L=xs();if(v(!0),L[0])if(i)await He($);else return await He($);else F(L[1]),v(!1)},Ie={onSuccess:async()=>{if(await t.invalidateQueries({queryKey:["transfers"]}),i)m(!0);else{if(y)return await Lt(r);v(!1),C(!1),q("Transfer info has been edited")}},onError:L=>{console.error(L),F(L.message),v(!1)}},{mutateAsync:He}=Y({mutationKey:["transfers"],mutationFn:Xt,...Ie}),Ss={onSuccess:async()=>{await t.invalidateQueries({queryKey:["inventory"]}),x(!0)},onError:L=>{console.error(L),F(L.message),v(!1)}},{mutateAsync:Cs}=Y({mutationKey:["addInventory"],mutationFn:Zt,...Ss}),ks={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfer_products"]}),v(!1),C(!1),q("Transfer info has been edited")},onError:L=>{console.error(L),F(L.message),v(!1)}},{mutateAsync:Lt}=Y({mutationKey:["initInventoryProduct"],mutationFn:Jt,...ks});return{transfer:$,selectedTransfer:l,lastId:le,isChanged:j,isSubmitting:T,error:S,success:I,dateDisplay:R,dateDisplayArrived:b,handleSubmit:qe,handleChange:ms,handleChangeSelect:U,handleChangeDateTime:_s,editTransferMutation:He}},Ls=()=>{const t=fe(),[s,a]=p.useState({}),l=(d,o)=>{a(m=>({...m,[d]:o}))},r=async d=>{if(console.log("Submitting: ",d),d.action==="add")return await c(d.data);if(d.action==="update")return await i({id:d.id,data:d.data});{const o="No data to submit. Function requires at least one parameter.";return console.error(o),{status:400,data:o}}},n={onSuccess:async()=>{await t.invalidateQueries({predicate:d=>["productPrices","pendingProductPrices","approvedProductPrices","productPricesTEST"].includes(d.queryKey[0])}),a({})},onError:d=>{console.error("Product Prices Data failed",d)}},{mutateAsync:c}=Y({mutationKey:["addProductListing"],mutationFn:sa,...n}),{mutateAsync:i}=Y({mutationKey:["patchProductListing"],mutationFn:ta,...n});return{value:s,setValue:a,handleChange:l,handleSubmit:r,addProductPricesMutation:c,patchProductPricesMutation:i}},il=()=>{const t=fe(),{transfers:s,transferProducts:a,selectedProduct:l,selectedTransfer:r,addProd:n}=Pe();se();const{data:c}=st(),{data:i}=aa(),{data:d}=et(),o=d.filter(U=>U.warehouse.id===r.source.id&&i.some(je=>je.inventory_id===U.id)),[m,u]=p.useState([]),[x,y]=p.useState(0),[f,N]=p.useState(""),[g,h]=p.useState(l.id?l.product.name:""),[j,C]=p.useState(0),[T,v]=p.useState(0),[S,F]=p.useState(!1),[I,q]=p.useState(!1),[R,P]=p.useState(null),[b,O]=p.useState(null),[W,K]=p.useState({});function ae(){l.id?K(U=>({...U,id:l.id,transfer_id:l.transfer_id,unit:l.unit,source_inventory:x})):K(U=>({...U,id:a.length+1,transfer_id:r.id}))}p.useEffect(()=>{K(n?U=>({...U,id:a.length+1,transfer_id:r.id}):{id:l.id,transfer_id:l.transfer_id,product_id:l.product.id,total_quantity:l.total_quantity,capital_price:l.capital_price,unit:l.unit,source_inventory:l.source_inventory})},[]),p.useEffect(()=>{if(!n){const U=i.find(je=>je.id===l.source_inventory);C(U!=null&&U.remaining_stocks_count?U.remaining_stocks_count:0),v(U!=null&&U.damage_count?U.damage_count:0),y(l.source_inventory)}},[i]);const A=U=>{F(!0),O(null),P(null),K(je=>({...je,[U.target.name]:Number(U.target.value)}))},le=(U,je,qe)=>{if(F(!0),O(null),P(null),U==="product_id"&&qe!=null){console.log(m[qe]);const Ie=m[qe];h(Ie.product.name);const He=Ie.capital_price,Ss=Ie.unit,Cs=Number(je);K(ks=>({...ks,[U]:Cs,capital_price:He,unit:Ss,source_inventory:x})),C(Ie.remaining_stocks_count?Ie.remaining_stocks_count:0),v(Ie.damage_count)}else if(U==="inventory_id"){N(je.toString());const Ie=o.filter(He=>He.code===je)[0].id;y(Ie),h(""),W.capital_price&&(ae(),K({}))}};p.useEffect(()=>{i.length!=0&&u(i.filter(U=>U.inventory_id===x&&U.remaining_stocks_count&&U.remaining_stocks_count>0))},[x,i]);const $=()=>{const je=Object.keys(W).map(qe=>({text:qe})).length===7;return je?W.total_quantity>j?[!1,"Quantity input is greater than the current stock quantity."]:[!0,""]:[je,"Please fill up all fields"]},re=async()=>{q(!0);const U=$();if(U[0])return n?await ms(W):await _s(W);P(U[1]),q(!1)},xs={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfer_products"]}),q(!1),F(!1),O(n?"Transfer product has been added":"Transfer product has been edited")},onError:U=>{console.error(U),P(U.message),q(!1)}},{mutateAsync:ms}=Y({mutationKey:["transfer_product"],mutationFn:la,...xs}),{mutateAsync:_s}=Y({mutationKey:["transfer_product"],mutationFn:ra,...xs});return{product:W,allProducts:c,allInventoryProducts:i,inventoryID:x,invCode:f,prodName:g,filteredInventoriesSrc:o,filteredProductsSrc:m,quantityLimit:j,damagedCount:T,isChanged:S,isSubmitting:I,error:R,success:b,handleSubmit:re,handleChange:A,handleChangeSelect:le,addProductMutation:ms}},dl=()=>{const{selectedReturn:t}=Ts(),[s,a]=p.useState(!1),[l,r]=p.useState(null),[n,c]=p.useState(null),[i,d]=p.useState({id:t.id,code:t.code,invoice_id:t.invoice.id,issued_by:t.issued_by.id,refundable_amount:t.refundable_amount,voucher_id:t.voucher?t.voucher.id:null,refund_status:"done",created_at:t.created_at,updated_at:t.updated_at}),o=async()=>{a(!0),await u(i)},m={onSuccess:async()=>{a(!1),c("Return info has been edited")},onError:x=>{console.error(x),r(x.response.data.message),a(!1)}},{mutateAsync:u}=Y({mutationKey:["returns"],mutationFn:na,...m});return{selectedReturn:t,isSubmitting:s,error:l,success:n,handleSubmit:o}};/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=_e("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=_e("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=_e("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=_e("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=_e("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=_e("CircleOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.35 2.69A10 10 0 0 1 21.3 15.65",key:"1pfsoa"}],["path",{d:"M19.08 19.08A10 10 0 1 1 4.92 4.92",key:"1ablyi"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=_e("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=_e("MapPinned",[["path",{d:"M18 8c0 4.5-6 9-6 9s-6-4.5-6-9a6 6 0 0 1 12 0",key:"yrbn30"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M8.835 14H5a1 1 0 0 0-.9.7l-2 6c-.1.1-.1.2-.1.3 0 .6.4 1 1 1h18c.6 0 1-.4 1-1 0-.1 0-.2-.1-.3l-2-6a1 1 0 0 0-.9-.7h-3.835",key:"112zkj"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=_e("MoveRight",[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ul=_e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=_e("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=_e("ShoppingBasket",[["path",{d:"m15 11-1 9",key:"5wnq3a"}],["path",{d:"m19 11-4-7",key:"cnml18"}],["path",{d:"M2 11h20",key:"3eubbj"}],["path",{d:"m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4",key:"yiazzp"}],["path",{d:"M4.5 15.5h15",key:"13mye1"}],["path",{d:"m5 11 4-7",key:"116ra9"}],["path",{d:"m9 11 1 9",key:"1ojof7"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=_e("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),fl=({isUpdate:t=!1,onClose:s,isDelete:a})=>{const{warehouseSelected:l}=As(),{value:r,setValue:n,handleChange:c,addWarehouseMutation:i,updateWarehouseMutation:d,removeWarehouseMutation:o}=rl();p.useEffect(()=>{(t||a)&&n(l)},[t,a,l,n]);const[m,u]=p.useState(!1),[x,y]=p.useState(null),[f,N]=p.useState(null),g=async()=>{u(!0);try{await new Promise(h=>setTimeout(h,1e3)),t&&(await d(r),u(!1),y("Warehouse updated successfully"),s()),a?(await o(r.id),u(!1),y("Warehouse deleted successfully"),s()):!t&&!a&&(await i(r),u(!1),y("Warehouse added successfully"),s())}catch(h){console.error("Warehouse data submission failed",h),u(!1),N(h.message)}};return e.jsx(e.Fragment,{children:a?e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:h=>{h.preventDefault(),g()},children:e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx(_,{type:"submit",fill:"red",children:a?"Delete Warehouse":"Add Warehouse"})})})}):e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:h=>{h.preventDefault(),g()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse ID"}),e.jsx(H,{name:"id",value:(r==null?void 0:r.id)||0,type:"number",disabled:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Code"}),e.jsx(H,{name:"code",placeholder:"Warehouse Code",value:(r==null?void 0:r.code)||"",onChange:c,maxLength:3})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Name"}),e.jsx(H,{name:"name",placeholder:"Warehouse Name",value:(r==null?void 0:r.name)||"",onChange:c,required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Location"}),e.jsx(H,{name:"location",placeholder:"Warehouse Location",type:"string",value:(r==null?void 0:r.location)||"",onChange:c,required:!0})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[x&&e.jsx("div",{className:"font-bold text-green-700",children:x}),f&&e.jsx("div",{className:"font-bold text-red-700",children:f}),m?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:s,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",children:t?"Update Warehouse":"Add Warehouse"})]})})]})})]})})})})},jl=({openModal:t})=>{const{warehouses:s,setWarehouseSelected:a,isFetching:l,progress:r}=As(),n=[{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE ID"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.id})},{accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:i})=>e.jsx("div",{className:"items-center",children:e.jsxs(_,{onClick:()=>i.toggleSorting(i.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["WAREHOUSE NAME ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.name})},{accessorKey:"code",header:()=>e.jsx("div",{className:"text-center",children:"code"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.code})},{accessorKey:"location",header:()=>e.jsx("div",{className:"text-center",children:"LOCATION"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.location})},{id:"actions",header:()=>e.jsx("div",{className:"flex flex-row justify-center",children:"ACTIONS"}),cell:({row:i})=>{const d=i.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(_,{fill:"empty",textColor:"black",onClick:()=>c(d),className:"flex flex-row items-center gap-2",children:[e.jsx(Us,{})," Edit"]})})}}],c=i=>{a(i),t(i,"edit")};return e.jsx(e.Fragment,{children:e.jsx(te,{data:s,columns:n,filterWhat:"location",dataType:"",isLoading:l,openModal:void 0})})},Sn=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Warehouse",children:e.jsxs(ca,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(jl,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:a,title:l==="edit"?"Edit Warehouse":l==="remove"?"Remove Warehouse":"Add Warehouse",children:e.jsx(fl,{onClose:a,isUpdate:l==="edit",isDelete:l==="remove"})})]})})})},gl=({openModal:t})=>{const{invoices:s}=tt(),a=Te(),l=[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx(e.Fragment,{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:r})=>e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{className:"font-bold",children:r.original.code})})},{accessorKey:"warehouse.code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Warehouse"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"payment_method",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Type"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:r})=>{const n=r.original.payment_method.split("_").join(" ");return e.jsx(e.Fragment,{children:e.jsx("span",{className:"capitalize",children:n})})}},{accessorKey:"is_paid",header:({})=>e.jsx("span",{children:"Balance Amount"}),cell:({row:r})=>{const n=r.original.is_paid;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"group relative flex w-fit items-center justify-center",children:n===1?e.jsx("span",{children:"——"}):n===0?e.jsx("span",{className:"",children:ie(r.original.balance_amount)}):e.jsx(Be,{size:20,strokeWidth:2,className:"text-amber-500"})})})}},{accessorKey:"total_amount_due",header:({column:r})=>e.jsx("span",{children:"Total Amount"}),cell:({row:r})=>ie(r.original.total_amount_due)},{id:"actions",cell:({row:r})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{a(`/transaction/items/${r.original.id}`)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(hl,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View Invoice"})]})]})]})}),enableGlobalFilter:!1}];return e.jsx(e.Fragment,{children:e.jsx(te,{columns:l,data:s.sort((r,n)=>{const c=new Date(r.updated_at??r.created_at);return new Date(n.updated_at??n.created_at).getTime()-c.getTime()}),filterWhat:"code",dataType:"Invoices"})})},Cn=({})=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i),console.log("modalAction:",l)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Transactions",children:e.jsx(at,{children:e.jsx(ia,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(gl,{openModal:n})})})})})})})},Nl=({items:t})=>{const s=[{id:"orderItem",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Item #"}),cell:({row:a})=>e.jsxs("div",{className:"flex flex-row gap-2 ",children:[a.original.product.brand?e.jsx(e.Fragment,{children:e.jsxs("span",{children:["(",a.original.product.brand,")"]})}):null,e.jsx("span",{className:"font-bold",children:a.original.product.name}),e.jsx("span",{className:"",children:a.original.product.size}),e.jsx("span",{className:"",children:a.original.product.color})]}),size:200},{id:"quantity",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Quantity"}),cell:({row:a})=>e.jsx("div",{className:"flex ",children:a.original.quantity})},{id:"price",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Price"}),cell:({row:a})=>e.jsx("div",{className:"flex ",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a.original.product_price??0)})}];return e.jsx(e.Fragment,{children:e.jsx(te,{columns:s,data:t,dataType:"orderItem",filterWhat:"price",hideFilter:!0})})},kn=({})=>{const t=Te(),{id:s}=Ds(),{data:a,isLoading:l}=da(Number(s)),{invoiceItems:r,isLoading:n}=oa(Number(s)),c=()=>{t(-1)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Transaction Items",children:e.jsxs("div",{className:"flex h-full max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:[e.jsxs("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:[e.jsxs(M,{onClick:()=>c(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(ps,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]}),e.jsxs("div",{className:"flex flex-row gap-8",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Inventory code:"}),e.jsx("span",{children:l?"Loading...":a==null?void 0:a.code})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Created at:"}),e.jsx("span",{children:l?"Loading...":tl(a==null?void 0:a.created_at)})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Issued By:"}),e.jsx("span",{children:l?"Loading...":(a==null?void 0:a.issued_by.firstname)+" "+(a==null?void 0:a.issued_by.lastname)})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Customer:"}),e.jsx("span",{className:"capitalize",children:l?"Loading...":(a==null?void 0:a.customer.firstname)+" "+(a==null?void 0:a.customer.lastname)})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Total Amount Due:"}),e.jsx("span",{children:l?"Loading...":ie(a==null?void 0:a.total_amount_due)})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Warehouse:"}),e.jsx("span",{children:l?"Loading...":a==null?void 0:a.warehouse.code})]})]}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Balance Amount:"}),e.jsx("span",{children:l?"Loading...":ie(a==null?void 0:a.balance_amount)})]})})]})]}),e.jsx("div",{children:!n&&e.jsx(e.Fragment,{children:e.jsx(Nl,{items:r})})})]})})})},yl=(t,s)=>{const a=fe(),[l,r]=p.useState(""),[n,c]=p.useState(""),[i,d]=p.useState({firstname:t.firstname,lastname:t.lastname,username:t.username,email:t.email,contact_no:t.contact_no,position:t.position,user_id:t.id,role_id:0});p.useEffect(()=>{s&&d(S=>{var F;return{...S,role_id:(F=s.find(I=>I.title===t.position))==null?void 0:F.id}})},[s]);const[o,m]=p.useState(!1),[u,x]=p.useState(!1),[y,f]=p.useState(null),[N,g]=p.useState(null),h=(S,F)=>{m(!0),g(null),f(null),d(I=>({...I,[S]:F}))},j=S=>{m(!0),g(null),S.target.name==="position"?d(F=>{var I;return{...F,[S.target.name]:S.target.value,role_id:(I=s.find(q=>q.title===S.target.value))==null?void 0:I.id}}):S.target.name==="new_password"?r(S.target.value):S.target.name==="confirm_password"?c(S.target.value):d(F=>({...F,[S.target.name]:S.target.value}))};p.useEffect(()=>{l!=n?f("Passwords don't match"):f(null)},[l,n]);const C=async()=>{var S,F;((S=i.contact_no)==null?void 0:S.length)>11||((F=i.contact_no)==null?void 0:F.length)<11?f("Contact number must be 11 digits"):(x(!0),l!==""&&n!==""&&d(I=>({...I,password:n})))};p.useEffect(()=>{u&&v(i)},[i,u]);const T={onSuccess:async()=>{await a.invalidateQueries({queryKey:["users"]}),x(!1),m(!1),g("User info has been updated")},onError:S=>{console.error(S),f(S.message),x(!1)}},{mutateAsync:v}=Y({mutationKey:["editUser"],mutationFn:xa,...T});return{user:i,isChanged:o,isSubmitting:u,password:l,compPassword:n,error:y,setError:f,success:N,handleSubmit:C,handleChangeSelect:h,handleChange:j,editUserMutation:v}},vl=()=>{const t=fe(),{users:s}=Oe(),{roles:a}=Oe();s[s.length-1].id+1;const[l,r]=p.useState({});p.useEffect(()=>{r(C=>({...C,active_status:"active"}))},[]);const[n,c]=p.useState(!1),[i,d]=p.useState(!1),[o,m]=p.useState(null),[u,x]=p.useState(null),y=()=>{var v,S;const T=Object.keys(l).map(F=>({text:F})).length===10;if(T){const F=l.password===l.password_confirmation;if(!F)return[F,"Passwords do not match"];const I=!(((v=l.contact_no)==null?void 0:v.length)>11||((S=l.contact_no)==null?void 0:S.length)<11);return I?[T&&F&&I,""]:[I,"Please input a valid contact number"]}else{const F=!!l.position;return F?[T,"Please correctly fill up all fields"]:[F,"Please choose a position"]}},f=C=>{c(!0),x(null),m(null),r(T=>({...T,[C.target.name]:C.target.value}))},N=(C,T)=>{c(!0),x(null),m(null),r(v=>{var S;return{...v,[C]:T,role_id:(S=a.find(F=>F.title===T))==null?void 0:S.id}})},g=async()=>{const C=y();if(d(!0),C[0])return await j(l);m(C[1]),d(!1)},h={onSuccess:async()=>{await t.invalidateQueries({queryKey:["users"]}),d(!1),c(!1),x("User info has been added")},onError:C=>{console.error(C),m(C.response.data.message),d(!1)}},{mutateAsync:j}=Y({mutationKey:["addUser"],mutationFn:ma,...h});return{user:l,isChanged:n,isSubmitting:i,error:o,setError:m,success:u,handleSubmit:g,handleChange:f,handleChangeSelect:N,addUserMutation:j}},bl=()=>{const t=fe(),{roles:s,selectedUser:a}=Oe(),l=s.filter(R=>R.title===a.position),[r,n]=p.useState([]),[c,i]=p.useState([]),[d,o]=p.useState([]),{data:m}=Is({queryKey:["all-permissions"],queryFn:()=>nt(),refetchOnWindowFocus:!1});p.useEffect(()=>{const R=m;R&&i(R)},[m]);const{isFetching:u,data:x}=Is({queryKey:["permissions"],queryFn:()=>ct(l[0].id),refetchOnWindowFocus:!1});p.useEffect(()=>{const R=x;R&&(n(R),o(R))},[x]);const[y,f]=p.useState(!1),[N,g]=p.useState(!1),[h,j]=p.useState(null),[C,T]=p.useState(null),v=(R,P)=>{f(!0),T(null),j(null),o(R?[...d,{id:null,role_id:l,permission_id:P}]:d.filter(b=>b.permission_id!==P))},S=async()=>{if(g(!0),d.length>r.length){const R=d.filter(P=>P.id===null);if(R.length>1)R.forEach(async P=>{await I(P)});else return await I(R)}else if(d.length<r.length){const R=r.filter(P=>d.find(b=>b.permission_id===P.permission_id)===void 0);if(R.length>1)R.forEach(async P=>{await q(P)});else return await q(R[0])}else g(!1),f(!1),T("No changes made")},F={onSuccess:async()=>{await t.invalidateQueries({queryKey:["all-permissions"]}),g(!1),f(!1),T("Role permissions have been updated")},onError:R=>{console.error(R),j(R.message),g(!1)}},{mutateAsync:I}=Y({mutationKey:["addpermission"],mutationFn:lt,...F}),{mutateAsync:q}=Y({mutationKey:["deletepermission"],mutationFn:rt,...F});return{permissions:r,allPermissions:c,permissionChange:d,isChanged:y,isSubmitting:N,error:h,success:C,handleSubmit:S,handleChange:v}},wl=()=>{const t=fe(),{roles:s}=Oe(),[a,l]=p.useState(),[r,n]=p.useState(0);p.useState();const[c,i]=p.useState([]),[d,o]=p.useState([]),[m,u]=p.useState([]),{data:x}=Is({queryKey:["all-permissions"],queryFn:()=>nt(),refetchOnWindowFocus:!1});p.useEffect(()=>{const P=x;P&&o(P)},[x]);const[y,f]=p.useState(!1),[N,g]=p.useState(!1),[h,j]=p.useState(null),[C,T]=p.useState(null),v=(P,b)=>{T(null),j(null),l(s.find(O=>O.title===b)),n(s.find(O=>O.title===b).id)};p.useEffect(()=>{async function P(){const b=await ct(r);i(b),u(b)}P()},[r]);const S=(P,b)=>{f(!0),T(null),j(null),u(P?[...m,{id:null,role_id:r,permission_id:b}]:m.filter(O=>O.permission_id!==b))},F=async()=>{if(g(!0),m.length>c.length){const P=m.filter(b=>b.id===null);if(P.length>1)P.forEach(async b=>{await q(b)});else return await q(P[0])}else if(m.length<c.length){const P=c.filter(b=>m.find(O=>O.permission_id===b.permission_id)===void 0);if(P.length>1)P.forEach(async b=>{await R(b)});else return await R(P[0])}else g(!1),f(!1),T("No changes made")},I={onSuccess:async()=>{await t.invalidateQueries({queryKey:["all-permissions"]}),g(!1),f(!1),T("Role permissions have been updated")},onError:P=>{console.error(P),j(P.message),g(!1)}},{mutateAsync:q}=Y({mutationKey:["addpermission"],mutationFn:lt,...I}),{mutateAsync:R}=Y({mutationKey:["deletepermission"],mutationFn:rt,...I});return{roles:s,roleSelect:a,permissions:c,allPermissions:d,permissionChange:m,roleId:r,isChanged:y,isSubmitting:N,error:h,success:C,handleSubmit:F,handleChange:S,handleChangeSelect:v}},_l=({openModal:t})=>{const{users:s,isFetching:a,progress:l,progress2:r,setSelectedUser:n}=Oe(),c=m=>{n(m),t(m,"edit")},i=m=>{n(m),t(m,"editPerms")},d=()=>{t({},"add")},o=[{accessorKey:"lastname",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{m.toggleSorting(m.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["LAST NAME ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.lastname})},{accessorKey:"firstname",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>m.toggleSorting(m.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["FIRST NAME ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.firstname})},{accessorKey:"position",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>m.toggleSorting(m.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["ROLE ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.position})},{accessorKey:"username",header:()=>e.jsx("div",{className:"text-center",children:"USERNAME"}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.username})},{accessorKey:"email",header:()=>e.jsx("div",{className:"text-center",children:"EMAIL ADDRESS"}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.email})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:m})=>{const u=m.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>c(u),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit User"})]}),e.jsxs(B,{onClick:()=>i(u),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit User Permission"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:s,columns:o,filterWhat:"username",dataType:"User",openModal:d,isLoading:a})})},Sl=({onClose:t})=>{const{user:s,isChanged:a,isSubmitting:l,error:r,setError:n,success:c,handleSubmit:i,handleChange:d,handleChangeSelect:o}=vl(),{roles:m}=Oe(),u=m==null?void 0:m.filter(x=>x.title!=="super_admin");return u&&u.map(x=>x.title.replace("_"," ")),c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:x=>{x.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User ID"}),e.jsx(H,{name:"id",value:s.id,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User First Name"}),e.jsx(H,{name:"firstname",placeholder:"User First Name",value:s.firstname||"",onChange:d,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Last Name"}),e.jsx(H,{name:"lastname",placeholder:"User Last Name",value:s.lastname||"",onChange:d,required:!0})]})]}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Email Address"}),e.jsx(H,{name:"email",placeholder:"User Email Address",type:"email",value:s.email||"",onChange:d,onKeyDown:x=>{x.code==="Space"?(x.preventDefault(),n("Space not allowed")):n(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Contact Number"}),e.jsx(H,{name:"contact_no",placeholder:"User Contact Number",type:"number",value:s.contact_no||"",onChange:d,onKeyDown:x=>{x.code==="Space"?(x.preventDefault(),n("Space not allowed")):n(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Position"}),e.jsxs(X,{onValueChange:x=>o("position",x),children:[e.jsx(Z,{name:"position",className:"flex flex-row items-center gap-3 truncate text-md rounded-md bg-slate-100",children:e.jsx(J,{placeholder:s.position?s.position.charAt(0).toUpperCase()+s.position.slice(1):"Choose position..."})}),e.jsx(ee,{className:"bg-white font-medium text-md",children:m.length>0?m.map(x=>{if(x.title!=="super_admin")return e.jsx(V,{value:x.title,children:x.title.charAt(0).toUpperCase()+x.title.slice(1).replace("_"," ")},x.id)}):e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]})]}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Username"}),e.jsx(H,{name:"username",placeholder:"User Username",type:"string",value:s.username||"",onChange:d,onKeyDown:x=>{x.code==="Space"?(x.preventDefault(),n("Space not allowed")):n(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Password"}),e.jsx(H,{name:"password",placeholder:"User Password",type:"password",value:s.password||"",onChange:d,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Confirm Password"}),e.jsx(H,{name:"password_confirmation",placeholder:"Confirm Password",type:"password",value:s.password_confirmation||"",onChange:d,required:!0})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),a&&e.jsx(_,{type:"submit",fill:"green",onClick:i,children:l?"Submitting":"Add User"})]})})]})})]})})})},Cl=({onClose:t})=>{const{selectedUser:s,roles:a}=Oe(),{auth:l}=se(),{user:r,isChanged:n,isSubmitting:c,password:i,compPassword:d,error:o,setError:m,success:u,handleSubmit:x,handleChange:y,handleChangeSelect:f}=yl(s,a),[N,g]=p.useState(!1),h=()=>{g(!N)},[j,C]=p.useState(!1),T=()=>{C(!j)};return u&&setTimeout(()=>{t()},1e3),e.jsxs(e.Fragment,{children:[s.id===l.user.id&&e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-6 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-6 font-bold text-red-700 text-start",children:["Warning: Be careful! You are editing your own account.",e.jsx("br",{}),"You are at risk of locking yourself out."]})}),e.jsx("form",{onSubmit:async v=>{v.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"id",children:"User ID"}),e.jsx(H,{type:"text",name:"id",placeholder:"User ID",className:"inputbox",value:r.user_id,disabled:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"First name"}),e.jsx(H,{type:"text",name:"firstname",placeholder:"First name",className:"inputbox rounded-md bg-slate-100",value:r.firstname,onChange:y})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Last name"}),e.jsx(H,{type:"text",name:"lastname",placeholder:"Last name",className:"inputbox rounded-md bg-slate-100",value:r.lastname,onChange:y})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"username",children:"Username"}),e.jsx(H,{type:"text",name:"username",placeholder:"Username",className:"inputbox rounded-md bg-slate-100",value:r.username,onChange:y,onKeyDown:v=>{v.code==="Space"?(v.preventDefault(),m("Space not allowed")):m(null)}})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Email address"}),e.jsx(H,{type:"email",name:"email",placeholder:"Email address",className:"inputbox rounded-md bg-slate-100",value:r.email,onChange:y,onKeyDown:v=>{v.code==="Space"?(v.preventDefault(),m("Space not allowed")):m(null)}})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Contact number"}),e.jsx(H,{type:"number",name:"contact_no",placeholder:"09XXXXXXXXX",className:"inputbox rounded-md bg-slate-100",value:r.contact_no,onChange:y,onKeyDown:v=>{v.code==="Space"?(v.preventDefault(),m("Space not allowed")):m(null)}})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"position",children:"Position"}),e.jsxs(X,{onValueChange:v=>f("position",v),children:[e.jsx(Z,{name:"position",className:"flex flex-row items-center gap-3 truncate text-md rounded-md bg-slate-100",children:e.jsx(J,{placeholder:r.position?r.position.charAt(0).toUpperCase()+r.position.slice(1):"Choose position..."})}),e.jsx(ee,{className:"bg-white font-medium text-md",children:a.length>0?a.map(v=>{if(v.title!=="super_admin")return e.jsx(V,{value:v.title,children:v.title.charAt(0).toUpperCase()+v.title.slice(1)},v.id)}):e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-6 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Change password (optional)"}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx(H,{type:N?"text":"password",name:"new_password",placeholder:"New pasword",className:"inputbox rounded-md bg-slate-100",value:i||"",onChange:y,onKeyDown:v=>{v.code==="Space"?(v.preventDefault(),m("Space not allowed")):m(null)}}),N?e.jsx(qs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:h}):e.jsx(Hs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:h})]})]}),e.jsxs("div",{className:"flex flex-col col-span-6 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Confirm new password"}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx(H,{type:j?"text":"password",name:"confirm_password",placeholder:"Confirm password",className:"inputbox rounded-md bg-slate-100",value:d,onChange:y,onKeyDown:v=>{v.code==="Space"?(v.preventDefault(),m("Space not allowed")):m(null)}}),j?e.jsx(qs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:T}):e.jsx(Hs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:T})]})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[u&&e.jsx("div",{className:"font-bold text-green-700",children:u}),o&&e.jsx("div",{className:"font-bold text-red-700",children:o}),c?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),n&&i===d&&e.jsx(_,{type:"submit",fill:n?"green":null,disabled:!n,onClick:x,children:c?"Submitting":"Edit User"})]})})]})})]})})]})},kl=({onClose:t})=>{const{selectedUser:s}=Oe(),{permissions:a,allPermissions:l,permissionChange:r,isChanged:n,isSubmitting:c,error:i,success:d,handleChange:o,handleSubmit:m}=bl(),{auth:u}=se(),x=l.filter(g=>Object.keys(g).some(h=>!g.title.includes("view".toLowerCase())&&g.title.includes("users".toLowerCase()))),y=l.filter(g=>Object.keys(g).some(h=>!g.title.includes("view".toLowerCase())&&!g.title.includes("transfer".toLowerCase())&&g.title.includes("product".toLowerCase())||g.title.includes("catalog".toLowerCase()))),f=l.filter(g=>Object.keys(g).some(h=>!g.title.includes("view".toLowerCase())&&g.title.includes("transfer".toLowerCase()))),N=l.filter(g=>Object.keys(g).some(h=>g.title.includes("view".toLowerCase())));return d&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto flex h-72 w-full flex-row divide-x",children:[e.jsxs("div",{className:"flex w-60 flex-none flex-col p-2 pt-8",children:[e.jsx("h3",{className:"ml-4 pb-1 text-xs font-semibold text-slate-500/80",children:"Roles"}),e.jsx("div",{className:"w-full",children:e.jsx(M,{variant:"ghost",className:"w-full justify-start capitalize text-slate-700 bg-slate-300/40",children:s.position.split("_").join(" ")},s.id+s.position)}),e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-slate-500/80",children:"After saving changes, affected users must log out and log back in to apply the changes."}),s.position===u.role&&e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-red-500/80",children:"You are editing your current role. Review your changes carefully."}),e.jsxs("div",{className:"mt-auto w-full space-y-3",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[d&&e.jsx("p",{className:"text-green-600",children:d}),i&&e.jsx("p",{className:"text-red-600",children:i})]}),n&&e.jsx(M,{type:"submit",className:"w-full disabled:cursor-not-allowed",disabled:!!c,onClick:m,children:c?"Saving...":"Save changes"})]})]}),e.jsx(Re,{className:"w-full",type:"auto",style:{"--border":"216 12% 84%"},children:e.jsxs("div",{className:`mx-auto flex w-full max-w-[700px] flex-1 flex-col gap-8 p-6 pt-8 ${c?"pointer-events-none opacity-50":null}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"User Management"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:x.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):x.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:`${s.position!=="admin"&&"cursor-pointer"} text-sm capitalize text-slate-700`,children:g.title.split("_").join(" ")}),e.jsx(ze,{id:g.title,name:g.title,value:g.id,disabled:s.position==="admin",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(h=>h.permission_id===g.id),onCheckedChange:h=>o(h,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Products"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:y.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):y.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(ze,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(h=>h.permission_id===g.id),onCheckedChange:h=>o(h,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Transfers"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:f.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):f.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(ze,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(h=>h.permission_id===g.id),onCheckedChange:h=>o(h,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Views"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:N.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):N.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(ze,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(h=>h.permission_id===g.id),onCheckedChange:h=>o(h,g.id)})]},g.id))})]})]})})]})})},Fn=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"User Information",children:e.jsxs(it,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(_l,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:a,title:l==="edit"?"Edit User":l==="add"?"Add User":"Edit User Role Permissions",children:e.jsxs(e.Fragment,{children:[l==="add"&&e.jsx(Sl,{onClose:a}),l==="edit"&&e.jsx(Cl,{onClose:a}),l==="editPerms"&&e.jsx(kl,{onClose:a})]})})]})})})},Fl=()=>{const t=fe(),{selectedSupplier:s,setSelectedSupplier:a}=dt(),[l,r]=p.useState({});p.useEffect(()=>{s&&r(s)},[s]);const[n,c]=p.useState({}),[i,d]=p.useState(!1),[o,m]=p.useState(!1),[u,x]=p.useState(null),[y,f]=p.useState(null),N=S=>{var F,I,q,R;if(S){const P=Object.keys(l).map(O=>({text:O})),b=P.length===3||P.length>3;if(b){const O=!(((F=l.contact_no)==null?void 0:F.length)>11||((I=l.contact_no)==null?void 0:I.length)<11);return O?[O,""]:[O,"Contact number must be 11 digits"]}else return[b,"Please fill up all fields"]}else{const P=Object.keys(n).map(O=>({text:O})),b=P.length===3||P.length>3;if(b){const O=!(((q=n.contact_no)==null?void 0:q.length)>11||((R=n.contact_no)==null?void 0:R.length)<11);return O?[O,""]:[O,"Contact number must be 11 digits"]}else return[b,"Please fill up all fields"]}},g=(S,F)=>{d(!0),f(null),x(null),F?r(I=>({...I,[S.target.name]:S.target.value})):c(I=>({...I,[S.target.name]:S.target.value}))},h=async S=>{const F=N(S);if(m(!0),F[0])return S?await C(l):await v(n);x(F[1]),m(!1),console.log(n)},j={onSuccess:async()=>{await t.invalidateQueries({queryKey:["supplier"]}),m(!1),d(!1),f("Supplier info has been edited")},onError:S=>{console.error(S),x(S.message),m(!1)}},{mutateAsync:C}=Y({mutationKey:["updateSupplier"],mutationFn:ua,...j}),T={onSuccess:async()=>{await t.invalidateQueries({queryKey:["supplier"]}),m(!1),d(!1),f("Supplier info has been added")},onError:S=>{console.error(S),x(S.message),m(!1)}},{mutateAsync:v}=Y({mutationKey:["addSupplier"],mutationFn:ha,...T});return{supplier:l,selectedSupplier:s,newSupplier:n,isChanged:i,isSubmitting:o,error:u,success:y,handleSubmit:h,handleChange:g,editSupplierMutation:C}},Il=({onClose:t,isUpdate:s})=>{const{supplier:a,newSupplier:l,isSubmitting:r,error:n,success:c,isChanged:i,handleChange:d,handleSubmit:o}=Fl();return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:m=>{m.preventDefault()},children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"name",children:"Supplier Name"}),e.jsx(H,{type:"text",name:"name",placeholder:"Supplier Name",value:s?a.name||"":l.name||"",className:"inputbox rounded-md bg-slate-100",onChange:m=>d(m,s),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"contact_no",children:"Supplier Contact Number"}),e.jsx(H,{type:"text",name:"contact_no",placeholder:"Supplier Contact Number",className:"inputbox rounded-md bg-slate-100",value:s?a.contact_no||"":l.contact_no||"",onChange:m=>d(m,s),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"address",children:"Supplier Address"}),e.jsx(H,{type:"text",name:"address",placeholder:"Supplier Address",className:"inputbox rounded-md bg-slate-100",value:s?a.address||"":l.address||"",onChange:m=>d(m,s),required:!0})]})]}),e.jsx("div",{className:"flex flex-col mt-4 gap-5",children:e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),n&&e.jsx("div",{className:"font-bold text-red-700",children:n}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:i?"green":"default",disabled:!i,onClick:()=>o(s),children:r?"Submitting":s?"Edit Supplier":"Add Supplier"})]})})]})})})]})})},Pl=({openModal:t})=>{const{suppliers:s,isFetching:a,progress:l,setSelectedSupplier:r}=dt(),n=()=>{t({},"add")},c=d=>{r(d),t(d,"edit")},i=[{accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:d})=>e.jsx("div",{className:"text-center",children:e.jsxs(_,{onClick:()=>d.toggleSorting(d.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row ml-auto mr-auto items-center",children:["NAME ",d.getIsSorted()==="asc"?e.jsx(D,{}):d.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.name})},{accessorKey:"contact_no",header:()=>e.jsx("div",{className:"text-center",children:"CONTACT NUMBER"}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.contact_no})},{accessorKey:"address",header:()=>e.jsx("div",{className:"text-center",children:"ADDRESS"}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.address})},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"ACTION"}),cell:({row:d})=>{const o=d.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(_,{fill:"empty",textColor:"black",onClick:()=>c(o),className:"flex flex-row items-center gap-2",children:[e.jsx(Us,{})," Edit"]})})}}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:s,columns:i,filterWhat:"address",dataType:"Supplier",openModal:n,isLoading:a})})},In=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Supplier",children:e.jsxs(pa,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Pl,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:a,title:l==="edit"?"Edit Supplier":"Add Supplier",children:e.jsx(e.Fragment,{children:e.jsx(Il,{onClose:a,isUpdate:l==="edit"})})})]})})})},Al=({handleEditProduct:t,handleDeleteProduct:s})=>[{accessorKey:"serial_no",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Serial Number"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{id:"name",accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"notes",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Notes"})},{id:"actions",cell:({row:l})=>{const r=l.original;return e.jsx("div",{className:"flex flex-row justify-end text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>t(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2.25})}),e.jsx("span",{className:"font-medium",children:"Edit"})]}),e.jsxs(B,{onClick:()=>s(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-red-50 hover:text-red-700 focus:bg-red-50 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ft,{size:16,strokeWidth:2.25})}),e.jsx("span",{className:"font-medium",children:"Delete"})]})]})]})})},enableGlobalFilter:!1}],Tl=({handleProdPriceDetails:t,handleEditProdPrice:s})=>[{id:"name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"inventory_product.inventory.code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Inventory"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Capital"}),cell:({row:l})=>{const r=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:l.original.capital_price?r:"—"})})}},{accessorKey:"markup_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Markup"}),cell:({row:l})=>{const r=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.markup_price||0),n=ce(l.original.markup_price/l.original.capital_price*100,{precision:3}).value;return e.jsxs("div",{className:"flex items-center uppercase",children:[e.jsx("span",{children:r}),e.jsxs("span",{className:"text-gray-500",children:[" (",n,"%)"]})]})}},{accessorKey:"sale_discount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Discount"}),cell:({row:l})=>{const r=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.sale_discount||0);return e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:l.original.on_sale?r:e.jsx("div",{className:"group relative flex w-fit items-center",children:e.jsxs(Qe,{children:[e.jsx(Ye,{children:e.jsx(fs,{size:20,strokeWidth:2,className:"text-gray-700"})}),e.jsx(Ge,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:"Not on sale"})})]})})})})}},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Price"}),cell:({row:l})=>{const r=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:l.original.price?r:"—"})})}},{accessorKey:"inventory_product.remaining_stocks_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Remaining"}),cell:({row:l})=>{const r=l.original.inventory_product.remaining_stocks_count??0,n=l.original.inventory_product.stocks_count*.2,c=l.original.inventory_product.stocks_count*.5;return e.jsxs(Qe,{children:[e.jsx(Ye,{children:e.jsx("span",{className:`${n>=r?"font-bold text-red-700":c>=r?"font-semibold text-amber-700":""}`,children:r})}),e.jsx(Ge,{children:n>=r?"Remaining stocks are low!":c>=r?"Remaining stocks are below 50%":"Remaining stocks are above 50%"})]})}},{id:"actions",cell:({row:l})=>{const r=l.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>t(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>s(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]})]})]})})},enableGlobalFilter:!1}],Dl=({openModal:t})=>{const{auth:s}=se(),{data:a,isLoading:l,setSelectedProduct:r}=zs(),n=()=>{t({},"add")},c=d=>{r(d),t(d,"edit")},i=d=>{r(d),t(d,"delete")};return e.jsx(e.Fragment,{children:e.jsx(te,{columns:(s==null?void 0:s.role)==="super_admin"||(s==null?void 0:s.role)==="admin"?Al({handleEditProduct:c,handleDeleteProduct:i}):Ja,data:a.sort((d,o)=>o.id-d.id),filterWhat:"name",dataType:"Product",openModal:n,isLoading:l})})},zl=({openModal:t,isModalOpen:s,filterWarehouse:a})=>{const{data:l,isLoading:r,setSelectedProductPrice:n}=js(),c=d=>{n(d),t(d,"details")},i=d=>{n(d),t(d,"edit")};return e.jsx(e.Fragment,{children:e.jsx(gs,{children:e.jsx(te,{columns:Tl({handleProdPriceDetails:c,handleEditProdPrice:i}),data:a?l.filter(d=>d.warehouse.id===a).sort((d,o)=>{let m=new Date(d.updated_at??d.created_at);return new Date(o.updated_at??o.created_at).getTime()-m.getTime()}):l.sort((d,o)=>{let m=new Date(d.updated_at??d.created_at);return new Date(o.updated_at??o.created_at).getTime()-m.getTime()}),filterWhat:"name",dataType:"Listing",isLoading:r})})})},El=()=>{const{selectedProductPrice:t}=js();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Unit"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.inventory_product.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Inventory"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.inventory_product.inventory.code})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Capital price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup percent"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[ce(t.markup_price/t.capital_price*100,{precision:3}).value,"%"]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.markup_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Cost"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.cost)})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sale discount"}),e.jsx("p",{className:"text-sm",children:t.on_sale===1?Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.sale_discount):"—"}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex flex-none flex-row items-center justify-end gap-1 pb-[0.1rem] pr-1",children:[t.on_sale===1?e.jsx(Ee,{size:14,strokeWidth:3.5,className:"text-green-600"}):e.jsx(fs,{size:14,strokeWidth:3.5,className:"text-gray-600"}),e.jsx("div",{className:"text-xs font-semibold leading-4 text-gray-900",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.price)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.created_by.firstname+" "+t.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(t.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(t.updated_at)})]})]})]})})},us=(t,s,a=2)=>ce(s/t*100,{precision:a}).value,Ps=(t,s,a=2)=>ce(ce(t).multiply(s/100),{precision:a}).value,hs=(t,s,a=2)=>ce(ce(t).add(s),{precision:a}).value,Wt=(t,s,a=2)=>ce(ce(t).subtract(s),{precision:a}).value,Wl=({onClose:t})=>{const{value:s,handleChange:a,handleSubmit:l}=It(),{selectedProduct:r}=zs(),[n,c]=p.useState(!1),[i,d]=p.useState(null),[o,m]=p.useState(),u=(x,y,f,N)=>{f.test(x.target.value)?(x.target.value=x.target.value,a(y,x.target.value),m(void 0)):m({type:y,error:N})};return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async x=>{c(!n),x.preventDefault(),l({action:"update",id:r.id,data:s}).then(()=>{c(!1),Q.success("Product updated successfully."),t()}).catch(y=>{c(!1),y.response.data.message?Q.error(y.response.data.message):Q.error("Failed to update product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"serial_no",className:"text-sm font-bold text-gray-600",children:"Serial number"}),e.jsx(k,{id:"serial_no",name:"serial_no",type:"text",maxLength:100,required:!0,placeholder:"Serial number...",value:s.serial_no!==void 0?s.serial_no:(r==null?void 0:r.serial_no)||"",onChange:x=>{u(x,"serial_no",/^[a-zA-Z0-9-]{0,100}$/,"Must only contain A-Z, 0-9, and -")}}),e.jsx("span",{hidden:!(o&&o.type==="serial_no"),className:"text-xs font-bold text-red-600",children:o==null?void 0:o.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"name",className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx(k,{id:"name",name:"name",type:"text",maxLength:100,required:!0,placeholder:"Product name...",value:s.name!==void 0?s.name:(r==null?void 0:r.name)||"",onChange:x=>{u(x,"name",/^[0-9a-zA-Z\s\-.,/+:_=]{0,100}$/,"Must only contain alphanumeric and limited special characters")}})," ",e.jsx("span",{hidden:!(o&&o.type==="name"),className:"max-w-[225px] text-xs font-bold text-red-600",children:o==null?void 0:o.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"brand",className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx(k,{id:"brand",name:"brand",type:"text",maxLength:100,required:!0,placeholder:"Brand...",value:s.brand!==void 0?s.brand:(r==null?void 0:r.brand)||"",onChange:x=>{u(x,"brand",/^[0-9a-zA-Z\s\-.,/+:_=]{0,100}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(o&&o.type==="brand"),className:"max-w-[225px] text-xs font-bold text-red-600",children:o==null?void 0:o.error})]}),e.jsx("hr",{className:"col-span-12 my-3 border-t border-slate-200"}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"size",className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx(k,{id:"size",name:"size",type:"text",maxLength:100,required:!0,placeholder:"e.g. medium...",value:s.size!==void 0?s.size:(r==null?void 0:r.size)||"",onChange:x=>{u(x,"size",/^[0-9a-zA-Z\s\-.,/+:_="']{0,100}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(o&&o.type==="size"),className:"max-w-[225px] text-xs font-bold text-red-600",children:o==null?void 0:o.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"color",className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx(k,{id:"color",name:"color",type:"text",maxLength:40,required:!0,placeholder:"e.g. white...",value:s.color!==void 0?s.color:(r==null?void 0:r.color)||"",onChange:x=>{u(x,"color",/^[0-9a-zA-Z\s\-.,/+:_="']{0,40}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(o&&o.type==="color"),className:"max-w-[225px] text-xs font-bold text-red-600",children:o==null?void 0:o.error})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(k,{id:"notes",name:"notes",type:"text",placeholder:"Type product notes here...",defaultValue:s.notes!==void 0?s.notes:(r==null?void 0:r.notes)||"",onBlur:x=>a("notes",x.target.value)})]})]}),e.jsxs("div",{className:"ml-auto flex flex-row gap-4 whitespace-nowrap",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:n||o!==void 0||s.name===""||s.serial_no==="",className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Applying...":"Apply changes"})]}),i&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:i})})]})})})},Ml=({onClose:t})=>{const{selectedProduct:s,setSelectedProduct:a,isDeletable:l}=zs(),{handleDeleteProduct:r}=It();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[42rem] max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"col-span-8 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:(s==null?void 0:s.brand)||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.color})]}),(s==null?void 0:s.notes)&&e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.notes})]})]}),e.jsx("hr",{className:"h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("p",{className:"max-w-[50%] text-sm",children:l!==void 0?l?"This product can be deleted. Are you sure you want to proceed? This action cannot be undone.":"This product cannot be deleted because it is associated with existing product price and inventory items.":"Checking if the product can be deleted..."}),e.jsxs("div",{className:"mt-auto flex-none space-x-4",children:[l&&e.jsx(_,{className:"flex-1 cursor-pointer bg-red-600 py-2 text-sm font-bold text-white hover:bg-red-700 disabled:pointer-events-none disabled:opacity-50",disabled:!l,onClick:()=>{s&&r(s.id).then(()=>{Q.success("Product deleted successfully."),a(void 0),t()}).catch(()=>{Q.error("An error occurred while deleting the product.")})},children:"Yes, delete"}),e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:l?"No, cancel":"Close"})]})]})]})})},Pn=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Products",children:e.jsxs(ot,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Dl,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:a,closeOnOverlayClick:l==="delete",title:l==="add"?"Add Product":l==="edit"?"Edit Product":l==="delete"?"Delete Product":"",children:e.jsxs(e.Fragment,{children:[l==="add"&&e.jsx(el,{onClose:a}),l==="edit"&&e.jsx(Wl,{onClose:a}),l==="delete"&&e.jsx(Ml,{onClose:a})]})})]})})})},Ol=({onClose:t})=>{var N,g;se();const{selectedProductPrice:s}=js(),{value:a,handleChange:l,handleSubmit:r}=Ls(),[n,c]=p.useState(!1),[i,d]=p.useState(null),[o,m]=p.useState(us(s.capital_price,s.markup_price,3)),[u,x]=p.useState(s.markup_price),y=h=>{const j=Number(h.target.value);m(j),x(Ps(s.capital_price,j))},f=h=>{const j=ce(h.target.value).value;x(j),m(us(s.capital_price,j,3))};return p.useEffect(()=>{l("markup_price",u),l("cost",hs(s.capital_price,u))},[o,u]),p.useEffect(()=>{l("price",Wt(a.cost??s.cost,a.sale_discount??s.sale_discount))},[a.cost,a.sale_discount]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async h=>{c(!n),h.preventDefault(),r({action:"update",id:s.id,data:a}).then(()=>{c(!n),Q.success("Product price edited successfully"),t()}).catch(()=>{c(!n),d("Failed to add product listing"),Q.error("Failed to add product listing")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-4 gap-y-5 font-medium text-gray-700",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:s.inventory_product.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Inventory"}),e.jsx("p",{className:"text-sm",children:s.inventory_product.inventory.code})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(k,{id:"capital_price",name:"capital_price",type:"number",disabled:!0,className:"pl-7",value:ce(s.capital_price).value}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_percent",className:"text-sm font-bold text-gray-600",children:"Markup percent"}),e.jsx(k,{id:"markup_percent",name:"markup_percent",type:"number",inputMode:"numeric",min:0,step:.001,required:!0,value:o||"",onChange:y,onBlur:h=>{h.target.value=ce(o,{precision:3}).value.toString()}}),e.jsx("span",{className:"absolute bottom-0 right-0 mr-2 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"%"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_price",className:"text-sm font-bold text-gray-600",children:"Markup price"}),e.jsx(k,{id:"markup_price",name:"markup_price",type:"number",min:0,step:.01,className:"pl-7",value:u||"",onChange:f,onBlur:h=>{h.target.value=Number(u).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"cost",className:"text-sm font-bold text-gray-600",children:"Cost"}),e.jsx(k,{id:"cost",name:"cost",type:"number",min:0,required:!0,className:"pl-7",readOnly:!0,value:hs(s.capital_price,u).toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"sale_discount",className:"text-sm font-bold text-gray-600",children:"Sale discount"}),e.jsx(k,{id:"sale_discount",name:"sale_discount",type:"number",inputMode:"numeric",min:0,step:.01,max:a.cost!==void 0?a.cost:s.cost,disabled:a.on_sale===void 0?s.on_sale===0:a.on_sale===0,required:!0,className:"pl-7",value:a.sale_discount??((N=s.sale_discount)==null?void 0:N.toFixed(2))??"",onChange:h=>{l("sale_discount",ce(h.target.value).value)},onBlur:h=>{h.target.value=Number(a.sale_discount!==void 0?a.sale_discount:s.sale_discount).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"}),e.jsxs("div",{className:"absolute right-0 top-1/2 mr-2 flex flex-none translate-y-1/4 flex-row items-center justify-start gap-2",children:[e.jsx(k,{name:"on_sale",id:"on_sale",type:"checkbox",checked:a.on_sale===void 0?s.on_sale===1:a.on_sale===1,className:"h-4 w-fit",onChange:h=>{const j=document.getElementById("sale_discount");l("on_sale",h.target.checked?1:0),!h.target.checked&&(l("sale_discount",0),j&&(j.value="0.00"))}}),e.jsx(w,{htmlFor:"on_sale",className:"text-xs font-bold text-slate-700",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"price",className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx(k,{id:"price",name:"price",type:"number",min:0,step:.01,required:!0,readOnly:!0,className:"pl-7",value:((g=a.price)==null?void 0:g.toFixed(2))||s.price.toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm",children:de(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm",children:de(s.updated_at)})]})]}),e.jsx("div",{className:"col-span-12 flex w-full justify-between whitespace-nowrap pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:n,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Applying changes...":"Apply changes"})]})}),i&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:i})})]})})})},An=()=>{const{warehouses:t}=Ke(),[s,a]=p.useState(0),{isOpen:l,openModal:r,closeModal:n}=xe(),[c,i]=p.useState(""),d=(o,m)=>{i(m),r()};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Product Listings",children:e.jsx(ot,{children:e.jsxs(at,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(X,{defaultValue:"0",onValueChange:o=>a(Number(o)),children:[e.jsx(Z,{className:"w-[300px] text-sm font-medium",children:e.jsx(J,{placeholder:"All"})}),e.jsxs(ee,{className:"text-sm font-medium capitalize",children:[e.jsx(V,{value:"0",children:"All"},"all"),t.map(o=>e.jsxs(V,{value:o.id.toString(),children:[o.name," (",o.code,")"]},o.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(zl,{openModal:d,isModalOpen:l,filterWarehouse:s>0?s:void 0})})]}),e.jsx(pe,{title:c==="details"?"Listing Details":c==="edit"?"Edit Listing":"",isOpen:l,onClose:n,closeOnOverlayClick:c==="details",children:e.jsxs(e.Fragment,{children:[c==="details"&&e.jsx(El,{}),c==="edit"&&e.jsx(Ol,{onClose:n})]})})]})})})})},Rl=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:l,setSelectedTransfer:r}=Pe();se(),Te();function n(u){window.api.transferSend({transfer:u,products:a.filter(x=>x.transfer_id===u.id)})}const c=u=>{r(u),t(u,"details")},i=u=>{r(u),t(u,"edit")},d=u=>{r(u),t(u,"products")},o=()=>{t({},"add")},m=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["TRANSFER CODE ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>e.jsx("div",{className:"text-center",children:u.original.code?u.original.code:"N/A"})},{accessorKey:"source",header:()=>e.jsx("div",{className:"text-center",children:"SOURCE-DESTINATION"}),cell:({row:u})=>{const x=u.original.source,y=u.original.destination;return e.jsxs("div",{className:"text-center",children:[x.code,"-",y.code]})}},{id:"transfer_products",header:()=>e.jsx("div",{className:"text-center",children:"PRODUCTS ADDED?"}),cell:({row:u})=>e.jsx("div",{className:"flex justify-center",children:a.filter(x=>x.transfer_id===u.original.id).length>0?e.jsx(Ee,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx($e,{size:20,strokeWidth:2,className:"text-red-600"})})},{accessorKey:"transfer_status",sortingFn:"text",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["TRANSFER STATUS ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>e.jsx("div",{className:"text-center",children:u.original.transfer_status?u.original.transfer_status:"N/A"})},{accessorKey:"transfer_schedule",sortingFn:"datetime",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["SCHEDULE ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>{const x=u.getValue("transfer_schedule");if(x.toString()!=="0000-00-00"){const y={year:"numeric",month:"long",day:"numeric"},f=new Date(x).toLocaleDateString([],y);return e.jsx("div",{className:"text-center",children:f})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"date_received",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["DATE RECEIVED ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>{const x=u.getValue("date_received");if(x){const y={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},f=new Date(x).toLocaleDateString([],y);return e.jsx("div",{className:"text-center",children:f})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"approval_status",header:()=>e.jsx("div",{className:"text-center",children:"APPROVAL STATUS"}),cell:({row:u})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:u.original.approval_status.toLowerCase()==="approved"?e.jsx(Ee,{size:20,strokeWidth:2,className:"text-green-600"}):u.original.approval_status.toLowerCase()==="rejected"?e.jsx($e,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(Be,{size:20,strokeWidth:2,className:"text-amber-500"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:u})=>{const x=u.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>c(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Details"})]}),e.jsxs(B,{onClick:()=>i(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit Transfer"})]}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>d(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:x.transfer_status!="arrived"&&x.approval_status!="rejected"?e.jsx(Se,{size:16,strokeWidth:2.25}):e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Products"})]}),x.transfer_status=="enroute"||x.transfer_status=="arrived"&&e.jsxs(B,{onClick:()=>n(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Et,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Print Transfer"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:s,columns:m,filterWhat:"approval_status",dataType:"Transfer",openModal:o,isLoading:l})})},Kl=({onClose:t})=>{const{selectedTransfer:s}=Pe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Source"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.source.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.destination.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer schedule"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_schedule.toString()==="0000-00-00 00:00:00"?"N/A":de(s.transfer_schedule)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Received by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.received_by?s.received_by.firstname+" "+s.received_by.lastname:"N/A"})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Date received"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.date_received?de(s.date_received):"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approved_by?s.approved_by.firstname+" "+s.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(s.updated_at)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.notes?s.notes:"N/A"})]})})]})})},Ul=({onClose:t})=>{var f,N,g;const{transfer:s,lastId:a,isChanged:l,isSubmitting:r,error:n,success:c,dateDisplay:i,handleSubmit:d,handleChange:o,handleChangeSelect:m,handleChangeDateTime:u}=nl(),{warehouses:x}=Ke(),{auth:y}=se();return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:h=>{h.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3 justify-center",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer ID"}),e.jsx(H,{name:"id",value:a,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Created by"}),e.jsx(H,{name:"created_by",placeholder:"User ID",value:y.user.firstname+" "+y.user.lastname,disabled:!0,readOnly:!0})]})]}),e.jsxs("div",{className:"flex flex-row grid-cols-12 gap-3 justify-center",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Source"}),e.jsxs(X,{onValueChange:h=>m("source",Number(h)),required:!0,name:"source",children:[e.jsx(Z,{name:"source",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:"Choose source location..."})}),e.jsx(ee,{className:"bg-white font-medium",children:x.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):x.map((h,j)=>e.jsxs(V,{value:h.id.toString(),className:"text-sm font-medium text-slate-700",children:[h.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+h.code+" • "+h.location})]},j))})]})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Destination"}),e.jsxs(X,{name:"destination",disabled:!0,children:[e.jsx(Z,{name:"destination",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:s.destination?e.jsxs(e.Fragment,{children:[(f=x[s.destination-1])==null?void 0:f.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","•"," ",(N=x[s.destination-1])==null?void 0:N.code," ","•"," ",(g=x[s.destination-1])==null?void 0:g.location]})]}):"Choose source location"})}),e.jsx(ee,{className:"bg-white font-medium",children:x.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):x.map((h,j)=>e.jsxs(V,{value:h.id.toString(),className:"text-sm font-medium text-slate-700",children:[h.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+h.code+" • "+h.location})]},h.code))})]})]})]}),e.jsxs("div",{className:"flex flex-col grid-cols-12 justify-center gap-1",children:[e.jsx(w,{htmlFor:"date_received",className:"text-sm font-bold uppercase",children:"Schedule date"}),e.jsxs(Ce,{children:[e.jsx(ke,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(M,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ls,{size:18,strokeWidth:1.5}),s.transfer_schedule?s.transfer_schedule.split(" ")[0]:"Choose date..."]})}),e.jsx(Fe,{className:"w-auto p-0",children:e.jsx(Xe,{mode:"single",initialFocus:!0,required:!0,onDayClick:h=>{const j=new Date(h),C=`${j.getFullYear()}-${(j.getMonth()+1).toString().padStart(2,"0")}-${j.getDate().toString().padStart(2,"0")}`;m("transfer_schedule",C)},selected:s.transfer_schedule?new Date(s.transfer_schedule.split(" ")[0]):new Date})})]})]}),e.jsx("div",{className:"flex flex-row gap-3 grid-cols-12",children:e.jsxs("div",{className:"flex flex-col gap-1 col-span-12 w-full",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Notes:"}),e.jsx(Ns,{name:"notes",onChange:o,value:s.notes||"",placeholder:"Add notes here...."})]})}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),n&&e.jsx("div",{className:"font-bold text-red-700",children:n}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),l&&i!=null&&e.jsx(_,{type:"submit",fill:l?"green":null,disabled:!l,onClick:d,children:r?"Submitting":"Add Transfer"})]})})]})})]})})})},Ll=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:l,selectedTransfer:r,setSelectedTransfer:n,selectedProduct:c,setSelectedProduct:i,addProd:d,setAddProd:o}=Pe();se();const m=a.filter(f=>f.transfer_id===r.id),u=f=>{i(f),o(!1),t(f,"edit")},x=()=>{o(!0),t({},"add")},y=[{id:"select",header:({table:f})=>e.jsx("input",{type:"checkbox",checked:f.getIsAllPageRowsSelected(),onChange:N=>f.toggleAllPageRowsSelected(!!N.target.checked),"aria-label":"Select all"}),cell:({row:f})=>e.jsx("input",{type:"checkbox",checked:f.getIsSelected(),onChange:N=>f.toggleSelected(!!N.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:f})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>f.toggleSorting(f.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["PRODUCT NAME ",f.getIsSorted()==="asc"?e.jsx(D,{}):f.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:f})=>e.jsx("div",{className:"flex flex-row text-xs justify-center font-normal uppercase",children:f.original.product.name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:f})=>e.jsx("div",{className:"text-center",children:f.original.total_quantity})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"text-center",children:"UNIT"}),cell:({row:f})=>e.jsx("div",{className:"text-center",children:f.original.unit})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:f})=>{const N=f.original;return r.transfer_status!="arrived"&&r.approval_status!="rejected"&&e.jsx("div",{className:"flex flex-row text-xs justify-center font-normal uppercase",children:e.jsx(_,{fill:"yellow",textColor:"black",onClick:()=>u(N),children:"Edit Product"})})}}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:m,columns:y,filterWhat:"product_name",dataType:"Transfer Products",openModal:r.transfer_status!="arrived"&&r.approval_status!="rejected"?x:void 0,isLoading:l})})},Zs=({onClose:t})=>{const{addProd:s,selectedProduct:a}=Pe(),{product:l,allProducts:r,allInventoryProducts:n,inventoryID:c,invCode:i,prodName:d,filteredProductsSrc:o,filteredInventoriesSrc:m,quantityLimit:u,damagedCount:x,isChanged:y,isSubmitting:f,error:N,success:g,handleSubmit:h,handleChange:j,handleChangeSelect:C}=il(),T=l.capital_price?l.capital_price:0,v=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(T);g&&setTimeout(()=>{t()},1e3);const[S,F]=p.useState(s?i:"Loading...");return p.useEffect(()=>{m.length>0&&!s&&l.source_inventory&&F(m.filter(I=>I.id===l.source_inventory)[0].code)},[l.source_inventory,m]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:I=>{I.preventDefault()},children:e.jsxs("div",{className:"flex max-w-6xl flex-col gap-5",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-3 justify-center",children:[e.jsxs("div",{className:"flex flex-col col-span-3 gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer Product"}),e.jsx(H,{name:"id",value:l.id,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer ID"}),e.jsx(H,{name:"created_by",placeholder:"User ID",value:l.transfer_id,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-6 gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Inventory source:"}),e.jsxs(X,{onValueChange:I=>C("inventory_id",I),required:!0,name:"inventory_id",value:S!="Loading..."?s?i:S:"",children:[e.jsx(Z,{name:"inventory_id",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:s?i||"Choose inventory...":S})}),e.jsx(ee,{className:"bg-white font-medium",children:m.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):m.map((I,q)=>e.jsx(V,{value:I.code,className:"text-sm font-medium text-slate-700",children:I.code},q))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-3 justify-center",children:[e.jsxs("div",{className:"flex flex-col col-span-6 gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Product to transfer:"}),e.jsxs(X,{onValueChange:I=>C("product_id",Number(I.split("-")[0]),Number(I.split("-")[1])),required:!0,name:"product_id",disabled:!c,children:[e.jsx(Z,{name:"product_id",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:s?c?"Choose product...":"Select inventory first":S!="Loading..."?d==""?"Choose product...":d:"Loading..."})}),e.jsx(ee,{className:"bg-white font-medium",children:o.length<=0?!s&&S!="Loading..."?e.jsx("div",{className:"flex h-12 w-full items-center justify-center px-2",children:"No items in selected inventory."}):e.jsx("div",{className:"px-2",children:" Loading... "}):o.map((I,q)=>e.jsx(V,{value:I.product.id?I.product.id.toString()+"-"+q.toString():"",className:`text-sm font-medium text-slate-700
												${!s&&I.product.id==a.product.id&&"selected"}`,children:I.product.name},q))})]})]}),e.jsxs("div",{className:"flex flex-col col-span-6 gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Capital Price:"}),e.jsx(H,{name:"capital_price",type:"string",value:v,onChange:j,disabled:!0,readOnly:!0})]})]}),e.jsxs("div",{className:"flex flex-row gap-3 justify-center",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"TOTAL QUANTITY"}),e.jsx(H,{name:"total_quantity",type:"string",value:l.total_quantity||"",placeholder:`Available stocks: ${u}`,onChange:j,disabled:!l.capital_price,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"UNIT"}),e.jsx(H,{name:"unit",type:"string",value:l.unit||"",placeholder:"box, pieces, etc.",disabled:!0,readOnly:!0})]}),l.total_quantity!=0&&x!=0&&l.total_quantity==u&&e.jsxs("div",{className:"grid content-end mb-2 group",children:[e.jsx(Tt,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsxs("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-2 rounded-md bg-gray-800 px-1 text-sm text-gray-100 transition-opacity opacity-0 group-hover:opacity-100",children:["Some damaged goods (",x," ",l.unit,") are included in the transfer."]})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[g&&e.jsx("div",{className:"font-bold text-green-700",children:g}),N&&e.jsx("div",{className:"font-bold text-red-700",children:N}),f?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),y&&e.jsx(_,{type:"submit",fill:y?"green":null,disabled:!y,onClick:h,children:f?"Submitting":s?"Add Product":"Edit Product"})]})})]})})]})})})},Mt=({onClose:t})=>{const{isOpen:s,openModal:a,closeModal:l}=xe(),[r,n]=p.useState("");se();const c=(i,d)=>{a(),n(d)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx(Ll,{openModal:c})}),e.jsx(pe,{title:r==="edit"?"Edit Transfer Product":"Add Transfer Product",isOpen:s,onClose:l,children:e.jsxs(e.Fragment,{children:[r==="edit"&&e.jsx(Zs,{onClose:l}),r==="add"&&e.jsx(Zs,{onClose:l})]})})]})},Ot=({onClose:t})=>{var F,I,q,R,P,b,O,W,K,ae;const{transfer:s,lastId:a,isChanged:l,isSubmitting:r,error:n,success:c,dateDisplay:i,dateDisplayArrived:d,handleSubmit:o,handleChange:m,handleChangeSelect:u,handleChangeDateTime:x}=cl(),{selectedTransfer:y,transferProducts:f}=Pe(),{warehouses:N}=Ke(),{users:g}=fa(),{auth:h}=se();p.useEffect(()=>{console.log(s)},[s]);const j=e.jsxs(e.Fragment,{children:[e.jsx(X,{onValueChange:A=>u("approval_status",A),name:"approval_status",value:s.approval_status||"",children:e.jsxs(Z,{name:"approval_status",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:[e.jsx(J,{placeholder:s.approval_status?s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1):"Choose status..."}),e.jsxs(ee,{className:"bg-white font-medium",children:[e.jsx(V,{value:"pending",className:"text-sm font-medium text-slate-700",children:"Pending"},"pending"),e.jsx(V,{value:"approved",className:"text-sm font-medium text-slate-700",children:"Approved"},"approved"),e.jsx(V,{value:"rejected",className:"text-sm font-medium text-slate-700",children:"Rejected"},"rejected")]})]})}),f.filter(A=>A.transfer_id===s.id).length===0&&e.jsxs("div",{className:"flex align-center group",children:[e.jsx(Tt,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsx("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-7 rounded-md bg-gray-800 px-1 text-sm text-gray-100 transition-opacity opacity-0 group-hover:opacity-100",children:"No products have been added yet."})]})]}),C=e.jsxs(X,{onValueChange:A=>u("source",Number(A)),name:"source",children:[e.jsx(Z,{name:"source",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsxs(e.Fragment,{children:[(F=N[s.source-1])==null?void 0:F.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","•"," ",(I=N[s.source-1])==null?void 0:I.code," ","•"," ",(q=N[s.source-1])==null?void 0:q.location]})]})})}),e.jsx(ee,{className:"bg-white font-medium",children:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):N.map((A,le)=>e.jsxs(V,{value:A.id.toString(),className:`text-sm font-medium text-slate-700 
								${A.id===s.source&&"selected"}`,children:[A.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+A.code+" • "+A.location})]},le))})]}),T=e.jsxs(X,{onValueChange:A=>u("destination",Number(A)),name:"destination",children:[e.jsx(Z,{name:"destination",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsxs(e.Fragment,{children:[(R=N[s.destination-1])==null?void 0:R.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","•"," ",(P=N[s.destination-1])==null?void 0:P.code," ","•"," ",(b=N[s.destination-1])==null?void 0:b.location]})]})})}),e.jsx(ee,{className:"bg-white font-medium",children:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):N.map((A,le)=>e.jsxs(V,{value:A.id.toString(),className:`text-sm font-medium text-slate-700 
								${A.id===s.destination&&"selected"}`,children:[A.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+A.code+" • "+A.location})]},A.code))})]}),v=e.jsx(X,{onValueChange:A=>u("transfer_status",A),name:"transfer_status",value:s.transfer_status||"",children:e.jsxs(Z,{name:"transfer_status",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:[e.jsx(J,{placeholder:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"Choose status..."}),e.jsxs(ee,{className:"bg-white font-medium",children:[e.jsx(V,{value:"loading",className:"text-sm font-medium text-slate-700",children:"Loading"},"loading"),e.jsx(V,{value:"en route",className:"text-sm font-medium text-slate-700",children:"En route"},"en route"),e.jsx(V,{value:"arrived",className:"text-sm font-medium text-slate-700",children:"Arrived"},"arrived")]})]})}),S=e.jsxs(X,{onValueChange:A=>u("received_by",Number(A)),name:"received_by",children:[e.jsx(Z,{name:"received_by",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:g.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsx(e.Fragment,{children:s.received_by?g[Number(s.received_by)-1].firstname+" "+g[Number(s.received_by)-1].lastname:"Choose user..."})})}),e.jsx(ee,{className:"bg-white font-medium",children:g.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):g.map((A,le)=>e.jsx(V,{value:A.id.toString(),className:`text-sm font-medium text-slate-700 
								${s.received_by&&A.id===s.received_by&&"selected"}`,children:A.firstname+" "+A.lastname},le))})]});return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:A=>{A.preventDefault()},children:[e.jsxs("div",{className:"flex max-w-3xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer Code"}),e.jsx("p",{className:"text-sm",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Source"}),C]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Destination"}),T]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4 pb-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:y.created_by.firstname+" "+y.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Approval status"}),e.jsxs("p",{className:"text-sm flex flex-row gap-2",children:[((O=s.approval_status)==null?void 0:O.toLowerCase())==="approved"&&e.jsxs(e.Fragment,{children:[s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1),e.jsx(Ee,{size:20,strokeWidth:2,className:"text-green-600"})]}),((W=s.approval_status)==null?void 0:W.toLowerCase())==="rejected"&&e.jsxs(e.Fragment,{children:[s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1),e.jsx($e,{size:20,strokeWidth:2,className:"text-red-600"})]}),((K=s.approval_status)==null?void 0:K.toLowerCase())==="pending"&&h.rolePermissions.some(A=>A.permission_id===22)&&((ae=s.approval_status)==null?void 0:ae.toLowerCase())==="pending"&&j]})]}),s.approved_by&&s.approval_status!="pending"&&e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-600",children:[s.approval_status==="approved"&&"Approved by",s.approval_status==="rejected"&&"Rejected by"]}),e.jsx("p",{className:"text-sm flex flex-row",children:g.length>0?g[s.approved_by-1].firstname+" "+g[s.approved_by-1].lastname:e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]}),s.approval_status=="approved"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-8 gap-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer status"}),e.jsx("p",{className:"text-sm",children:v})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer schedule"}),e.jsx("div",{className:"text-sm",children:e.jsxs(Ce,{children:[e.jsx(ke,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(M,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ls,{size:18,strokeWidth:1.5}),s.transfer_schedule?s.transfer_schedule.split(" ")[0]:"Choose date..."]})}),e.jsx(Fe,{className:"w-auto p-0",children:e.jsx(Xe,{mode:"single",initialFocus:!0,required:!0,onDayClick:A=>{const le=new Date(A),$=`${le.getFullYear()}-${(le.getMonth()+1).toString().padStart(2,"0")}-${le.getDate().toString().padStart(2,"0")}`;u("transfer_schedule",$)},selected:s.transfer_schedule?new Date(s.transfer_schedule.split(" ")[0]):new Date})})]})})]}),s.transfer_status==="arrived"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Received by"}),e.jsx("p",{className:"text-sm",children:S})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsx("div",{className:"text-sm",children:e.jsxs(Ce,{children:[e.jsx(ke,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(M,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ls,{size:18,strokeWidth:1.5}),s.date_received?s.date_received.split(" ")[0]:"Choose date..."]})}),e.jsx(Fe,{className:"w-auto p-0",children:e.jsx(Xe,{mode:"single",initialFocus:!0,required:!0,onDayClick:A=>{const le=new Date(A),$=`${le.getFullYear()}-${(le.getMonth()+1).toString().padStart(2,"0")}-${le.getDate().toString().padStart(2,"0")}`;u("date_received",$)},selected:s.date_received?new Date(s.date_received.split(" ")[0]):new Date(s.transfer_schedule.split(" ")[0])})})]})})]})]})]})}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 w-full flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(Ns,{name:"notes",value:s.notes||"",placeholder:"Add notes here....",onChange:m})]})})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),n&&e.jsx("div",{className:"font-bold text-red-700",children:n}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:l?"green":null,disabled:!l,onClick:o,children:r?"Submitting":"Edit Transfer"})]})})]})})]})})},Tn=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Transfer",children:e.jsxs(xt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border",children:e.jsx(Rl,{openModal:n})})}),e.jsx(pe,{title:l==="details"?"Transfer Details":l==="edit"?"Edit Transfer":l==="add"?"Add Transfer":"Transfer Products",isOpen:t,onClose:a,closeOnOverlayClick:l==="details",children:e.jsxs(e.Fragment,{children:[l==="details"&&e.jsx(Kl,{onClose:a}),l==="edit"&&e.jsx(Ot,{onClose:a}),l==="add"&&e.jsx(Ul,{onClose:a}),l==="products"&&e.jsx(Mt,{onClose:a})]})})]})})})},ql=()=>{const t=fe(),[s,a]=p.useState({}),l=(i,d)=>{a(o=>({...o,[i]:d}))},r=async i=>(console.log("Submitting: ",i),await c(i)),n={onSuccess:async()=>{await t.invalidateQueries({queryKey:["customers"]}),a({})},onError:i=>{console.error("Error adding customer:",i.message)}},{mutateAsync:c}=Y({mutationKey:["addCustomer"],mutationFn:ja,...n});return{value:s,setValue:a,handleChange:l,handleSubmit:r}},Hl=({onClose:t})=>{const{value:s,setValue:a,handleChange:l,handleSubmit:r}=ql(),{setSelectedCustomer:n}=Ue();p.useEffect(()=>{a(m=>({...m}))},[]);const[c,i]=p.useState(!1),[d,o]=p.useState(null);return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async m=>{i(!c),m.preventDefault();const u=await r(s);(u==null?void 0:u.status)===201?(i(!c),n(u.data.data),t(),console.log(u.data)):(i(!c),o("Failed to add inventory"))},children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-2 ",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"firstname",children:"First Name"}),e.jsx(k,{id:"firstname",name:"firstname",required:!0,type:"text",placeholder:"First Name",onChange:m=>l("firstname",m.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"lastname",children:"Last Name"}),e.jsx(k,{id:"lastname",name:"lastname",required:!0,type:"text",placeholder:"Last Name",onChange:m=>l("lastname",m.target.value)})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"address",children:"Address"}),e.jsxs("div",{className:"relative flex flex-col ",children:[e.jsx(ml,{color:"#2D2D2D",className:"absolute top-0 translate-x-3 translate-y-1/2",size:20}),e.jsx(k,{id:"address",name:"address",type:"text",placeholder:"Address",defaultValue:"",className:"pl-10",onChange:m=>l("address",m.target.value),required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"contact_no",children:"Contact Number"}),e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx(ul,{color:"#2D2D2D",className:"absolute top-0 translate-x-3 translate-y-1/2",size:20}),e.jsx(k,{required:!0,id:"contact_no",name:"contact_no",type:"text",inputMode:"numeric",placeholder:"Contact Number",className:"pl-10",defaultValue:"",max:11,maxLength:11,onChange:m=>l("contact_no",m.target.value)})]})]})]}),e.jsxs("div",{className:"flex flex-row justify-end gap-4",children:[e.jsx(_,{onClick:()=>t(),type:"reset",className:'hover:text-white"  py-2 text-sm font-bold text-slate-700',children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:c||Object.keys(s).length<=2,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Submitting...":"Add Customer"})]}),d&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-semibold text-red-600",children:d})})]})})})},Vl=({})=>{const{data:t,isLoading:s,selectedCustomer:a,setSelectedCustomer:l,openSearchCustomer:r,setOpenSearchCustomer:n,setSearchFullName:c}=Ue(),[i,d]=p.useState(""),[o,m]=p.useState(""),{isOpen:u,closeModal:x,openModal:y}=xe();function f(){c(i)}return p.useEffect(()=>{if(o!==""){const N=t.find(g=>g.id===parseInt(o));N&&l(N)}},[o]),e.jsxs(e.Fragment,{children:[e.jsx(ns,{open:r,onOpenChange:n,children:e.jsxs(cs,{children:[e.jsx(is,{className:"items-start",children:e.jsx(ds,{children:"Search Customer"})}),e.jsx("form",{className:"flex flex-col",onSubmit:N=>{N.preventDefault(),f()},children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(k,{placeholder:"Enter customer name",onChange:N=>{d(N.target.value)},className:"w-[90%]"}),e.jsx(M,{type:"submit",size:"icon",children:s?e.jsx(G,{className:"animate-spin"}):e.jsx(mt,{size:18})})]})}),t.length!==0&&!s&&e.jsx(e.Fragment,{children:e.jsxs(X,{onValueChange:m,children:[e.jsx(Z,{className:"h-15 text-left ",children:e.jsx(J,{placeholder:"Select Customer"})}),e.jsx(ee,{children:e.jsx(ga,{children:t.map((N,g)=>e.jsx(V,{value:N.id.toString(),onClick:()=>{d("")},children:e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("span",{className:"w-full font-bold",children:[N.firstname," ",N.lastname]}),e.jsxs("span",{className:"w-full",children:[N.contact_no," •"," ",N.address]})]})},g))})})]})}),e.jsxs(Na,{className:"flex flex-row gap-2",children:[e.jsx(M,{variant:"outline",className:"flex-1 font-medium",onClick:()=>{n(!1),y()},children:"Add new customer"}),e.jsx(M,{className:"flex-1",onClick:()=>{n(!1)},children:"Close"})]})]})}),e.jsx(pe,{isOpen:u,onClose:x,title:"Add Customer",children:e.jsx(Hl,{onClose:x})})]})},Rt=()=>{const t=fe(),[s,a]=p.useState({}),l=(o,m)=>{a(u=>({...u,[o]:m}))},r=o=>{a(m=>({...m,...o}))},n={onSuccess:async()=>{await t.invalidateQueries({queryKey:["invoices"]}),a({}),Q.success("Submitted successfully!",{autoClose:3e3})},onError:o=>{console.error("Invoices Data failed",o.message)}},{mutateAsync:c}=Y({mutationKey:["addInvoice"],mutationFn:ya,...n}),{mutateAsync:i}=Y({mutationKey:["updateInvoice"],mutationFn:va,...n}),{mutateAsync:d}=Y({mutationKey:["removeInvoice"],mutationFn:ba,...n});return{value:s,setValue:a,selectChange:r,handleChange:l,addInvoiceMutation:c,updateInvoiceMutation:i,removeInvoiceMutation:d}},$l=()=>{const{currentInvoiceItemsQueue:t}=me();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Items"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.length>0?e.jsx(e.Fragment,{children:t.length}):0})]})})},Bl=()=>{const{invoiceItemsDatabase:t}=me();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Subtotal"}),e.jsx(w,{className:"font-bold text-slate-700",children:ie(t.reduce((s,a)=>s+(a.total_price??0),0))})]})})},Ql=()=>{const{currentInvoicePos:t}=me();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Discount"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.total_discount?ie(t.total_discount):"₱0.00"})]})})},Yl=()=>{const{currentInvoicePos:t}=me();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Delivery Charge"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.delivery_charge?ie(t.delivery_charge):"₱0.00"})]})})},Gl=()=>{const{currentInvoicePos:t}=me(),s=t.total_amount_due;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex w-full flex-col justify-between gap-2 py-2",children:e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx(w,{className:"text-lg font-bold text-gray-700",children:"Total"}),e.jsx(w,{className:"text-lg font-bold text-black",children:ie(s??0)})]})})})},Xl=()=>{const{currentInvoicePos:t}=me();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Paid Amount"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.paid_amount?ie(t.paid_amount):"₱0.00"})]})})},Zl=()=>{var s,a;const{currentInvoicePos:t}=me();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Payment Type"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:(s=t.type)==null?void 0:s.replace("_"," ")})]}),t.type!=="exit"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Payment Method"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:(a=t.payment_method)==null?void 0:a.replace("_"," ")})]}),t.payment_method!=="cash"&&t.payment_method!==""&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Reference Number"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:t.reference_no})]})})]})]})},Js=()=>{const{currentInvoicePos:t}=me();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-col justify-between gap-2 border-t-2 border-dashed py-2",children:[e.jsx(Zl,{}),t.payment_method!=="purchase_order"&&e.jsx(Xl,{}),e.jsxs("div",{className:"flex flex-row justify-between",children:[(t.change_amount??0)<0?e.jsx("span",{className:"text-lg font-bold text-gray-700",children:"Balance"}):e.jsx("span",{className:"text-lg font-bold text-gray-700",children:"Change"}),e.jsx("span",{className:"text-lg font-bold text-black",children:ie(t.change_amount??0)})]})]})})},Jl=()=>{const{currentInvoicePos:t,setCurrentInvoicePos:s}=me(),{selectedCustomer:a}=Ue();return p.useEffect(()=>{t.payment_method==="balance_payment"&&s({...t,subtotal:(a==null?void 0:a.total_balance)??0,total_amount_due:(a==null?void 0:a.total_balance)??0})},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"my-2 flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Remaining Balance"}),e.jsx(w,{className:"font-bold text-slate-700",children:a!=null&&a.total_balance?ie(a.total_balance??0):"₱0.00"})]})})},er=({})=>{const{setDialogOptions:t,dialogOptions:s}=We(),{handleInvoicePosChange:a,currentInvoicePos:l}=me(),{selectedCustomer:r,vouchers:n,selectedVoucher:c,setSelectedVoucher:i}=Ue(),[d,o]=p.useState(l.total_discount??0),m=()=>{a("total_discount",d),t({open:!1,title:""})};return e.jsx(ns,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(cs,{children:[e.jsxs(is,{className:"items-start",children:[e.jsx(ds,{children:"Add Discount Amount"}),e.jsx(Es,{children:"Contact admininstrator for approval"})]}),e.jsxs("form",{className:"flex flex-col gap-2 ",onSubmit:u=>{u.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(k,{className:"pl-8",value:d,type:"number",onChange:u=>{o(Number(u.target.value)),i(void 0)},onBlur:u=>{u.target.value=d.toString()}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Claim voucher"}),e.jsxs(X,{disabled:Object.keys(r).length===0,value:c?c==null?void 0:c.id.toString():"",onValueChange:u=>{const x=n==null?void 0:n.find(y=>y.id===Number(u));o((x==null?void 0:x.discounted_price)??0),i(x??void 0)},children:[e.jsx(Z,{className:"w-full",children:e.jsx(J,{placeholder:"Select voucher..."})}),e.jsx(ee,{children:n==null?void 0:n.map(u=>e.jsxs(V,{value:`${u.id}`,children:[e.jsx("span",{className:"font-bold",children:u.code})," • ",e.jsx("span",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(u.discounted_price??0)})]},u.id))})]})]}),e.jsx(ys,{asChild:!0,children:e.jsx(M,{className:"w-full ",type:"submit",onClick:()=>{m()},children:"Apply"})})]})]})})},sr=({})=>{const{setDialogOptions:t,dialogOptions:s}=We(),{handleInvoicePosChange:a,currentInvoicePos:l}=me(),[r,n]=p.useState(l.paid_amount??0),c=()=>{a("paid_amount",r),t({open:!1,title:""})};return e.jsx(ns,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(cs,{children:[e.jsxs(is,{className:"items-start",children:[e.jsx(ds,{children:"Add Paid Amount"}),e.jsx(Es,{children:"Input the exact amount paid by the customer"})]}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:i=>{i.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(k,{className:"pl-8",defaultValue:r,type:"number",onChange:i=>{n(Number(i.target.value))}})]}),e.jsx(ys,{asChild:!0,children:e.jsx(M,{className:"w-full ",type:"submit",onClick:()=>{c()},children:"Apply"})})]})]})})},tr=({})=>{const{setDialogOptions:t,dialogOptions:s}=We(),{selectedCustomer:a}=Ue(),{handleInvoicePosChange:l,currentInvoicePos:r,setCurrentInvoiceItemsQueue:n,setInvoiceItemsDatabase:c}=me(),[i,d]=p.useState(r.type??"payment");return p.useEffect(()=>{r.type==="exit"&&l("payment_method","exit")},[r.type]),e.jsx(ns,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(cs,{children:[e.jsxs(is,{className:"items-start",children:[e.jsx(ds,{children:"Select Payment Type"}),e.jsxs(Es,{children:["Payment Type:"," ",r.type==="payment"?"Payment":"Exit"]})]}),e.jsx(wa,{id:"type",value:i,onValueChange:o=>{l("type",o),d(o)},children:e.jsxs(_a,{className:"flex h-12 flex-row gap-1 p-2",children:[e.jsx(Vs,{value:"payment",className:`data-[state=active]:bg-primary h-10 w-full rounded-md font-medium
                                text-slate-800 hover:bg-slate-200 data-[state=active]:text-white`,children:"Payment"}),e.jsx(Vs,{value:"exit",className:`data-[state=active]:bg-primary h-10 w-full rounded-md font-medium
                                text-slate-800 hover:bg-slate-200 data-[state=active]:text-white`,children:"Exit"})]})}),r.type==="payment"&&e.jsxs("div",{className:"grid columns-4 grid-cols-2 gap-2",children:[e.jsx(M,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="cash"&&"bg-primary text-white"}`,onClick:()=>{l("payment_method","cash")},children:"Cash"}),e.jsx(M,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="cheque"&&"bg-primary text-white"}`,onClick:()=>{l("payment_method","cheque")},children:"Cheque"}),e.jsx(M,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="e-wallet"&&"bg-primary text-white"}`,onClick:()=>{l("payment_method","e-wallet")},children:"E-Wallet"}),e.jsx(M,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="purchase_order"&&"bg-primary text-white"}`,onClick:()=>{l("payment_method","purchase_order")},children:"Purchase Order"}),e.jsx(M,{variant:"outline",disabled:!(a!=null&&a.total_balance),className:`h-16 font-medium ${r.payment_method==="balance_payment"&&"bg-primary text-white"}`,onClick:()=>{n([]),c([]),l("payment_method","balance_payment")},children:"Balance Payment"})]}),e.jsx("div",{children:(r.payment_method==="cheque"||r.payment_method==="voucher"||r.payment_method==="e-wallet"||r.payment_method==="purchase_order")&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-col justify-between gap-2",children:[e.jsx(w,{children:"Input Reference Code:"}),e.jsx(k,{placeholder:"Reference Code"})]})})}),e.jsx(ys,{asChild:!0,children:e.jsx(M,{type:"button",onClick:()=>{t({open:!1,title:""})},children:"Close"})})]})})},ar=()=>{const{auth:t}=se(),{searchFilterItems:s}=We(),a=Te();return e.jsx(e.Fragment,{children:e.jsx("div",{children:t.role==="admin"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row items-center justify-between px-2 py-4 ",children:[e.jsxs("span",{className:"flex flex-col font-bold text-slate-700",children:["Warehouse"," ",e.jsx("span",{className:"font-medium text-slate-800",children:s.warehouse_id===1?"Cagayan De Oro":"Iligan"})]}),e.jsx(M,{onClick:()=>{a("/pos")},size:"icon",children:e.jsx($s,{size:18})})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row justify-between p-2 bg-white",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"flex flex-row items-center gap-2 font-bold uppercase text-slate-800",children:s.warehouse_id===1?"Cagayan De Oro Branch":"Iligan Branch"}),e.jsx("span",{className:"font-medium capitalize text-slate-900",children:t.user.firstname+" "+t.user.lastname})]}),e.jsx(M,{className:"hover:cursor-default",size:"icon",children:e.jsx($s,{size:18})})]})})})})},lr=({})=>{const{selectedCustomer:t,setOpenSearchCustomer:s}=Ue();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex max-w-2xl flex-col gap-1 border-y-[1px] border-slate-200 bg-white px-2 py-4 pb-5",children:e.jsxs("div",{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(w,{className:"text-[16px] font-bold text-slate-700",children:"Customer"}),Object.keys(t).length===0?e.jsx("span",{className:"text-sm font-medium",children:"Select Customer"}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2 pt-2 ",children:[e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs(w,{className:"font-medium text-normal text-slate-800",children:["Full Name:"," "]}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.firstname+" "+t.lastname})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx(w,{className:"font-medium text-normal text-slate-800",children:"Address:"}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.address})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx(w,{className:"font-medium text-normal text-slate-800",children:"Contact Number:"}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.contact_no})]})]})})]}),e.jsx(M,{onClick:()=>s(!0),size:"icon",children:e.jsx(mt,{size:18})})]})})})},rr=({})=>{const{setDialogOptions:t,dialogOptions:s}=We(),{currentInvoicePos:a}=me();Rt();const{selectedCustomer:l}=Ue();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-1 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(M,{className:"flex-1",onClick:()=>{t({open:!0,title:"delivery_charge"})},disabled:a.payment_method==="balance_payment",children:"Set Delivery"}),e.jsx(M,{className:"flex-1",onClick:()=>{t({open:!0,title:"discount"})},disabled:a.payment_method==="balance_payment",children:"Set Discount"})]}),e.jsx(M,{onClick:()=>{t({open:!0,title:"payment_type"}),console.log("Options:",s)},children:"Set Payment Type"}),e.jsx(M,{onClick:()=>{t({open:!0,title:"paid_amount"}),console.log("Options:",s)},children:"Add Paid Amount"}),e.jsx("hr",{className:"my-1 w-full"}),e.jsx(M,{className:"w-full disabled:cursor-not-allowed",onClick:()=>{t({open:!0,title:"checkout"})},disabled:Object.keys(l).length===0||a.type==="payment"&&a.payment_method!=="purchase_order"&&a.payment_method!=="balance_payment"&&(a.change_amount??0)<0,children:"Checkout"})]})})},Kt=()=>{const{currentInvoicePos:t}=me();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-full flex-col justify-between p-4 px-2",children:e.jsx("div",{className:"flex flex-col gap-2",children:t.payment_method!=="balance_payment"?e.jsxs(e.Fragment,{children:[e.jsx($l,{}),e.jsx(Bl,{}),e.jsx(Ql,{}),e.jsx(Yl,{}),e.jsx(Gl,{}),e.jsx(Js,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(Jl,{}),e.jsx(Js,{})]})})})})},nr=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-pos-primary-background flex h-screen w-full max-w-[375px] flex-col gap-2 overflow-auto p-5",children:e.jsxs("div",{className:"flex flex-col rounded-md bg-white p-2 px-4",children:[e.jsx(ar,{}),e.jsx(Vl,{}),e.jsx(lr,{}),e.jsx(Kt,{}),e.jsx(rr,{})]})})}),cr=()=>{const{dialogOptions:t}=We();return e.jsxs(e.Fragment,{children:[t.title==="payment_type"&&e.jsx(tr,{}),t.title==="discount"&&e.jsx(er,{}),t.title==="paid_amount"&&e.jsx(sr,{}),t.title==="checkout"&&e.jsx(ir,{}),t.title==="delivery_charge"&&e.jsx(dr,{})]})},ir=()=>{const{setDialogOptions:t,dialogOptions:s}=We(),{invoiceItemsDatabase:a,currentInvoiceItemsQueue:l,fullData:r,setFullData:n,currentInvoicePos:c}=me(),[i,d]=p.useState("confirming"),{addInvoiceMutation:o}=Rt(),{selectedVoucher:m,setSelectedVoucher:u}=Ue();async function x(){d("submitting"),console.log("Invoice:",c),console.log("InvoiceItems:",l),console.log("InvoiceItemsDatabase:",a);const N=c;N.invoice_items=a.map(g=>({...g,product_id:g.product_id})),await o(N).then(g=>{m&&Pa(m.id).then(()=>u(void 0)),n(g.data),d("success"),Q.success("Transaction successful.",{autoClose:3e3})}).catch(()=>{d("confirming"),Q.error("Transaction failed. Please try again.",{autoClose:3e3})})}const y=Te();function f(){window.api.send({fullData:r,invoiceItems:l,invoiceItemsDatabase:a})}return e.jsx(Sa,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(Ca,{children:[e.jsxs(ka,{className:"items-start",children:[e.jsx(Fa,{children:i!=="success"?"Checkout":"Transaction successful"}),i!=="success"&&e.jsx(Ia,{children:"Confirm the details of this transaction"})]}),i!=="success"?e.jsx(Kt,{}):e.jsxs("div",{className:"my-4 w-full space-y-2 text-center",children:[e.jsx(xl,{size:80,className:"mx-auto text-green-500"}),e.jsx("h3",{className:"text-base font-medium text-slate-700",children:"Transaction has been successully submitted!"})]}),e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(M,{variant:"outline",className:`font-medium ${i!=="confirming"&&"hidden"} flex-1`,type:"reset",onClick:()=>{t({open:!1,title:""})},children:"Cancel"}),i==="success"?e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(M,{className:"flex-1",onClick:()=>{y(0)},children:"New transaction"}),e.jsx(M,{className:"flex-1",type:"submit",onClick:N=>{N.preventDefault(),f()},children:"Print invoice"})]}):e.jsx(M,{className:"flex-1",disabled:i==="submitting",type:"submit",onClick:N=>{N.preventDefault(),d("submitting"),x()},children:i==="confirming"?"Confirm transaction":i==="submitting"?"Submitting...":""})]})]})})},dr=()=>{const{setDialogOptions:t,dialogOptions:s}=We(),{handleInvoicePosChange:a,currentInvoicePos:l}=me(),[r,n]=p.useState(l.delivery_charge??0),c=()=>{a("delivery_charge",r),t({open:!1,title:""})};return e.jsx(ns,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(cs,{children:[e.jsx(is,{className:"items-start",children:e.jsx(ds,{children:"Add Delivery Charge"})}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:i=>{i.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(k,{className:"pl-8",defaultValue:r,type:"number",onChange:i=>{n(Number(i.target.value))}})]}),e.jsx(ys,{asChild:!0,children:e.jsx(M,{className:"w-full ",type:"submit",onClick:()=>{c()},children:"Apply"})})]})]})})},or=({})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center",children:[e.jsx(pl,{width:150,height:150,color:"#888888",strokeWidth:-1}),e.jsx("span",{className:"max-w-[300px] text-center text-[#888]",children:"Start entering products / product code / serial number / brand"})]})}),xr=({})=>{const{currentInvoiceItemsQueue:t,handleInvoicePosChange:s,handleInvoiceItemQuantity:a,removeInvoiceItem:l,invoiceItemsDatabase:r}=me();console.log(),p.useEffect(()=>{s("subtotal",t.reduce((c,i)=>c+i.total_price,0))},[t]);const n=[{id:"orderItem",enableResizing:!1,enableHiding:!1,header:()=>e.jsx("div",{className:"flex justify-center",children:"Item #"}),cell:({row:c})=>e.jsx("div",{className:"flex justify-center",children:c.index+1}),size:100},{accessorKey:"name",enableHiding:!1,header:()=>e.jsx("div",{className:"justify-center",children:"Product"}),cell:({row:c})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"text-sm font-bold",children:c.original.product.name}),e.jsx("span",{className:"font-medium",children:c.original.product.size})]}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[c.original.product.brand?e.jsx("span",{className:"",children:c.original.product.brand}):e.jsx("span",{className:"font-light",children:"(No Brand)"}),e.jsxs("span",{className:"",children:["• ",c.original.product.color]})]})]}),size:350},{enableHiding:!1,accessorKey:"quantity",header:()=>e.jsx("div",{className:"flex justify-center",children:"Quantity"}),size:150,cell:({row:c})=>{const i=c.index,d=c.original.inventory_product.approved_stocks-c.original.inventory_product.sold_count||0;return e.jsx("div",{className:"flex justify-center ",children:e.jsxs("div",{className:"flex flex-row border drop-shadow-sm",children:[e.jsx(M,{className:"rounded-sm bg-red-300 hover:bg-red-500 disabled:opacity-100",onClick:()=>{a(i,d,r[c.index].quantity-1)},disabled:r[c.index].quantity===1,children:e.jsx("span",{children:"-"})}),e.jsx(k,{id:"quantity",className:"w-20 rounded-none text-center drop-shadow-none",type:"number",defaultValue:r[i].quantity,onChange:o=>{console.log(o.target.value),setTimeout(()=>{a(i,d,Number(o.target.value))},1e3)}}),e.jsx(M,{className:"rounded-sm bg-slate-500 hover:bg-slate-700 disabled:bg-slate-200",onClick:()=>{a(i,d,r[c.index].quantity+1)},disabled:r[c.index].quantity>=d,children:e.jsx("span",{children:"+"})})]})})}},{id:"item_capital_price",size:125,header:()=>e.jsx("div",{className:"justify-center",children:"Capital Price"}),cell:({row:c})=>e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx("span",{children:ie(c.original.capital_price)})})},{accessorKey:"price",enableHiding:!1,header:()=>e.jsx("div",{className:"justify-center",children:"Product Price"}),cell:({row:c})=>e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{children:ie(c.original.price)}),c.original.on_sale?e.jsxs("span",{className:"text-sm font-light",children:["(",ie(c.original.sale_discount??0),")"]}):null]})},{id:"item_total_capital_price",size:125,header:()=>e.jsx("div",{className:"justify-center",children:"Total Capital Price"}),cell:({row:c})=>e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx("span",{children:ie(c.original.capital_price*r[c.index].quantity)})})},{id:"total_price",enableHiding:!1,accessorKey:"total_price",header:()=>e.jsx("div",{className:"justify-center",children:"Subtotal"}),cell:({row:c})=>e.jsx("div",{className:"",children:e.jsx("span",{children:ie(r[c.index].quantity*c.original.price)})}),size:250},{enableHiding:!1,id:"actions",size:100,cell:({row:c})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsx(M,{className:"bg-red-500 hover:bg-red-700",onClick:()=>{l(c.index)},children:e.jsx(Ft,{color:"#FFF"})})})}];return e.jsx("div",{className:"h-full overflow-y-scroll",children:t.length===0?e.jsx(e.Fragment,{children:e.jsx(or,{})}):e.jsx(ll,{data:t,columns:n})})},mr=()=>{const t=["","Product name","Price","Qty","Total"],{selectedInvoiceCode:s}=tt(),{data:a}=js();return console.log(s),e.jsx(e.Fragment,{children:e.jsxs(ut,{children:[e.jsxs(Aa,{children:["Select items the customer wants to return for invoice"," "]}),e.jsx(ht,{children:e.jsx(ss,{id:"tHeaderRow",className:"hover:bg-white",children:t.map(l=>e.jsx(pt,{className:"whitespace-nowrap px-5 py-3 text-left text-xs font-bold uppercase",children:l},l+"_head"))},"tHeaderRow")}),e.jsx(ft,{children:s.invoice_items.length>0&&s.invoice_items.map((l,r)=>e.jsxs(ss,{className:"text-sm font-medium text-gray-700",children:[e.jsx(oe,{className:"p-3 pr-0",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4",name:"return",id:"return"})}),e.jsx(oe,{className:"text-sm font-medium text-gray-700",children:l==null?void 0:l.product.name},(l==null?void 0:l.product.name)+"Product Name"),e.jsx(oe,{children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{children:ie(a.find(n=>n.id===l.product_price_id).cost)}),a.find(n=>n.id===l.product_price_id).on_sale?e.jsxs("span",{className:"text-muted-foreground",children:["(",ie(a.find(n=>n.id===l.product_price_id).sale_discount),")"]}):null]})}),e.jsx(oe,{children:l==null?void 0:l.quantity}),e.jsx(oe,{children:ie(l==null?void 0:l.total_price)})]},(l==null?void 0:l.id)+"row"))}),e.jsx(Ta,{children:e.jsxs(ss,{children:[e.jsx(oe,{colSpan:4,className:"text-right",children:"Total:"}),e.jsx(oe,{children:ie(s.paid_amount)})]})})]})})},ur=()=>{const[t,s]=p.useState(""),{sellableItems:a,fetchingProducts:l}=We(),{currentInvoiceItemsQueue:r,setCurrentInvoiceItemsQueue:n,invoiceItemsDatabase:c,setInvoiceItemsDatabase:i,currentInvoicePos:d}=me();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative z-20 pb-10",children:e.jsx("div",{className:"absolute box-content flex w-full ",children:e.jsxs(Ze,{className:"rounded-lg border p-1 shadow-md",children:[e.jsx(Je,{value:t,onValueChange:s,placeholder:l?"Loading Products":"Enter Product Name",disabled:a.length===0||d.payment_method==="balance_payment"}),e.jsx(Da,{className:"",children:t?e.jsx(e.Fragment,{children:a.filter(o=>o.inventory_product.approved_stocks>(o.inventory_product.sold_count??0)).map((o,m)=>{var x;const u=o.inventory_product.approved_stocks-o.inventory_product.sold_count;return e.jsx(Me,{onSelect:()=>{const y=r.findIndex(f=>f.inventory_product.product.id===o.inventory_product.product.id);y!==-1&&(c[y].quantity+=1,s("")),y===-1&&(n([...r,o]),i([...c,{product_id:o.product.id,product_price_id:o.inventory_product.product_price.id,product_price:o.inventory_product.product_price.price,quantity:1,unit:o.unit,item_discount:0,price:o.price,created_by:o.created_by,active_status:o.active_status,created_at:o.created_at,updated_at:o.updated_at,total_price:o.price,source_inventory:o.warehouse.id}]),s(""))},value:`${o.product.id} ${o.id} ${o.product.name} ${o.product.serial_no} ${o.product.brand} ${o.product.color}`,children:e.jsxs("div",{className:"flex flex-1 flex-row justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"font-bold",children:o.product.name}),e.jsx("span",{className:"font-medium",children:(x=o.product.size)==null?void 0:x.replace("inch",'"')})]}),e.jsxs("div",{className:"flex flex-row gap-1",children:[o.product.brand?e.jsxs("span",{className:"text-[12px]",children:["(",o.product.brand,")"]}):e.jsx("span",{className:"text-[12px]",children:"(No Brand)"}),e.jsxs("span",{className:"",children:["• ",o.product.color]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-bold ",children:ie(o.price)}),e.jsxs("span",{className:"font-medium",children:[u," ",u>1?"items":"item"]})]})]})},m)})}):null})]})})})})},Dn=({})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex h-full flex-row",children:[e.jsx(Pt,{}),e.jsxs("div",{className:"flex h-full w-screen flex-row",children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx(ur,{}),e.jsx(xr,{})]}),e.jsx(nr,{}),e.jsx(cr,{})]})]})}),hr=({openModal:t})=>{const{transactions:s,isFetching:a,progress:l}=za(),r=[{id:"select",header:({table:n})=>e.jsx("input",{type:"checkbox",checked:n.getIsAllPageRowsSelected(),onChange:c=>n.toggleAllPageRowsSelected(!!c.target.checked),"aria-label":"Select all"}),cell:({row:n})=>e.jsx("input",{type:"checkbox",checked:n.getIsSelected(),onChange:c=>n.toggleSelected(!!c.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"Product ID"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.id})},{accessorKey:"price",header:()=>e.jsx("div",{className:"text-center",children:"Price"}),cell:({row:n})=>{const c=parseFloat(n.getValue("amount")),i=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c);return e.jsx("div",{className:"text-center",children:i})}},{accessorKey:"product_name",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["PRODUCT NAME ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.product_name})},{accessorKey:"dimensions",header:()=>e.jsx("div",{className:"text-center",children:"DIMENSIONS"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.dimensions})},{accessorKey:"serial",header:()=>e.jsx("div",{className:"text-center",children:"SERIAL"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.serial})},{accessorKey:"sku",header:()=>e.jsx("div",{className:"text-center",children:"SKU"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.sku})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"INVENTORY STATUS"}),cell:({row:n})=>{const c=n.getValue("status"),i=c==="LOW"?"bg-red-500":c==="MEDIUM"?"bg-amber-500":"bg-lime-600";return e.jsx("div",{className:`flex w-full flex-1 flex-col text-center ${i}`,children:n.getValue("status")})}},{accessorKey:"type",header:()=>e.jsx("div",{className:"text-center",children:"ORDER TYPE"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.type})},{accessorKey:"quantity",header:()=>e.jsx("div",{className:"text-center",children:"QUANTITY"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.quantity})}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:s,columns:r,filterWhat:"serial",dataType:"Transaction",openModal:()=>t,isLoading:a})})},zn=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Transaction",children:e.jsx(Ea,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(hr,{openModal:n})})})})})})},pr=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:l,progress:r,setSelectedTransfer:n}=Pe(),c=a.map(f=>({transfer_id:f.transfer_id})),d=s.filter(f=>{if(c.some(N=>N.transfer_id===f.id))return f}).filter(f=>{if(f.approval_status==="pending")return f}),{auth:o}=se(),m=f=>{n(f),t(f,"details")},u=f=>{n(f),t(f,"edit")},x=f=>{n(f),t(f,"products")},y=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:f})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>f.toggleSorting(f.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["TRANSFER CODE ",f.getIsSorted()==="asc"?e.jsx(D,{}):f.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:f})=>e.jsx("div",{children:f.original.code?f.original.code:"N/A"})},{accessorKey:"source",header:()=>e.jsx("div",{className:"text-center",children:"SOURCE-DESTINATION"}),cell:({row:f})=>{const N=f.original.source,g=f.original.destination;return e.jsxs("div",{className:"text-center",children:[N.code,"-",g.code]})}},{accessorKey:"transfer_status",sortingFn:"text",enableSorting:!0,header:({column:f})=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(_,{onClick:()=>f.toggleSorting(f.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center z-10",children:["TRANSFER STATUS ",f.getIsSorted()==="asc"?e.jsx(D,{}):f.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:f})=>e.jsx("div",{className:"text-center",children:f.original.transfer_status?f.original.transfer_status:"N/A"})},{accessorKey:"transfer_schedule",sortingFn:"datetime",enableSorting:!0,header:({column:f})=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(_,{onClick:()=>f.toggleSorting(f.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center z-10",children:["SCHEDULE ",f.getIsSorted()==="asc"?e.jsx(D,{}):f.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:f})=>{const N=f.getValue("transfer_schedule");if(N.toString()!=="0000-00-00 00:00:00"){const g={year:"numeric",month:"long",day:"numeric"},h=new Date(N).toLocaleDateString([],g);return e.jsx("div",{className:"text-center",children:h})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"approval_status",header:()=>e.jsx("div",{className:"text-center",children:"APPROVAL STATUS"}),cell:({row:f})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:f.original.approval_status.toLowerCase()==="approved"?e.jsx(Ee,{size:20,strokeWidth:2,className:"text-green-600"}):f.original.approval_status.toLowerCase()==="rejected"?e.jsx($e,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(Be,{size:20,strokeWidth:2,className:"text-amber-500"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:f})=>{var g;const N=f.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>m(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),((g=o.role)==null?void 0:g.toLowerCase())!="encoder"&&e.jsxs(B,{onClick:()=>u(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:N.transfer_status!="arrived"&&N.approval_status!="rejected"?e.jsx(Se,{size:16,strokeWidth:2.25}):e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>x(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:N.transfer_status!="arrived"&&N.approval_status!="rejected"?e.jsx(Se,{size:16,strokeWidth:2.25}):e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Products"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:d,columns:y,filterWhat:"approval_status",dataType:"",openModal:void 0,isLoading:l})})},fr=({onClose:t})=>{const{selectedTransfer:s}=Pe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Source"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.source.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.destination.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer schedule"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_schedule.toString()==="0000-00-00 00:00:00"?"N/A":de(s.transfer_schedule)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Received by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.received_by?s.received_by.firstname+" "+s.received_by.lastname:"N/A"})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Date received"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.date_received?de(s.date_received):"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approved_by?s.approved_by.firstname+" "+s.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(s.updated_at)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.notes?s.notes:"N/A"})]})})]})})},En=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Pending Transfer",children:e.jsxs(xt,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(pr,{openModal:n})})}),e.jsx(pe,{title:l==="details"?"Transfer Details":l==="edit"?"Edit Transfer":"Transfer Products",isOpen:t,onClose:a,closeOnOverlayClick:l==="details",children:e.jsxs(e.Fragment,{children:[l==="details"&&e.jsx(fr,{onClose:a}),l==="edit"&&e.jsx(Ot,{onClose:a}),l==="products"&&e.jsx(Mt,{onClose:a})]})})]})})})},jr=({openModal:t})=>{const{invoices:s,isFetching:a,users:l,userSales:r,setSelectedInvoice:n}=jt(),c=d=>{n(d.invoices),t(d,"details")},i=[{accessorKey:"issued_by",sortingFn:"text",enableSorting:!0,header:({column:d})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{d.toggleSorting(d.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["FULL NAME ",d.getIsSorted()==="asc"?e.jsx(D,{}):d.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.invoices[0].issued_by.firstname+" "+d.original.invoices[0].issued_by.lastname})},{id:"total_sales",sortingFn:"basic",enableSorting:!0,header:({column:d})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{d.toggleSorting(d.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["NUMBER OF SALES ",d.getIsSorted()==="asc"?e.jsx(D,{}):d.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.invoices.length})},{id:"amount_sales",sortingFn:"basic",enableSorting:!0,header:({column:d})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{d.toggleSorting(d.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TOTAL AMOUNT OF SALES ",d.getIsSorted()==="asc"?e.jsx(D,{}):d.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:d})=>{const m=d.original.invoices.filter(x=>x.status==="approved").reduce((x,y)=>x+y.paid_amount,0),u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m);return e.jsx("div",{className:"text-center",children:u})}},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:d})=>{const o=d.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>c(o),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:r,columns:i,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:a})})},gr=({onClose:t})=>{const{invoices:s,selectedInvoice:a,isFetching:l}=jt(),r=a[0],n=[{id:"select",header:({table:c})=>e.jsx("input",{type:"checkbox",checked:c.getIsAllPageRowsSelected(),onChange:i=>c.toggleAllPageRowsSelected(!!i.target.checked),"aria-label":"Select all"}),cell:({row:c})=>e.jsx("input",{type:"checkbox",checked:c.getIsSelected(),onChange:i=>c.toggleSelected(!!i.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"or_no",sortingFn:"alphanumeric",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{c.toggleSorting(c.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["OR NUMBER ",c.getIsSorted()==="asc"?e.jsx(D,{}):c.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.or_no})},{accessorKey:"created_at",sortingFn:"datetime",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{c.toggleSorting(c.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["CREATED AT ",c.getIsSorted()==="asc"?e.jsx(D,{}):c.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:c})=>{const i=c.getValue("created_at");if(i.toString()!=="0000-00-00 00:00:00"){const d={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},o=new Date(i).toLocaleDateString([],d);return e.jsx("div",{className:"text-center",children:o})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"warehouse",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE CODE"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.warehouse.code})},{id:"customer",header:()=>e.jsx("div",{className:"text-center",children:"CUSTOMER NAME"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.customer.firstname+" "+c.original.customer.lastname})},{accessorKey:"type",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{c.toggleSorting(c.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TRANSACTION TYPE ",c.getIsSorted()==="asc"?e.jsx(D,{}):c.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.type})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"STATUS"}),cell:({row:c})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:c.original.status.toLowerCase()==="approved"?e.jsx(Ee,{size:20,strokeWidth:2,className:"text-green-600"}):c.original.status.toLowerCase()==="rejected"?e.jsx($e,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(Be,{size:20,strokeWidth:2,className:"text-amber-500"})})},{accessorKey:"subtotal",header:()=>e.jsx("div",{className:"text-center",children:" SUBTOTAL "}),cell:({row:c})=>{const i=c.original.subtotal,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"total_discount",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL DISCOUNT "}),cell:({row:c})=>{const i=c.original.total_discount,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"total_tax",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL TAX "}),cell:({row:c})=>{const i=c.original.total_tax,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"delivery_charge",header:()=>e.jsx("div",{className:"text-center",children:" DELIVERY CHARGE "}),cell:({row:c})=>{const i=c.original.delivery_charge,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"total_amount_due",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL AMOUNT DUE "}),cell:({row:c})=>{const i=c.original.total_amount_due,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"paid_amount",header:()=>e.jsx("div",{className:"text-center",children:" PAID AMOUNT "}),cell:({row:c})=>{const i=c.original.paid_amount,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"change_amount",header:()=>e.jsx("div",{className:"text-center",children:" CHANGE AMOUNT "}),cell:({row:c})=>{const i=c.original.change_amount,d=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:d})}},{accessorKey:"payment_method",header:()=>e.jsx("div",{className:"text-center",children:" PAYMENT METHOD "}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.payment_method||"N/A"})},{accessorKey:"reference_no",header:({column:c})=>e.jsx("div",{className:"text-center",children:"REF #"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.reference_no||"--"})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl max-h-96 flex-col gap-4",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Issuer: ",r.issued_by.firstname+" "+r.issued_by.lastname]}),e.jsx("div",{className:"overflow-x-hidden",children:e.jsx(te,{data:a,columns:n,filterWhat:"or_no",dataType:"",openModal:void 0,isLoading:l})})]})})},Wn=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"User Sales",children:e.jsxs(Wa,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(jr,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:a,title:l==="details"?"Invoice Details":"",closeOnOverlayClick:l==="details",children:e.jsx(e.Fragment,{children:l==="details"&&e.jsx(gr,{onClose:a})})})]})})})},Nr=()=>{const{roles:t,roleSelect:s,permissions:a,allPermissions:l,permissionChange:r,roleId:n,isChanged:c,isSubmitting:i,error:d,success:o,handleChange:m,handleChangeSelect:u,handleSubmit:x}=wl(),{auth:y}=se(),f=l.filter(j=>Object.keys(j).some(C=>!j.title.includes("view".toLowerCase())&&j.title.includes("users".toLowerCase()))),N=l.filter(j=>Object.keys(j).some(C=>!j.title.includes("view".toLowerCase())&&!j.title.includes("transfer".toLowerCase())&&j.title.includes("product".toLowerCase())||j.title.includes("capital".toLowerCase()))),g=l.filter(j=>Object.keys(j).some(C=>!j.title.includes("view".toLowerCase())&&j.title.includes("transfer".toLowerCase()))),h=l.filter(j=>Object.keys(j).some(C=>j.title.includes("view".toLowerCase())));return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto flex h-full max-h-full w-full flex-row divide-x",children:[e.jsxs("div",{className:"flex w-60 flex-none flex-col p-2 pt-8",children:[e.jsx("h3",{className:"ml-4 pb-1 text-xs font-semibold text-slate-500/80",children:"Roles"}),e.jsx("div",{className:"w-full",children:t?t.map(j=>j.title!=="super_admin"&&e.jsx(M,{variant:"ghost",className:`w-full justify-start capitalize text-slate-700 ${(s==null?void 0:s.title)===j.title&&"bg-slate-300/40"}`,onClick:()=>u("roles",j.title),children:j.title.split("_").join(" ")},j.id+j.title)):e.jsx("div",{className:"flex h-16 w-full items-center justify-center text-slate-500",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})})}),e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-slate-500/80",children:"After saving changes, affected users must log out and log back in to apply the changes."}),(s==null?void 0:s.title)===y.role&&e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-red-500/80",children:"You are editing your current role. Review your changes carefully."}),e.jsxs("div",{className:"mt-auto w-full space-y-3",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[o&&e.jsx("p",{className:"text-green-600",children:o}),d&&e.jsx("p",{className:"text-red-600",children:d})]}),c&&e.jsx(M,{type:"submit",className:"w-full disabled:cursor-not-allowed",disabled:!!i,onClick:x,children:i?"Saving...":"Save changes"})]})]}),s?e.jsx(Re,{className:"w-full",type:"auto",style:{"--border":"216 12% 84%"},children:e.jsxs("div",{className:`mx-auto flex w-full max-w-[700px] flex-1 flex-col gap-8 p-6 pt-8 ${!s||i?"pointer-events-none opacity-50":null}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"User Management"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:f.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):f.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:`${!((s==null?void 0:s.title)==="super_admin"||(s==null?void 0:s.title)==="admin")&&"cursor-pointer"} text-sm capitalize text-slate-700`,children:j.title.split("_").join(" ")}),e.jsx(ze,{id:j.title,name:j.title,value:j.id,disabled:(s==null?void 0:s.title)==="super_admin"||(s==null?void 0:s.title)==="admin",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(C=>C.permission_id===j.id),onCheckedChange:C=>m(C,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Products"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:N.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):N.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(ze,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(C=>C.permission_id===j.id),onCheckedChange:C=>m(C,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Transfers"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:g.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):g.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(ze,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(C=>C.permission_id===j.id),onCheckedChange:C=>m(C,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Views"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:h.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):h.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(ze,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(C=>C.permission_id===j.id),onCheckedChange:C=>m(C,j.id)})]},j.id))})]})]})}):e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsx("p",{className:"text-lg font-medium text-slate-700/50",children:"Select a role to view and modify permissions"})})]})})},Mn=()=>e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Role Permissions",children:e.jsx(it,{children:e.jsx("div",{className:"flex h-full max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(Nr,{})})})})})}),yr=({handleViewItems:t,handleViewDetails:s,handleEditInventory:a})=>[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"warehouse.code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["WHS"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"date_received",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Received"})},{accessorKey:"transfer_id",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Transer Id"}),cell:({row:r})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{children:r.original.transfer_id?r.original.transfer_id:"—"})})},{accessorKey:"created_by",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Created by"}),cell:({row:r})=>e.jsx("div",{className:"uppercase",children:e.jsxs("span",{className:"max-w-[25ch] truncate",children:[r.original.created_by.firstname," ",r.original.created_by.lastname]})})},{accessorKey:"notes",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Notes"}),cell:({row:r})=>e.jsx("div",{children:e.jsx("p",{className:"max-w-[25ch] truncate",children:r.original.notes?r.original.notes:"—"})})},{id:"actions",cell:({row:r})=>{const n=r.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{t(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(gt,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View items"})]}),e.jsxs(B,{onClick:()=>{s(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>{a(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]})]})]})})},enableGlobalFilter:!1}],vr=({openModal:t,filterWarehouse:s,setTotalInventories:a})=>{const[l,r]=p.useState([]),{data:n,isLoading:c,setSelectedInventory:i}=vs(),d=Te();p.useEffect(()=>{r(s?n.filter(y=>y.warehouse.id===s):n),a(n.length)},[n,s]);const o=()=>{t({},"add")},m=y=>{i(y),t(y,"edit")},u=y=>{i(y),d(`/inventory/items/${y.id}`)},x=y=>{i(y),t(y,"view_details")};return e.jsx(e.Fragment,{children:e.jsx(te,{columns:yr({handleViewItems:u,handleViewDetails:x,handleEditInventory:m}),data:l.sort((y,f)=>{let N=new Date(y.updated_at??y.created_at);return new Date(f.updated_at??f.created_at).getTime()-N.getTime()}),filterWhat:"code",dataType:"Inventory",openModal:o,isLoading:c})})},br=({FormValue:t,handleChange:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"date_received",className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsxs(Ce,{children:[e.jsx(ke,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(M,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ls,{size:18,strokeWidth:1.5}),t.date_received?t.date_received:"Choose date..."]})}),e.jsx(Fe,{className:"w-auto p-0",children:e.jsx(Xe,{mode:"single",initialFocus:!0,required:!0,onDayClick:a=>{const l=new Date(a),r=`${l.getFullYear()}-${(l.getMonth()+1).toString().padStart(2,"0")}-${l.getDate().toString().padStart(2,"0")}`;s("date_received",r)},selected:t.date_received?new Date(t.date_received):new Date})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(k,{id:"notes",name:"notes",type:"text",defaultValue:t.notes?t.notes:void 0,maxLength:1e3,placeholder:"Notes...",onChange:a=>s("notes",a.target.value)})]})]})}),Ut=(t,s,a)=>{const l=a||new Date,r=l.getFullYear()+"-"+("0"+(l.getMonth()+1)).slice(-2)+"-"+("0"+l.getDate()).slice(-2),n=t.slice(0,3),c=s.toString().padStart(4,"0");return`${n}-${r}-${c}`.toUpperCase()},wr=({onClose:t,totalInventories:s,warehouses:a})=>{const{auth:l}=se(),{value:r,setValue:n,handleChange:c,handleSubmit:i}=At(),[d,o]=p.useState(!1),[m,u]=p.useState(null);p.useEffect(()=>{c("created_by",l.user.id),c("type","supplier")},[]);const[x,y]=p.useState();return p.useEffect(()=>{if(x){const f=Ut(x,s+1);c("code",f)}},[x]),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:async f=>{f.preventDefault(),r.date_received===void 0?u("Please select a date for date received."):(o(!d),i({action:"add",data:r}).then(()=>{o(!1),Q.success("Inventory added successfully."),t()}).catch(N=>{o(!1),N.response.data.message?Q.error(N.response.data.message):Q.error("Failed to add inventory.")}))},children:[e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"code",className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx(k,{id:"code",name:"code",type:"text",value:r.code||"",readOnly:!0,placeholder:"Code..."})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"warehouse",className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs(X,{onValueChange:f=>{var N;c("warehouse_id",Number(f)),y((N=a.find(g=>g.id===Number(f)))==null?void 0:N.code)},required:!0,children:[e.jsx(Z,{name:"warehouse",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:"Choose warehouse..."})}),e.jsx(ee,{className:"bg-white font-medium",children:a.map((f,N)=>e.jsxs(V,{value:f.id.toString(),className:"text-sm font-medium text-slate-700",children:[f.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+f.code+" • "+f.location})]},N))})]})]})]}),e.jsx("hr",{className:"col-span-12 my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"flex flex-col justify-center gap-1",children:e.jsx(br,{FormValue:r,handleChange:c})})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:d||Object.keys(r).length<=2||!x,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:d?"Submitting...":"Add inventory"})]})}),m&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-semibold text-red-600",children:m})})]})})},_r=({onClose:t})=>{const{selectedInventory:s}=vs(),{transfers:a,isFetching:l}=Nt(),r=a.find(n=>n.id===s.transfer_id);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx("p",{className:"text-sm",children:s.code})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Type"}),e.jsx("p",{className:"text-sm capitalize",children:s.type})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"ID"}),e.jsx("p",{className:"text-sm",children:s.id})]}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs("p",{className:"text-sm",children:[s.warehouse.name," (",s.warehouse.code,")"]})]}),s.type==="transfer"&&e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer Code"}),e.jsx("p",{className:"text-sm capitalize",children:l?"Loading...":r==null?void 0:r.code})]}),e.jsxs("div",{className:`flex flex-col justify-center gap-1 ${s.type==="supplier"?"col-span-7":"col-span-3"}`,children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsx("p",{className:"text-sm capitalize",children:s.date_received?s.date_received:"—"})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx("p",{className:"text-sm capitalize",children:s.notes?s.notes:"—"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsxs("p",{className:"text-sm capitalize",children:[s.created_by.firstname," ",s.created_by.lastname]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm capitalize",children:de(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm capitalize",children:s.updated_at?de(s.updated_at):"—"})]})]})]})})},Sr=({onClose:t,warehouses:s})=>{const{selectedInventory:a}=vs(),{value:l,handleChange:r,handleSubmit:n}=At(),{transfers:c,isFetching:i}=Nt(),[d,o]=p.useState(!1),[m,u]=p.useState(!1),[x,y]=p.useState(null),f=h=>c.find(j=>h===j.id),[N,g]=p.useState();return p.useEffect(()=>{if(N){const h=Ut(N,a.id,new Date(a.created_at));r("code",h)}},[N]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async h=>{u(!m),h.preventDefault(),n({action:"update",id:a.id,data:l}).then(()=>{u(!1),Q.success("Inventory updated successfully."),t()}).catch(j=>{u(!1),j.response.data.message?Q.error(j.response.data.message):Q.error("Failed to update inventory.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"code",className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx(k,{id:"code",name:"code",type:"text",value:l.code||a.code||"",readOnly:!0,placeholder:"Code..."})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"warehouse",className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs(X,{onValueChange:h=>{var j;r("warehouse_id",Number(h)),g((j=s.find(C=>C.id===Number(h)))==null?void 0:j.code)},defaultValue:a.warehouse.id.toString(),required:!0,children:[e.jsx(Z,{name:"warehouse",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(J,{placeholder:"Choose warehouse..."})}),e.jsx(ee,{className:"bg-white font-medium",children:s.map((h,j)=>e.jsxs(V,{value:h.id.toString(),className:"text-sm font-medium text-slate-700",children:[h.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+h.code+" • "+h.location})]},j))})]})]})]}),e.jsx("hr",{className:"col-span-12 my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"type",className:"text-sm font-bold text-gray-600",children:"Type"}),e.jsxs(X,{defaultValue:a.type,onValueChange:h=>r("type",h),children:[e.jsx(Z,{name:"type",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm capitalize",children:e.jsx(J,{placeholder:"Choose type..."})}),e.jsxs(ee,{className:"bg-white font-medium",children:[e.jsx(V,{value:"supplier",className:"text-sm font-medium text-slate-700",children:"Supplier"}),e.jsx(V,{value:"transfer",className:"text-sm font-medium text-slate-700",children:"Transfer"})]})]})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"date_received",className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsxs(Ce,{children:[e.jsx(ke,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(M,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ls,{size:18,strokeWidth:1.5}),l.date_received?l.date_received:a.date_received]})}),e.jsx(Fe,{className:"w-auto p-0",children:e.jsx(Xe,{mode:"single",initialFocus:!0,required:!0,month:l.date_received?new Date(l.date_received):new Date(a.date_received),onDayClick:h=>{const j=new Date(h),C=`${j.getFullYear()}-${(j.getMonth()+1).toString().padStart(2,"0")}-${j.getDate().toString().padStart(2,"0")}`;r("date_received",C)},selected:l.date_received?new Date(l.date_received):new Date(a.date_received)})})]})]}),(a.type==="transfer"||l.type==="transfer")&&e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"transfer_id",className:"text-sm font-bold text-gray-600",children:"Transfer Item"}),e.jsxs(Ce,{open:d,onOpenChange:o,children:[e.jsx(ke,{className:"relative my-2 w-full",asChild:!0,children:e.jsxs(M,{role:"combobox",className:"my-0 w-full justify-between text-sm text-slate-700",variant:"outline",children:[c?l.transfer_id?(()=>{const h=f(l.transfer_id);return e.jsx("div",{className:"flex items-baseline gap-4",children:h==null?void 0:h.code})})():a.transfer_id?(()=>{const h=f(a.transfer_id);return e.jsx("div",{className:"flex items-baseline gap-4",children:h?h.code:"Loading..."})})():"Select inventory item...":"Loading...",e.jsx(as,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Fe,{className:"w-[462px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ze,{children:[e.jsx(Je,{id:"transfer_id",name:"transfer_id",placeholder:"Transfer code..."}),i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(ts,{children:"No match found"}),e.jsx(Re,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ve,{children:c.map(h=>e.jsxs(Me,{value:h.id.toString()+h.code,onSelect:()=>{r("transfer_id",h.id),o(!1)},className:"cursor-pointer justify-between rounded-sm",children:[e.jsx("span",{children:h.code}),e.jsxs("span",{className:"text-xs font-semibold text-slate-700/50",children:[h.approval_status," • ",h.source.code,"->",h.destination.code," • ",h.transfer_status]})]},h.id))})})]})})]})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(k,{id:"notes",name:"notes",type:"text",defaultValue:l.notes?l.notes:a.notes?a.notes:void 0,maxLength:1e3,placeholder:"Notes...",onChange:h=>r("notes",h.target.value)})]})]}),e.jsx("div",{className:"flex w-full flex-row pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4 whitespace-nowrap",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:m||Object.keys(l).length===0,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying changes...":"Apply changes"})]})}),x&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:x})})]})})})},On=()=>{const{warehouses:t}=Ke(),[s,a]=p.useState(0),[l,r]=p.useState(0),{openModal:n,isOpen:c,closeModal:i}=xe(),[d,o]=p.useState(""),m=(u,x)=>{o(x),n()};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Inventory",children:e.jsxs(yt,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(X,{defaultValue:"0",onValueChange:u=>a(Number(u)),children:[e.jsx(Z,{className:"w-[300px] text-sm font-medium",children:e.jsx(J,{placeholder:"All"})}),e.jsxs(ee,{className:"text-sm font-medium capitalize",children:[e.jsx(V,{value:"0",children:"All"},"all"),t.map(u=>e.jsxs(V,{value:u.id.toString(),children:[u.name," (",u.code,")"]},u.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(vr,{filterWarehouse:s>0?s:void 0,openModal:m,setTotalInventories:r})})]}),e.jsx(pe,{isOpen:c,onClose:i,title:d==="add"?"Add Inventory":d==="view_details"?"Details":d==="edit"?"Edit Inventory":"",closeOnOverlayClick:d==="view_details",children:e.jsxs(e.Fragment,{children:[d==="add"&&e.jsx(wr,{warehouses:t,totalInventories:l,onClose:i}),d==="view_details"&&e.jsx(_r,{onClose:i}),d==="edit"&&e.jsx(Sr,{warehouses:t,onClose:i})]})})]})})})},Cr=({handleViewDetails:t,handleEditInventoryProduct:s,handleApproveInventoryProduct:a})=>[{id:"product_name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Name"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Cap. Price"}),cell:({row:r})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(r.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:r.original.capital_price?n:"—"})})}},{accessorKey:"stocks_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Stocks"})},{accessorKey:"approved_stocks",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Approved"})},{accessorKey:"sold_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Sold"})},{accessorKey:"remaining_stocks_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Remaining"}),cell:({row:r})=>{const n=r.original.remaining_stocks_count??0,c=r.original.stocks_count*.2,i=r.original.stocks_count*.5;return e.jsxs(Qe,{children:[e.jsx(Ye,{children:e.jsx("span",{className:`${c>=n?"font-bold text-red-700":i>=n?"font-semibold text-amber-700":""}`,children:n})}),e.jsx(Ge,{children:c>=n?"Remaining stocks are low!":i>=n?"Remaining stocks are below 50%":"Remaining stocks are above 50%"})]})}},{accessorKey:"status",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Status"}),cell:({row:r})=>e.jsx(Qe,{children:e.jsxs("div",{className:"group relative flex w-fit items-center",children:[e.jsx(Ye,{children:r.original.approved_stocks>0?e.jsx(rs,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(Be,{size:20,strokeWidth:2,className:"text-gray-600"})}),e.jsx(Ge,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:r.original.approved_stocks>0?"Approved":"Pending"})})]})})},{id:"actions",cell:({row:r})=>{const n=r.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{t(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>{s(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsxs(B,{onClick:()=>a(n),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(rs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve stocks"})]})]})]})})},enableGlobalFilter:!1}],kr=({openModal:t,inventory:s})=>{const{data:a,isLoading:l,setSelectedInventoryProduct:r}=bs(),n=()=>{t({},"add")},c=o=>{r(o),t(o,"view_details")},i=o=>{r(o),t(o,"edit")},d=o=>{r(o),t(o,"approve")};return e.jsxs(gs,{children:[e.jsxs(_,{fill:l?"default":"primary",onClick:()=>{window.api.invSend({inventory:s,products:a})},className:"ml-4 mt-2 flex h-8 flex-row disabled:cursor-not-allowed disabled:opacity-40",children:[e.jsx(Et,{size:26,strokeWidth:2})," Print Inventory Details"]}),e.jsx(te,{columns:Cr({handleViewDetails:c,handleEditInventoryProduct:i,handleApproveInventoryProduct:d}),data:a||[],filterWhat:"product_name",dataType:"Items",openModal:n,isLoading:l})]})},Fr=({setInventoryProductsQueue:t,inventoryId:s,products:a,productsLoading:l,suppliers:r,suppliersLoading:n,currentId:c,handleNavigation:i,selectedProduct:d})=>{var v,S,F,I,q,R,P;const{auth:o}=se(),{value:m,handleChange:u}=es(),[x,y]=p.useState(!1),[f,N]=p.useState(!1),[g,h]=p.useState(null),j=Te();p.useEffect(()=>{var b;u("inventory_id",s),u("unit","pcs"),d&&(u("product_id",d.data.product_id),u("supplier_id",d.data.supplier_id),u("capital_price",d.data.capital_price),u("unit",d.data.unit),u("stocks_count",d.data.stocks_count),u("damage_count",d.data.damage_count),u("total_count",d.data.total_count)),!d&&!((b=o.role)!=null&&b.includes("admin"))&&u("capital_price",0)},[]);const[C,T]=p.useState();return p.useEffect(()=>{const b=Ks(m.stocks_count||0,m.damage_count||0);T(b),u("total_count",b)},[m.damage_count,m.stocks_count,C]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:b=>{b.preventDefault(),m.product_id===void 0?h("Please select a product first."):m.supplier_id===void 0?h("Please select a supplier first."):(t(d?O=>[...O.filter(W=>W.id!==d.id),{id:d.id,data:m}]:O=>[...O,{id:c+1,data:m}]),i())},children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-8 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(Ce,{open:x,onOpenChange:y,children:[e.jsx(ke,{id:"product_id",className:"relative w-full",asChild:!0,autoFocus:!0,children:e.jsxs(M,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[m.product_id?e.jsx(e.Fragment,{children:(()=>{const b=a.find(O=>O.id===m.product_id);return e.jsxs("div",{className:"flex w-full flex-row items-baseline gap-4",children:[e.jsx("span",{children:b==null?void 0:b.name}),e.jsxs("div",{className:"flex gap-4 truncate text-xs font-semibold",children:[(b==null?void 0:b.brand)&&e.jsx("span",{children:`Brand: ${b==null?void 0:b.brand}`}),(b==null?void 0:b.size)&&e.jsx("span",{children:`Size: ${b==null?void 0:b.size}`}),(b==null?void 0:b.color)&&e.jsx("span",{children:`Color: ${b==null?void 0:b.color}`})]})]})})()}):e.jsx("span",{children:"Select a product..."}),e.jsx(as,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Fe,{className:"min-w-[756px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ze,{children:[e.jsx(Je,{placeholder:"Product name or serial number..."}),l&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(ts,{children:"No match found"}),e.jsxs(Re,{className:"max-h-[200px] overflow-y-scroll",children:[e.jsx(Ve,{forceMount:!0,children:e.jsxs(Me,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{j("/products"),N(!1)},forceMount:!0,children:[e.jsx("span",{children:"Add new product..."}),e.jsx(Bs,{size:16,strokeWidth:2.25,className:"text-slate-700/50"})]},"create-new-product")}),e.jsx(Qs,{}),e.jsx(Ve,{children:a.map((b,O)=>e.jsx(Me,{className:"cursor-pointer justify-between rounded-sm border-b",value:b.id+"_"+b.name+"_"+b.serial_no,onSelect:()=>{u("product_id",b.id),y(!1)},children:`${b.name} • ${b.brand} • ${b.size} • ${b.color}`},O))})]})]})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(Ce,{open:f,onOpenChange:N,children:[e.jsx(ke,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(M,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[m.supplier_id?e.jsx(e.Fragment,{children:(()=>{const b=r.find(O=>O.id===m.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:b==null?void 0:b.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:b==null?void 0:b.address})]})})()}):e.jsx("span",{children:"Select a supplier..."}),e.jsx(as,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Fe,{className:"min-w-[315px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ze,{children:[e.jsx(Je,{placeholder:"Supplier name or address..."}),n&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(ts,{children:"No match found"}),e.jsxs(Re,{className:"max-h-[200px] overflow-y-scroll",children:[e.jsx(Ve,{forceMount:!0,children:e.jsxs(Me,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{j("/supplier"),N(!1)},children:[e.jsx("span",{children:"Add new supplier..."}),e.jsx(Bs,{size:16,strokeWidth:2.25,className:"text-slate-700/50"})]},"create-new-supplier")}),e.jsx(Qs,{}),e.jsx(Ve,{children:r.map((b,O)=>e.jsxs(Me,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{u("supplier_id",b.id),N(!1)},children:[e.jsx("span",{children:b.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:b.address})]},O))})]})]})})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"relative col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(k,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",disabled:!((v=o.role)!=null&&v.includes("admin")),value:m.capital_price||"",onBlur:b=>{m.capital_price!==void 0&&(b.target.value=Number(b.target.value).toFixed(2))},onChange:b=>{u("capital_price",Number(Number(b.target.value).toFixed(2)))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(k,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,value:m.unit||"",onChange:b=>u("unit",b.target.value)})]}),e.jsxs("div",{className:`${(S=o.role)!=null&&S.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(k,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:(F=m.stocks_count)==null?void 0:F.toFixed(0),required:!0,onChange:b=>{u("stocks_count",Number(Number(b.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:`${(I=o.role)!=null&&I.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(k,{id:"damage_count",name:"damage_count",type:"number",min:0,max:m.stocks_count??0,step:1,required:!0,value:(q=m.damage_count)==null?void 0:q.toFixed(0),onChange:b=>u("damage_count",Number(Number(b.target.value).toFixed(0)))})]}),e.jsxs("div",{className:`${(R=o.role)!=null&&R.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(k,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,readOnly:!0,value:C??"0",className:`${C&&C<0&&"text-red-600"}`})]}),((P=o.role)==null?void 0:P.includes("admin"))&&e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(k,{id:"total_count",name:"total_count",type:"number",min:0,max:m.stocks_count??0,step:1,value:m.approved_stocks!==void 0?String(m.approved_stocks):"",onChange:b=>u("approved_stocks",b.target.value),onBlur:b=>{u("approved_stocks",Number(b.target.value))}})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsx("div",{className:"ml-auto flex flex-row gap-4",children:e.jsx(_,{type:"submit",fill:"green",disabled:m.product_id===void 0||m.supplier_id===void 0,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:d?"Save changes":"Add item to queue"})})}),g&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:g})})]})})})},Ir=["","Name","Brand","Size","Color","Supplier","Capital price","Unit","Stocks","Damaged","Total","Approved"],Pr=({data:t,products:s,suppliers:a,handleEditItem:l,handleRemoveItem:r,handleSubmit:n,onClose:c})=>{const[i,d]=p.useState(!1),[o,m]=p.useState(null),u=()=>{d(!0),n({action:"batch-add",data:t.map(x=>x==null?void 0:x.data)}).then(()=>{Q.success("Items added to inventory."),d(!1),c()}).catch(x=>{m("Error adding items to inventory"),x.response.data.message?Q.error(x.response.data.message):Q.error("Error adding items to inventory.")})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative flex h-full flex-col",children:e.jsxs(gs,{children:[e.jsxs(Re,{type:"always",className:"flex-1 rounded-md border border-gray-200 bg-white",style:{"--border":"216 12% 84%"},children:[t.length<=0&&e.jsx("div",{className:"absolute z-10 flex h-full w-full items-center justify-center",children:e.jsx("p",{className:"text-lg font-medium text-gray-500/50",children:"No items in queue"})}),e.jsx(Ys,{orientation:"horizontal",className:"z-50 h-3"}),e.jsx(Ys,{orientation:"vertical",className:"z-50 h-3",style:{"--border":"216 12% 84%"},asChild:!0}),e.jsxs(ut,{children:[e.jsx(ht,{children:e.jsx(ss,{id:"tHeaderRow",className:"hover:bg-white",children:Ir.map(x=>e.jsx(pt,{className:"whitespace-nowrap px-5 py-3 text-xs font-bold uppercase",children:x},x+"_head"))},"tHeaderRow")}),e.jsx(ft,{className:"[&>*:nth-child(even)]:bg-white [&>*:nth-child(odd)]:bg-gray-50",children:t.length>0&&t.map(x=>{var y,f,N,g,h;return e.jsxs(ss,{className:"text-sm font-medium text-gray-700",children:[e.jsx(oe,{className:"p-3 pr-0",children:e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-200/70 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white font-medium",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{x!=null&&x.id&&l(x)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2})}),e.jsx("span",{children:"Edit"})]},(x==null?void 0:x.id)+"edit"),e.jsxs(B,{onClick:()=>{x!=null&&x.id&&r(x.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 focus:bg-red-50 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(sl,{size:16,strokeWidth:2})}),e.jsx("span",{children:"Remove"})]},(x==null?void 0:x.id)+"remove")]})]})})},(x==null?void 0:x.id)+"action"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.product_id?(y=s.find(j=>j.id===x.data.product_id))==null?void 0:y.name:x==null?void 0:x.data.product_id},(x==null?void 0:x.id)+"product_id"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.product_id?(f=s.find(j=>j.id===x.data.product_id))==null?void 0:f.brand:"No brand"},(x==null?void 0:x.id)+"product_brand"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.product_id?(N=s.find(j=>j.id===x.data.product_id))==null?void 0:N.size:"No data"},(x==null?void 0:x.id)+"product_size"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.product_id?(g=s.find(j=>j.id===x.data.product_id))==null?void 0:g.color:"No data"},(x==null?void 0:x.id)+"product_color"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:x!=null&&x.data.supplier_id?(h=a.find(j=>j.id===x.data.supplier_id))==null?void 0:h.name:x==null?void 0:x.data.supplier_id},(x==null?void 0:x.id)+"supplier_id"),e.jsx(oe,{className:"px-5 py-3",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((x==null?void 0:x.data.capital_price)||0)},(x==null?void 0:x.id)+"capital_price"),e.jsx(oe,{className:"px-5 py-3",children:x==null?void 0:x.data.unit},(x==null?void 0:x.id)+"unit"),e.jsx(oe,{className:"px-5 py-3",children:x==null?void 0:x.data.stocks_count},(x==null?void 0:x.id)+"stocks_count"),e.jsx(oe,{className:"px-5 py-3",children:x==null?void 0:x.data.damage_count},(x==null?void 0:x.id)+"damage_count"),e.jsx(oe,{className:"px-5 py-3",children:x==null?void 0:x.data.total_count},(x==null?void 0:x.id)+"total_count"),e.jsx(oe,{className:"px-5 py-3",children:x==null?void 0:x.data.approved_stocks},(x==null?void 0:x.id)+"approved_stocks")]},(x==null?void 0:x.id)+"row")})})]})]}),e.jsxs("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:[o&&e.jsx("div",{className:"flex w-full flex-row items-center justify-start gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:o})}),e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>c(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:t.length<=0||i,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",onClick:x=>{x.preventDefault(),u()},children:t.length<=1?"Add item to inventory":`Add ${t.length} items to inventory`})]})]})]})})})},Ar={hidden:{opacity:0,x:"-100%"},animate:{opacity:1,x:"0%",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,x:"-100%",transition:{duration:.3,ease:"easeInOut"}}},Tr={hidden:{opacity:0,x:"100%"},animate:{opacity:1,x:"0%",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,x:"100%",transition:{duration:.3,ease:"easeInOut"}}},Dr=({onClose:t,inventoryId:s})=>{se();const{data:a,isLoading:l}=st(),{suppliers:r,isFetching:n}=Ws(),{handleSubmit:c}=es(),[i,d]=p.useState([]),[o,m]=p.useState({}),[u,x]=p.useState("main"),y=()=>{m({}),x(u==="main"?"form":"main")},f=g=>{m(g),x("form")},N=g=>{d(h=>h.filter(j=>j.id!==g))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:u==="main"?"ml-auto":"",children:e.jsx(M,{className:"flex flex-row items-center gap-2 bg-gray-200 text-sm font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",onClick:()=>{y()},children:e.jsxs(e.Fragment,{children:[u==="main"?e.jsx(al,{size:20,strokeWidth:2.5}):e.jsx(ps,{size:20,strokeWidth:2.5}),u==="main"?"Add an item":"Back"]})})}),e.jsx("div",{className:`relative min-w-[850px] overflow-x-clip transition-all duration-300 
					${u==="form"?"min-h-[330px]":"min-h-[540px]"}`,children:e.jsx(Ma,{initial:!1,children:u==="main"?e.jsx(Gs.div,{variants:Ar,initial:"hidden",animate:"animate",exit:"exit",className:"absolute h-full w-full overflow-x-auto antialiased",children:e.jsx(Pr,{data:i,products:a,suppliers:r,handleEditItem:f,handleRemoveItem:N,handleSubmit:c,onClose:t})},"main"):e.jsx(Gs.div,{variants:Tr,initial:"hidden",animate:"animate",exit:"exit",className:"absolute max-h-[406px] w-full p-1",children:e.jsx(Fr,{setInventoryProductsQueue:d,inventoryId:s,products:a,productsLoading:l,suppliers:r,suppliersLoading:n,currentId:i.reduce((g,h)=>h.id>g?h.id:g,0),handleNavigation:y,selectedProduct:Object.keys(o).length?o:void 0})},"form")})})]})})},zr=({onClose:t})=>{var g;const{auth:s}=se(),{selectedInventoryProduct:a}=bs(),{value:l,handleChange:r,handleSubmit:n}=es(),{suppliers:c,isFetching:i}=Ws(),[d,o]=p.useState(!1),[m,u]=p.useState(!1),[x,y]=p.useState(null),[f,N]=p.useState();return p.useEffect(()=>{const h=Ks(l.stocks_count??a.stocks_count,l.damage_count??a.damage_count);N(h),r("total_count",h)},[l.damage_count,l.stocks_count,f]),e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:async h=>{u(!m),h.preventDefault(),n({action:"update",id:a.id,data:l}).then(()=>{u(!1),Q.success("Inventory product updated successfully."),t()}).catch(()=>{u(!1),Q.error("Failed to update inventory product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:a.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:a.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:a.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:a.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:a.product.color})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(Ce,{open:d,onOpenChange:o,children:[e.jsx(ke,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(M,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[l.supplier_id?e.jsx(e.Fragment,{children:(()=>{const h=c.find(j=>j.id===l.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:h==null?void 0:h.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:h==null?void 0:h.address})]})})()}):e.jsx("span",{children:a.supplier_id.name}),e.jsx(as,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Fe,{className:"p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ze,{children:[e.jsx(Je,{placeholder:"Supplier name or address..."}),c===void 0&&i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(ts,{children:"No match found"}),e.jsx(Re,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ve,{children:c.map((h,j)=>e.jsxs(Me,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{r("supplier_id",h.id),o(!1)},children:[e.jsx("span",{children:h.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:h.address})]},j))})})]})})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(k,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",readOnly:s.role!=="admin",defaultValue:a==null?void 0:a.capital_price.toFixed(2),onBlur:h=>{h.target.value=Number(h.target.value).toFixed(2)},onChange:h=>{const j=Number(h.target.value).toFixed(2);r("capital_price",Number(j))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(k,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,defaultValue:a==null?void 0:a.unit,onChange:h=>r("unit",h.target.value)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(k,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:((g=l.stocks_count)==null?void 0:g.toFixed(0))??(a==null?void 0:a.stocks_count)??0,onChange:h=>{r("stocks_count",Number(Number(h.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(k,{id:"damage_count",name:"damage_count",type:"number",min:0,max:l.stocks_count??a.stocks_count,step:1,required:!0,value:l.damage_count!==void 0?String(l.damage_count):String(a==null?void 0:a.damage_count)||"",onBlur:h=>{h.target.value=Number(h.target.value).toFixed(0)},onChange:h=>r("damage_count",Number(Number(h.target.value).toFixed(0)))})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(k,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,value:f||0,className:`${f&&f<0&&"text-red-600"}`,readOnly:!0})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:m,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying...":"Apply changes"})]})}),x&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:x})})]})})})},Er=()=>{const{selectedInventoryProduct:t}=bs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:t.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:t.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:t.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:t.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:t.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:t.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:t.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:t.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:t.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Status"}),e.jsx("p",{className:"text-sm",children:t.status?"Approved":"Pending"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx("p",{className:"text-sm",children:t.approved_stocks})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unapproved stocks"}),e.jsx("p",{className:"text-sm",children:t.remaining_unapproved_stocks})]})]})]})})},Wr=({onClose:t})=>{const{selectedInventoryProduct:s}=bs(),{value:a,handleChange:l,handleSubmit:r}=es(),[n,c]=p.useState(!1),i=d=>{d.preventDefault(),c(!0),r({action:"update",id:s.id,data:a}).then(()=>{Q.success("Inventory product successfully approved."),c(!1),t()}).catch(o=>{var m,u;Q.error((u=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:u.message),c(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[24rem] max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.capital_price)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:s.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:s.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:s.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:s.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:s.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:s.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:s.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("form",{className:"grid w-full grid-flow-row grid-cols-11 gap-3",onSubmit:i,children:[e.jsxs("div",{className:"relative col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approved_stocks",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(k,{id:"approved_stocks",name:"approved_stocks",type:"number",min:0,step:1,max:s.remaining_unapproved_stocks,required:!0,autoFocus:!0,value:a.approved_stocks!==void 0?String(a.approved_stocks):"",onChange:d=>{l("approved_stocks",d.target.value)},onBlur:d=>{l("approved_stocks",Number(d.target.value))}}),e.jsxs("span",{className:"absolute bottom-0 right-0 -translate-x-4 -translate-y-2 pb-[2px] text-sm font-medium text-slate-700",children:["/ ",s.remaining_unapproved_stocks]})]}),e.jsx("div",{className:"col-span-1 flex items-center pt-6",children:e.jsx(zt,{size:24,strokeWidth:2,className:"mx-auto text-slate-600"})}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"prev_approved_stocks",className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx(k,{id:"prev_approved_stocks",name:"prev_approved_stocks",type:"number",readOnly:!0,value:s.approved_stocks||0})]}),e.jsx("div",{className:"col-span-11 flex w-full justify-between whitespace-nowrap pt-3",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:n,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Approving...":"Approve"})]})})]})]})})},Rn=()=>{const{id:t}=Ds(),{data:s,isLoading:a}=Oa(Number(t)),l=Te(),r=()=>{l(-1)},{openModal:n,isOpen:c,closeModal:i}=xe(),[d,o]=p.useState(""),m=(u,x)=>{o(x),n()};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Inventory items",children:e.jsxs(Ra,{inventoryId:Number(t),children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:[e.jsxs(M,{onClick:()=>r(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(ps,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Inventory code:"}),e.jsx("span",{children:a?"Loading...":s==null?void 0:s.code})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(kr,{openModal:m,inventory:s})})]}),e.jsx(pe,{isOpen:c,onClose:i,closeOnOverlayClick:d==="view_details",title:d==="add"?"Add Items":d==="edit"?"Edit Item":d==="view_details"?"Item Details":d==="approve"?"Approve Item":"",children:e.jsxs(e.Fragment,{children:[d==="add"&&e.jsx(Dr,{inventoryId:Number(t),onClose:i}),d==="view_details"&&e.jsx(Er,{}),d==="edit"&&e.jsx(zr,{onClose:i}),d==="approve"&&e.jsx(Wr,{onClose:i})]})})]})})})},Mr=()=>{const t=fe(),{selectedExpenses:s}=Ms(),[a,l]=p.useState({id:s.id,title:s.title,date_of_operation:s.date_of_operation,amount:s.amount,notes:s.notes,created_by:s.created_by.id,created_at:s.created_at,updated_at:s.updated_at}),[r,n]=p.useState(!1),[c,i]=p.useState(!1),[d,o]=p.useState(null),[m,u]=p.useState(null),x=()=>Object.keys(a).map(j=>({text:j})).length>=8?a.amount?a.title?[!0,""]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"],y=h=>{n(!0),u(null),o(null),l(j=>({...j,[h.target.name]:h.target.value}))},f=async()=>{const h=x();i(!0),h[0]?await g(a):(o(h[1]),i(!1))},N={onSuccess:async()=>{await t.invalidateQueries({queryKey:["expenses"]}),i(!1),n(!1),u("Expenses info has been edited")},onError:h=>{console.error(h),o(h.message),i(!1)}},{mutateAsync:g}=Y({mutationKey:["editExpenses"],mutationFn:Ka,...N});return{expensesEdit:a,isChanged:r,isSubmitting:c,error:d,success:m,handleSubmit:f,handleChange:y,editExpensesMutation:g}},Or=()=>{const t=fe(),{expenses:s,dateToday:a}=Ms(),l=s.length+1,{auth:r}=se(),[n,c]=p.useState({id:l,title:"",date_of_operation:a,amount:0,notes:"",created_by:r.user.id,created_at:"",updated_at:""}),[i,d]=p.useState(!1),[o,m]=p.useState(!1),[u,x]=p.useState(null),[y,f]=p.useState(null),N=()=>Object.keys(n).map(v=>({text:v})).length>=5?n.amount?n.title?[!0,""]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"],g=T=>{d(!0),f(null),x(null),c(v=>({...v,[T.target.name]:T.target.value}))},h=async()=>{const T=N();m(!0),T[0]?await C(n):(x(T[1]),m(!1))},j={onSuccess:async()=>{await t.invalidateQueries({queryKey:["expenses"]}),m(!1),d(!1),f("Expenses info has been added")},onError:T=>{console.error(T),x(T.message),m(!1)}},{mutateAsync:C}=Y({mutationKey:["addExpenses"],mutationFn:Ua,...j});return{dateToday:a,expensesAdd:n,isChanged:i,isSubmitting:o,error:u,success:y,handleSubmit:h,handleChange:g,addExpensesMutation:C}},Rr=({openModal:t})=>{const{expenses:s,isFetching:a,selectedExpenses:l,setSelectedExpenses:r,dateToday:n}=Ms(),c=()=>{t({},"add")},i=m=>{r(m[0]),t(m,"edit")},d=[{accessorKey:"date_of_operation",sortingFn:"datetime",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{m.toggleSorting(m.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["DATE OF OPERATION ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>{const u=m.getValue("date_of_operation");if(u.toString()!=="0000-00-00"){const x={year:"numeric",month:"long",day:"numeric"},y=new Date(u).toLocaleDateString([],x);return e.jsx("div",{className:"text-center",children:y})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"title",header:({column:m})=>e.jsx("div",{className:"text-center",children:" TITLE "}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.title})},{accessorKey:"amount",header:({column:m})=>e.jsx("div",{className:"text-center",children:" AMOUNT "}),cell:({row:m})=>{const u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m.original.amount);return e.jsx("div",{className:"text-center",children:u})}},{accessorKey:"notes",header:({column:m})=>e.jsx("div",{className:"text-center",children:" NOTES "}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.notes})},{accessorKey:"created_by",header:({column:m})=>e.jsx("div",{className:"text-center",children:" CREATED BY "}),cell:({row:m})=>e.jsxs("div",{className:"text-center",children:[m.original.created_by.firstname," ",m.original.created_by.lastname]})},{id:"actions",header:()=>e.jsx("div",{className:"flex flex-row justify-center",children:"ACTIONS"}),cell:({row:m})=>{const u=m.original;if(u.date_of_operation===n)return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(_,{fill:"empty",textColor:"black",onClick:()=>i([u]),className:"flex flex-row items-center gap-2",children:[e.jsx(Us,{})," Edit"]})})}}],o=s.some(m=>m.date_of_operation===n);return s.sort((m,u)=>{let x=m.date_of_operation,y=u.date_of_operation;return x<y?1:x>y?-1:0}),e.jsx(e.Fragment,{children:e.jsx(te,{data:s,columns:d,filterWhat:"notes",dataType:"Today's Expenses",openModal:o?void 0:c,isLoading:a})})},Kr=({onClose:t})=>{const{expensesEdit:s,isChanged:a,isSubmitting:l,error:r,success:n,handleSubmit:c,handleChange:i}=Mr();return n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async d=>{d.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Date of Operation"}),e.jsx(H,{type:"text",name:"date_of_operation",placeholder:"2024-04-06",className:"inputbox rounded-md",value:s.date_of_operation,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"Title"}),e.jsx(H,{type:"text",name:"title",placeholder:"Title",className:"inputbox rounded-md bg-slate-100",value:s.title,onChange:i,required:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Amount"}),e.jsx(H,{type:"number",name:"amount",placeholder:"₱500.00",className:"inputbox rounded-md bg-slate-100",value:s.amount,onChange:i,required:!0})]})]}),e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-12 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Notes"}),e.jsx(Ns,{name:"notes",placeholder:"Notes here....",className:"text-base rounded-md bg-slate-100",value:s.notes,onChange:i})]})}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4 text-center",children:[e.jsx("div",{className:"flex flex-col col-span-3 gap-3",children:e.jsx(_,{type:"submit",fill:a?"green":null,disabled:!a,onClick:c,children:l?"Submitting":"Edit Expenses"})}),e.jsxs("div",{className:"flex flex-col col-span-6 items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-3 gap-3 items-end",children:e.jsx(_,{type:"reset",fill:"red",onClick:t,children:"Cancel"})})]})]})})})},Ur=({onClose:t})=>{const{expensesAdd:s,isChanged:a,isSubmitting:l,error:r,success:n,handleSubmit:c,handleChange:i,dateToday:d}=Or();return n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async o=>{o.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Date of Operation"}),e.jsx(H,{type:"text",name:"date_of_operation",placeholder:"2024-04-06",className:"inputbox rounded-md",value:d,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"Title"}),e.jsx(H,{type:"text",name:"title",placeholder:"Title",className:"inputbox rounded-md bg-slate-100",value:s.title||"",onChange:i,required:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Amount"}),e.jsx(H,{type:"number",name:"amount",placeholder:"₱500.00",className:"inputbox rounded-md bg-slate-100",value:s.amount||"",onChange:i,required:!0})]})]}),e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-12 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Notes"}),e.jsx(Ns,{name:"notes",placeholder:"Notes here....",className:"text-base rounded-md bg-slate-100",value:s.notes||"",onChange:i})]})}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),a&&e.jsx(_,{type:"submit",fill:a?"green":null,disabled:!a,onClick:c,children:l?"Submitting":"Add Expenses"})]})})]})})]})})})},Kn=()=>{const{openModal:t,isOpen:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{r(i),t()};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Expenses",children:e.jsxs(La,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Rr,{openModal:n})})}),e.jsx(pe,{isOpen:s,onClose:a,title:l==="add"?"Add Expenses":"Edit Expenses",children:e.jsxs(e.Fragment,{children:[l==="edit"&&e.jsx(Kr,{onClose:a}),l==="add"&&e.jsx(Ur,{onClose:a})]})})]})})})},Lr=()=>{const{reports:t,isReportsFetching:s}=Le(),a=[(t==null?void 0:t.new_customers)??0,(t==null?void 0:t.returning_customers)??0],l={series:[(t==null?void 0:t.new_customers)??0,(t==null?void 0:t.returning_customers)??0],labels:["New customers","Returning customers"],colors:["#3b82f6","#1e3a8a"],legend:{show:!0,fontFamily:"sans-serif",fontSize:"14px",fontWeight:500,itemMargin:{vertical:4}},dataLabels:{enabled:!0,dropShadow:{top:2,blur:3,opacity:.5},style:{fontFamily:"Inter",fontSize:"12px",fontWeight:600}},tooltip:{style:{fontFamily:"Inter",fontSize:"14px"}},plotOptions:{pie:{donut:{size:"50%"}}},chart:{animations:{speed:600}}};return e.jsx(e.Fragment,{children:s?e.jsxs("div",{className:"flex h-72 w-full animate-pulse justify-center p-4",children:[e.jsx("div",{className:"mx-auto h-full w-72 rounded-2xl bg-slate-200"}),e.jsx("div",{className:"h-20 w-44 rounded-2xl bg-slate-200"})]}):e.jsx(vt,{series:a,options:l,type:"donut",height:"100%",width:"100%"})})},qr=()=>e.jsx(e.Fragment,{children:e.jsxs(bt,{className:"flex min-h-[24rem] flex-col gap-4",children:[e.jsxs(wt,{className:"flex flex-none flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(_t,{className:"text-base font-bold",children:"Customers"}),e.jsx(St,{className:"text-sm font-medium",children:"Shows new and returning customers for the selected date range"})]}),e.jsx(Ct,{className:"flex-1",children:e.jsx(Lr,{})})]})}),Hr=()=>{const{reports:t,isReportsFetching:s}=Le();return e.jsx(e.Fragment,{children:e.jsx(os,{title:"Profit",tooltip:"Calculated by subtracting the sum of capital and expenses from sales.",bgClassName:`${t!=null&&t.total_profit?t.total_profit>=0?"bg-blue-50":"bg-red-50":"bg-blue-50"}`,textColorClassName:`${t!=null&&t.total_profit?t.total_profit>=0?"text-blue-800":"text-red-800":"text-blue-800"}`,children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-blue-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_profit)??0)})})})},Vr=()=>{const{reports:t,isReportsFetching:s}=Le();return e.jsx(e.Fragment,{children:e.jsx(os,{title:"Sales",tooltip:"Calculated by adding up the total amount due in paid transactions.",bgClassName:"bg-green-50",textColorClassName:"text-green-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-green-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_sales)??0)})})})},$r=()=>{const{reports:t,isReportsFetching:s}=Le();return e.jsx(e.Fragment,{children:e.jsx(os,{title:"Capital",tooltip:"Calculated capital of sold products.",bgClassName:"bg-orange-50",textColorClassName:"text-orange-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-orange-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_overall_capital)??0)})})})},Br=()=>{const{reports:t,isReportsFetching:s}=Le();return e.jsx(e.Fragment,{children:e.jsx(os,{title:"Expenses",tooltip:"Calculated by adding up the operational expenses.",bgClassName:"bg-violet-50",textColorClassName:"text-violet-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-violet-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_expenses)??0)})})})},Qr=()=>{const{reports:t,isReportsFetching:s}=Le();return e.jsx(e.Fragment,{children:e.jsx(os,{title:"Collectibles",tooltip:"Total amount owed from customers for non-payment type transactions.",bgClassName:"bg-stone-50",textColorClassName:"text-stone-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-stone-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_collectibles)??0)})})})};function Yr({className:t}){const{dateRange:s,setDateRange:a}=Le();return e.jsx("div",{className:Xs("grid gap-2",t),children:e.jsxs(Ce,{children:[e.jsx(ke,{asChild:!0,children:e.jsxs(M,{id:"date",variant:"outline",className:Xs("w-[300px] justify-start text-left font-medium",!s&&"text-muted-foreground"),children:[e.jsx(ol,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?e.jsxs(e.Fragment,{children:[Fs(s.from,"LLL dd, y")," —"," ",Fs(s.to,"LLL dd, y")]}):Fs(s.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(Fe,{className:"w-auto p-0",align:"start",children:e.jsx(Xe,{initialFocus:!0,mode:"range",defaultMonth:s!=null&&s.to?new Date(s.to.getFullYear(),s.to.getMonth()-1,1):new Date,selected:s,onSelect:a,classNames:{day:"text-sm flex items-center justify-center w-full h-full rounded-md font-medium",months:"flex flex-row gap-6"},numberOfMonths:2})})]})})}const Gr=()=>{const{setDateRange:t,isFetching:s}=Le(),a=()=>{t({from:new Date(new Date().setDate(new Date().getDate()-90)),to:new Date})};return e.jsx(M,{variant:"outline",disabled:s,onClick:a,children:"Reset date"})},Xr=()=>{const{year:t,setYear:s}=Os(),a=p.useMemo(()=>{const l=new Date().getFullYear(),r=2020,n=[];for(let c=r;c<=l;c++)n.push(c);return n.sort((c,i)=>i-c)},[]);return e.jsx(e.Fragment,{children:e.jsxs(X,{value:t.toString(),onValueChange:l=>{s(Number(l))},children:[e.jsx(Z,{className:"w-32 flex-none",children:e.jsx(J,{placeholder:"Choose year...",children:e.jsx("span",{className:"text-slate-600",children:t})})}),e.jsx(ee,{children:a.map(l=>e.jsx(V,{value:l.toString(),className:"text-sm font-medium",children:l},`${l}-item`))})]})})},Zr=()=>{var l;const{warehouseId:t,setWarehouseId:s}=Os(),{warehouses:a}=Ke();return e.jsx(e.Fragment,{children:e.jsxs(X,{value:t==null?void 0:t.toString(),onValueChange:r=>{s(r!=="0"?Number(r):0)},children:[e.jsx(Z,{className:"w-44",children:e.jsx(J,{placeholder:"Select warehouse...",children:e.jsx("span",{className:"text-slate-600",children:((l=a.find(r=>r.id===t))==null?void 0:l.name)??"All"})})}),e.jsxs(ee,{children:[e.jsx(V,{value:"0",className:"text-sm font-medium",children:"All"},"all-warehouses-item"),a&&a.map(r=>e.jsx(V,{value:r.id.toString(),className:"text-sm font-medium",children:r.name},`${r.id}-item`))]})]})})},Jr=()=>{const{reportAnalytics:t,isReportAnalyticsFetching:s}=Os();return e.jsx(e.Fragment,{children:e.jsxs(bt,{className:"flex min-h-[36rem] w-full flex-col gap-4",children:[e.jsxs(wt,{className:"flex w-full flex-none flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(_t,{className:"flex w-full flex-row justify-between text-base font-bold",children:"Reports Analytics"}),e.jsxs(St,{className:"!mt-1 flex flex-row gap-2 font-bold uppercase",children:[e.jsx(Zr,{}),e.jsx(Xr,{})]})]}),e.jsx(Ct,{className:"mx-auto w-[99%] flex-1 overflow-hidden",children:s?e.jsx("div",{className:"h-[350px] w-full animate-pulse rounded-2xl bg-slate-200/50"}):e.jsx(vt,{type:"line",height:"100%",width:"100%",series:[{name:"Sales",data:(t==null?void 0:t.map(a=>a.gross_income??0))??[]},{name:"Profit",data:(t==null?void 0:t.map(a=>a.net_profit??0))??[]},{name:"Capital",data:(t==null?void 0:t.map(a=>a.capital??0))??[]},{name:"Expenses",data:(t==null?void 0:t.map(a=>a.expenses??0))??[]},{name:"Collectibles",data:(t==null?void 0:t.map(a=>a.collectibles??0))??[]}],options:{markers:{size:5},stroke:{width:4},colors:["#16a34a","#2563eb","#f59e0b","#7c3aed","#525252"],xaxis:{tooltip:{enabled:!1},categories:(t==null?void 0:t.map(a=>a.Month??""))??[],labels:{style:{fontFamily:"sans-serif",fontSize:"12px",fontWeight:600}}},yaxis:{labels:{style:{fontFamily:"sans-serif",fontSize:"12px",fontWeight:600},formatter:a=>Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a)}},tooltip:{style:{fontFamily:"sans-serif",fontSize:"14px"}},legend:{position:"top",horizontalAlign:"right"},chart:{toolbar:{show:!1}}}})})]})})},Un=()=>e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Reports",children:e.jsx(qa,{children:e.jsx(Ha,{children:e.jsx("div",{className:"flex h-full w-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"h-full max-h-full w-full max-w-full overflow-auto",children:e.jsxs("div",{className:"flex w-full max-w-full flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(Yr,{}),e.jsx(Gr,{})]}),e.jsx("div",{className:"flex flex-1 flex-col gap-4",children:e.jsxs("div",{className:"flex flex-row gap-2 rounded-lg border p-2 shadow-sm",children:[e.jsx(Vr,{}),e.jsx(Hr,{}),e.jsx($r,{}),e.jsx(Br,{}),e.jsx(Qr,{})]})}),e.jsx(qr,{}),e.jsx(Jr,{})]})})})})})})}),Ln=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(Pt,{}),e.jsx("div",{id:"main",className:"flex w-screen flex-row",children:e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[e.jsx("div",{className:"flex w-full flex-row justify-between",children:e.jsx("h1",{className:"text-primary-dark-gray text-2xl font-bold",children:"Return Item"})}),e.jsx(mr,{})]})})]})}),en=({onClose:t})=>{const{invoices:s,isFetching:a,customers:l,selectedInvoice:r}=kt(),n=r[0],c=[{id:"select",header:({table:i})=>e.jsx("input",{type:"checkbox",checked:i.getIsAllPageRowsSelected(),onChange:d=>i.toggleAllPageRowsSelected(!!d.target.checked),"aria-label":"Select all"}),cell:({row:i})=>e.jsx("input",{type:"checkbox",checked:i.getIsSelected(),onChange:d=>i.toggleSelected(!!d.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"or_no",sortingFn:"alphanumeric",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["OR NUMBER ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.or_no})},{accessorKey:"created_at",sortingFn:"datetime",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["CREATED AT ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>{const d=i.getValue("created_at");if(d.toString()!=="0000-00-00 00:00:00"){const o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},m=new Date(d).toLocaleDateString([],o);return e.jsx("div",{className:"text-center",children:m})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"warehouse",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE CODE"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.warehouse.code})},{id:"customer",header:()=>e.jsx("div",{className:"text-center",children:"CUSTOMER NAME"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.customer.firstname+" "+i.original.customer.lastname})},{accessorKey:"type",sortingFn:"text",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TRANSACTION TYPE ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.type})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"STATUS"}),cell:({row:i})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:i.original.status.toLowerCase()==="approved"?e.jsx(Ee,{size:20,strokeWidth:2,className:"text-green-600"}):i.original.status.toLowerCase()==="rejected"?e.jsx($e,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(Be,{size:20,strokeWidth:2,className:"text-amber-500"})})},{accessorKey:"subtotal",header:()=>e.jsx("div",{className:"text-center",children:" SUBTOTAL "}),cell:({row:i})=>{const d=i.original.subtotal,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_discount",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL DISCOUNT "}),cell:({row:i})=>{const d=i.original.total_discount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_tax",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL TAX "}),cell:({row:i})=>{const d=i.original.total_tax,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"delivery_charge",header:()=>e.jsx("div",{className:"text-center",children:" DELIVERY CHARGE "}),cell:({row:i})=>{const d=i.original.delivery_charge,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_amount_due",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL AMOUNT DUE "}),cell:({row:i})=>{const d=i.original.total_amount_due,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"paid_amount",header:()=>e.jsx("div",{className:"text-center",children:" PAID AMOUNT "}),cell:({row:i})=>{const d=i.original.paid_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"change_amount",header:()=>e.jsx("div",{className:"text-center",children:" CHANGE AMOUNT "}),cell:({row:i})=>{const d=i.original.change_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"payment_method",header:()=>e.jsx("div",{className:"text-center",children:" PAYMENT METHOD "}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.payment_method||"N/A"})},{accessorKey:"reference_no",header:({column:i})=>e.jsx("div",{className:"text-center",children:"REF #"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.reference_no||"--"})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl max-h-96 flex-col gap-4",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Issuer: ",n.issued_by.firstname+" "+n.issued_by.lastname]}),e.jsx("div",{className:"overflow-x-hidden",children:e.jsx(te,{data:r,columns:c,filterWhat:"or_no",dataType:"",openModal:void 0,isLoading:a})})]})})},sn=({openModal:t})=>{const{customersList:s,isFetching:a}=kt(),l=[{accessorKey:"customer.firstname",id:"customer",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["NAME"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.firstname+" "+r.original.customer.lastname})},{id:"address",header:()=>e.jsx("div",{children:"ADDRESS"}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.address})},{id:"contact_no",header:()=>e.jsx("div",{children:"CONTACT NO"}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.contact_no})},{accessorKey:"customer.total_balance",id:"total_balance",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["BALANCE"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.customer.total_balance)})},{accessorKey:"customer.total_credit",id:"total_credit",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["CREDITS"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.customer.total_credit)})},{accessorKey:"total_transactions",id:"total_transactions",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["TRANSACTIONS"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:r.original.total_transactions})},{accessorKey:"total_sales",id:"amount_sales",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["SALES"," ",r.getIsSorted()==="asc"?e.jsx(D,{}):r.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.total_sales)})}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:s.sort((r,n)=>n.total_sales>r.total_sales?1:-1),columns:l,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:a})})},qn=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Customer Sales",children:e.jsxs(Va,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(sn,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:a,title:l==="details"?"Invoice Details":"",closeOnOverlayClick:l==="details",children:e.jsx(e.Fragment,{children:l==="details"&&e.jsx(en,{onClose:a})})})]})})})},tn=({openModal:t})=>{const{returns:s,selectedReturn:a,setSelectedReturn:l,isFetching:r}=Ts(),n=s.filter(o=>{if(o.refund_status==="pending")return o});se();const c=o=>{l(o),t(o,"details")},i=o=>{l(o),t(o,"edit")},d=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>o.toggleSorting(o.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["RETURN CODE ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.code?o.original.code:"N/A"})},{accessorKey:"invoice",sortingFn:"alphanumeric",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>o.toggleSorting(o.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["INVOICE CODE ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.invoice.code?o.original.invoice.code:"N/A"})},{accessorKey:"customer",sortingFn:"alphanumeric",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>o.toggleSorting(o.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["CUSTOMER NAME ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.invoice.customer.firstname+" "+o.original.invoice.customer.lastname})},{accessorKey:"refundable_amount",sortingFn:"text",enableSorting:!0,header:({column:o})=>e.jsx("div",{className:"flex flex-row justify-center text-center mx-auto",children:" REFUNDABLE AMOUNT "}),cell:({row:o})=>{const m=o.original.refundable_amount,u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m);return e.jsx("div",{className:"text-center",children:u})}},{accessorKey:"refund_status",sortingFn:"text",enableSorting:!0,header:({column:o})=>e.jsx("div",{className:"flex flex-row justify-center text-center mx-auto",children:" REFUND STATUS "}),cell:({row:o})=>e.jsx("div",{className:"flex items-center",children:o.original.refund_status&&e.jsx(Be,{size:20,strokeWidth:2,className:"text-amber-500 mx-auto"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:o})=>{const m=o.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>c(m),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>i(m),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve Return/Refund"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(te,{data:n,columns:d,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:r})})},an=({onClose:t})=>{const{selectedReturn:s}=Ts();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-6xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Return Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.code})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.issued_by.firstname+" "+s.issued_by.lastname})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Payment method"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.payment_method.charAt(0).toUpperCase()+s.invoice.payment_method.slice(1)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Reference number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.reference_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Refundable amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.refundable_amount)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-amber-600",children:s.refund_status.charAt(0).toUpperCase()+s.refund_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(s.updated_at)})]})]})]})})},ln=({onClose:t})=>{const{selectedReturn:s,success:a,error:l,isSubmitting:r,handleSubmit:n}=dl();return a&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsx("p",{className:"font-bold text-red-900",children:" Are you sure you want to set this return as done? "}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Return Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.code})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.issued_by.firstname+" "+s.issued_by.lastname})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Payment method"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.payment_method.charAt(0).toUpperCase()+s.invoice.payment_method.slice(1)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Reference number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.reference_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Refundable amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.refundable_amount)})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[a&&e.jsx("div",{className:"font-bold text-green-700",children:a}),l&&e.jsx("div",{className:"font-bold text-red-700",children:l}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-4 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",onClick:n,fill:"green",children:r?"Submitting":"Mark as done"})]})})]})})]})})},Hn=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Pending Return",children:e.jsxs($a,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(tn,{openModal:n})})}),e.jsx(pe,{title:l==="details"?"Return Details":"Approve Return",isOpen:t,onClose:a,children:e.jsxs(e.Fragment,{children:[l==="details"&&e.jsx(an,{onClose:a}),l==="edit"&&e.jsx(ln,{onClose:a})]})})]})})})},rn=()=>{const{selectedProductPrice:t}=Rs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Unit"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.warehouse.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Capital price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup percent"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[ce(t.markup_price/t.capital_price*100,{precision:3}).value,"%"]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.markup_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Cost"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.cost)})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sale discount"}),e.jsx("p",{className:"text-sm",children:t.on_sale===1?Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.sale_discount):"—"}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex flex-none flex-row items-center justify-end gap-1 pb-[0.1rem] pr-1",children:[t.on_sale===1?e.jsx(Ee,{size:14,strokeWidth:3.5,className:"text-green-600"}):e.jsx(fs,{size:14,strokeWidth:3.5,className:"text-gray-600"}),e.jsx("div",{className:"text-xs font-semibold leading-4 text-gray-900",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.price)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Active status"}),e.jsxs("span",{className:"flex flex-row items-center gap-2",children:[t.active_status==="active"?e.jsx(rs,{size:16,strokeWidth:2.5,className:"text-green-600"}):e.jsx(Dt,{size:16,strokeWidth:2.5,className:"text-gray-600"}),e.jsx("p",{className:"text-sm capitalize text-gray-800",children:t.active_status})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.created_by.firstname+" "+t.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(t.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm capitalize",children:t.approval_status})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.approved_by?t.approved_by.firstname+" "+t.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:de(t.updated_at)})]})]})]})})},nn=({onClose:t})=>{var C,T;const{auth:s}=se(),{selectedProductPrice:a}=Rs(),{value:l,handleChange:r,handleSubmit:n}=Ls(),[c,i]=p.useState(!1),[d,o]=p.useState(null),[m,u]=p.useState(a.capital_price),[x,y]=p.useState(us(a.capital_price,a.markup_price,3)),[f,N]=p.useState(a.markup_price),g=v=>{const S=v.target.value;u(ce(S).value),r("capital_price",ce(S).value),N(Ps(ce(S).value,x||0))},h=v=>{const S=Number(v.target.value);y(S),N(Ps(m,S))},j=v=>{const S=ce(v.target.value).value;N(S),y(us(m,S,3))};return p.useEffect(()=>{r("capital_price",m),r("markup_price",f),r("cost",hs(m,f))},[m,x,f]),p.useEffect(()=>{r("price",Wt(l.cost??a.cost,l.sale_discount??a.sale_discount))},[l.cost,l.sale_discount]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async v=>{i(!c),v.preventDefault(),n({action:"update",id:a.id,data:l}).then(()=>{i(!c),Q.success("Product price edited successfully"),t()}).catch(()=>{i(!c),o("Failed to add product listing"),Q.error("Failed to add product listing")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-4 gap-y-5 font-medium text-gray-700",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:a.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:a.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-sm",children:a.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(k,{id:"unit",name:"unit",type:"text",maxLength:20,required:!0,value:l.unit||a.unit,onChange:v=>{r("unit",v.target.value)}})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:a.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:a.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsx("p",{className:"text-sm",children:a.warehouse.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(k,{id:"capital_price",name:"capital_price",type:"number",inputMode:"numeric",min:0,step:.01,required:!0,className:"pl-7",value:m||"",onChange:g,onBlur:v=>{v.target.value=Number(m).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_percent",className:"text-sm font-bold text-gray-600",children:"Markup percent"}),e.jsx(k,{id:"markup_percent",name:"markup_percent",type:"number",inputMode:"numeric",min:0,max:1e3,step:.001,required:!0,value:x||"",onChange:h,onBlur:v=>{v.target.value=ce(x,{precision:3}).value.toString()}}),e.jsx("span",{className:"absolute bottom-0 right-0 mr-2 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"%"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_price",className:"text-sm font-bold text-gray-600",children:"Markup price"}),e.jsx(k,{id:"markup_price",name:"markup_price",type:"number",min:0,max:1e3,step:.01,className:"pl-7",value:f||"",onChange:j,onBlur:v=>{v.target.value=Number(f).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"cost",className:"text-sm font-bold text-gray-600",children:"Cost"}),e.jsx(k,{id:"cost",name:"cost",type:"number",min:0,required:!0,className:"pl-7",readOnly:!0,value:hs(m,f).toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"sale_discount",className:"text-sm font-bold text-gray-600",children:"Sale discount"}),e.jsx(k,{id:"sale_discount",name:"sale_discount",type:"number",inputMode:"numeric",min:0,step:.01,max:l.cost!==void 0?l.cost:a.cost,disabled:l.on_sale===void 0?a.on_sale===0:l.on_sale===0,required:!0,className:"pl-7",value:l.sale_discount??((C=a.sale_discount)==null?void 0:C.toFixed(2))??"",onChange:v=>{r("sale_discount",ce(v.target.value).value)},onBlur:v=>{v.target.value=Number(l.sale_discount!==void 0?l.sale_discount:a.sale_discount).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"}),e.jsxs("div",{className:"absolute right-0 top-1/2 mr-2 flex flex-none translate-y-1/4 flex-row items-center justify-start gap-2",children:[e.jsx(k,{name:"on_sale",id:"on_sale",type:"checkbox",checked:l.on_sale===void 0?a.on_sale===1:l.on_sale===1,className:"h-4 w-fit",onChange:v=>{const S=document.getElementById("sale_discount");r("on_sale",v.target.checked?1:0),!v.target.checked&&(r("sale_discount",0),S&&(S.value="0.00"))}}),e.jsx(w,{htmlFor:"on_sale",className:"text-xs font-bold text-slate-700",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"price",className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx(k,{id:"price",name:"price",type:"number",min:0,step:.01,required:!0,readOnly:!0,className:"pl-7",value:((T=l.price)==null?void 0:T.toFixed(2))||a.price.toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-row items-center justify-start	gap-3",children:[e.jsx(ze,{id:"active_status",name:"active_status",checked:l.active_status?l.active_status==="active":a.active_status==="active",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",onCheckedChange:v=>{r("active_status",v?"active":"inactive")}}),e.jsx(w,{htmlFor:"active_status",className:"text-sm font-bold text-gray-600",children:"Active"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:a.created_by.firstname+" "+a.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm",children:de(a.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approval_status",className:"text-sm font-bold text-gray-600",children:"Approval status"}),e.jsxs(X,{onValueChange:v=>{r("approval_status",v),v==="approved"?r("approved_by",s.user.id):r("approved_by","")},value:l.approval_status||a.approval_status||"",required:!0,children:[e.jsx(Z,{name:"approval_status",className:"flex flex-row items-center gap-3 bg-white text-sm capitalize",children:e.jsx(J,{placeholder:l.approval_status||a.approval_status||"Select status..."})}),e.jsxs(ee,{className:"bg-white",children:[e.jsx(V,{className:"rounded-md",value:"pending",children:"Pending"},"pending"),e.jsx(V,{className:"rounded-md",value:"approved",children:"Approved"},"approved"),e.jsx(V,{className:"rounded-md",value:"rejected",children:"Rejected"},"rejected")]})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Approved by"}),e.jsx("p",{className:"text-sm",children:a.approved_by?a.approved_by.firstname+" "+a.approved_by.lastname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm",children:de(a.updated_at)})]})]}),e.jsx("div",{className:"col-span-12 flex w-full justify-between whitespace-nowrap pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:c,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Applying changes...":"Apply changes"})]})}),d&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:d})})]})})})},cn=({handleProdPriceDetails:t,handleEditProdPrice:s,handleApproveProdPrice:a,handleRejectProdPrice:l})=>[{id:"name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",n.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):n.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"warehouse.code",sortingFn:"basic",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["WHS"," ",n.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):n.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Unit"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Capital"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:n.original.capital_price?c:"—"})})}},{accessorKey:"markup_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Markup"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.markup_price||0),i=ce(n.original.markup_price/n.original.capital_price*100,{precision:3}).value;return e.jsxs("div",{className:"flex items-center uppercase",children:[e.jsx("span",{children:c}),e.jsxs("span",{className:"text-gray-500",children:[" (",i,"%)"]})]})}},{accessorKey:"sale_discount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Discount"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.sale_discount||0);return e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:n.original.on_sale?c:e.jsx("div",{className:"group relative flex w-fit items-center",children:e.jsxs(Qe,{children:[e.jsx(Ye,{children:e.jsx(fs,{size:20,strokeWidth:2,className:"text-gray-700"})}),e.jsx(Ge,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:"Not on sale"})})]})})})})}},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Price"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:n.original.price?c:"—"})})}},{accessorKey:"active_status",sortingFn:"basic",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"ml-auto mr-auto flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Active"," ",n.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):n.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:n})=>{const c=n.original.active_status;return e.jsx("div",{className:"group relative mx-auto flex w-fit items-center justify-center",children:e.jsxs(Qe,{children:[e.jsx(Ye,{children:c==="active"?e.jsx(Ee,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(Dt,{size:20,strokeWidth:2,className:"text-gray-600"})}),e.jsx(Ge,{children:e.jsx("p",{className:"text-sm font-medium capitalize",children:c})})]})})},enableGlobalFilter:!1},{id:"actions",cell:({row:n})=>{const c=n.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>t(c),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>s(c),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{a(c.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(rs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve"})]}),e.jsxs(B,{onClick:()=>{l(c.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx($e,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Reject"})]})]})]})})},enableGlobalFilter:!1}],dn=({openModal:t,isModalOpen:s,filterWarehouse:a})=>{const{data:l,isLoading:r,setSelectedProductPrice:n}=Rs(),c=u=>{n(u),t(u,"details")},i=u=>{n(u),t(u,"edit")},{handleSubmit:d}=Ls(),o=u=>{d({action:"update",id:u,data:{approval_status:"approved"}}).then(()=>Q.success("Product price approved")).catch(()=>Q.error("Failed to approve product price"))},m=u=>{d({action:"update",id:u,data:{approval_status:"rejected"}}).then(()=>Q.success("Product price rejected")).catch(()=>Q.error("Failed to reject product price"))};return e.jsx(e.Fragment,{children:e.jsx(gs,{children:e.jsx(te,{columns:cn({handleProdPriceDetails:c,handleEditProdPrice:i,handleApproveProdPrice:o,handleRejectProdPrice:m}),data:a?l.filter(u=>u.warehouse.id===a):l,filterWhat:"name",dataType:"Listing",isLoading:r})})})},Vn=()=>{const{warehouses:t}=Ke(),[s,a]=p.useState(0),{isOpen:l,openModal:r,closeModal:n}=xe(),[c,i]=p.useState(""),d=(o,m)=>{i(m),r()};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Pending Listing",children:e.jsxs(Ba,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(X,{defaultValue:"0",onValueChange:o=>a(Number(o)),children:[e.jsx(Z,{className:"w-[300px] text-sm font-medium",children:e.jsx(J,{placeholder:"All"})}),e.jsxs(ee,{className:"text-sm font-medium capitalize",children:[e.jsx(V,{value:"0",children:"All"},"all"),t.map(o=>e.jsxs(V,{value:o.id.toString(),children:[o.name," (",o.code,")"]},o.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(dn,{openModal:d,isModalOpen:l,filterWarehouse:s})})]}),e.jsx(pe,{title:c==="details"?"Price Details":c==="edit"?"Edit Price":"",isOpen:l,onClose:n,closeOnOverlayClick:c==="details"||c==="toggle_active_stat",children:e.jsxs(e.Fragment,{children:[c==="details"&&e.jsx(rn,{}),c==="edit"&&e.jsx(nn,{onClose:n})]})})]})})})},on=({inventories:t,handleViewDetails:s,handleEditInventoryProduct:a,handleApproveInventoryProduct:l})=>[{accessorKey:"inventory_id",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Inventory"}),cell:({row:n})=>{var c;return e.jsx("div",{children:t?(c=t.find(i=>i.id===n.original.inventory_id))==null?void 0:c.code:n.original.inventory_id})}},{id:"product",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Name"," ",n.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):n.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Cap. Price"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:n.original.capital_price?c:"—"})})}},{accessorKey:"total_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Total"})},{accessorKey:"sold_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Sold"})},{accessorKey:"approved_stocks",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Approved"}),cell:({row:n})=>e.jsx("div",{children:e.jsx("span",{children:n.original.approved_stocks??0})})},{id:"actions",cell:({row:n})=>{const c=n.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{s(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>{a(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Se,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsxs(B,{onClick:()=>{l(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(rs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve stocks"})]})]})]})})},enableGlobalFilter:!1}],xn=({openModal:t})=>{const{data:s,isLoading:a,setSelectedInventoryProduct:l}=ws(),{data:r}=vs(),n=d=>{l(d),t(d,"view_details")},c=d=>{l(d),t(d,"edit")},i=d=>{l(d),t(d,"approve")};return e.jsx(e.Fragment,{children:e.jsx(te,{columns:on({inventories:r,handleViewDetails:n,handleEditInventoryProduct:c,handleApproveInventoryProduct:i}),data:s.sort((d,o)=>o.inventory_id-d.inventory_id),filterWhat:"product",isLoading:a,dataType:"Inventory Product"})})},mn=()=>{const{selectedInventoryProduct:t}=ws();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:(t==null?void 0:t.product.brand)||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.capital_price)??0)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.remaining_stocks_count})]})]})]})})},un=({onClose:t})=>{const{selectedInventoryProduct:s}=ws(),{value:a,handleChange:l,handleSubmit:r}=es(),[n,c]=p.useState(!1),i=d=>{d.preventDefault(),c(!0),r({action:"update",id:s.id,data:a}).then(()=>{Q.success("Inventory product successfully approved."),c(!1),t()}).catch(()=>{Q.error("Failed to approve inventory product."),c(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[24rem] max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:(s==null?void 0:s.product.brand)||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((s==null?void 0:s.capital_price)||0)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("form",{className:"grid w-full grid-flow-row grid-cols-11 gap-3",onSubmit:i,children:[e.jsxs("div",{className:"relative col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approved_stocks",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(k,{id:"approved_stocks",name:"approved_stocks",type:"number",min:0,step:1,max:(s==null?void 0:s.remaining_unapproved_stocks)??0,required:!0,autoFocus:!0,value:a.approved_stocks!==void 0?String(a.approved_stocks):"",onChange:d=>{l("approved_stocks",d.target.value)},onBlur:d=>{l("approved_stocks",Number(d.target.value))}}),e.jsxs("span",{className:"absolute bottom-0 right-0 -translate-x-4 -translate-y-2 pb-[2px] text-sm font-medium text-slate-700",children:["/ ",s==null?void 0:s.remaining_unapproved_stocks]})]}),e.jsx("div",{className:"col-span-1 flex items-center pt-6",children:e.jsx(zt,{size:24,strokeWidth:2,className:"mx-auto text-slate-600"})}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"prev_approved_stocks",className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx(k,{id:"prev_approved_stocks",name:"prev_approved_stocks",type:"number",readOnly:!0,value:(s==null?void 0:s.approved_stocks)||0})]}),e.jsx("div",{className:"col-span-11 flex w-full justify-between whitespace-nowrap pt-3",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:n,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Approving...":"Approve"})]})})]})]})})},hn=({onClose:t})=>{var g;const{auth:s}=se(),{selectedInventoryProduct:a}=ws(),{value:l,handleChange:r,handleSubmit:n}=es(),{suppliers:c,isFetching:i}=Ws(),[d,o]=p.useState(!1),[m,u]=p.useState(!1),[x,y]=p.useState(null),[f,N]=p.useState();return p.useEffect(()=>{const h=Ks(l.stocks_count??((a==null?void 0:a.stocks_count)||0),l.damage_count??((a==null?void 0:a.damage_count)||0));N(h),r("total_count",h)},[l.damage_count,l.stocks_count,f]),e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:async h=>{u(!m),h.preventDefault(),n({action:"update",id:a.id,data:l}).then(()=>{u(!1),Q.success("Inventory product successfully updated."),t()}).catch(()=>{u(!1),Q.error("Failed to update inventory product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsx(k,{id:"product",name:"product",type:"text",readOnly:!0,value:a==null?void 0:a.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_brand",className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx(k,{id:"product_brand",name:"product_brand",type:"text",readOnly:!0,value:a==null?void 0:a.product.brand})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_size",className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx(k,{id:"product_size",name:"product_size",type:"text",readOnly:!0,value:a==null?void 0:a.product.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_color",className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx(k,{id:"product_color",name:"product_color",type:"text",readOnly:!0,value:a==null?void 0:a.product.color})]}),e.jsxs("div",{className:`${s.role==="admin"||s.role==="super_admin"?"col-span-6":"col-span-12"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(Ce,{open:d,onOpenChange:o,children:[e.jsx(ke,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(M,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[l.supplier_id?e.jsx(e.Fragment,{children:(()=>{const h=c.find(j=>j.id===l.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:h==null?void 0:h.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:h==null?void 0:h.address})]})})()}):e.jsx("span",{children:a==null?void 0:a.supplier_id.name}),e.jsx(as,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(Fe,{className:"p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ze,{children:[e.jsx(Je,{placeholder:"Supplier name or address..."}),c===void 0&&i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(ts,{children:"No match found"}),e.jsx(Re,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ve,{children:c.map((h,j)=>e.jsxs(Me,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{r("supplier_id",h.id),o(!1)},children:[e.jsx("span",{children:h.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:h.address})]},j))})})]})})]})]}),(s.role==="admin"||s.role==="super_admin")&&e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"status",className:"text-sm font-bold text-gray-600",children:"Status"}),e.jsxs(X,{value:l.status?l.status.toString():a==null?void 0:a.status.toString(),required:!0,onValueChange:h=>r("status",h),children:[e.jsx(Z,{name:"status",id:"status",className:"w-full px-4 text-sm font-bold text-slate-700",children:e.jsx(J,{placeholder:"Select status..."})}),e.jsxs(ee,{className:"text-sm font-medium",children:[e.jsx(V,{value:"1",children:"Approved"}),e.jsx(V,{value:"0",children:"Pending"})]})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(k,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",readOnly:s.role!=="admin",defaultValue:a==null?void 0:a.capital_price.toFixed(2),onBlur:h=>{h.target.value=Number(h.target.value).toFixed(2)},onChange:h=>{const j=Number(h.target.value).toFixed(2);r("capital_price",Number(j))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(k,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,defaultValue:a==null?void 0:a.unit,onChange:h=>r("unit",h.target.value)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(k,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:((g=l.stocks_count)==null?void 0:g.toFixed(0))??(a==null?void 0:a.stocks_count)??0,onChange:h=>{r("stocks_count",Number(Number(h.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(k,{id:"damage_count",name:"damage_count",type:"number",min:0,max:l.stocks_count??(a==null?void 0:a.stocks_count),step:1,required:!0,value:l.damage_count!==void 0?String(l.damage_count):String(a==null?void 0:a.damage_count)||"",onBlur:h=>{h.target.value=Number(h.target.value).toFixed(0)},onChange:h=>r("damage_count",Number(Number(h.target.value).toFixed(0)))})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(k,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,value:f||0,className:`${f&&f<0&&"text-red-600"}`,readOnly:!0})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:m,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying...":"Apply changes"})]})}),x&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:x})})]})})})},$n=()=>{const{isOpen:t,openModal:s,closeModal:a}=xe(),[l,r]=p.useState(""),n=(c,i)=>{r(i),s()};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Pending Inventory Products",children:e.jsx(Qa,{children:e.jsxs(yt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border",children:e.jsx(xn,{openModal:n})})}),e.jsx(pe,{title:l==="add"?"Add Items":l==="edit"?"Edit Item":l==="view_details"?"Item Details":l==="approve"?"Approve Item":"",isOpen:t,onClose:a,closeOnOverlayClick:l==="view_details",children:e.jsxs(e.Fragment,{children:[l==="view_details"&&e.jsx(mn,{}),l==="edit"&&e.jsx(hn,{onClose:a}),l==="approve"&&e.jsx(un,{onClose:a})]})})]})})})})},pn=({handleViewItems:t})=>[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",a.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"invoice.code",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Invoice code"," ",a.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"refundable_amount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Refundable"}),cell:({row:a})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a.original.refundable_amount)})})},{accessorKey:"issued_by",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Issued by"}),cell:({row:a})=>e.jsx("div",{children:e.jsx("span",{children:a.original.issued_by?`${a.original.issued_by.firstname} ${a.original.issued_by.lastname}`:"—"})})},{accessorKey:"created_at",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Issued at"}),cell:({row:a})=>e.jsx("div",{children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.DateTimeFormat("en-PH",{year:"numeric",month:"long",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(new Date(a.original.created_at))})})},{id:"actions",cell:({row:a})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(Ne,{children:[e.jsx(ye,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(we,{size:16,strokeWidth:2.25})}),e.jsxs(ve,{className:"relative z-50 w-44 bg-white",children:[e.jsx(be,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{t(a.original.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(gt,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View items"})]})]})]})}),enableGlobalFilter:!1}],fn=()=>{const{data:t,isFetching:s}=Ya(),a=Te(),l=r=>{a(`/returns/${r}`)};return e.jsx(e.Fragment,{children:e.jsx(te,{columns:pn({handleViewItems:l}),data:t?t.sort((r,n)=>new Date(n.created_at).getTime()-new Date(r.created_at).getTime()):[],isLoading:s,dataType:"Returns",filterWhat:"code"})})},Bn=()=>e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Returns",children:e.jsx(Ga,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(fn,{})})})})})}),jn=()=>[{id:"product",accessorKey:"invoice_item.product.name",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Product"}),cell:({row:s})=>e.jsx("div",{children:e.jsx("span",{className:"max-w-[20ch] truncate",children:s.original.invoice_item.product.name})})},{accessorKey:"invoice_item.product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"invoice_item.product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"invoice_item.product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"invoice_item.product.serial_no",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Serial"})},{accessorKey:"quantity",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"QTY"})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Unit"})},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Selling price"}),cell:({row:s})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s.original.price)})})},{id:"subtotal",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Subtotal"}),cell:({row:s})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format((s.original.price??0)*(s.original.quantity??0))})})}],gn=()=>{const{data:t,isFetching:s}=Xa();return e.jsx(e.Fragment,{children:e.jsx(te,{columns:jn(),data:t??[],isLoading:s,dataType:"Return Items",filterWhat:"product"})})},Qn=()=>{const{id:t}=Ds(),s=Te(),a=()=>{s(-1)};return e.jsx(e.Fragment,{children:e.jsx(ne,{title:"Return items",children:e.jsx(Za,{returnTransactionId:Number(t??0),children:e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsx("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:e.jsxs(M,{onClick:()=>a(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(ps,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]})}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(gn,{})})]})})})})};export{qn as Customers,Kn as ExpensesPage,On as Inventory,Rn as InventoryItemsPage,Cn as Invoice,kn as InvoiceItems,Xn as Login,$n as PendingInventoryProduct,Vn as PendingProductPrice,Hn as PendingReturn,En as PendingTransfer,Dn as PointOfSalePage,Ln as PosReturnsPage,An as ProductPrices,Pn as Products,Un as Reports,Qn as ReturnItems,Bn as Returns,Mn as RolePermissions,In as Supplier,zn as Transaction,Tn as Transfer,Fn as UserInfo,Wn as UserSales,Sn as Warehouse};
