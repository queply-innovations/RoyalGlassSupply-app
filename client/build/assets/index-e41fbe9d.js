import{p as je,t as Ms,r as h,v as aa,w as la,x as ra,y as Ie,m as ae,z as ss,D as na,E as ca,G as ia,H as ct,I as oa,J as da,K as xa,L as ma,O as ua,Q as ha,R as it,U as pa,V as ot,W as dt,X as Os,Y as fa,Z as ge,j as e,B as _,$ as Ae,M as le,a0 as ja,a1 as xt,a2 as Le,b as ts,a3 as we,a4 as _e,a5 as Se,a6 as Ce,a7 as he,a8 as Q,a9 as mt,aa as ga,ab as Rs,ac as Na,ad as ya,ae as A,af as Ns,ag as va,ah as Qe,ai as ba,d as zs,aj as ut,ak as ht,al as pt,am as ft,an as J,ao as ee,ap as se,aq as te,ar as H,as as G,at as Gs,au as Xs,av as We,aw as b,ax as qe,ay as jt,az as gt,aA as wa,aB as _a,aC as Sa,aD as ne,aE as Me,aF as Oe,aG as ys,aH as Re,aI as Ls,aJ as vs,aK as Ye,C as He,aL as V,aM as I,aN as Nt,aO as Ke,aP as ye,aQ as fe,aR as ve,aS as as,aT as Ve,aU as $e,aV as Ge,aW as Ee,aX as Te,aY as bs,aZ as yt,a_ as vt,a$ as ps,b0 as Zs,b1 as Ca,b2 as ka,b3 as Fa,T as bt,b4 as Ia,b5 as Pa,b6 as Ze,b7 as is,b8 as os,b9 as ds,ba as xs,bb as wt,bc as Ta,bd as Aa,be as Da,bf as za,bg as Ea,bh as xe,bi as Be,bj as Ks,bk as ws,bl as Js,bm as Wa,bn as Ma,bo as Oa,bp as Ra,bq as La,br as Ka,bs as _t,bt as Ua,bu as St,bv as ns,bw as Ct,bx as kt,by as oe,bz as qa,bA as Ha,bB as Va,bC as $a,bD as Ft,bE as Ba,bF as It,bG as _s,u as Pt,bH as Tt,bI as Ss,bJ as et,bK as st,bL as tt,bM as Us,bN as Qa,bO as at,bP as Ya,bQ as Ga,bR as qs,bS as Xa,bT as Za,bU as Ja,bV as Je,_ as At,h as Dt,i as zt,k as Et,bW as Wt,l as Mt,bX as lt,bY as Ds,bZ as Hs,b_ as el,b$ as sl,c0 as Ot,c1 as tl,c2 as al,c3 as Vs,c4 as ll,c5 as Cs,c6 as rl,c7 as nl,c8 as cl,c9 as il,ca as ol}from"./index-a900e2ee.js";import{cb as yc}from"./index-a900e2ee.js";import{M as pe,f as ce,a as ke,P as be,T as ks,b as dl,u as Rt,A as xl,C as Xe,N as Lt,c as ls,g as $s,d as ml}from"./useInventoryProductCalculations-e64c1973.js";import{a as Y,I as B,D as Z,A as z,b as E,c as W,u as de,f as ul,d as ie,P as Bs}from"./timeUtils-21a12166.js";import{F as Qs,B as es,M as hl,R as ms}from"./ReportCard-f7ca525e.js";import{P as pl}from"./PosTable-5a8285d9.js";import"./index-c1554a1e.js";const fl=()=>{const t=je(),{warehouses:s}=Ms(),[l,a]=h.useState({id:s.length+1||0,code:"",name:"",location:""}),r=x=>{const{name:m,value:u}=x.target;a(d=>({...d,[m]:u}))},n={onSuccess:async()=>{await t.invalidateQueries({queryKey:["warehouses"]}),a({id:s.length+1||0,code:"",name:"",location:""})},onError:x=>{console.error("Warehouse Data failed",x)}},{mutateAsync:c}=Y({mutationKey:["removeWarehouse"],mutationFn:aa,...n}),{mutateAsync:i}=Y({mutationKey:["addWarehouse"],mutationFn:la,...n}),{mutateAsync:o}=Y({mutationKey:["updateWarehouse"],mutationFn:ra,...n});return{value:l,setValue:a,handleChange:r,removeWarehouseMutation:c,addWarehouseMutation:i,updateWarehouseMutation:o}},jl=()=>{const t=je(),{transfers:s}=Ie(),{auth:l}=ae(),{warehouses:a}=ss(),r=s[0]?s[s.length-1].id+1:1,[n,c]=h.useState(!1),[i,o]=h.useState(!1),[x,m]=h.useState(null),[u,d]=h.useState(null),[y,p]=h.useState(null),[N,j]=h.useState(),[f,g]=h.useState(),[v,F]=h.useState(),[w,k]=h.useState({});h.useEffect(()=>{k(O=>({...O,approval_status:"pending",created_by:l.user.id,transfer_schedule:""}))},[]);const P=()=>{const O=Object.keys(w).map(T=>({text:T})),R=O.length===6||O.length>6;if(R){const T=w.source!==w.destination;if(T){const X=w.transfer_schedule!=="";return X?[X,""]:[X,"Please fill up transfer schedule"]}else return[T,"You cannot have the same source and destination"]}else return[R,"Please fill up all fields"]},C=O=>{c(!0),d(null),m(null),k(R=>({...R,[O.target.name]:O.target.value}))},M=O=>{if(c(!0),d(null),m(null),O){p(O);const R=O.$H<10?"0"+O.$H.toString():O.$H.toString(),T=O.$m<10?"0"+O.$m.toString():O.$m.toString(),X=O.$s<10?"0"+O.$s.toString():O.$s.toString();k($=>({...$,transfer_schedule:w.transfer_schedule+" "+R+":"+T+":"+X}))}else p(null),k(R=>({...R,transfer_schedule:w.transfer_schedule.split(" ")[0]}))},L=(O,R)=>{var T,X,$,Pe;c(!0),d(null),m(null),k(me=>({...me,[O]:R})),console.log(O,R),O==="source"&&R==1?(j((T=a.find(me=>me.id===R))==null?void 0:T.code),g((X=a.find(me=>me.id===R+1))==null?void 0:X.code),k(me=>({...me,destination:R+1}))):O==="source"&&R==2?(j(($=a.find(me=>me.id===R))==null?void 0:$.code),g((Pe=a.find(me=>me.id===R-1))==null?void 0:Pe.code),k(me=>({...me,destination:R-1}))):O==="transfer_schedule"&&(F(R.replace(/-/g,"")),p(R))},D=async()=>{if(console.log(N,f,v),console.log(w),N&&f&&v){const O="TRF-"+N+"-"+f+"-"+v+"-"+r;k(R=>({...R,code:O}))}};h.useEffect(()=>{async function O(){if(w.code){const R=P();if(o(!0),R[0])return S(w);m(R[1]),o(!1)}}O()},[w.code]);const K={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfers"]}),o(!1),c(!1),d("Transfer info has been added")},onError:O=>{console.error(O),m(O.message),o(!1)}},{mutateAsync:S,isPending:re}=Y({mutationKey:["addTransfer"],mutationFn:na,...K});return{transfer:w,lastId:r,isChanged:n,isSubmitting:i,isPending:re,error:x,success:u,dateDisplay:y,handleSubmit:D,handleChange:C,handleChangeSelect:L,handleChangeDateTime:M,addTransferMutation:S}},Kt=()=>{const t=je(),[s,l]=h.useState({}),a=(o,x)=>{l(m=>({...m,[o]:x}))},r=async o=>{if(console.log("Submitting: ",o),o.action==="add")return await c(o.data);if(o.action==="update")return await i({id:o.id,data:o.data});{const x="No data to submit. Function requires at least one parameter.";return console.error(x),{status:400,data:x}}},n={onSuccess:async()=>{await t.invalidateQueries({queryKey:["inventory"]})},onError:o=>{console.error("Inventory Data failed",o)}},{mutateAsync:c}=Y({mutationKey:["addInventory"],mutationFn:ca,...n}),{mutateAsync:i}=Y({mutationKey:["patchInventory"],mutationFn:ia,...n});return{value:s,setValue:l,handleChange:a,handleSubmit:r}},gl=()=>{const t=je(),{transfers:s,transferProducts:l,selectedTransfer:a}=Ie(),r=l.filter(U=>U.transfer_id===a.id),{auth:n}=ae(),{warehouses:c}=ss(),[i,o]=h.useState(!1),[x,m]=h.useState(!1);h.useState(!1);const[u,d]=h.useState(!1);h.useState(!1);const[y,p]=h.useState(!1),{data:N}=ct(),[j,f]=h.useState(0),[g,v]=h.useState(!1),[F,w]=h.useState(!1),[k,P]=h.useState(null),[C,M]=h.useState(null),[L,D]=h.useState(new Date),[K,S]=h.useState(new Date),[re,O]=h.useState(""),[R,T]=h.useState(),X=s[s.length-1].id+1,[$,Pe]=h.useState({});if(h.useEffect(()=>{a&&(Pe({id:a.id,code:a.code,created_by:a.created_by.id,source:a.source.id,destination:a.destination.id,transfer_schedule:a.transfer_schedule,approval_status:a.approval_status,approved_by:a.approved_by?a.approved_by.id:null,transfer_status:a.transfer_status,date_received:a.date_received,received_by:a.received_by?a.received_by.id:null,notes:a.notes}),D(new Date(a.transfer_schedule)),a.date_received?S(new Date(a.date_received)):S(new Date(a.transfer_schedule)))},[a]),$.code==""){const U=$.transfer_schedule.split(" ")[0].split("-").join(""),ue="TRF-"+a.source.code+"-"+a.destination.code+"-"+U+"-"+X;Pe(Ue=>({...Ue,code:ue}))}const me=()=>{const U=$.source!==$.destination;if(U){const ue=$.transfer_status==="arrived"?!!($.received_by&&$.date_received):!0;if(ue)return[ue,""];{const Ue=`Fields you need to fill: ${$.received_by?"":"received by"} 
									${!$.date_received&&!$.received_by?" and ":""}
									${$.date_received?"":"date received"}`;return[ue,Ue]}}else return[U,"You cannot have the same source and destination"]},Is=U=>{v(!0),M(null),P(null),Pe(ue=>({...ue,[U.target.name]:U.target.value}))},us=(U,ue)=>{v(!0),M(null),P(null),O(U),T(ue),U==="transfer_schedule"?D(ue):S(ue)};h.useEffect(()=>{async function U(){if(re&&R){const ue=R.getFullYear()+"-"+(R.getMonth()+1)+"-"+R.getDate()+" "+R.getHours()+":"+R.getMinutes()+":"+R.getSeconds();Pe(Ue=>({...Ue,[re]:ue}))}}U()},[L,K]);const hs=(U,ue)=>{console.log(U,ue),v(!0),M(null),P(null),Pe(Ue=>({...Ue,[U]:ue}))};h.useEffect(()=>{$.approval_status==="approved"?Pe(U=>({...U,approved_by:n.user.id})):$.approval_status==="rejected"&&p(!0)},[$.approval_status]),h.useEffect(()=>{$.transfer_status==="arrived"?o(!0):o(!1)},[$.transfer_status]),h.useEffect(()=>{if(x){async function U(){const Ue={code:"INV-"+c.filter(ta=>ta.id===$.destination)[0].code+"-TRA-"+a.code.split("-")[3]+"-"+(Number(N.length)+1).toString(),warehouse_id:$.destination,created_by:$.created_by,date_received:$.date_received,type:"transfer",transfer_id:$.id,notes:$.notes},sa=await rs(Ue);f(sa.data.data.id)}U()}},[x]);async function Ps(){await ma(r,j).then(async U=>{w(!1),v(!1),M("Transfer info has been edited")}).catch(U=>{throw console.error("Error updating inventory products:",U),U})}h.useEffect(()=>{j!=0&&Ps()},[j]);const q=async()=>{const U=me();if(w(!0),U[0])if(i)await De($);else return await De($);else P(U[1]),w(!1)},Fe={onSuccess:async()=>{if(await t.invalidateQueries({queryKey:["transfers"]}),i)m(!0);else{if(y)return await As(r);w(!1),v(!1),M("Transfer info has been edited")}},onError:U=>{console.error(U),P(U.message),w(!1)}},{mutateAsync:De}=Y({mutationKey:["transfers"],mutationFn:oa,...Fe}),ze={onSuccess:async()=>{await t.invalidateQueries({queryKey:["inventory"]}),d(!0)},onError:U=>{console.error(U),P(U.message),w(!1)}},{mutateAsync:rs}=Y({mutationKey:["addInventory"],mutationFn:da,...ze}),Ts={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfer_products"]}),w(!1),v(!1),M("Transfer info has been edited")},onError:U=>{console.error(U),P(U.message),w(!1)}},{mutateAsync:As}=Y({mutationKey:["initInventoryProduct"],mutationFn:xa,...Ts});return{transfer:$,selectedTransfer:a,lastId:X,isChanged:g,isSubmitting:F,error:k,success:C,dateDisplay:L,dateDisplayArrived:K,handleSubmit:q,handleChange:Is,handleChangeSelect:hs,handleChangeDateTime:us,editTransferMutation:De}},Ys=()=>{const t=je(),[s,l]=h.useState({}),a=(o,x)=>{l(m=>({...m,[o]:x}))},r=async o=>{if(console.log("Submitting: ",o),o.action==="add")return await c(o.data);if(o.action==="update")return await i({id:o.id,data:o.data});{const x="No data to submit. Function requires at least one parameter.";return console.error(x),{status:400,data:x}}},n={onSuccess:async()=>{await t.invalidateQueries({predicate:o=>["productPrices","pendingProductPrices","approvedProductPrices","productPricesTEST"].includes(o.queryKey[0])}),l({})},onError:o=>{console.error("Product Prices Data failed",o)}},{mutateAsync:c}=Y({mutationKey:["addProductListing"],mutationFn:ua,...n}),{mutateAsync:i}=Y({mutationKey:["patchProductListing"],mutationFn:ha,...n});return{value:s,setValue:l,handleChange:a,handleSubmit:r,addProductPricesMutation:c,patchProductPricesMutation:i}},Fs=()=>{const t=je(),{transfers:s,transferProducts:l,selectedProduct:a,selectedTransfer:r,addProd:n}=Ie();ae();const{data:c,isLoading:i}=it(),{data:o}=pa(),{data:x,isLoading:m}=ct(),u=x.filter(q=>q.warehouse.id===r.source.id&&o.some(Fe=>Fe.inventory_id===q.id)),[d,y]=h.useState([]),[p,N]=h.useState(0),[j,f]=h.useState(""),[g,v]=h.useState(a.id?a.product.name:""),[F,w]=h.useState(0),[k,P]=h.useState(0),[C,M]=h.useState(!1),[L,D]=h.useState(!1),[K,S]=h.useState(null),[re,O]=h.useState(null),[R,T]=h.useState({});function X(){a.id?T(q=>({...q,id:a.id,transfer_id:a.transfer_id,unit:a.unit,source_inventory:p})):T(q=>({...q,id:l.length+1,transfer_id:r.id}))}h.useEffect(()=>{T(n?q=>({...q,id:l.length+1,transfer_id:r.id}):{id:a.id,transfer_id:a.transfer_id,product_id:a.product.id,total_quantity:a.total_quantity,capital_price:a.capital_price,unit:a.unit,source_inventory:a.source_inventory})},[]),h.useEffect(()=>{if(!n){const q=o.find(Fe=>Fe.id===a.source_inventory);w(q!=null&&q.remaining_stocks_count?q.remaining_stocks_count:0),P(q!=null&&q.damage_count?q.damage_count:0),N(a.source_inventory)}},[o]);const $=(q,Fe)=>{M(!0),O(null),S(null),T(De=>({...De,[q.target.name]:Number(q.target.value)}))},Pe=(q,Fe,De)=>{if(M(!0),O(null),S(null),q==="product_id"&&De!=null){const ze=d[De];v(ze.product.name);const rs=ze.capital_price,Ts=ze.unit,As=Number(Fe);T(U=>({...U,[q]:As,capital_price:rs,unit:Ts,source_inventory:p})),w(ze.remaining_stocks_count?ze.remaining_stocks_count:0),P(ze.damage_count)}else if(q==="inventory_id"){f(Fe.toString());const ze=u==null?void 0:u.filter(rs=>rs.id===Fe)[0].id;N(ze),v(""),R.capital_price&&(X(),T({}))}};h.useEffect(()=>{o.length!=0&&y(o.filter(q=>q.inventory_id===p&&q.remaining_stocks_count&&q.remaining_stocks_count>0))},[p]);const me=()=>{const Fe=Object.keys(R).map(De=>({text:De})).length===7;return Fe?R.total_quantity>F?[!1,"Quantity input is greater than the current stock quantity."]:[!0,""]:[Fe,"Please fill up all fields"]},Is=async()=>{D(!0);const q=me();if(q[0])return n?await hs(R):await Ps(R);S(q[1]),D(!1)},us={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfer_products"]}),D(!1),M(!1),O(n?"Transfer product has been added":"Transfer product has been edited")},onError:q=>{console.error(q),S(q.message),D(!1)}},{mutateAsync:hs}=Y({mutationKey:["transfer_product"],mutationFn:ot,...us}),{mutateAsync:Ps}=Y({mutationKey:["transfer_product"],mutationFn:dt,...us});return{product:R,allProducts:c,allInventoryProducts:o,isInventoryLoading:m,isAllProductsLoading:i,inventoryID:p,invCode:j,prodName:g,filteredInventoriesSrc:u,filteredProductsSrc:d,quantityLimit:F,damagedCount:k,isChanged:C,isSubmitting:L,error:K,success:re,handleSubmit:Is,handleChange:$,handleChangeSelect:Pe,addProductMutation:hs}},Nl=()=>{const{selectedReturn:t}=Os(),[s,l]=h.useState(!1),[a,r]=h.useState(null),[n,c]=h.useState(null),[i,o]=h.useState({id:t.id,code:t.code,invoice_id:t.invoice.id,issued_by:t.issued_by.id,refundable_amount:t.refundable_amount,voucher_id:t.voucher?t.voucher.id:null,refund_status:"done",created_at:t.created_at,updated_at:t.updated_at}),x=async()=>{l(!0),await u(i)},m={onSuccess:async()=>{l(!1),c("Return info has been edited")},onError:d=>{console.error(d),r(d.response.data.message),l(!1)}},{mutateAsync:u}=Y({mutationKey:["returns"],mutationFn:fa,...m});return{selectedReturn:t,isSubmitting:s,error:a,success:n,handleSubmit:x}};/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=ge("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=ge("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=ge("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=ge("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=ge("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=ge("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=ge("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=ge("CircleOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.35 2.69A10 10 0 0 1 21.3 15.65",key:"1pfsoa"}],["path",{d:"M19.08 19.08A10 10 0 1 1 4.92 4.92",key:"1ablyi"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=ge("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=ge("MapPinned",[["path",{d:"M18 8c0 4.5-6 9-6 9s-6-4.5-6-9a6 6 0 0 1 12 0",key:"yrbn30"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M8.835 14H5a1 1 0 0 0-.9.7l-2 6c-.1.1-.1.2-.1.3 0 .6.4 1 1 1h18c.6 0 1-.4 1-1 0-.1 0-.2-.1-.3l-2-6a1 1 0 0 0-.9-.7h-3.835",key:"112zkj"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=ge("MoveRight",[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=ge("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=ge("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _l=ge("ShoppingBasket",[["path",{d:"m15 11-1 9",key:"5wnq3a"}],["path",{d:"m19 11-4-7",key:"cnml18"}],["path",{d:"M2 11h20",key:"3eubbj"}],["path",{d:"m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4",key:"yiazzp"}],["path",{d:"M4.5 15.5h15",key:"13mye1"}],["path",{d:"m5 11 4-7",key:"116ra9"}],["path",{d:"m9 11 1 9",key:"1ojof7"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=ge("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Cl=({isUpdate:t=!1,onClose:s,isDelete:l})=>{const{warehouseSelected:a}=Ms(),{value:r,setValue:n,handleChange:c,addWarehouseMutation:i,updateWarehouseMutation:o,removeWarehouseMutation:x}=fl();h.useEffect(()=>{(t||l)&&n(a)},[t,l,a,n]);const[m,u]=h.useState(!1),[d,y]=h.useState(null),[p,N]=h.useState(null),j=async()=>{u(!0);try{await new Promise(f=>setTimeout(f,1e3)),t&&(await o(r),u(!1),y("Warehouse updated successfully"),s()),l?(await x(r.id),u(!1),y("Warehouse deleted successfully"),s()):!t&&!l&&(await i(r),u(!1),y("Warehouse added successfully"),s())}catch(f){console.error("Warehouse data submission failed",f),u(!1),N(f.message)}};return e.jsx(e.Fragment,{children:l?e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:f=>{f.preventDefault(),j()},children:e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx(_,{type:"submit",fill:"red",children:l?"Delete Warehouse":"Add Warehouse"})})})}):e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:f=>{f.preventDefault(),j()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse ID"}),e.jsx(B,{name:"id",value:(r==null?void 0:r.id)||0,type:"number",disabled:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Code"}),e.jsx(B,{name:"code",placeholder:"Warehouse Code",value:(r==null?void 0:r.code)||"",onChange:c,maxLength:3})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Name"}),e.jsx(B,{name:"name",placeholder:"Warehouse Name",value:(r==null?void 0:r.name)||"",onChange:c,required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Location"}),e.jsx(B,{name:"location",placeholder:"Warehouse Location",type:"string",value:(r==null?void 0:r.location)||"",onChange:c,required:!0})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[d&&e.jsx("div",{className:"font-bold text-green-700",children:d}),p&&e.jsx("div",{className:"font-bold text-red-700",children:p}),m?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:s,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",children:t?"Update Warehouse":"Add Warehouse"})]})})]})})]})})})})},kl=({openModal:t})=>{const{warehouses:s,setWarehouseSelected:l,isFetching:a,progress:r}=Ms(),n=[{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE ID"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.id})},{accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:i})=>e.jsx("div",{className:"items-center",children:e.jsxs(_,{onClick:()=>i.toggleSorting(i.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["WAREHOUSE NAME ",i.getIsSorted()==="asc"?e.jsx(z,{}):i.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.name})},{accessorKey:"code",header:()=>e.jsx("div",{className:"text-center",children:"code"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.code})},{accessorKey:"location",header:()=>e.jsx("div",{className:"text-center",children:"LOCATION"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.location})},{id:"actions",header:()=>e.jsx("div",{className:"flex flex-row justify-center",children:"ACTIONS"}),cell:({row:i})=>{const o=i.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(_,{fill:"empty",textColor:"black",onClick:()=>c(o),className:"flex flex-row items-center gap-2",children:[e.jsx(Qs,{})," Edit"]})})}}],c=i=>{l(i),t(i,"edit")};return e.jsx(e.Fragment,{children:e.jsx(Z,{data:s,columns:n,filterWhat:"location",dataType:"",isLoading:a,openModal:void 0})})},Qn=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Warehouse",children:e.jsxs(ja,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(kl,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:l,title:a==="edit"?"Edit Warehouse":a==="remove"?"Remove Warehouse":"Add Warehouse",children:e.jsx(Cl,{onClose:l,isUpdate:a==="edit",isDelete:a==="remove"})})]})})})},Fl=({openModal:t})=>{const{invoices:s}=xt(),l=Le(),a=[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx(e.Fragment,{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",r.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})}),cell:({row:r})=>e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{className:"font-bold",children:r.original.code})})},{accessorKey:"warehouse.code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Warehouse"," ",r.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"payment_method",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Type"," ",r.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})}),cell:({row:r})=>{const n=r.original.payment_method.split("_").join(" ");return e.jsx(e.Fragment,{children:e.jsx("span",{className:"capitalize",children:n})})}},{accessorKey:"is_paid",header:({})=>e.jsx("span",{children:"Balance Amount"}),cell:({row:r})=>{const n=r.original.is_paid;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"group relative flex w-fit items-center justify-center",children:n===1?e.jsx("span",{children:"——"}):n===0?e.jsx("span",{className:"",children:ce(r.original.balance_amount)}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})})}},{accessorKey:"total_amount_due",header:({column:r})=>e.jsx("span",{children:"Total Amount"}),cell:({row:r})=>ce(r.original.total_amount_due)},{id:"actions",cell:({row:r})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>{l(`/transaction/items/${r.original.id}`)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(_l,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View Invoice"})]})]})]})}),enableGlobalFilter:!1}];return e.jsx(e.Fragment,{children:e.jsx(Z,{columns:a,data:s.sort((r,n)=>{const c=new Date(r.updated_at??r.created_at);return new Date(n.updated_at??n.created_at).getTime()-c.getTime()}),filterWhat:"code",dataType:"Invoices"})})},Yn=({})=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i),console.log("modalAction:",a)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Transactions",children:e.jsx(mt,{children:e.jsx(ga,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Fl,{openModal:n})})})})})})})},Il=({items:t})=>{const s=[{id:"orderItem",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Item #"}),cell:({row:l})=>e.jsxs("div",{className:"flex flex-row gap-2 ",children:[l.original.product.brand?e.jsx(e.Fragment,{children:e.jsxs("span",{children:["(",l.original.product.brand,")"]})}):null,e.jsx("span",{className:"font-bold",children:l.original.product.name}),e.jsx("span",{className:"",children:l.original.product.size}),e.jsx("span",{className:"",children:l.original.product.color})]}),size:200},{id:"quantity",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Quantity"}),cell:({row:l})=>e.jsx("div",{className:"flex ",children:l.original.quantity})},{id:"price",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Price"}),cell:({row:l})=>e.jsx("div",{className:"flex ",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(l.original.product_price??0)})}];return e.jsx(e.Fragment,{children:e.jsx(Z,{columns:s,data:t,dataType:"orderItem",filterWhat:"price",hideFilter:!0})})},Gn=({})=>{const t=Le(),{id:s}=Rs(),{data:l,isLoading:a}=Na(Number(s)),{invoiceItems:r,isLoading:n}=ya(Number(s)),c=()=>{t(-1)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Transaction Items",children:e.jsxs("div",{className:"flex h-full max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:[e.jsxs("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:[e.jsxs(A,{onClick:()=>c(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(Ns,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]}),e.jsxs("div",{className:"flex flex-row gap-8",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Inventory code:"}),e.jsx("span",{children:a?"Loading...":l==null?void 0:l.code})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Created at:"}),e.jsx("span",{children:a?"Loading...":ul(l==null?void 0:l.created_at)})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Issued By:"}),e.jsx("span",{children:a?"Loading...":(l==null?void 0:l.issued_by.firstname)+" "+(l==null?void 0:l.issued_by.lastname)})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Customer:"}),e.jsx("span",{className:"capitalize",children:a?"Loading...":(l==null?void 0:l.customer.firstname)+" "+(l==null?void 0:l.customer.lastname)})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Total Amount Due:"}),e.jsx("span",{children:a?"Loading...":ce(l==null?void 0:l.total_amount_due)})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Warehouse:"}),e.jsx("span",{children:a?"Loading...":l==null?void 0:l.warehouse.code})]})]}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Balance Amount:"}),e.jsx("span",{children:a?"Loading...":ce(l==null?void 0:l.balance_amount)})]})})]})]}),e.jsx("div",{children:!n&&e.jsx(e.Fragment,{children:e.jsx(Il,{items:r})})})]})})})},Pl=(t,s)=>{const l=je(),[a,r]=h.useState(""),[n,c]=h.useState(""),[i,o]=h.useState({firstname:t.firstname,lastname:t.lastname,username:t.username,email:t.email,contact_no:t.contact_no,position:t.position,user_id:t.id,role_id:0});h.useEffect(()=>{s&&o(k=>{var P;return{...k,role_id:(P=s.find(C=>C.title===t.position))==null?void 0:P.id}})},[s]);const[x,m]=h.useState(!1),[u,d]=h.useState(!1),[y,p]=h.useState(null),[N,j]=h.useState(null),f=(k,P)=>{m(!0),j(null),p(null),o(C=>({...C,[k]:P}))},g=k=>{m(!0),j(null),k.target.name==="position"?o(P=>{var C;return{...P,[k.target.name]:k.target.value,role_id:(C=s.find(M=>M.title===k.target.value))==null?void 0:C.id}}):k.target.name==="new_password"?r(k.target.value):k.target.name==="confirm_password"?c(k.target.value):o(P=>({...P,[k.target.name]:k.target.value}))};h.useEffect(()=>{a!=n?p("Passwords don't match"):p(null)},[a,n]);const v=async()=>{var k,P;((k=i.contact_no)==null?void 0:k.length)>11||((P=i.contact_no)==null?void 0:P.length)<11?p("Contact number must be 11 digits"):(d(!0),a!==""&&n!==""&&o(C=>({...C,password:n})))};h.useEffect(()=>{u&&w(i)},[i,u]);const F={onSuccess:async()=>{await l.invalidateQueries({queryKey:["users"]}),d(!1),m(!1),j("User info has been updated")},onError:k=>{console.error(k),p(k.message),d(!1)}},{mutateAsync:w}=Y({mutationKey:["editUser"],mutationFn:va,...F});return{user:i,isChanged:x,isSubmitting:u,password:a,compPassword:n,error:y,setError:p,success:N,handleSubmit:v,handleChangeSelect:f,handleChange:g,editUserMutation:w}},Tl=()=>{const t=je(),{users:s}=Qe(),{roles:l}=Qe();s[s.length-1].id+1;const[a,r]=h.useState({});h.useEffect(()=>{r(v=>({...v,active_status:"active"}))},[]);const[n,c]=h.useState(!1),[i,o]=h.useState(!1),[x,m]=h.useState(null),[u,d]=h.useState(null),y=()=>{var w,k;const F=Object.keys(a).map(P=>({text:P})).length===10;if(F){const P=a.password===a.password_confirmation;if(!P)return[P,"Passwords do not match"];const C=!(((w=a.contact_no)==null?void 0:w.length)>11||((k=a.contact_no)==null?void 0:k.length)<11);return C?[F&&P&&C,""]:[C,"Please input a valid contact number"]}else{const P=!!a.position;return P?[F,"Please correctly fill up all fields"]:[P,"Please choose a position"]}},p=v=>{c(!0),d(null),m(null),r(F=>({...F,[v.target.name]:v.target.value}))},N=(v,F)=>{c(!0),d(null),m(null),r(w=>{var k;return{...w,[v]:F,role_id:(k=l.find(P=>P.title===F))==null?void 0:k.id}})},j=async()=>{const v=y();if(o(!0),v[0])return await g(a);m(v[1]),o(!1)},f={onSuccess:async()=>{await t.invalidateQueries({queryKey:["users"]}),o(!1),c(!1),d("User info has been added")},onError:v=>{console.error(v),m(v.response.data.message),o(!1)}},{mutateAsync:g}=Y({mutationKey:["addUser"],mutationFn:ba,...f});return{user:a,isChanged:n,isSubmitting:i,error:x,setError:m,success:u,handleSubmit:j,handleChange:p,handleChangeSelect:N,addUserMutation:g}},Al=()=>{const t=je(),{roles:s,selectedUser:l}=Qe(),a=s.filter(L=>L.title===l.position),[r,n]=h.useState([]),[c,i]=h.useState([]),[o,x]=h.useState([]),{data:m}=zs({queryKey:["all-permissions"],queryFn:()=>pt(),refetchOnWindowFocus:!1});h.useEffect(()=>{const L=m;L&&i(L)},[m]);const{isFetching:u,data:d}=zs({queryKey:["permissions"],queryFn:()=>ft(a[0].id),refetchOnWindowFocus:!1});h.useEffect(()=>{const L=d;L&&(n(L),x(L))},[d]);const[y,p]=h.useState(!1),[N,j]=h.useState(!1),[f,g]=h.useState(null),[v,F]=h.useState(null),w=(L,D)=>{p(!0),F(null),g(null),x(L?[...o,{id:null,role_id:a,permission_id:D}]:o.filter(K=>K.permission_id!==D))},k=async()=>{if(j(!0),o.length>r.length){const L=o.filter(D=>D.id===null);if(L.length>1)L.forEach(async D=>{await C(D)});else return await C(L)}else if(o.length<r.length){const L=r.filter(D=>o.find(K=>K.permission_id===D.permission_id)===void 0);if(L.length>1)L.forEach(async D=>{await M(D)});else return await M(L[0])}else j(!1),p(!1),F("No changes made")},P={onSuccess:async()=>{await t.invalidateQueries({queryKey:["all-permissions"]}),j(!1),p(!1),F("Role permissions have been updated")},onError:L=>{console.error(L),g(L.message),j(!1)}},{mutateAsync:C}=Y({mutationKey:["addpermission"],mutationFn:ut,...P}),{mutateAsync:M}=Y({mutationKey:["deletepermission"],mutationFn:ht,...P});return{permissions:r,allPermissions:c,permissionChange:o,isChanged:y,isSubmitting:N,error:f,success:v,handleSubmit:k,handleChange:w}},Dl=()=>{const t=je(),{roles:s}=Qe(),[l,a]=h.useState(),[r,n]=h.useState(0);h.useState();const[c,i]=h.useState([]),[o,x]=h.useState([]),[m,u]=h.useState([]),{data:d}=zs({queryKey:["all-permissions"],queryFn:()=>pt(),refetchOnWindowFocus:!1});h.useEffect(()=>{const D=d;D&&x(D)},[d]);const[y,p]=h.useState(!1),[N,j]=h.useState(!1),[f,g]=h.useState(null),[v,F]=h.useState(null),w=(D,K)=>{F(null),g(null),a(s.find(S=>S.title===K)),n(s.find(S=>S.title===K).id)};h.useEffect(()=>{async function D(){const K=await ft(r);i(K),u(K)}D()},[r]);const k=(D,K)=>{p(!0),F(null),g(null),u(D?[...m,{id:null,role_id:r,permission_id:K}]:m.filter(S=>S.permission_id!==K))},P=async()=>{if(j(!0),m.length>c.length){const D=m.filter(K=>K.id===null);if(D.length>1)D.forEach(async K=>{await M(K)});else return await M(D[0])}else if(m.length<c.length){const D=c.filter(K=>m.find(S=>S.permission_id===K.permission_id)===void 0);if(D.length>1)D.forEach(async K=>{await L(K)});else return await L(D[0])}else j(!1),p(!1),F("No changes made")},C={onSuccess:async()=>{await t.invalidateQueries({queryKey:["all-permissions"]}),j(!1),p(!1),F("Role permissions have been updated")},onError:D=>{console.error(D),g(D.message),j(!1)}},{mutateAsync:M}=Y({mutationKey:["addpermission"],mutationFn:ut,...C}),{mutateAsync:L}=Y({mutationKey:["deletepermission"],mutationFn:ht,...C});return{roles:s,roleSelect:l,permissions:c,allPermissions:o,permissionChange:m,roleId:r,isChanged:y,isSubmitting:N,error:f,success:v,handleSubmit:P,handleChange:k,handleChangeSelect:w}},zl=({openModal:t})=>{const{users:s,isFetching:l,progress:a,progress2:r,setSelectedUser:n}=Qe(),c=m=>{n(m),t(m,"edit")},i=m=>{n(m),t(m,"editPerms")},o=()=>{t({},"add")},x=[{accessorKey:"lastname",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{m.toggleSorting(m.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["LAST NAME ",m.getIsSorted()==="asc"?e.jsx(z,{}):m.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.lastname})},{accessorKey:"firstname",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>m.toggleSorting(m.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["FIRST NAME ",m.getIsSorted()==="asc"?e.jsx(z,{}):m.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.firstname})},{accessorKey:"position",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>m.toggleSorting(m.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["ROLE ",m.getIsSorted()==="asc"?e.jsx(z,{}):m.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.position})},{accessorKey:"username",header:()=>e.jsx("div",{className:"text-center",children:"USERNAME"}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.username})},{accessorKey:"email",header:()=>e.jsx("div",{className:"text-center",children:"EMAIL ADDRESS"}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.email})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:m})=>{const u=m.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>c(u),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit User"})]}),e.jsxs(Q,{onClick:()=>i(u),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit User Permission"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:s,columns:x,filterWhat:"username",dataType:"User",openModal:o,isLoading:l})})},El=({onClose:t})=>{const{user:s,isChanged:l,isSubmitting:a,error:r,setError:n,success:c,handleSubmit:i,handleChange:o,handleChangeSelect:x}=Tl(),{roles:m}=Qe(),u=m==null?void 0:m.filter(d=>d.title!=="super_admin");return u&&u.map(d=>d.title.replace("_"," ")),c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:d=>{d.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User ID"}),e.jsx(B,{name:"id",value:s.id,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User First Name"}),e.jsx(B,{name:"firstname",placeholder:"User First Name",value:s.firstname||"",onChange:o,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Last Name"}),e.jsx(B,{name:"lastname",placeholder:"User Last Name",value:s.lastname||"",onChange:o,required:!0})]})]}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Email Address"}),e.jsx(B,{name:"email",placeholder:"User Email Address",type:"email",value:s.email||"",onChange:o,onKeyDown:d=>{d.code==="Space"?(d.preventDefault(),n("Space not allowed")):n(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Contact Number"}),e.jsx(B,{name:"contact_no",placeholder:"User Contact Number",type:"number",value:s.contact_no||"",onChange:o,onKeyDown:d=>{d.code==="Space"?(d.preventDefault(),n("Space not allowed")):n(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Position"}),e.jsxs(J,{onValueChange:d=>x("position",d),children:[e.jsx(ee,{name:"position",className:"flex flex-row items-center gap-3 truncate text-md rounded-md bg-slate-100",children:e.jsx(se,{placeholder:s.position?s.position.charAt(0).toUpperCase()+s.position.slice(1):"Choose position..."})}),e.jsx(te,{className:"bg-white font-medium text-md",children:m.length>0?m.map(d=>{if(d.title!=="super_admin")return e.jsx(H,{value:d.title,children:d.title.charAt(0).toUpperCase()+d.title.slice(1).replace("_"," ")},d.id)}):e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]})]}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Username"}),e.jsx(B,{name:"username",placeholder:"User Username",type:"string",value:s.username||"",onChange:o,onKeyDown:d=>{d.code==="Space"?(d.preventDefault(),n("Space not allowed")):n(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Password"}),e.jsx(B,{name:"password",placeholder:"User Password",type:"password",value:s.password||"",onChange:o,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Confirm Password"}),e.jsx(B,{name:"password_confirmation",placeholder:"Confirm Password",type:"password",value:s.password_confirmation||"",onChange:o,required:!0})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),a?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),l&&e.jsx(_,{type:"submit",fill:"green",onClick:i,children:a?"Submitting":"Add User"})]})})]})})]})})})},Wl=({onClose:t})=>{const{selectedUser:s,roles:l}=Qe(),{auth:a}=ae(),{user:r,isChanged:n,isSubmitting:c,password:i,compPassword:o,error:x,setError:m,success:u,handleSubmit:d,handleChange:y,handleChangeSelect:p}=Pl(s,l),[N,j]=h.useState(!1),f=()=>{j(!N)},[g,v]=h.useState(!1),F=()=>{v(!g)};return u&&setTimeout(()=>{t()},1e3),e.jsxs(e.Fragment,{children:[s.id===a.user.id&&e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-6 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-6 font-bold text-red-700 text-start",children:["Warning: Be careful! You are editing your own account.",e.jsx("br",{}),"You are at risk of locking yourself out."]})}),e.jsx("form",{onSubmit:async w=>{w.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"id",children:"User ID"}),e.jsx(B,{type:"text",name:"id",placeholder:"User ID",className:"inputbox",value:r.user_id,disabled:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"First name"}),e.jsx(B,{type:"text",name:"firstname",placeholder:"First name",className:"inputbox rounded-md bg-slate-100",value:r.firstname,onChange:y})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Last name"}),e.jsx(B,{type:"text",name:"lastname",placeholder:"Last name",className:"inputbox rounded-md bg-slate-100",value:r.lastname,onChange:y})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"username",children:"Username"}),e.jsx(B,{type:"text",name:"username",placeholder:"Username",className:"inputbox rounded-md bg-slate-100",value:r.username,onChange:y,onKeyDown:w=>{w.code==="Space"?(w.preventDefault(),m("Space not allowed")):m(null)}})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Email address"}),e.jsx(B,{type:"email",name:"email",placeholder:"Email address",className:"inputbox rounded-md bg-slate-100",value:r.email,onChange:y,onKeyDown:w=>{w.code==="Space"?(w.preventDefault(),m("Space not allowed")):m(null)}})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Contact number"}),e.jsx(B,{type:"number",name:"contact_no",placeholder:"09XXXXXXXXX",className:"inputbox rounded-md bg-slate-100",value:r.contact_no,onChange:y,onKeyDown:w=>{w.code==="Space"?(w.preventDefault(),m("Space not allowed")):m(null)}})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"position",children:"Position"}),e.jsxs(J,{onValueChange:w=>p("position",w),children:[e.jsx(ee,{name:"position",className:"flex flex-row items-center gap-3 truncate text-md rounded-md bg-slate-100",children:e.jsx(se,{placeholder:r.position?r.position.charAt(0).toUpperCase()+r.position.slice(1):"Choose position..."})}),e.jsx(te,{className:"bg-white font-medium text-md",children:l.length>0?l.map(w=>{if(w.title!=="super_admin")return e.jsx(H,{value:w.title,children:w.title.charAt(0).toUpperCase()+w.title.slice(1)},w.id)}):e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-6 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Change password (optional)"}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx(B,{type:N?"text":"password",name:"new_password",placeholder:"New pasword",className:"inputbox rounded-md bg-slate-100",value:i||"",onChange:y,onKeyDown:w=>{w.code==="Space"?(w.preventDefault(),m("Space not allowed")):m(null)}}),N?e.jsx(Gs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:f}):e.jsx(Xs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:f})]})]}),e.jsxs("div",{className:"flex flex-col col-span-6 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Confirm new password"}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx(B,{type:g?"text":"password",name:"confirm_password",placeholder:"Confirm password",className:"inputbox rounded-md bg-slate-100",value:o,onChange:y,onKeyDown:w=>{w.code==="Space"?(w.preventDefault(),m("Space not allowed")):m(null)}}),g?e.jsx(Gs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:F}):e.jsx(Xs,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:F})]})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[u&&e.jsx("div",{className:"font-bold text-green-700",children:u}),x&&e.jsx("div",{className:"font-bold text-red-700",children:x}),c?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),n&&i===o&&e.jsx(_,{type:"submit",fill:n?"green":null,disabled:!n,onClick:d,children:c?"Submitting":"Edit User"})]})})]})})]})})]})},Ml=({onClose:t})=>{const{selectedUser:s}=Qe(),{permissions:l,allPermissions:a,permissionChange:r,isChanged:n,isSubmitting:c,error:i,success:o,handleChange:x,handleSubmit:m}=Al(),{auth:u}=ae(),d=a.filter(j=>Object.keys(j).some(f=>!j.title.includes("view".toLowerCase())&&j.title.includes("users".toLowerCase()))),y=a.filter(j=>Object.keys(j).some(f=>!j.title.includes("view".toLowerCase())&&!j.title.includes("transfer".toLowerCase())&&j.title.includes("product".toLowerCase())||j.title.includes("catalog".toLowerCase()))),p=a.filter(j=>Object.keys(j).some(f=>!j.title.includes("view".toLowerCase())&&j.title.includes("transfer".toLowerCase()))),N=a.filter(j=>Object.keys(j).some(f=>j.title.includes("view".toLowerCase())));return o&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto flex h-72 w-full flex-row divide-x",children:[e.jsxs("div",{className:"flex w-60 flex-none flex-col p-2 pt-8",children:[e.jsx("h3",{className:"ml-4 pb-1 text-xs font-semibold text-slate-500/80",children:"Roles"}),e.jsx("div",{className:"w-full",children:e.jsx(A,{variant:"ghost",className:"w-full justify-start capitalize text-slate-700 bg-slate-300/40",children:s.position.split("_").join(" ")},s.id+s.position)}),e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-slate-500/80",children:"After saving changes, affected users must log out and log back in to apply the changes."}),s.position===u.role&&e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-red-500/80",children:"You are editing your current role. Review your changes carefully."}),e.jsxs("div",{className:"mt-auto w-full space-y-3",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[o&&e.jsx("p",{className:"text-green-600",children:o}),i&&e.jsx("p",{className:"text-red-600",children:i})]}),n&&e.jsx(A,{type:"submit",className:"w-full disabled:cursor-not-allowed",disabled:!!c,onClick:m,children:c?"Saving...":"Save changes"})]})]}),e.jsx(We,{className:"w-full",type:"auto",style:{"--border":"216 12% 84%"},children:e.jsxs("div",{className:`mx-auto flex w-full max-w-[700px] flex-1 flex-col gap-8 p-6 pt-8 ${c?"pointer-events-none opacity-50":null}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"User Management"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:d.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):d.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(b,{htmlFor:j.title,className:`${s.position!=="admin"&&"cursor-pointer"} text-sm capitalize text-slate-700`,children:j.title.split("_").join(" ")}),e.jsx(qe,{id:j.title,name:j.title,value:j.id,disabled:s.position==="admin",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(f=>f.permission_id===j.id),onCheckedChange:f=>x(f,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Products"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:y.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):y.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(b,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(qe,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(f=>f.permission_id===j.id),onCheckedChange:f=>x(f,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Transfers"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:p.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):p.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(b,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(qe,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(f=>f.permission_id===j.id),onCheckedChange:f=>x(f,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Views"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:N.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):N.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(b,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(qe,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(f=>f.permission_id===j.id),onCheckedChange:f=>x(f,j.id)})]},j.id))})]})]})})]})})},Xn=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"User Information",children:e.jsxs(jt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(zl,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:l,title:a==="edit"?"Edit User":a==="add"?"Add User":"Edit User Role Permissions",children:e.jsxs(e.Fragment,{children:[a==="add"&&e.jsx(El,{onClose:l}),a==="edit"&&e.jsx(Wl,{onClose:l}),a==="editPerms"&&e.jsx(Ml,{onClose:l})]})})]})})})},Ol=()=>{const t=je(),{selectedSupplier:s,setSelectedSupplier:l}=gt(),[a,r]=h.useState({});h.useEffect(()=>{s&&r(s)},[s]);const[n,c]=h.useState({}),[i,o]=h.useState(!1),[x,m]=h.useState(!1),[u,d]=h.useState(null),[y,p]=h.useState(null),N=k=>{var P,C,M,L;if(k){const D=Object.keys(a).map(S=>({text:S})),K=D.length===3||D.length>3;if(K){const S=!(((P=a.contact_no)==null?void 0:P.length)>11||((C=a.contact_no)==null?void 0:C.length)<11);return S?[S,""]:[S,"Contact number must be 11 digits"]}else return[K,"Please fill up all fields"]}else{const D=Object.keys(n).map(S=>({text:S})),K=D.length===3||D.length>3;if(K){const S=!(((M=n.contact_no)==null?void 0:M.length)>11||((L=n.contact_no)==null?void 0:L.length)<11);return S?[S,""]:[S,"Contact number must be 11 digits"]}else return[K,"Please fill up all fields"]}},j=(k,P)=>{o(!0),p(null),d(null),P?r(C=>({...C,[k.target.name]:k.target.value})):c(C=>({...C,[k.target.name]:k.target.value}))},f=async k=>{const P=N(k);if(m(!0),P[0])return k?await v(a):await w(n);d(P[1]),m(!1),console.log(n)},g={onSuccess:async()=>{await t.invalidateQueries({queryKey:["supplier"]}),m(!1),o(!1),p("Supplier info has been edited")},onError:k=>{console.error(k),d(k.message),m(!1)}},{mutateAsync:v}=Y({mutationKey:["updateSupplier"],mutationFn:wa,...g}),F={onSuccess:async()=>{await t.invalidateQueries({queryKey:["supplier"]}),m(!1),o(!1),p("Supplier info has been added")},onError:k=>{console.error(k),d(k.message),m(!1)}},{mutateAsync:w}=Y({mutationKey:["addSupplier"],mutationFn:_a,...F});return{supplier:a,selectedSupplier:s,newSupplier:n,isChanged:i,isSubmitting:x,error:u,success:y,handleSubmit:f,handleChange:j,editSupplierMutation:v}},Rl=({onClose:t,isUpdate:s})=>{const{supplier:l,newSupplier:a,isSubmitting:r,error:n,success:c,isChanged:i,handleChange:o,handleSubmit:x}=Ol();return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:m=>{m.preventDefault()},children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"name",children:"Supplier Name"}),e.jsx(B,{type:"text",name:"name",placeholder:"Supplier Name",value:s?l.name||"":a.name||"",className:"inputbox rounded-md bg-slate-100",onChange:m=>o(m,s),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"contact_no",children:"Supplier Contact Number"}),e.jsx(B,{type:"text",name:"contact_no",placeholder:"Supplier Contact Number",className:"inputbox rounded-md bg-slate-100",value:s?l.contact_no||"":a.contact_no||"",onChange:m=>o(m,s),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"address",children:"Supplier Address"}),e.jsx(B,{type:"text",name:"address",placeholder:"Supplier Address",className:"inputbox rounded-md bg-slate-100",value:s?l.address||"":a.address||"",onChange:m=>o(m,s),required:!0})]})]}),e.jsx("div",{className:"flex flex-col mt-4 gap-5",children:e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),n&&e.jsx("div",{className:"font-bold text-red-700",children:n}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:i?"green":"default",disabled:!i,onClick:()=>x(s),children:r?"Submitting":s?"Edit Supplier":"Add Supplier"})]})})]})})})]})})},Ll=({openModal:t})=>{const{suppliers:s,isFetching:l,progress:a,setSelectedSupplier:r}=gt(),n=()=>{t({},"add")},c=o=>{r(o),t(o,"edit")},i=[{accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:o})=>e.jsx("div",{className:"text-center",children:e.jsxs(_,{onClick:()=>o.toggleSorting(o.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row ml-auto mr-auto items-center",children:["NAME ",o.getIsSorted()==="asc"?e.jsx(z,{}):o.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.name})},{accessorKey:"contact_no",header:()=>e.jsx("div",{className:"text-center",children:"CONTACT NUMBER"}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.contact_no})},{accessorKey:"address",header:()=>e.jsx("div",{className:"text-center",children:"ADDRESS"}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.address})},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"ACTION"}),cell:({row:o})=>{const x=o.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(_,{fill:"empty",textColor:"black",onClick:()=>c(x),className:"flex flex-row items-center gap-2",children:[e.jsx(Qs,{})," Edit"]})})}}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:s,columns:i,filterWhat:"address",dataType:"Supplier",openModal:n,isLoading:l})})},Zn=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Supplier",children:e.jsxs(Sa,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Ll,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:l,title:a==="edit"?"Edit Supplier":"Add Supplier",children:e.jsx(e.Fragment,{children:e.jsx(Rl,{onClose:l,isUpdate:a==="edit"})})})]})})})},Kl=({handleEditProduct:t,handleDeleteProduct:s})=>[{accessorKey:"serial_no",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Serial Number"," ",a.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{id:"name",accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",a.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"notes",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Notes"})},{id:"actions",cell:({row:a})=>{const r=a.original;return e.jsx("div",{className:"flex flex-row justify-end text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>t(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{className:"font-medium",children:"Edit"})]}),e.jsxs(Q,{onClick:()=>s(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-red-50 hover:text-red-700 focus:bg-red-50 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ks,{size:16,strokeWidth:2.25})}),e.jsx("span",{className:"font-medium",children:"Delete"})]})]})]})})},enableGlobalFilter:!1}],Ul=({handleProdPriceDetails:t,handleEditProdPrice:s})=>[{id:"name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",a.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"inventory_product.inventory.code",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Inventory"," ",a.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Capital"}),cell:({row:a})=>{const r=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:a.original.capital_price?r:"—"})})}},{accessorKey:"markup_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Markup"}),cell:({row:a})=>{const r=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a.original.markup_price||0),n=ne(a.original.markup_price/a.original.capital_price*100,{precision:3}).value;return e.jsxs("div",{className:"flex items-center uppercase",children:[e.jsx("span",{children:r}),e.jsxs("span",{className:"text-gray-500",children:[" (",n,"%)"]})]})}},{accessorKey:"sale_discount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Discount"}),cell:({row:a})=>{const r=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a.original.sale_discount||0);return e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:a.original.on_sale?r:e.jsx("div",{className:"group relative flex w-fit items-center",children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(ys,{size:20,strokeWidth:2,className:"text-gray-700"})}),e.jsx(Re,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:"Not on sale"})})]})})})})}},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Price"}),cell:({row:a})=>{const r=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a.original.price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:a.original.price?r:"—"})})}},{accessorKey:"inventory_product.remaining_stocks_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Remaining"}),cell:({row:a})=>{const r=a.original.inventory_product.remaining_stocks_count??0,n=a.original.inventory_product.stocks_count*.2,c=a.original.inventory_product.stocks_count*.5;return e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx("span",{className:`${n>=r?"font-bold text-red-700":c>=r?"font-semibold text-amber-700":""}`,children:r})}),e.jsx(Re,{children:n>=r?"Remaining stocks are low!":c>=r?"Remaining stocks are below 50%":"Remaining stocks are above 50%"})]})}},{id:"actions",cell:({row:a})=>{const r=a.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>t(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(Q,{onClick:()=>s(r),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]})]})]})})},enableGlobalFilter:!1}],ql=({openModal:t})=>{const{auth:s}=ae(),{data:l,isLoading:a,setSelectedProduct:r}=Ls(),n=()=>{t({},"add")},c=o=>{r(o),t(o,"edit")},i=o=>{r(o),t(o,"delete")};return e.jsx(e.Fragment,{children:e.jsx(Z,{columns:(s==null?void 0:s.role)==="super_admin"||(s==null?void 0:s.role)==="admin"?Kl({handleEditProduct:c,handleDeleteProduct:i}):dl,data:l.sort((o,x)=>x.id-o.id),filterWhat:"name",dataType:"Product",openModal:n,isLoading:a})})},Hl=({openModal:t,isModalOpen:s,filterWarehouse:l})=>{const{data:a,isLoading:r,setSelectedProductPrice:n}=vs(),c=o=>{n(o),t(o,"details")},i=o=>{n(o),t(o,"edit")};return e.jsx(e.Fragment,{children:e.jsx(Ye,{children:e.jsx(Z,{columns:Ul({handleProdPriceDetails:c,handleEditProdPrice:i}),data:l?a.filter(o=>o.warehouse.id===l).sort((o,x)=>{let m=new Date(o.updated_at??o.created_at);return new Date(x.updated_at??x.created_at).getTime()-m.getTime()}):a.sort((o,x)=>{let m=new Date(o.updated_at??o.created_at);return new Date(x.updated_at??x.created_at).getTime()-m.getTime()}),filterWhat:"name",dataType:"Listing",isLoading:r})})})},Vl=()=>{const{selectedProductPrice:t}=vs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Unit"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.inventory_product.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Inventory"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.inventory_product.inventory.code})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Capital price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup percent"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[ne(t.markup_price/t.capital_price*100,{precision:3}).value,"%"]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.markup_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Cost"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.cost)})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sale discount"}),e.jsx("p",{className:"text-sm",children:t.on_sale===1?Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.sale_discount):"—"}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex flex-none flex-row items-center justify-end gap-1 pb-[0.1rem] pr-1",children:[t.on_sale===1?e.jsx(He,{size:14,strokeWidth:3.5,className:"text-green-600"}):e.jsx(ys,{size:14,strokeWidth:3.5,className:"text-gray-600"}),e.jsx("div",{className:"text-xs font-semibold leading-4 text-gray-900",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.price)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.created_by.firstname+" "+t.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(t.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(t.updated_at)})]})]})]})})},js=(t,s,l=2)=>ne(s/t*100,{precision:l}).value,Ws=(t,s,l=2)=>ne(ne(t).multiply(s/100),{precision:l}).value,gs=(t,s,l=2)=>ne(ne(t).add(s),{precision:l}).value,Bt=(t,s,l=2)=>ne(ne(t).subtract(s),{precision:l}).value,$l=({onClose:t})=>{const{value:s,handleChange:l,handleSubmit:a}=Rt(),{selectedProduct:r}=Ls(),[n,c]=h.useState(!1),[i,o]=h.useState(null),[x,m]=h.useState(),u=(d,y,p,N)=>{p.test(d.target.value)?(d.target.value=d.target.value,l(y,d.target.value),m(void 0)):m({type:y,error:N})};return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async d=>{c(!n),d.preventDefault(),a({action:"update",id:r.id,data:s}).then(()=>{c(!1),V.success("Product updated successfully."),t()}).catch(y=>{c(!1),y.response.data.message?V.error(y.response.data.message):V.error("Failed to update product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 flex flex-col justify-start gap-1",children:[e.jsx(b,{htmlFor:"serial_no",className:"text-sm font-bold text-gray-600",children:"Serial number"}),e.jsx(I,{id:"serial_no",name:"serial_no",type:"text",maxLength:100,required:!0,placeholder:"Serial number...",value:s.serial_no!==void 0?s.serial_no:(r==null?void 0:r.serial_no)||"",onChange:d=>{u(d,"serial_no",/^[a-zA-Z0-9-]{0,100}$/,"Must only contain A-Z, 0-9, and -")}}),e.jsx("span",{hidden:!(x&&x.type==="serial_no"),className:"text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(b,{htmlFor:"name",className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx(I,{id:"name",name:"name",type:"text",maxLength:100,required:!0,placeholder:"Product name...",value:s.name!==void 0?s.name:(r==null?void 0:r.name)||"",onChange:d=>{u(d,"name",/^[0-9a-zA-Z\s\-.,/+:_=]{0,100}$/,"Must only contain alphanumeric and limited special characters")}})," ",e.jsx("span",{hidden:!(x&&x.type==="name"),className:"max-w-[225px] text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(b,{htmlFor:"brand",className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx(I,{id:"brand",name:"brand",type:"text",maxLength:100,required:!0,placeholder:"Brand...",value:s.brand!==void 0?s.brand:(r==null?void 0:r.brand)||"",onChange:d=>{u(d,"brand",/^[0-9a-zA-Z\s\-.,/+:_=]{0,100}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(x&&x.type==="brand"),className:"max-w-[225px] text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsx("hr",{className:"col-span-12 my-3 border-t border-slate-200"}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(b,{htmlFor:"size",className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx(I,{id:"size",name:"size",type:"text",maxLength:100,required:!0,placeholder:"e.g. medium...",value:s.size!==void 0?s.size:(r==null?void 0:r.size)||"",onChange:d=>{u(d,"size",/^[0-9a-zA-Z\s\-.,/+:_="']{0,100}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(x&&x.type==="size"),className:"max-w-[225px] text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(b,{htmlFor:"color",className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx(I,{id:"color",name:"color",type:"text",maxLength:40,required:!0,placeholder:"e.g. white...",value:s.color!==void 0?s.color:(r==null?void 0:r.color)||"",onChange:d=>{u(d,"color",/^[0-9a-zA-Z\s\-.,/+:_="']{0,40}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(x&&x.type==="color"),className:"max-w-[225px] text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-start gap-1",children:[e.jsx(b,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(I,{id:"notes",name:"notes",type:"text",placeholder:"Type product notes here...",defaultValue:s.notes!==void 0?s.notes:(r==null?void 0:r.notes)||"",onBlur:d=>l("notes",d.target.value)})]})]}),e.jsxs("div",{className:"ml-auto flex flex-row gap-4 whitespace-nowrap",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:n||x!==void 0||s.name===""||s.serial_no==="",className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Applying...":"Apply changes"})]}),i&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:i})})]})})})},Bl=({onClose:t})=>{const{selectedProduct:s,setSelectedProduct:l,isDeletable:a}=Ls(),{handleDeleteProduct:r}=Rt();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[42rem] max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"col-span-8 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:(s==null?void 0:s.brand)||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.color})]}),(s==null?void 0:s.notes)&&e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.notes})]})]}),e.jsx("hr",{className:"h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("p",{className:"max-w-[50%] text-sm",children:a!==void 0?a?"This product can be deleted. Are you sure you want to proceed? This action cannot be undone.":"This product cannot be deleted because it is associated with existing product price and inventory items.":"Checking if the product can be deleted..."}),e.jsxs("div",{className:"mt-auto flex-none space-x-4",children:[a&&e.jsx(_,{className:"flex-1 cursor-pointer bg-red-600 py-2 text-sm font-bold text-white hover:bg-red-700 disabled:pointer-events-none disabled:opacity-50",disabled:!a,onClick:()=>{s&&r(s.id).then(()=>{V.success("Product deleted successfully."),l(void 0),t()}).catch(()=>{V.error("An error occurred while deleting the product.")})},children:"Yes, delete"}),e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:a?"No, cancel":"Close"})]})]})]})})},Jn=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Products",children:e.jsxs(Nt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(ql,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:l,closeOnOverlayClick:a==="delete",title:a==="add"?"Add Product":a==="edit"?"Edit Product":a==="delete"?"Delete Product":"",children:e.jsxs(e.Fragment,{children:[a==="add"&&e.jsx(xl,{onClose:l}),a==="edit"&&e.jsx($l,{onClose:l}),a==="delete"&&e.jsx(Bl,{onClose:l})]})})]})})})},Ql=({onClose:t})=>{var N,j;ae();const{selectedProductPrice:s}=vs(),{value:l,handleChange:a,handleSubmit:r}=Ys(),[n,c]=h.useState(!1),[i,o]=h.useState(null),[x,m]=h.useState(js(s.capital_price,s.markup_price,3)),[u,d]=h.useState(s.markup_price),y=f=>{const g=Number(f.target.value);m(g),d(Ws(s.capital_price,g))},p=f=>{const g=ne(f.target.value).value;d(g),m(js(s.capital_price,g,3))};return h.useEffect(()=>{a("markup_price",u),a("cost",gs(s.capital_price,u))},[x,u]),h.useEffect(()=>{a("price",Bt(l.cost??s.cost,l.sale_discount??s.sale_discount))},[l.cost,l.sale_discount]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async f=>{c(!n),f.preventDefault(),r({action:"update",id:s.id,data:l}).then(()=>{c(!n),V.success("Product price edited successfully"),t()}).catch(()=>{c(!n),o("Failed to add product listing"),V.error("Failed to add product listing")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-4 gap-y-5 font-medium text-gray-700",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:s.inventory_product.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Inventory"}),e.jsx("p",{className:"text-sm",children:s.inventory_product.inventory.code})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",disabled:!0,className:"pl-7",value:ne(s.capital_price).value}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"markup_percent",className:"text-sm font-bold text-gray-600",children:"Markup percent"}),e.jsx(I,{id:"markup_percent",name:"markup_percent",type:"number",inputMode:"numeric",min:0,step:.001,required:!0,value:x||"",onChange:y,onBlur:f=>{f.target.value=ne(x,{precision:3}).value.toString()}}),e.jsx("span",{className:"absolute bottom-0 right-0 mr-2 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"%"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"markup_price",className:"text-sm font-bold text-gray-600",children:"Markup price"}),e.jsx(I,{id:"markup_price",name:"markup_price",type:"number",min:0,step:.01,className:"pl-7",value:u||"",onChange:p,onBlur:f=>{f.target.value=Number(u).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"cost",className:"text-sm font-bold text-gray-600",children:"Cost"}),e.jsx(I,{id:"cost",name:"cost",type:"number",min:0,required:!0,className:"pl-7",readOnly:!0,value:gs(s.capital_price,u).toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"sale_discount",className:"text-sm font-bold text-gray-600",children:"Sale discount"}),e.jsx(I,{id:"sale_discount",name:"sale_discount",type:"number",inputMode:"numeric",min:0,step:.01,max:l.cost!==void 0?l.cost:s.cost,disabled:l.on_sale===void 0?s.on_sale===0:l.on_sale===0,required:!0,className:"pl-7",value:l.sale_discount??((N=s.sale_discount)==null?void 0:N.toFixed(2))??"",onChange:f=>{a("sale_discount",ne(f.target.value).value)},onBlur:f=>{f.target.value=Number(l.sale_discount!==void 0?l.sale_discount:s.sale_discount).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"}),e.jsxs("div",{className:"absolute right-0 top-1/2 mr-2 flex flex-none translate-y-1/4 flex-row items-center justify-start gap-2",children:[e.jsx(I,{name:"on_sale",id:"on_sale",type:"checkbox",checked:l.on_sale===void 0?s.on_sale===1:l.on_sale===1,className:"h-4 w-fit",onChange:f=>{const g=document.getElementById("sale_discount");a("on_sale",f.target.checked?1:0),!f.target.checked&&(a("sale_discount",0),g&&(g.value="0.00"))}}),e.jsx(b,{htmlFor:"on_sale",className:"text-xs font-bold text-slate-700",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"price",className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx(I,{id:"price",name:"price",type:"number",min:0,step:.01,required:!0,readOnly:!0,className:"pl-7",value:((j=l.price)==null?void 0:j.toFixed(2))||s.price.toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm",children:ie(s.updated_at)})]})]}),e.jsx("div",{className:"col-span-12 flex w-full justify-between whitespace-nowrap pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:n,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Applying changes...":"Apply changes"})]})}),i&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:i})})]})})})},ec=()=>{const{warehouses:t}=ss(),[s,l]=h.useState(0),{isOpen:a,openModal:r,closeModal:n}=de(),[c,i]=h.useState(""),o=(x,m)=>{i(m),r()};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Product Listings",children:e.jsx(Nt,{children:e.jsxs(mt,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:x=>l(Number(x)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx(H,{value:"0",children:"All"},"all"),t.map(x=>e.jsxs(H,{value:x.id.toString(),children:[x.name," (",x.code,")"]},x.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Hl,{openModal:o,isModalOpen:a,filterWarehouse:s>0?s:void 0})})]}),e.jsx(pe,{title:c==="details"?"Listing Details":c==="edit"?"Edit Listing":"",isOpen:a,onClose:n,closeOnOverlayClick:c==="details",children:e.jsxs(e.Fragment,{children:[c==="details"&&e.jsx(Vl,{}),c==="edit"&&e.jsx(Ql,{onClose:n})]})})]})})})})},Yl=({openModal:t})=>{const{transfers:s,transferProducts:l,isFetching:a,setSelectedTransfer:r}=Ie();ae(),Le();function n(u){window.api.transferSend({transfer:u,products:l.filter(d=>d.transfer_id===u.id)})}const c=u=>{r(u),t(u,"details")},i=u=>{r(u),t(u,"edit")},o=u=>{r(u),t(u,"products")},x=()=>{t({},"add")},m=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["TRANSFER CODE ",u.getIsSorted()==="asc"?e.jsx(z,{}):u.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:u})=>e.jsx("div",{className:"text-center",children:u.original.code?u.original.code:"N/A"})},{accessorKey:"source",header:()=>e.jsx("div",{className:"text-center",children:"SOURCE-DESTINATION"}),cell:({row:u})=>{const d=u.original.source,y=u.original.destination;return e.jsxs("div",{className:"text-center",children:[d.code,"-",y.code]})}},{id:"transfer_products",header:()=>e.jsx("div",{className:"text-center",children:"PRODUCTS ADDED?"}),cell:({row:u})=>e.jsx("div",{className:"flex justify-center",children:l.filter(d=>d.transfer_id===u.original.id).length>0?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"})})},{accessorKey:"transfer_status",sortingFn:"text",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["TRANSFER STATUS ",u.getIsSorted()==="asc"?e.jsx(z,{}):u.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:u})=>e.jsx("div",{className:"text-center",children:u.original.transfer_status?u.original.transfer_status:"N/A"})},{accessorKey:"transfer_schedule",sortingFn:"datetime",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["SCHEDULE ",u.getIsSorted()==="asc"?e.jsx(z,{}):u.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:u})=>{const d=u.getValue("transfer_schedule");if(d.toString()!=="0000-00-00"){const y={year:"numeric",month:"long",day:"numeric"},p=new Date(d).toLocaleDateString([],y);return e.jsx("div",{className:"text-center",children:p})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"date_received",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["DATE RECEIVED ",u.getIsSorted()==="asc"?e.jsx(z,{}):u.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:u})=>{const d=u.getValue("date_received");if(d){const y={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},p=new Date(d).toLocaleDateString([],y);return e.jsx("div",{className:"text-center",children:p})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"approval_status",header:()=>e.jsx("div",{className:"text-center",children:"APPROVAL STATUS"}),cell:({row:u})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:u.original.approval_status.toLowerCase()==="approved"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):u.original.approval_status.toLowerCase()==="rejected"?e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:u})=>{const d=u.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>c(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Details"})]}),e.jsxs(Q,{onClick:()=>i(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit Transfer"})]}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>o(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:d.transfer_status!="arrived"&&d.approval_status!="rejected"?e.jsx(be,{size:16,strokeWidth:2.25}):e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Products"})]}),d.transfer_status=="enroute"||d.transfer_status=="arrived"&&e.jsxs(Q,{onClick:()=>n(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx($t,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Print Transfer"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:s,columns:m,filterWhat:"approval_status",dataType:"Transfer",openModal:x,isLoading:a})})},Gl=({onClose:t})=>{const{selectedTransfer:s}=Ie();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Source"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.source.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.destination.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer schedule"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_schedule.toString()==="0000-00-00 00:00:00"?"N/A":ie(s.transfer_schedule)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Received by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.received_by?s.received_by.firstname+" "+s.received_by.lastname:"N/A"})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Date received"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.date_received?ie(s.date_received):"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approved_by?s.approved_by.firstname+" "+s.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.updated_at)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.notes?s.notes:"N/A"})]})})]})})},Xl=()=>{var l,a;const{newTransfer:t,handleChange:s}=Ke();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-span-5 flex flex-col gap-1",children:[e.jsx(b,{htmlFor:"source",className:"text-sm font-bold text-slate-800",children:"Source"}),e.jsxs(J,{name:"source",value:((l=t.source)==null?void 0:l.toString())??"",onValueChange:r=>{s("source",Number(r)),s("destination",r==="1"?2:1)},required:!0,children:[e.jsx(ee,{name:"source",id:"source",className:"flex flex-row items-center gap-3 truncate bg-white text-sm font-medium",children:e.jsx(se,{placeholder:"Select warehouse..."})}),e.jsxs(te,{className:"text-sm font-medium text-slate-700",children:[e.jsx(H,{value:"1",children:"Cagayan de Oro"}),e.jsx(H,{value:"2",children:"Iligan"})]})]})]}),e.jsx("div",{className:"col-span-1 mt-3 flex h-full items-center justify-center",children:e.jsx(yl,{size:20,strokeWidth:2,className:"text-slate-800"})}),e.jsxs("div",{className:"col-span-5 flex flex-col gap-1",children:[e.jsx(b,{htmlFor:"destination",className:"text-sm font-bold text-slate-800",children:"Destination"}),e.jsxs(J,{name:"destination",value:((a=t.destination)==null?void 0:a.toString())??"",onValueChange:r=>{s("destination",Number(r)),s("source",r==="1"?2:1)},required:!0,children:[e.jsx(ee,{name:"destination",id:"destination",className:"flex flex-row items-center gap-3 truncate bg-white text-sm font-medium",children:e.jsx(se,{placeholder:"Select warehouse..."})}),e.jsxs(te,{className:"text-sm font-medium text-slate-700",children:[e.jsx(H,{value:"1",children:"Cagayan de Oro"}),e.jsx(H,{value:"2",children:"Iligan"})]})]})]})]})},Zl=()=>{const{newTransfer:t,handleChange:s}=Ke();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-span-11 flex flex-col gap-1",children:[e.jsx(b,{htmlFor:"transfer_schedule",className:"text-sm font-bold text-slate-800",children:"Schedule"}),e.jsxs(ye,{children:[e.jsx(fe,{id:"transfer_schedule",name:"transfer_schedule",asChild:!0,children:e.jsxs(A,{variant:"outline",className:"w-full justify-start",children:[e.jsx(qt,{className:"mr-2 h-4 w-4"}),t.transfer_schedule?new Date(t.transfer_schedule).toLocaleString("en-PH",{dateStyle:"full"}):e.jsx("span",{children:"Pick a date..."})]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(as,{required:!0,mode:"single",disabled:{before:new Date},selected:new Date(t.transfer_schedule??""),onDayClick:l=>{const a=new Date(l).toISOString();s("transfer_schedule",a)},initialFocus:!0})})]})]})})},Qt=({tabState:t})=>{var i;const{inventoriesList:s,inventoriesLoading:l,selectedInventory:a,setSelectedInventory:r}=Ke(),[n,c]=h.useState(!1);return e.jsxs("div",{className:`${t==="details"?"col-span-11":"col-span-8"} flex flex-col gap-1`,children:[e.jsx(b,{htmlFor:"inventory",className:"text-sm font-bold text-slate-800",children:"Inventory"}),e.jsxs(ye,{open:n,onOpenChange:c,children:[e.jsx(fe,{asChild:!0,children:e.jsxs(A,{id:"inventory",variant:"outline",role:"combobox","aria-expanded":n,className:"justify-between",disabled:l||t==="items",children:[l?"Loading...":a?(i=s.find(o=>o.id===a.id))==null?void 0:i.code:"Select inventory...",e.jsx(Xe,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ve,{className:"max-h-[300px] w-[568px] overflow-auto p-0",children:e.jsxs(Ve,{defaultValue:(a==null?void 0:a.id.toString())??"",children:[e.jsx($e,{placeholder:"Search inventory...",className:"text-sm font-medium"}),e.jsx(Ge,{className:"p-4 text-center text-sm font-medium",children:"No inventory found."}),e.jsx(Ee,{children:s.map(o=>e.jsxs(Te,{className:"flex justify-between text-sm",value:o.id.toString(),onSelect:()=>{r(o),c(!1)},children:[e.jsx("span",{className:"font-semibold",children:o.code}),e.jsxs("span",{className:"inline-block text-xs font-bold text-slate-600",children:["Created:"," ",new Date(o.created_at??"").toLocaleDateString("en-PH",{dateStyle:"long"})]})]},o.id))})]})})]})]})},Jl=({activeView:t,setActiveView:s,setEditProduct:l})=>{const{selectedInventory:a}=Ke();return e.jsx("div",{className:"col-span-3 col-start-10 flex h-full items-end",children:e.jsx(A,{variant:"secondary",disabled:!a,className:"w-full text-sm font-bold text-slate-800 hover:bg-slate-300",onClick:t==="table"?()=>{s("form"),l(null)}:()=>s("table"),children:e.jsx("span",{children:t==="table"?e.jsxs("span",{className:"flex gap-2",children:[e.jsx(Bs,{size:20})," ",e.jsx("span",{children:"Add an item"})]}):e.jsxs("span",{className:"flex gap-2",children:[e.jsx(Ut,{size:20})," ",e.jsx("span",{children:"Cancel"})]})})})})},er=({onClose:t})=>{const{newTransfer:s,handleChange:l,setActiveTab:a}=Ke();return e.jsx("div",{className:"flex flex-col gap-5",children:e.jsxs("div",{className:"grid grid-cols-11 gap-4",children:[e.jsx(Xl,{}),e.jsx(Qt,{tabState:"details"}),e.jsx(Zl,{}),e.jsxs("div",{className:"col-span-11 flex flex-col gap-1",children:[e.jsx(b,{htmlFor:"notes",className:"text-sm font-bold text-slate-800",children:"Notes"}),e.jsx(bs,{id:"notes",placeholder:"Type the notes for this transfer...",className:"text-sm",value:s.notes??"",onChange:r=>l("notes",r.target.value)})]}),e.jsxs("div",{className:"col-span-11 flex justify-end gap-4",children:[e.jsx(_,{fill:"default",className:"py-2 text-sm font-bold text-slate-900",onClick:()=>t(),children:"Cancel"}),e.jsx(_,{fill:"green",className:"py-2 text-sm font-bold disabled:cursor-not-allowed disabled:opacity-50",disabled:!s.source||!s.destination||!s.transfer_schedule,onClick:()=>a("items"),children:"Proceed to add items"})]})]})})},Yt=({selectedProduct:t,setSelectedProduct:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex w-1/2 flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",value:(t==null?void 0:t.capital_price)||0,onBlur:()=>{},onChange:l=>{s(a=>({...a,capital_price:l.target.value}))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]})}),sr=({selectedProduct:t})=>{const{inventoryProducts:s,inventoryProductsLoading:l}=Ke();return e.jsx(e.Fragment,{children:l?e.jsx(fe,{asChild:!0,children:e.jsx(A,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:!0,children:e.jsx(G,{className:"h-4 w-4 animate-spin"})})}):e.jsx(fe,{asChild:!0,children:e.jsxs(A,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:s.length===0,children:[s.length>0?t?t.product_name:"Select product...":"No products",e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})})})},tr=({selectedProduct:t,setSelectedProduct:s})=>{const{inventoryProducts:l,handleChange:a,newTransfer:r}=Ke(),[n,c]=h.useState(!1);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(ye,{open:n,onOpenChange:c,children:[e.jsx(sr,{selectedProduct:t}),e.jsx(ve,{className:"min-w-[53rem] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ve,{children:[e.jsx($e,{placeholder:"Product name or serial number..."}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:l.map(i=>e.jsx(Te,{className:"cursor-pointer justify-between rounded-sm border-b",value:i.product.id+"_"+i.product.name+"_"+i.product.brand+"_"+i.id,onSelect:()=>{s({id:i.id,product_id:i.product.id,product_name:`${i.product.name} • ${i.product.brand} • ${i.product.size} • ${i.product.color}`,unit:i.unit,source_inventory:i.inventory_id,total_quantity:1,capital_price:i.capital_price}),c(!1)},children:`${i.product.name} • ${i.product.brand} • ${i.product.size} • ${i.product.color}`},i==null?void 0:i.id))})})]})})]})]})})},Gt=({selectedProduct:t,setSelectedProduct:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex w-1/2 flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks Count"}),e.jsx(I,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:(t==null?void 0:t.total_quantity)||0,required:!0,onChange:l=>{s(a=>({...a,total_quantity:l.target.value}))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500"})]})}),ar=({setActiveView:t,editProduct:s})=>{const{newTransfer:l,handleChange:a}=Ke(),[r,n]=h.useState(s||null),c=i=>{i.preventDefault();const o=[...l.transferItems];let x=o.findIndex(m=>m.id===r.id);x!==-1?o[x]={...o[x],...r}:o.push({...r}),a("transferItems",o),t("table")};return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:c,children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsx(tr,{selectedProduct:r,setSelectedProduct:n}),e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-row justify-between gap-2",children:[e.jsx(Yt,{selectedProduct:r,setSelectedProduct:n}),e.jsx(Gt,{selectedProduct:r,setSelectedProduct:n})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(_,{type:"submit",fill:"green",className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:"Add Item to Queue"})})]})})})},lr=({onClose:t})=>{const{newTransfer:s,handleChange:l}=Ke(),[a,r]=h.useState(null),{addTransferMutation:n,isPending:c,success:i}=jl(),o=[{id:"select",header:({table:d})=>e.jsx("input",{type:"checkbox",checked:d.getIsAllPageRowsSelected(),onChange:y=>d.toggleAllPageRowsSelected(!!y.target.checked),"aria-label":"Select all"}),cell:({row:d})=>e.jsx("input",{type:"checkbox",checked:d.getIsSelected(),onChange:y=>d.toggleSelected(!!y.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:d})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>d.toggleSorting(d.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",d.getIsSorted()==="asc"?e.jsx(z,{}):d.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:d})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:d.original.product_name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.total_quantity})},{accessorKey:"capital price",header:()=>e.jsx("div",{className:"text-center",children:"Capital Price"}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d.original.capital_price)})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:d})=>{const y=d.original;return e.jsxs("div",{className:"flex flex-row justify-center gap-3 text-xs font-normal uppercase",children:[e.jsx(Ye,{children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(be,{onClick:()=>{m("form"),r(y)},size:20,className:" text-yellow-500"})}),e.jsx(Re,{children:e.jsx("p",{children:"Edit"})})]})}),e.jsx(Ye,{children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(ks,{onClick:()=>{const p=s.transferItems.filter(N=>N.id!==y.id);l("transferItems",p)},size:20,className:"text-red-500"})}),e.jsx(Re,{children:e.jsx("p",{children:"Remove"})})]})})]})}}],[x,m]=h.useState("table"),u=async()=>{n(s)};return h.useEffect(()=>{i&&(V(i,{position:"top-right",closeOnClick:!0,type:"success"}),t())},[i]),e.jsxs(e.Fragment,{children:[c&&e.jsx("div",{className:"absolute left-[45%] top-[43%] z-50",children:e.jsx(Ae,{})}),e.jsxs("div",{className:`flex flex-col gap-4 ${c?"blur-sm":""}`,children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsx(Qt,{tabState:"items"}),e.jsx(Jl,{activeView:x,setActiveView:m,setEditProduct:r})]}),x==="table"&&e.jsx("div",{className:"h-[400px] w-full bg-slate-100",children:e.jsx(Z,{data:s.transferItems,columns:o,dataType:"Transfer Products",isLoading:!1,hideFilter:!0,filterWhat:""})}),x==="form"&&e.jsx("div",{className:"h-[200px] w-full ",children:e.jsx(ar,{setActiveView:m,editProduct:a})}),e.jsx("div",{className:`flex flex-col items-end ${x==="form"?"hidden":""}`,children:e.jsx(_,{disabled:s.transferItems.length<=0||c,onClick:u,fill:"green",className:"disabled:opacity-50",children:"Submit Request"})})]})]})},rr=({onClose:t})=>{const{newTransfer:s,activeTab:l,setActiveTab:a}=Ke();return e.jsx(e.Fragment,{children:e.jsxs(yt,{value:l,onValueChange:r=>a(r),className:"w-full",children:[e.jsxs(vt,{className:"mb-4 flex w-full",children:[e.jsx(ps,{value:"details",className:"flex-1 font-semibold",children:"Details"}),e.jsx(ps,{value:"items",className:"flex-1 font-semibold",disabled:!s.source||!s.destination||!s.transfer_schedule,children:"Items"})]}),e.jsx(Zs,{value:"details",className:"min-w-[540px]",children:e.jsx(er,{onClose:t})}),e.jsx(Zs,{value:"items",className:"min-w-[860px]",children:e.jsx(lr,{onClose:t})})]})})},nr=({selectedProduct:t,products:s})=>{const{isInventoryLoading:l}=Fs();return e.jsx(e.Fragment,{children:l?e.jsx(fe,{asChild:!0,children:e.jsx(A,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:!0,children:e.jsx(G,{className:"h-4 w-4 animate-spin"})})}):e.jsx(fe,{asChild:!0,children:e.jsxs(A,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:s.length===0,children:[s.length>0||!l?t?t.product_name:"Select product...":"No products",e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})})})},cr=({selectedProduct:t,setSelectedProduct:s})=>{const[l,a]=h.useState(!1),{filteredProductsSrc:r,filteredInventoriesSrc:n,handleChangeSelect:c,isInventoryLoading:i}=Fs(),{selectedTransfer:o}=Ie(),x=n.find(m=>(m==null?void 0:m.warehouse.id)===o.source.id);return h.useEffect(()=>{x&&!i&&c("inventory_id",x.id)},[x,i]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(ye,{open:l,onOpenChange:a,children:[e.jsx(nr,{selectedProduct:t,products:r}),e.jsx(ve,{className:"min-w-[53rem] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ve,{children:[e.jsx($e,{placeholder:"Product name or serial number..."}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:r.map(m=>e.jsx(Te,{className:"cursor-pointer justify-between rounded-sm border-b",value:m.product.id+"_"+m.product.name+"_"+m.product.brand+"_"+m.id,onSelect:()=>{s({id:m.id,product_id:m.product.id,product_name:`${m.product.name} • ${m.product.brand} • ${m.product.size} • ${m.product.color}`,unit:m.unit,source_inventory:m.inventory_id,total_quantity:1,capital_price:m.capital_price}),a(!1)},children:`${m.product.name} • ${m.product.brand} • ${m.product.size} • ${m.product.color}`},m==null?void 0:m.id))})})]})})]})]})})},ir=({onClose:t})=>{var k,P;const[s,l]=h.useState(null),[a,r]=h.useState({isDeleting:!1,product:null}),[n,c]=h.useState(),i=je(),o=[{id:"select",header:({table:C})=>e.jsx("input",{type:"checkbox",checked:C.getIsAllPageRowsSelected(),onChange:M=>C.toggleAllPageRowsSelected(!!M.target.checked),"aria-label":"Select all"}),cell:({row:C})=>e.jsx("input",{type:"checkbox",checked:C.getIsSelected(),onChange:M=>C.toggleSelected(!!M.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:C})=>e.jsx("div",{children:e.jsxs(A,{onClick:()=>C.toggleSorting(C.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",C.getIsSorted()==="asc"?e.jsx(z,{}):C.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:C})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:C.original.product.name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:C})=>e.jsx("div",{className:"text-center",children:C.original.total_quantity})},{accessorKey:"capital price",header:()=>e.jsx("div",{className:"text-center",children:"Capital Price"}),cell:({row:C})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(C.original.capital_price)})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:C})=>{const M=C.original;return e.jsxs("div",{className:"flex flex-row justify-center gap-3 text-xs font-normal uppercase",children:[e.jsx(Ye,{children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(be,{onClick:()=>{w("form"),l(M),c({...M,product_name:`${M.product.name} • ${M.product.brand} • ${M.product.size} • ${M.product.color}`})},size:20,className:" text-yellow-500"})}),e.jsx(Re,{children:e.jsx("p",{children:"Edit"})})]})}),e.jsx(Ye,{children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(ks,{onClick:()=>{r({isDeleting:!0,product:M})},size:20,className:"text-red-500"})}),e.jsx(Re,{children:e.jsx("p",{children:"Remove"})})]})})]})}}],{mutateAsync:x,isPending:m}=Y({mutationKey:["transfer_product"],mutationFn:ot,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),V("Product has been added",{position:"top-right",closeOnClick:!0,type:"success"}),w("table")},onError:C=>{console.error(C)}}),{mutateAsync:u,isPending:d}=Y({mutationKey:["transfer_product"],mutationFn:dt,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),V("Product has been edited",{position:"top-right",closeOnClick:!0,type:"success"}),l(void 0),w("table")},onError:C=>{console.error(C)}}),{mutateAsync:y,isPending:p}=Y({mutationKey:["transfer_product"],mutationFn:Ca,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),r(C=>({...C,isDeleting:!1})),V("Product has been removed",{position:"top-right",closeOnClick:!0,type:"success"})},onError:C=>{console.error(C)}}),{filteredInventoriesSrc:N}=Fs(),{transferProducts:j,selectedTransfer:f}=Ie(),g=j.filter(C=>C.transfer_id===f.id),v=N.find(C=>(C==null?void 0:C.warehouse.id)===f.source.id),[F,w]=h.useState("table");return h.useEffect(()=>{F==="table"&&c(void 0)},[F]),e.jsxs(e.Fragment,{children:[(m||p||d)&&e.jsx("div",{className:"absolute left-[45%] top-[43%] z-50",children:e.jsx(Ae,{})}),e.jsx(hl,{isOpen:a.isDeleting,onClose:()=>{r(C=>({...C,isDeleting:!1}))},children:e.jsxs("div",{className:"",children:[e.jsxs("p",{className:"text-center font-semibold",children:["Are you sure you want to delete"," ",(P=(k=a==null?void 0:a.product)==null?void 0:k.product)==null?void 0:P.name," from this transfer?"]}),e.jsx("p",{className:"pt-2 text-center text-sm opacity-80",children:"This process cannot be undone."}),e.jsxs("div",{className:"flex gap-2 pt-3",children:[e.jsx(A,{onClick:()=>{r(C=>({...C,isDeleting:!1}))},className:"w-full bg-red-400 hover:bg-red-800",disabled:p,children:"Cancel"}),e.jsx(A,{onClick:()=>{y({id:a.product.id})},disabled:p,className:"w-full bg-green-400 hover:bg-green-800",children:p?e.jsx(ka,{type:"spin",width:20,className:"relative top-[22px]"}):"Confirm"})]})]})}),e.jsxs("div",{className:`flex flex-col gap-4 ${m||p||d?"blur-sm":""}`,children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{className:"text-sm font-bold text-slate-800",children:"Inventory"}),e.jsx(A,{id:"inventory",variant:"outline",className:"w-fit justify-between",disabled:!0,children:v!=null&&v.code?v==null?void 0:v.code:"Loading..."})]}),e.jsx("div",{className:"col-span-3 col-start-10 flex h-full items-end",children:e.jsx(A,{variant:"secondary",onClick:()=>{F==="form"&&w("table"),F==="table"&&w("form")},disabled:!(v!=null&&v.code),className:"w-full text-sm font-bold text-slate-800 hover:bg-slate-300",children:e.jsxs("div",{className:"flex items-center gap-2",children:[F=="table"&&e.jsxs(e.Fragment,{children:[e.jsx(Bs,{}),e.jsx("span",{children:"Add Item"})]}),F=="form"&&e.jsxs(e.Fragment,{children:[e.jsx(Ut,{}),e.jsx("span",{children:"Cancel"})]})]})})})]}),F==="table"&&e.jsx("div",{className:"h-[400px] w-full bg-slate-100",children:e.jsx(Z,{data:g,columns:o,dataType:"Transfer Products",isLoading:!1,hideFilter:!0,filterWhat:""})}),F==="form"&&e.jsxs("div",{className:"flex h-[200px] w-full flex-col",children:[e.jsx(cr,{selectedProduct:n,setSelectedProduct:c}),e.jsxs("div",{className:"mt-5 flex gap-3",children:[e.jsx(Gt,{selectedProduct:n,setSelectedProduct:c}),e.jsx(Yt,{selectedProduct:n,setSelectedProduct:c})]}),e.jsx(A,{variant:"secondary",onClick:()=>{if(s){u({...n,transfer_id:f.id});return}x({...n,transfer_id:f.id})},disabled:!(n||d||m),className:"mt-5 w-full text-sm font-bold text-slate-800 hover:bg-slate-300",children:e.jsx("p",{children:s?"Apply changes":"Add Product"})})]})]})]})},or=({onClose:t})=>e.jsx(e.Fragment,{children:e.jsx(ir,{onClose:t})}),Xt=({onClose:t})=>{var P,C,M,L,D,K,S,re,O,R;const{transfer:s,lastId:l,isChanged:a,isSubmitting:r,error:n,success:c,dateDisplay:i,dateDisplayArrived:o,handleSubmit:x,handleChange:m,handleChangeSelect:u,handleChangeDateTime:d}=gl(),{selectedTransfer:y,transferProducts:p}=Ie(),{warehouses:N}=ss(),{users:j}=Fa(),{auth:f}=ae();h.useEffect(()=>{console.log(s)},[s]);const g=e.jsxs(e.Fragment,{children:[e.jsx(J,{onValueChange:T=>u("approval_status",T),name:"approval_status",value:s.approval_status||"",children:e.jsxs(ee,{name:"approval_status",value:y.approval_status||"",children:[e.jsx(se,{placeholder:s.approval_status?s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1):"Choose status..."}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx(H,{value:"pending",className:"text-sm font-medium text-slate-700",children:"Pending"},"pending"),e.jsx(H,{value:"approved",className:"text-sm font-medium text-slate-700",children:"Approved"},"approved"),e.jsx(H,{value:"rejected",className:"text-sm font-medium text-slate-700",children:"Rejected"},"rejected")]})]})}),p.filter(T=>T.transfer_id===s.id).length===0&&e.jsxs("div",{className:"align-center group flex",children:[e.jsx(Es,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsx("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-7 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:"No products have been added yet."})]}),p.filter(T=>T.transfer_id===y.id).length===0&&e.jsxs("div",{className:"align-center group flex",children:[e.jsx(Es,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsx("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-7 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:"No products have been added yet."})]})]}),v=e.jsxs(J,{onValueChange:T=>u("source",Number(T)),name:"source",children:[e.jsx(ee,{name:"source",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsxs(e.Fragment,{children:[(P=N[s.source-1])==null?void 0:P.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","• ",(C=N[s.source-1])==null?void 0:C.code," •"," ",(M=N[s.source-1])==null?void 0:M.location]})]})})}),e.jsx(te,{className:"bg-white font-medium",children:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):N.map((T,X)=>e.jsxs(H,{value:T.id.toString(),className:`text-sm font-medium text-slate-700 
								${T.id===s.source&&"selected"}`,children:[T.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+T.code+" • "+T.location})]},X))})]}),F=e.jsxs(J,{onValueChange:T=>u("destination",Number(T)),name:"destination",children:[e.jsx(ee,{name:"destination",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsxs(e.Fragment,{children:[(L=N[s.destination-1])==null?void 0:L.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","• ",(D=N[s.destination-1])==null?void 0:D.code," •"," ",(K=N[s.destination-1])==null?void 0:K.location]})]})})}),e.jsx(te,{className:"bg-white font-medium",children:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):N.map((T,X)=>e.jsxs(H,{value:T.id.toString(),className:`text-sm font-medium text-slate-700 
								${T.id===s.destination&&"selected"}`,children:[T.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+T.code+" • "+T.location})]},T.code))})]}),w=e.jsx(J,{onValueChange:T=>u("transfer_status",T),name:"transfer_status",value:s.transfer_status||"",children:e.jsxs(ee,{name:"transfer_status",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:[e.jsx(se,{placeholder:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"Choose status..."}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx(H,{value:"loading",className:"text-sm font-medium text-slate-700",children:"Loading"},"loading"),e.jsx(H,{value:"en route",className:"text-sm font-medium text-slate-700",children:"En route"},"en route"),e.jsx(H,{value:"arrived",className:"text-sm font-medium text-slate-700",children:"Arrived"},"arrived")]})]})}),k=e.jsxs(J,{onValueChange:T=>u("received_by",Number(T)),name:"received_by",children:[e.jsx(ee,{name:"received_by",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:j.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsx(e.Fragment,{children:s.received_by?j[Number(s.received_by)-1].firstname+" "+j[Number(s.received_by)-1].lastname:"Choose user..."})})}),e.jsx(te,{className:"bg-white font-medium",children:j.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):j.map((T,X)=>e.jsx(H,{value:T.id.toString(),className:`text-sm font-medium text-slate-700 
								${s.received_by&&T.id===s.received_by&&"selected"}`,children:T.firstname+" "+T.lastname},X))})]});return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:T=>{T.preventDefault()},children:[e.jsxs("div",{className:"flex max-w-3xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer Code"}),e.jsx("p",{className:"text-sm",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Source"}),v]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Destination"}),F]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4 pb-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:y.created_by.firstname+" "+y.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Approval status"}),e.jsxs("p",{className:"flex flex-row gap-2 text-sm",children:[((S=s.approval_status)==null?void 0:S.toLowerCase())==="approved"&&e.jsxs(e.Fragment,{children:[s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1),e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"})]}),((re=s.approval_status)==null?void 0:re.toLowerCase())==="rejected"&&e.jsxs(e.Fragment,{children:[s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1),e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"})]}),((O=s.approval_status)==null?void 0:O.toLowerCase())==="pending"&&f.rolePermissions.some(T=>T.permission_id===22)&&((R=s.approval_status)==null?void 0:R.toLowerCase())==="pending"&&g]})]}),s.approved_by&&s.approval_status!="pending"&&e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-600",children:[s.approval_status==="approved"&&"Approved by",s.approval_status==="rejected"&&"Rejected by"]}),e.jsx("p",{className:"flex flex-row text-sm",children:j.length>0?j[s.approved_by-1].firstname+" "+j[s.approved_by-1].lastname:e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]}),s.approval_status=="approved"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-8 gap-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer status"}),e.jsx("p",{className:"text-sm",children:w})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer schedule"}),e.jsx("div",{className:"text-sm",children:e.jsxs(ye,{children:[e.jsx(fe,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(A,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(fs,{size:18,strokeWidth:1.5}),s.transfer_schedule?s.transfer_schedule.split(" ")[0]:"Choose date..."]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(as,{mode:"single",initialFocus:!0,required:!0,onDayClick:T=>{const X=new Date(T),$=`${X.getFullYear()}-${(X.getMonth()+1).toString().padStart(2,"0")}-${X.getDate().toString().padStart(2,"0")}`;u("transfer_schedule",$)},selected:s.transfer_schedule?new Date(s.transfer_schedule.split(" ")[0]):new Date})})]})})]}),s.transfer_status==="arrived"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Received by"}),e.jsx("p",{className:"text-sm",children:k})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsx("div",{className:"text-sm",children:e.jsxs(ye,{children:[e.jsx(fe,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(A,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(fs,{size:18,strokeWidth:1.5}),s.date_received?s.date_received.split(" ")[0]:"Choose date..."]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(as,{mode:"single",initialFocus:!0,required:!0,onDayClick:T=>{const X=new Date(T),$=`${X.getFullYear()}-${(X.getMonth()+1).toString().padStart(2,"0")}-${X.getDate().toString().padStart(2,"0")}`;u("date_received",$)},selected:s.date_received?new Date(s.date_received.split(" ")[0]):new Date(s.transfer_schedule.split(" ")[0])})})]})})]})]})]})}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex w-full flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(bs,{name:"notes",value:s.notes||"",placeholder:"Add notes here....",onChange:m})]})})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"col-span-5 flex flex-col items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),n&&e.jsx("div",{className:"font-bold text-red-700",children:n}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"col-span-5 flex flex-col items-end gap-3",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:a?"green":null,disabled:!a,onClick:x,children:r?"Submitting":"Edit Transfer"})]})})]})})]})})},sc=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Transfer",children:e.jsxs(bt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border",children:e.jsx(Yl,{openModal:n})})}),e.jsx(pe,{title:a==="details"?"Transfer Details":a==="edit"?"Edit Transfer":a==="add"?"Add Transfer":"Transfer Products",isOpen:t,onClose:l,closeOnOverlayClick:a==="details",children:e.jsxs(e.Fragment,{children:[a==="details"&&e.jsx(Gl,{onClose:l}),a==="edit"&&e.jsx(Xt,{onClose:l}),a==="add"&&e.jsx(Ia,{children:e.jsx(rr,{onClose:l})}),a==="products"&&e.jsx(or,{onClose:l})]})})]})})})},dr=()=>{const t=je(),[s,l]=h.useState({}),a=(i,o)=>{l(x=>({...x,[i]:o}))},r=async i=>(console.log("Submitting: ",i),await c(i)),n={onSuccess:async()=>{await t.invalidateQueries({queryKey:["customers"]}),l({})},onError:i=>{console.error("Error adding customer:",i.message)}},{mutateAsync:c}=Y({mutationKey:["addCustomer"],mutationFn:Pa,...n});return{value:s,setValue:l,handleChange:a,handleSubmit:r}},xr=({onClose:t})=>{const{value:s,setValue:l,handleChange:a,handleSubmit:r}=dr(),{setSelectedCustomer:n}=Ze();h.useEffect(()=>{l(m=>({...m}))},[]);const[c,i]=h.useState(!1),[o,x]=h.useState(null);return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async m=>{i(!c),m.preventDefault();const u=await r(s);(u==null?void 0:u.status)===201?(i(!c),n(u.data.data),t(),console.log(u.data)):(i(!c),x("Failed to add inventory"))},children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-2 ",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(b,{className:"text-sm font-semibold uppercase",htmlFor:"firstname",children:"First Name"}),e.jsx(I,{id:"firstname",name:"firstname",required:!0,type:"text",placeholder:"First Name",onChange:m=>a("firstname",m.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(b,{className:"text-sm font-semibold uppercase",htmlFor:"lastname",children:"Last Name"}),e.jsx(I,{id:"lastname",name:"lastname",required:!0,type:"text",placeholder:"Last Name",onChange:m=>a("lastname",m.target.value)})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(b,{className:"text-sm font-semibold uppercase",htmlFor:"address",children:"Address"}),e.jsxs("div",{className:"relative flex flex-col ",children:[e.jsx(bl,{color:"#2D2D2D",className:"absolute top-0 translate-x-3 translate-y-1/2",size:20}),e.jsx(I,{id:"address",name:"address",type:"text",placeholder:"Address",defaultValue:"",className:"pl-10",onChange:m=>a("address",m.target.value),required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(b,{className:"text-sm font-semibold uppercase",htmlFor:"contact_no",children:"Contact Number"}),e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx(wl,{color:"#2D2D2D",className:"absolute top-0 translate-x-3 translate-y-1/2",size:20}),e.jsx(I,{required:!0,id:"contact_no",name:"contact_no",type:"text",inputMode:"numeric",placeholder:"Contact Number",className:"pl-10",defaultValue:"",max:11,maxLength:11,onChange:m=>a("contact_no",m.target.value)})]})]})]}),e.jsxs("div",{className:"flex flex-row justify-end gap-4",children:[e.jsx(_,{onClick:()=>t(),type:"reset",className:'hover:text-white"  py-2 text-sm font-bold text-slate-700',children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:c||Object.keys(s).length<=2,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Submitting...":"Add Customer"})]}),o&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-semibold text-red-600",children:o})})]})})})},mr=({})=>{const{data:t,isLoading:s,selectedCustomer:l,setSelectedCustomer:a,openSearchCustomer:r,setOpenSearchCustomer:n,setSearchFullName:c}=Ze(),[i,o]=h.useState(""),[x,m]=h.useState(""),{isOpen:u,closeModal:d,openModal:y}=de();function p(){c(i)}return h.useEffect(()=>{if(x!==""){const N=t.find(j=>j.id===parseInt(x));N&&a(N)}},[x]),e.jsxs(e.Fragment,{children:[e.jsx(is,{open:r,onOpenChange:n,children:e.jsxs(os,{children:[e.jsx(ds,{className:"items-start",children:e.jsx(xs,{children:"Search Customer"})}),e.jsx("form",{className:"flex flex-col",onSubmit:N=>{N.preventDefault(),p()},children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(I,{placeholder:"Enter customer name",onChange:N=>{o(N.target.value)},className:"w-[90%]"}),e.jsx(A,{type:"submit",size:"icon",children:s?e.jsx(G,{className:"animate-spin"}):e.jsx(wt,{size:18})})]})}),t.length!==0&&!s&&e.jsx(e.Fragment,{children:e.jsxs(J,{onValueChange:m,children:[e.jsx(ee,{className:"h-15 text-left ",children:e.jsx(se,{placeholder:"Select Customer"})}),e.jsx(te,{children:e.jsx(Ta,{children:t.map((N,j)=>e.jsx(H,{value:N.id.toString(),onClick:()=>{o("")},children:e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("span",{className:"w-full font-bold",children:[N.firstname," ",N.lastname]}),e.jsxs("span",{className:"w-full",children:[N.contact_no," •"," ",N.address]})]})},j))})})]})}),e.jsxs(Aa,{className:"flex flex-row gap-2",children:[e.jsx(A,{variant:"outline",className:"flex-1 font-medium",onClick:()=>{n(!1),y()},children:"Add new customer"}),e.jsx(A,{className:"flex-1",onClick:()=>{n(!1)},children:"Close"})]})]})}),e.jsx(pe,{isOpen:u,onClose:d,title:"Add Customer",children:e.jsx(xr,{onClose:d})})]})},Zt=()=>{const t=je(),[s,l]=h.useState({}),a=(x,m)=>{l(u=>({...u,[x]:m}))},r=x=>{l(m=>({...m,...x}))},n={onSuccess:async()=>{await t.invalidateQueries({queryKey:["invoices"]}),l({}),V.success("Submitted successfully!",{autoClose:3e3})},onError:x=>{console.error("Invoices Data failed",x.message)}},{mutateAsync:c}=Y({mutationKey:["addInvoice"],mutationFn:Da,...n}),{mutateAsync:i}=Y({mutationKey:["updateInvoice"],mutationFn:za,...n}),{mutateAsync:o}=Y({mutationKey:["removeInvoice"],mutationFn:Ea,...n});return{value:s,setValue:l,selectChange:r,handleChange:a,addInvoiceMutation:c,updateInvoiceMutation:i,removeInvoiceMutation:o}},ur=()=>{const{currentInvoiceItemsQueue:t}=xe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Items"}),e.jsx(b,{className:"font-bold text-slate-700",children:t.length>0?e.jsx(e.Fragment,{children:t.length}):0})]})})},hr=()=>{const{invoiceItemsDatabase:t}=xe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Subtotal"}),e.jsx(b,{className:"font-bold text-slate-700",children:ce(t.reduce((s,l)=>s+(l.total_price??0),0))})]})})},pr=()=>{const{currentInvoicePos:t}=xe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Discount"}),e.jsx(b,{className:"font-bold text-slate-700",children:t.total_discount?ce(t.total_discount):"₱0.00"})]})})},fr=()=>{const{currentInvoicePos:t}=xe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Delivery Charge"}),e.jsx(b,{className:"font-bold text-slate-700",children:t.delivery_charge?ce(t.delivery_charge):"₱0.00"})]})})},jr=()=>{const{currentInvoicePos:t}=xe(),s=t.total_amount_due;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex w-full flex-col justify-between gap-2 py-2",children:e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx(b,{className:"text-lg font-bold text-gray-700",children:"Total"}),e.jsx(b,{className:"text-lg font-bold text-black",children:ce(s??0)})]})})})},gr=()=>{const{currentInvoicePos:t}=xe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Paid Amount"}),e.jsx(b,{className:"font-bold text-slate-700",children:t.paid_amount?ce(t.paid_amount):"₱0.00"})]})})},Nr=()=>{var s,l;const{currentInvoicePos:t}=xe();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Payment Type"}),e.jsx(b,{className:"font-bold capitalize text-slate-700",children:(s=t.type)==null?void 0:s.replace("_"," ")})]}),t.type!=="exit"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Payment Method"}),e.jsx(b,{className:"font-bold capitalize text-slate-700",children:(l=t.payment_method)==null?void 0:l.replace("_"," ")})]}),t.payment_method!=="cash"&&t.payment_method!==""&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Reference Number"}),e.jsx(b,{className:"font-bold capitalize text-slate-700",children:t.reference_no})]})})]})]})},rt=()=>{const{currentInvoicePos:t}=xe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-col justify-between gap-2 border-t-2 border-dashed py-2",children:[e.jsx(Nr,{}),t.payment_method!=="purchase_order"&&e.jsx(gr,{}),e.jsxs("div",{className:"flex flex-row justify-between",children:[(t.change_amount??0)<0?e.jsx("span",{className:"text-lg font-bold text-gray-700",children:"Balance"}):e.jsx("span",{className:"text-lg font-bold text-gray-700",children:"Change"}),e.jsx("span",{className:"text-lg font-bold text-black",children:ce(t.change_amount??0)})]})]})})},yr=()=>{const{currentInvoicePos:t,setCurrentInvoicePos:s}=xe(),{selectedCustomer:l}=Ze();return h.useEffect(()=>{t.payment_method==="balance_payment"&&s({...t,subtotal:(l==null?void 0:l.total_balance)??0,total_amount_due:(l==null?void 0:l.total_balance)??0})},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"my-2 flex w-full flex-row justify-between",children:[e.jsx(b,{className:"text-medium font-medium text-slate-700",children:"Remaining Balance"}),e.jsx(b,{className:"font-bold text-slate-700",children:l!=null&&l.total_balance?ce(l.total_balance??0):"₱0.00"})]})})},vr=({})=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{handleInvoicePosChange:l,currentInvoicePos:a}=xe(),{selectedCustomer:r,vouchers:n,selectedVoucher:c,setSelectedVoucher:i}=Ze(),[o,x]=h.useState(a.total_discount??0),m=()=>{l("total_discount",o),t({open:!1,title:""})};return e.jsx(is,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(os,{children:[e.jsxs(ds,{className:"items-start",children:[e.jsx(xs,{children:"Add Discount Amount"}),e.jsx(Ks,{children:"Contact admininstrator for approval"})]}),e.jsxs("form",{className:"flex flex-col gap-2 ",onSubmit:u=>{u.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(I,{className:"pl-8",value:o,type:"number",onChange:u=>{x(Number(u.target.value)),i(void 0)},onBlur:u=>{u.target.value=o.toString()}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Claim voucher"}),e.jsxs(J,{disabled:Object.keys(r).length===0,value:c?c==null?void 0:c.id.toString():"",onValueChange:u=>{const d=n==null?void 0:n.find(y=>y.id===Number(u));x((d==null?void 0:d.discounted_price)??0),i(d??void 0)},children:[e.jsx(ee,{className:"w-full",children:e.jsx(se,{placeholder:"Select voucher..."})}),e.jsx(te,{children:n==null?void 0:n.map(u=>e.jsxs(H,{value:`${u.id}`,children:[e.jsx("span",{className:"font-bold",children:u.code})," • ",e.jsx("span",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(u.discounted_price??0)})]},u.id))})]})]}),e.jsx(ws,{asChild:!0,children:e.jsx(A,{className:"w-full ",type:"submit",onClick:()=>{m()},children:"Apply"})})]})]})})},br=({})=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{handleInvoicePosChange:l,currentInvoicePos:a}=xe(),[r,n]=h.useState(a.paid_amount??0),c=()=>{l("paid_amount",r),t({open:!1,title:""})};return e.jsx(is,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(os,{children:[e.jsxs(ds,{className:"items-start",children:[e.jsx(xs,{children:"Add Paid Amount"}),e.jsx(Ks,{children:"Input the exact amount paid by the customer"})]}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:i=>{i.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(I,{className:"pl-8",defaultValue:r,type:"number",onChange:i=>{n(Number(i.target.value))}})]}),e.jsx(ws,{asChild:!0,children:e.jsx(A,{className:"w-full ",type:"submit",onClick:()=>{c()},children:"Apply"})})]})]})})},wr=({})=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{selectedCustomer:l}=Ze(),{handleInvoicePosChange:a,currentInvoicePos:r,setCurrentInvoiceItemsQueue:n,setInvoiceItemsDatabase:c}=xe(),[i,o]=h.useState(r.type??"payment");return h.useEffect(()=>{r.type==="exit"&&a("payment_method","exit")},[r.type]),e.jsx(is,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(os,{children:[e.jsxs(ds,{className:"items-start",children:[e.jsx(xs,{children:"Select Payment Type"}),e.jsxs(Ks,{children:["Payment Type:"," ",r.type==="payment"?"Payment":"Exit"]})]}),e.jsx(yt,{id:"type",value:i,onValueChange:x=>{a("type",x),o(x)},children:e.jsxs(vt,{className:"flex h-12 flex-row gap-1 p-2",children:[e.jsx(ps,{value:"payment",className:`data-[state=active]:bg-primary h-10 w-full rounded-md font-medium
                                text-slate-800 hover:bg-slate-200 data-[state=active]:text-white`,children:"Payment"}),e.jsx(ps,{value:"exit",className:`data-[state=active]:bg-primary h-10 w-full rounded-md font-medium
                                text-slate-800 hover:bg-slate-200 data-[state=active]:text-white`,children:"Exit"})]})}),r.type==="payment"&&e.jsxs("div",{className:"grid columns-4 grid-cols-2 gap-2",children:[e.jsx(A,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="cash"&&"bg-primary text-white"}`,onClick:()=>{a("payment_method","cash")},children:"Cash"}),e.jsx(A,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="cheque"&&"bg-primary text-white"}`,onClick:()=>{a("payment_method","cheque")},children:"Cheque"}),e.jsx(A,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="e-wallet"&&"bg-primary text-white"}`,onClick:()=>{a("payment_method","e-wallet")},children:"E-Wallet"}),e.jsx(A,{variant:"outline",className:`h-16 font-medium ${r.payment_method==="purchase_order"&&"bg-primary text-white"}`,onClick:()=>{a("payment_method","purchase_order")},children:"Purchase Order"}),e.jsx(A,{variant:"outline",disabled:!(l!=null&&l.total_balance),className:`h-16 font-medium ${r.payment_method==="balance_payment"&&"bg-primary text-white"}`,onClick:()=>{n([]),c([]),a("payment_method","balance_payment")},children:"Balance Payment"})]}),e.jsx("div",{children:(r.payment_method==="cheque"||r.payment_method==="voucher"||r.payment_method==="e-wallet"||r.payment_method==="purchase_order")&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-col justify-between gap-2",children:[e.jsx(b,{children:"Input Reference Code:"}),e.jsx(I,{placeholder:"Reference Code"})]})})}),e.jsx(ws,{asChild:!0,children:e.jsx(A,{type:"button",onClick:()=>{t({open:!1,title:""})},children:"Close"})})]})})},_r=()=>{const{auth:t}=ae(),{searchFilterItems:s}=Be(),l=Le();return e.jsx(e.Fragment,{children:e.jsx("div",{children:t.role==="admin"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row items-center justify-between px-2 py-4 ",children:[e.jsxs("span",{className:"flex flex-col font-bold text-slate-700",children:["Warehouse"," ",e.jsx("span",{className:"font-medium text-slate-800",children:s.warehouse_id===1?"Cagayan De Oro":"Iligan"})]}),e.jsx(A,{onClick:()=>{l("/pos")},size:"icon",children:e.jsx(Js,{size:18})})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row justify-between p-2 bg-white",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"flex flex-row items-center gap-2 font-bold uppercase text-slate-800",children:s.warehouse_id===1?"Cagayan De Oro Branch":"Iligan Branch"}),e.jsx("span",{className:"font-medium capitalize text-slate-900",children:t.user.firstname+" "+t.user.lastname})]}),e.jsx(A,{className:"hover:cursor-default",size:"icon",children:e.jsx(Js,{size:18})})]})})})})},Sr=({})=>{const{selectedCustomer:t,setOpenSearchCustomer:s}=Ze();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex max-w-2xl flex-col gap-1 border-y-[1px] border-slate-200 bg-white px-2 py-4 pb-5",children:e.jsxs("div",{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(b,{className:"text-[16px] font-bold text-slate-700",children:"Customer"}),Object.keys(t).length===0?e.jsx("span",{className:"text-sm font-medium",children:"Select Customer"}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2 pt-2 ",children:[e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs(b,{className:"font-medium text-normal text-slate-800",children:["Full Name:"," "]}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.firstname+" "+t.lastname})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx(b,{className:"font-medium text-normal text-slate-800",children:"Address:"}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.address})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx(b,{className:"font-medium text-normal text-slate-800",children:"Contact Number:"}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.contact_no})]})]})})]}),e.jsx(A,{onClick:()=>s(!0),size:"icon",children:e.jsx(wt,{size:18})})]})})})},Cr=({})=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{currentInvoicePos:l}=xe();Zt();const{selectedCustomer:a}=Ze();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-1 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(A,{className:"flex-1",onClick:()=>{t({open:!0,title:"delivery_charge"})},disabled:l.payment_method==="balance_payment",children:"Set Delivery"}),e.jsx(A,{className:"flex-1",onClick:()=>{t({open:!0,title:"discount"})},disabled:l.payment_method==="balance_payment",children:"Set Discount"})]}),e.jsx(A,{onClick:()=>{t({open:!0,title:"payment_type"}),console.log("Options:",s)},children:"Set Payment Type"}),e.jsx(A,{onClick:()=>{t({open:!0,title:"paid_amount"}),console.log("Options:",s)},children:"Add Paid Amount"}),e.jsx("hr",{className:"my-1 w-full"}),e.jsx(A,{className:"w-full disabled:cursor-not-allowed",onClick:()=>{t({open:!0,title:"checkout"})},disabled:Object.keys(a).length===0||l.type==="payment"&&l.payment_method!=="purchase_order"&&l.payment_method!=="balance_payment"&&(l.change_amount??0)<0,children:"Checkout"})]})})},Jt=()=>{const{currentInvoicePos:t}=xe();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-full flex-col justify-between p-4 px-2",children:e.jsx("div",{className:"flex flex-col gap-2",children:t.payment_method!=="balance_payment"?e.jsxs(e.Fragment,{children:[e.jsx(ur,{}),e.jsx(hr,{}),e.jsx(pr,{}),e.jsx(fr,{}),e.jsx(jr,{}),e.jsx(rt,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(yr,{}),e.jsx(rt,{})]})})})})},kr=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-pos-primary-background flex h-screen w-full max-w-[375px] flex-col gap-2 overflow-auto p-5",children:e.jsxs("div",{className:"flex flex-col rounded-md bg-white p-2 px-4",children:[e.jsx(_r,{}),e.jsx(mr,{}),e.jsx(Sr,{}),e.jsx(Jt,{}),e.jsx(Cr,{})]})})}),Fr=()=>{const{dialogOptions:t}=Be();return e.jsxs(e.Fragment,{children:[t.title==="payment_type"&&e.jsx(wr,{}),t.title==="discount"&&e.jsx(vr,{}),t.title==="paid_amount"&&e.jsx(br,{}),t.title==="checkout"&&e.jsx(Ir,{}),t.title==="delivery_charge"&&e.jsx(Pr,{})]})},Ir=()=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{invoiceItemsDatabase:l,currentInvoiceItemsQueue:a,fullData:r,setFullData:n,currentInvoicePos:c}=xe(),[i,o]=h.useState("confirming"),{addInvoiceMutation:x}=Zt(),{selectedVoucher:m,setSelectedVoucher:u}=Ze();async function d(){o("submitting"),console.log("Invoice:",c),console.log("InvoiceItems:",a),console.log("InvoiceItemsDatabase:",l);const N=c;N.invoice_items=l.map(j=>({...j,product_id:j.product_id})),await x(N).then(j=>{m&&Ka(m.id).then(()=>u(void 0)),n(j.data),o("success"),V.success("Transaction successful.",{autoClose:3e3})}).catch(()=>{o("confirming"),V.error("Transaction failed. Please try again.",{autoClose:3e3})})}const y=Le();function p(){window.api.send({fullData:r,invoiceItems:a,invoiceItemsDatabase:l})}return e.jsx(Wa,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(Ma,{children:[e.jsxs(Oa,{className:"items-start",children:[e.jsx(Ra,{children:i!=="success"?"Checkout":"Transaction successful"}),i!=="success"&&e.jsx(La,{children:"Confirm the details of this transaction"})]}),i!=="success"?e.jsx(Jt,{}):e.jsxs("div",{className:"my-4 w-full space-y-2 text-center",children:[e.jsx(vl,{size:80,className:"mx-auto text-green-500"}),e.jsx("h3",{className:"text-base font-medium text-slate-700",children:"Transaction has been successully submitted!"})]}),e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(A,{variant:"outline",className:`font-medium ${i!=="confirming"&&"hidden"} flex-1`,type:"reset",onClick:()=>{t({open:!1,title:""})},children:"Cancel"}),i==="success"?e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(A,{className:"flex-1",onClick:()=>{y(0)},children:"New transaction"}),e.jsx(A,{className:"flex-1",type:"submit",onClick:N=>{N.preventDefault(),p()},children:"Print invoice"})]}):e.jsx(A,{className:"flex-1",disabled:i==="submitting",type:"submit",onClick:N=>{N.preventDefault(),o("submitting"),d()},children:i==="confirming"?"Confirm transaction":i==="submitting"?"Submitting...":""})]})]})})},Pr=()=>{const{setDialogOptions:t,dialogOptions:s}=Be(),{handleInvoicePosChange:l,currentInvoicePos:a}=xe(),[r,n]=h.useState(a.delivery_charge??0),c=()=>{l("delivery_charge",r),t({open:!1,title:""})};return e.jsx(is,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(os,{children:[e.jsx(ds,{className:"items-start",children:e.jsx(xs,{children:"Add Delivery Charge"})}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:i=>{i.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(I,{className:"pl-8",defaultValue:r,type:"number",onChange:i=>{n(Number(i.target.value))}})]}),e.jsx(ws,{asChild:!0,children:e.jsx(A,{className:"w-full ",type:"submit",onClick:()=>{c()},children:"Apply"})})]})]})})},Tr=({})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center",children:[e.jsx(Sl,{width:150,height:150,color:"#888888",strokeWidth:-1}),e.jsx("span",{className:"max-w-[300px] text-center text-[#888]",children:"Start entering products / product code / serial number / brand"})]})}),Ar=({})=>{const{currentInvoiceItemsQueue:t,handleInvoicePosChange:s,handleInvoiceItemQuantity:l,removeInvoiceItem:a,invoiceItemsDatabase:r}=xe();console.log(),h.useEffect(()=>{s("subtotal",t.reduce((c,i)=>c+i.total_price,0))},[t]);const n=[{id:"orderItem",enableResizing:!1,enableHiding:!1,header:()=>e.jsx("div",{className:"flex justify-center",children:"Item #"}),cell:({row:c})=>e.jsx("div",{className:"flex justify-center",children:c.index+1}),size:100},{accessorKey:"name",enableHiding:!1,header:()=>e.jsx("div",{className:"justify-center",children:"Product"}),cell:({row:c})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"text-sm font-bold",children:c.original.product.name}),e.jsx("span",{className:"font-medium",children:c.original.product.size})]}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[c.original.product.brand?e.jsx("span",{className:"",children:c.original.product.brand}):e.jsx("span",{className:"font-light",children:"(No Brand)"}),e.jsxs("span",{className:"",children:["• ",c.original.product.color]})]})]}),size:350},{enableHiding:!1,accessorKey:"quantity",header:()=>e.jsx("div",{className:"flex justify-center",children:"Quantity"}),size:150,cell:({row:c})=>{const i=c.index,o=c.original.inventory_product.approved_stocks-c.original.inventory_product.sold_count||0;return e.jsx("div",{className:"flex justify-center ",children:e.jsxs("div",{className:"flex flex-row border drop-shadow-sm",children:[e.jsx(A,{className:"rounded-sm bg-red-300 hover:bg-red-500 disabled:opacity-100",onClick:()=>{l(i,o,r[c.index].quantity-1)},disabled:r[c.index].quantity===1,children:e.jsx("span",{children:"-"})}),e.jsx(I,{id:"quantity",className:"w-20 rounded-none text-center drop-shadow-none",type:"number",defaultValue:r[i].quantity,onChange:x=>{console.log(x.target.value),setTimeout(()=>{l(i,o,Number(x.target.value))},1e3)}}),e.jsx(A,{className:"rounded-sm bg-slate-500 hover:bg-slate-700 disabled:bg-slate-200",onClick:()=>{l(i,o,r[c.index].quantity+1)},disabled:r[c.index].quantity>=o,children:e.jsx("span",{children:"+"})})]})})}},{id:"item_capital_price",size:125,header:()=>e.jsx("div",{className:"justify-center",children:"Capital Price"}),cell:({row:c})=>e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx("span",{children:ce(c.original.capital_price)})})},{accessorKey:"price",enableHiding:!1,header:()=>e.jsx("div",{className:"justify-center",children:"Product Price"}),cell:({row:c})=>e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{children:ce(c.original.price)}),c.original.on_sale?e.jsxs("span",{className:"text-sm font-light",children:["(",ce(c.original.sale_discount??0),")"]}):null]})},{id:"item_total_capital_price",size:125,header:()=>e.jsx("div",{className:"justify-center",children:"Total Capital Price"}),cell:({row:c})=>e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx("span",{children:ce(c.original.capital_price*r[c.index].quantity)})})},{id:"total_price",enableHiding:!1,accessorKey:"total_price",header:()=>e.jsx("div",{className:"justify-center",children:"Subtotal"}),cell:({row:c})=>e.jsx("div",{className:"",children:e.jsx("span",{children:ce(r[c.index].quantity*c.original.price)})}),size:250},{enableHiding:!1,id:"actions",size:100,cell:({row:c})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsx(A,{className:"bg-red-500 hover:bg-red-700",onClick:()=>{a(c.index)},children:e.jsx(ks,{color:"#FFF"})})})}];return e.jsx("div",{className:"h-full overflow-y-scroll",children:t.length===0?e.jsx(e.Fragment,{children:e.jsx(Tr,{})}):e.jsx(pl,{data:t,columns:n})})},Dr=()=>{const t=["","Product name","Price","Qty","Total"],{selectedInvoiceCode:s}=xt(),{data:l}=vs();return console.log(s),e.jsx(e.Fragment,{children:e.jsxs(_t,{children:[e.jsxs(Ua,{children:["Select items the customer wants to return for invoice"," "]}),e.jsx(St,{children:e.jsx(ns,{id:"tHeaderRow",className:"hover:bg-white",children:t.map(a=>e.jsx(Ct,{className:"whitespace-nowrap px-5 py-3 text-left text-xs font-bold uppercase",children:a},a+"_head"))},"tHeaderRow")}),e.jsx(kt,{children:s.invoice_items.length>0&&s.invoice_items.map((a,r)=>e.jsxs(ns,{className:"text-sm font-medium text-gray-700",children:[e.jsx(oe,{className:"p-3 pr-0",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4",name:"return",id:"return"})}),e.jsx(oe,{className:"text-sm font-medium text-gray-700",children:a==null?void 0:a.product.name},(a==null?void 0:a.product.name)+"Product Name"),e.jsx(oe,{children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{children:ce(l.find(n=>n.id===a.product_price_id).cost)}),l.find(n=>n.id===a.product_price_id).on_sale?e.jsxs("span",{className:"text-muted-foreground",children:["(",ce(l.find(n=>n.id===a.product_price_id).sale_discount),")"]}):null]})}),e.jsx(oe,{children:a==null?void 0:a.quantity}),e.jsx(oe,{children:ce(a==null?void 0:a.total_price)})]},(a==null?void 0:a.id)+"row"))}),e.jsx(qa,{children:e.jsxs(ns,{children:[e.jsx(oe,{colSpan:4,className:"text-right",children:"Total:"}),e.jsx(oe,{children:ce(s.paid_amount)})]})})]})})},zr=()=>{const[t,s]=h.useState(""),{sellableItems:l,fetchingProducts:a}=Be(),{currentInvoiceItemsQueue:r,setCurrentInvoiceItemsQueue:n,invoiceItemsDatabase:c,setInvoiceItemsDatabase:i,currentInvoicePos:o}=xe();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative z-20 pb-10",children:e.jsx("div",{className:"absolute box-content flex w-full ",children:e.jsxs(Ve,{className:"rounded-lg border p-1 shadow-md",children:[e.jsx($e,{value:t,onValueChange:s,placeholder:a?"Loading Products":"Enter Product Name",disabled:l.length===0||o.payment_method==="balance_payment"}),e.jsx(Ha,{className:"",children:t?e.jsx(e.Fragment,{children:l.filter(x=>x.inventory_product.approved_stocks>(x.inventory_product.sold_count??0)).map((x,m)=>{var d;const u=x.inventory_product.approved_stocks-x.inventory_product.sold_count;return e.jsx(Te,{onSelect:()=>{const y=r.findIndex(p=>p.inventory_product.product.id===x.inventory_product.product.id);y!==-1&&(c[y].quantity+=1,s("")),y===-1&&(n([...r,x]),i([...c,{product_id:x.product.id,product_price_id:x.inventory_product.product_price.id,product_price:x.inventory_product.product_price.price,quantity:1,unit:x.unit,item_discount:0,price:x.price,created_by:x.created_by,active_status:x.active_status,created_at:x.created_at,updated_at:x.updated_at,total_price:x.price,source_inventory:x.warehouse.id}]),s(""))},value:`${x.product.id} ${x.id} ${x.product.name} ${x.product.serial_no} ${x.product.brand} ${x.product.color}`,children:e.jsxs("div",{className:"flex flex-1 flex-row justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"font-bold",children:x.product.name}),e.jsx("span",{className:"font-medium",children:(d=x.product.size)==null?void 0:d.replace("inch",'"')})]}),e.jsxs("div",{className:"flex flex-row gap-1",children:[x.product.brand?e.jsxs("span",{className:"text-[12px]",children:["(",x.product.brand,")"]}):e.jsx("span",{className:"text-[12px]",children:"(No Brand)"}),e.jsxs("span",{className:"",children:["• ",x.product.color]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-bold ",children:ce(x.price)}),e.jsxs("span",{className:"font-medium",children:[u," ",u>1?"items":"item"]})]})]})},m)})}):null})]})})})})},tc=({})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex h-full flex-row",children:[e.jsx(Lt,{}),e.jsxs("div",{className:"flex h-full w-screen flex-row",children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx(zr,{}),e.jsx(Ar,{})]}),e.jsx(kr,{}),e.jsx(Fr,{})]})]})}),Er=({openModal:t})=>{const{transactions:s,isFetching:l,progress:a}=Va(),r=[{id:"select",header:({table:n})=>e.jsx("input",{type:"checkbox",checked:n.getIsAllPageRowsSelected(),onChange:c=>n.toggleAllPageRowsSelected(!!c.target.checked),"aria-label":"Select all"}),cell:({row:n})=>e.jsx("input",{type:"checkbox",checked:n.getIsSelected(),onChange:c=>n.toggleSelected(!!c.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"Product ID"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.id})},{accessorKey:"price",header:()=>e.jsx("div",{className:"text-center",children:"Price"}),cell:({row:n})=>{const c=parseFloat(n.getValue("amount")),i=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c);return e.jsx("div",{className:"text-center",children:i})}},{accessorKey:"product_name",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["PRODUCT NAME ",n.getIsSorted()==="asc"?e.jsx(z,{}):n.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.product_name})},{accessorKey:"dimensions",header:()=>e.jsx("div",{className:"text-center",children:"DIMENSIONS"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.dimensions})},{accessorKey:"serial",header:()=>e.jsx("div",{className:"text-center",children:"SERIAL"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.serial})},{accessorKey:"sku",header:()=>e.jsx("div",{className:"text-center",children:"SKU"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.sku})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"INVENTORY STATUS"}),cell:({row:n})=>{const c=n.getValue("status"),i=c==="LOW"?"bg-red-500":c==="MEDIUM"?"bg-amber-500":"bg-lime-600";return e.jsx("div",{className:`flex w-full flex-1 flex-col text-center ${i}`,children:n.getValue("status")})}},{accessorKey:"type",header:()=>e.jsx("div",{className:"text-center",children:"ORDER TYPE"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.type})},{accessorKey:"quantity",header:()=>e.jsx("div",{className:"text-center",children:"QUANTITY"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.quantity})}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:s,columns:r,filterWhat:"serial",dataType:"Transaction",openModal:()=>t,isLoading:l})})},ac=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Transaction",children:e.jsx($a,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Er,{openModal:n})})})})})})},Wr=({openModal:t})=>{const{transfers:s,transferProducts:l,isFetching:a,progress:r,setSelectedTransfer:n}=Ie(),c=l.map(p=>({transfer_id:p.transfer_id})),o=s.filter(p=>{if(c.some(N=>N.transfer_id===p.id))return p}).filter(p=>{if(p.approval_status==="pending")return p}),{auth:x}=ae(),m=p=>{n(p),t(p,"details")},u=p=>{n(p),t(p,"edit")},d=p=>{n(p),t(p,"products")},y=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:p})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>p.toggleSorting(p.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["TRANSFER CODE ",p.getIsSorted()==="asc"?e.jsx(z,{}):p.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:p})=>e.jsx("div",{children:p.original.code?p.original.code:"N/A"})},{accessorKey:"source",header:()=>e.jsx("div",{className:"text-center",children:"SOURCE-DESTINATION"}),cell:({row:p})=>{const N=p.original.source,j=p.original.destination;return e.jsxs("div",{className:"text-center",children:[N.code,"-",j.code]})}},{accessorKey:"transfer_status",sortingFn:"text",enableSorting:!0,header:({column:p})=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(_,{onClick:()=>p.toggleSorting(p.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center z-10",children:["TRANSFER STATUS ",p.getIsSorted()==="asc"?e.jsx(z,{}):p.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:p})=>e.jsx("div",{className:"text-center",children:p.original.transfer_status?p.original.transfer_status:"N/A"})},{accessorKey:"transfer_schedule",sortingFn:"datetime",enableSorting:!0,header:({column:p})=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(_,{onClick:()=>p.toggleSorting(p.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center z-10",children:["SCHEDULE ",p.getIsSorted()==="asc"?e.jsx(z,{}):p.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:p})=>{const N=p.getValue("transfer_schedule");if(N.toString()!=="0000-00-00 00:00:00"){const j={year:"numeric",month:"long",day:"numeric"},f=new Date(N).toLocaleDateString([],j);return e.jsx("div",{className:"text-center",children:f})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"approval_status",header:()=>e.jsx("div",{className:"text-center",children:"APPROVAL STATUS"}),cell:({row:p})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:p.original.approval_status.toLowerCase()==="approved"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):p.original.approval_status.toLowerCase()==="rejected"?e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:p})=>{var j;const N=p.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>m(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),((j=x.role)==null?void 0:j.toLowerCase())!="encoder"&&e.jsxs(Q,{onClick:()=>u(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:N.transfer_status!="arrived"&&N.approval_status!="rejected"?e.jsx(be,{size:16,strokeWidth:2.25}):e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>d(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:N.transfer_status!="arrived"&&N.approval_status!="rejected"?e.jsx(be,{size:16,strokeWidth:2.25}):e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Products"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:o,columns:y,filterWhat:"approval_status",dataType:"",openModal:void 0,isLoading:a})})},Mr=({onClose:t})=>{const{selectedTransfer:s}=Ie();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Source"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.source.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.destination.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer schedule"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_schedule.toString()==="0000-00-00 00:00:00"?"N/A":ie(s.transfer_schedule)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Received by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.received_by?s.received_by.firstname+" "+s.received_by.lastname:"N/A"})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Date received"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.date_received?ie(s.date_received):"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approved_by?s.approved_by.firstname+" "+s.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.updated_at)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.notes?s.notes:"N/A"})]})})]})})},Or=({openModal:t})=>{const{transfers:s,transferProducts:l,isFetching:a,selectedTransfer:r,setSelectedTransfer:n,selectedProduct:c,setSelectedProduct:i,addProd:o,setAddProd:x}=Ie();ae();const m=l.filter(p=>p.transfer_id===r.id),u=p=>{i(p),x(!1),t(p,"edit")},d=()=>{x(!0),t({},"add")},y=[{id:"select",header:({table:p})=>e.jsx("input",{type:"checkbox",checked:p.getIsAllPageRowsSelected(),onChange:N=>p.toggleAllPageRowsSelected(!!N.target.checked),"aria-label":"Select all"}),cell:({row:p})=>e.jsx("input",{type:"checkbox",checked:p.getIsSelected(),onChange:N=>p.toggleSelected(!!N.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:p})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>p.toggleSorting(p.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",p.getIsSorted()==="asc"?e.jsx(z,{}):p.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:p})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:p.original.product.name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:p})=>e.jsx("div",{className:"text-center",children:p.original.total_quantity})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"text-center",children:"UNIT"}),cell:({row:p})=>e.jsx("div",{className:"text-center",children:p.original.unit})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:p})=>{const N=p.original;return r.transfer_status!="arrived"&&r.approval_status!="rejected"&&e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsx(_,{fill:"yellow",textColor:"black",onClick:()=>u(N),children:"Edit Product"})})}}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:m,columns:y,filterWhat:"product_name",dataType:"Transfer Products",openModal:r.transfer_status!="arrived"&&r.approval_status!="rejected"?d:void 0,isLoading:a})})},nt=({onClose:t})=>{const{addProd:s,selectedProduct:l}=Ie(),{product:a,allProducts:r,allInventoryProducts:n,inventoryID:c,invCode:i,prodName:o,filteredProductsSrc:x,filteredInventoriesSrc:m,quantityLimit:u,damagedCount:d,isChanged:y,isSubmitting:p,error:N,success:j,handleSubmit:f,handleChange:g,handleChangeSelect:v}=Fs(),F=a.capital_price?a.capital_price:0,w=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(F);j&&setTimeout(()=>{t()},1e3);const[k,P]=h.useState(s?i:"Loading...");return h.useEffect(()=>{m.length>0&&!s&&a.source_inventory&&P(m.filter(C=>C.id===a.source_inventory)[0].code)},[a.source_inventory,m]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:C=>{C.preventDefault()},children:e.jsxs("div",{className:"flex max-w-6xl flex-col gap-5",children:[e.jsxs("div",{className:"grid grid-cols-12 justify-center gap-3",children:[e.jsxs("div",{className:"col-span-3 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer Product"}),e.jsx(B,{name:"id",value:a.id,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"col-span-3 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer ID"}),e.jsx(B,{name:"created_by",placeholder:"User ID",value:a.transfer_id,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Inventory source:"}),e.jsxs(J,{onValueChange:C=>v("inventory_id",C),required:!0,name:"inventory_id",value:k!="Loading..."?s?i:k:"",children:[e.jsx(ee,{name:"inventory_id",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:s?i||"Choose inventory...":k})}),e.jsx(te,{className:"bg-white font-medium",children:m.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):m.map((C,M)=>e.jsx(H,{value:C.code,className:"text-sm font-medium text-slate-700",children:C.code},M))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 justify-center gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Product to transfer:"}),e.jsxs(J,{onValueChange:C=>v("product_id",Number(C.split("-")[0]),Number(C.split("-")[1])),required:!0,name:"product_id",disabled:!c,children:[e.jsx(ee,{name:"product_id",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:s?c?"Choose product...":"Select inventory first":k!="Loading..."?o==""?"Choose product...":o:"Loading..."})}),e.jsx(te,{className:"bg-white font-medium",children:x.length<=0?!s&&k!="Loading..."?e.jsx("div",{className:"flex h-12 w-full items-center justify-center px-2",children:"No items in selected inventory."}):e.jsx("div",{className:"px-2",children:" Loading... "}):x.map((C,M)=>e.jsx(H,{value:C.product.id?C.product.id.toString()+"-"+M.toString():"",className:`text-sm font-medium text-slate-700
												${!s&&C.product.id==l.product.id&&"selected"}`,children:C.product.name},M))})]})]}),e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Capital Price:"}),e.jsx(B,{name:"capital_price",type:"string",value:w,disabled:!0,readOnly:!0})]})]}),e.jsxs("div",{className:"flex flex-row justify-center gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"TOTAL QUANTITY"}),e.jsx(B,{name:"total_quantity",type:"string",value:a.total_quantity||"",placeholder:`Available stocks: ${u}`,disabled:!a.capital_price,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"UNIT"}),e.jsx(B,{name:"unit",type:"string",value:a.unit||"",placeholder:"box, pieces, etc.",disabled:!0,readOnly:!0})]}),a.total_quantity!=0&&d!=0&&a.total_quantity==u&&e.jsxs("div",{className:"group mb-2 grid content-end",children:[e.jsx(Es,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsxs("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-2 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:["Some damaged goods (",d," ",a.unit,") are included in the transfer."]})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"col-span-5 flex flex-col items-start",children:[j&&e.jsx("div",{className:"font-bold text-green-700",children:j}),N&&e.jsx("div",{className:"font-bold text-red-700",children:N}),p?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"col-span-5 flex flex-col items-end gap-3",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),y&&e.jsx(_,{type:"submit",fill:y?"green":null,disabled:!y,onClick:f,children:p?"Submitting":s?"Add Product":"Edit Product"})]})})]})})]})})})},Rr=({onClose:t})=>{const{isOpen:s,openModal:l,closeModal:a}=de(),[r,n]=h.useState("");ae();const c=(i,o)=>{l(),n(o)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx(Or,{openModal:c})}),e.jsx(pe,{title:r==="edit"?"Edit Transfer Product":"Add Transfer Product",isOpen:s,onClose:a,children:e.jsxs(e.Fragment,{children:[r==="edit"&&e.jsx(nt,{onClose:a}),r==="add"&&e.jsx(nt,{onClose:a})]})})]})},lc=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Pending Transfer",children:e.jsxs(bt,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(Wr,{openModal:n})})}),e.jsx(pe,{title:a==="details"?"Transfer Details":a==="edit"?"Edit Transfer":"Transfer Products",isOpen:t,onClose:l,closeOnOverlayClick:a==="details",children:e.jsxs(e.Fragment,{children:[a==="details"&&e.jsx(Mr,{onClose:l}),a==="edit"&&e.jsx(Xt,{onClose:l}),a==="products"&&e.jsx(Rr,{onClose:l})]})})]})})})},Lr=({openModal:t})=>{const{invoices:s,isFetching:l,users:a,userSales:r,setSelectedInvoice:n}=Ft(),c=o=>{n(o.invoices),t(o,"details")},i=[{accessorKey:"issued_by",sortingFn:"text",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["FULL NAME ",o.getIsSorted()==="asc"?e.jsx(z,{}):o.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.invoices[0].issued_by.firstname+" "+o.original.invoices[0].issued_by.lastname})},{id:"total_sales",sortingFn:"basic",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["NUMBER OF SALES ",o.getIsSorted()==="asc"?e.jsx(z,{}):o.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.invoices.length})},{id:"amount_sales",sortingFn:"basic",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TOTAL AMOUNT OF SALES ",o.getIsSorted()==="asc"?e.jsx(z,{}):o.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:o})=>{const m=o.original.invoices.filter(d=>d.status==="approved").reduce((d,y)=>d+y.paid_amount,0),u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m);return e.jsx("div",{className:"text-center",children:u})}},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:o})=>{const x=o.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>c(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:r,columns:i,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:l})})},Kr=({onClose:t})=>{const{invoices:s,selectedInvoice:l,isFetching:a}=Ft(),r=l[0],n=[{id:"select",header:({table:c})=>e.jsx("input",{type:"checkbox",checked:c.getIsAllPageRowsSelected(),onChange:i=>c.toggleAllPageRowsSelected(!!i.target.checked),"aria-label":"Select all"}),cell:({row:c})=>e.jsx("input",{type:"checkbox",checked:c.getIsSelected(),onChange:i=>c.toggleSelected(!!i.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"or_no",sortingFn:"alphanumeric",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{c.toggleSorting(c.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["OR NUMBER ",c.getIsSorted()==="asc"?e.jsx(z,{}):c.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.or_no})},{accessorKey:"created_at",sortingFn:"datetime",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{c.toggleSorting(c.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["CREATED AT ",c.getIsSorted()==="asc"?e.jsx(z,{}):c.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:c})=>{const i=c.getValue("created_at");if(i.toString()!=="0000-00-00 00:00:00"){const o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},x=new Date(i).toLocaleDateString([],o);return e.jsx("div",{className:"text-center",children:x})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"warehouse",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE CODE"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.warehouse.code})},{id:"customer",header:()=>e.jsx("div",{className:"text-center",children:"CUSTOMER NAME"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.customer.firstname+" "+c.original.customer.lastname})},{accessorKey:"type",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{c.toggleSorting(c.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TRANSACTION TYPE ",c.getIsSorted()==="asc"?e.jsx(z,{}):c.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.type})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"STATUS"}),cell:({row:c})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:c.original.status.toLowerCase()==="approved"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):c.original.status.toLowerCase()==="rejected"?e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})},{accessorKey:"subtotal",header:()=>e.jsx("div",{className:"text-center",children:" SUBTOTAL "}),cell:({row:c})=>{const i=c.original.subtotal,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_discount",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL DISCOUNT "}),cell:({row:c})=>{const i=c.original.total_discount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_tax",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL TAX "}),cell:({row:c})=>{const i=c.original.total_tax,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"delivery_charge",header:()=>e.jsx("div",{className:"text-center",children:" DELIVERY CHARGE "}),cell:({row:c})=>{const i=c.original.delivery_charge,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_amount_due",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL AMOUNT DUE "}),cell:({row:c})=>{const i=c.original.total_amount_due,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"paid_amount",header:()=>e.jsx("div",{className:"text-center",children:" PAID AMOUNT "}),cell:({row:c})=>{const i=c.original.paid_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"change_amount",header:()=>e.jsx("div",{className:"text-center",children:" CHANGE AMOUNT "}),cell:({row:c})=>{const i=c.original.change_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"payment_method",header:()=>e.jsx("div",{className:"text-center",children:" PAYMENT METHOD "}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.payment_method||"N/A"})},{accessorKey:"reference_no",header:({column:c})=>e.jsx("div",{className:"text-center",children:"REF #"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.reference_no||"--"})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl max-h-96 flex-col gap-4",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Issuer: ",r.issued_by.firstname+" "+r.issued_by.lastname]}),e.jsx("div",{className:"overflow-x-hidden",children:e.jsx(Z,{data:l,columns:n,filterWhat:"or_no",dataType:"",openModal:void 0,isLoading:a})})]})})},rc=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"User Sales",children:e.jsxs(Ba,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Lr,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:l,title:a==="details"?"Invoice Details":"",closeOnOverlayClick:a==="details",children:e.jsx(e.Fragment,{children:a==="details"&&e.jsx(Kr,{onClose:l})})})]})})})},Ur=()=>{const{roles:t,roleSelect:s,permissions:l,allPermissions:a,permissionChange:r,roleId:n,isChanged:c,isSubmitting:i,error:o,success:x,handleChange:m,handleChangeSelect:u,handleSubmit:d}=Dl(),{auth:y}=ae(),p=a.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&g.title.includes("users".toLowerCase()))),N=a.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&!g.title.includes("transfer".toLowerCase())&&g.title.includes("product".toLowerCase())||g.title.includes("capital".toLowerCase()))),j=a.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&g.title.includes("transfer".toLowerCase()))),f=a.filter(g=>Object.keys(g).some(v=>g.title.includes("view".toLowerCase())));return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto flex h-full max-h-full w-full flex-row divide-x",children:[e.jsxs("div",{className:"flex w-60 flex-none flex-col p-2 pt-8",children:[e.jsx("h3",{className:"ml-4 pb-1 text-xs font-semibold text-slate-500/80",children:"Roles"}),e.jsx("div",{className:"w-full",children:t?t.map(g=>g.title!=="super_admin"&&e.jsx(A,{variant:"ghost",className:`w-full justify-start capitalize text-slate-700 ${(s==null?void 0:s.title)===g.title&&"bg-slate-300/40"}`,onClick:()=>u("roles",g.title),children:g.title.split("_").join(" ")},g.id+g.title)):e.jsx("div",{className:"flex h-16 w-full items-center justify-center text-slate-500",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})})}),e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-slate-500/80",children:"After saving changes, affected users must log out and log back in to apply the changes."}),(s==null?void 0:s.title)===y.role&&e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-red-500/80",children:"You are editing your current role. Review your changes carefully."}),e.jsxs("div",{className:"mt-auto w-full space-y-3",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[x&&e.jsx("p",{className:"text-green-600",children:x}),o&&e.jsx("p",{className:"text-red-600",children:o})]}),c&&e.jsx(A,{type:"submit",className:"w-full disabled:cursor-not-allowed",disabled:!!i,onClick:d,children:i?"Saving...":"Save changes"})]})]}),s?e.jsx(We,{className:"w-full",type:"auto",style:{"--border":"216 12% 84%"},children:e.jsxs("div",{className:`mx-auto flex w-full max-w-[700px] flex-1 flex-col gap-8 p-6 pt-8 ${!s||i?"pointer-events-none opacity-50":null}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"User Management"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:p.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):p.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(b,{htmlFor:g.title,className:`${!((s==null?void 0:s.title)==="super_admin"||(s==null?void 0:s.title)==="admin")&&"cursor-pointer"} text-sm capitalize text-slate-700`,children:g.title.split("_").join(" ")}),e.jsx(qe,{id:g.title,name:g.title,value:g.id,disabled:(s==null?void 0:s.title)==="super_admin"||(s==null?void 0:s.title)==="admin",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Products"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:N.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):N.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(b,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(qe,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Transfers"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:j.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):j.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(b,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(qe,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Views"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:f.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):f.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(b,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(qe,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:r.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]})]})}):e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsx("p",{className:"text-lg font-medium text-slate-700/50",children:"Select a role to view and modify permissions"})})]})})},nc=()=>e.jsx(e.Fragment,{children:e.jsx(le,{title:"Role Permissions",children:e.jsx(jt,{children:e.jsx("div",{className:"flex h-full max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(Ur,{})})})})})}),qr=({handleViewItems:t,handleViewDetails:s,handleEditInventory:l})=>[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",r.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"warehouse.code",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["WHS"," ",r.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"date_received",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Received"})},{accessorKey:"transfer_id",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Transer Id"}),cell:({row:r})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{children:r.original.transfer_id?r.original.transfer_id:"—"})})},{accessorKey:"created_by",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Created by"}),cell:({row:r})=>e.jsx("div",{className:"uppercase",children:e.jsxs("span",{className:"max-w-[25ch] truncate",children:[r.original.created_by.firstname," ",r.original.created_by.lastname]})})},{accessorKey:"notes",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Notes"}),cell:({row:r})=>e.jsx("div",{children:e.jsx("p",{className:"max-w-[25ch] truncate",children:r.original.notes?r.original.notes:"—"})})},{id:"actions",cell:({row:r})=>{const n=r.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>{t(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(It,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View items"})]}),e.jsxs(Q,{onClick:()=>{s(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(Q,{onClick:()=>{l(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]})]})]})})},enableGlobalFilter:!1}],Hr=({openModal:t,filterWarehouse:s,setTotalInventories:l})=>{const[a,r]=h.useState([]),{data:n,isLoading:c,setSelectedInventory:i}=_s(),o=Le();h.useEffect(()=>{r(s?n.filter(y=>y.warehouse.id===s):n),l(n.length)},[n,s]);const x=()=>{t({},"add")},m=y=>{i(y),t(y,"edit")},u=y=>{i(y),o(`/inventory/items/${y.id}`)},d=y=>{i(y),t(y,"view_details")};return e.jsx(e.Fragment,{children:e.jsx(Z,{columns:qr({handleViewItems:u,handleViewDetails:d,handleEditInventory:m}),data:a.sort((y,p)=>{let N=new Date(y.updated_at??y.created_at);return new Date(p.updated_at??p.created_at).getTime()-N.getTime()}),filterWhat:"code",dataType:"Inventory",openModal:x,isLoading:c})})},Vr=({FormValue:t,handleChange:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"date_received",className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsxs(ye,{children:[e.jsx(fe,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(A,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(fs,{size:18,strokeWidth:1.5}),t.date_received?t.date_received:"Choose date..."]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(as,{mode:"single",initialFocus:!0,required:!0,onDayClick:l=>{const a=new Date(l),r=`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")}`;s("date_received",r)},selected:t.date_received?new Date(t.date_received):new Date})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(I,{id:"notes",name:"notes",type:"text",defaultValue:t.notes?t.notes:void 0,maxLength:1e3,placeholder:"Notes...",onChange:l=>s("notes",l.target.value)})]})]})}),ea=(t,s,l)=>{const a=l||new Date,r=a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2),n=t.slice(0,3),c=s.toString().padStart(4,"0");return`${n}-${r}-${c}`.toUpperCase()},$r=({onClose:t,totalInventories:s,warehouses:l})=>{const{auth:a}=ae(),{value:r,setValue:n,handleChange:c,handleSubmit:i}=Kt(),[o,x]=h.useState(!1),[m,u]=h.useState(null);h.useEffect(()=>{c("created_by",a.user.id),c("type","supplier")},[]);const[d,y]=h.useState();return h.useEffect(()=>{if(d){const p=ea(d,s+1);c("code",p)}},[d]),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:async p=>{p.preventDefault(),r.date_received===void 0?u("Please select a date for date received."):(x(!o),i({action:"add",data:r}).then(()=>{x(!1),V.success("Inventory added successfully."),t()}).catch(N=>{x(!1),N.response.data.message?V.error(N.response.data.message):V.error("Failed to add inventory.")}))},children:[e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"code",className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx(I,{id:"code",name:"code",type:"text",value:r.code||"",readOnly:!0,placeholder:"Code..."})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"warehouse",className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs(J,{onValueChange:p=>{var N;c("warehouse_id",Number(p)),y((N=l.find(j=>j.id===Number(p)))==null?void 0:N.code)},required:!0,children:[e.jsx(ee,{name:"warehouse",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:"Choose warehouse..."})}),e.jsx(te,{className:"bg-white font-medium",children:l.map((p,N)=>e.jsxs(H,{value:p.id.toString(),className:"text-sm font-medium text-slate-700",children:[p.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+p.code+" • "+p.location})]},N))})]})]})]}),e.jsx("hr",{className:"col-span-12 my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"flex flex-col justify-center gap-1",children:e.jsx(Vr,{FormValue:r,handleChange:c})})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:o||Object.keys(r).length<=2||!d,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:o?"Submitting...":"Add inventory"})]})}),m&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-semibold text-red-600",children:m})})]})})},Br=({onClose:t})=>{const{selectedInventory:s}=_s(),{transfers:l,isFetching:a}=Pt(),r=l.find(n=>n.id===s.transfer_id);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx("p",{className:"text-sm",children:s.code})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Type"}),e.jsx("p",{className:"text-sm capitalize",children:s.type})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"ID"}),e.jsx("p",{className:"text-sm",children:s.id})]}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs("p",{className:"text-sm",children:[s.warehouse.name," (",s.warehouse.code,")"]})]}),s.type==="transfer"&&e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer Code"}),e.jsx("p",{className:"text-sm capitalize",children:a?"Loading...":r==null?void 0:r.code})]}),e.jsxs("div",{className:`flex flex-col justify-center gap-1 ${s.type==="supplier"?"col-span-7":"col-span-3"}`,children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsx("p",{className:"text-sm capitalize",children:s.date_received?s.date_received:"—"})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx("p",{className:"text-sm capitalize",children:s.notes?s.notes:"—"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsxs("p",{className:"text-sm capitalize",children:[s.created_by.firstname," ",s.created_by.lastname]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm capitalize",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm capitalize",children:s.updated_at?ie(s.updated_at):"—"})]})]})]})})},Qr=({onClose:t,warehouses:s})=>{const{selectedInventory:l}=_s(),{value:a,handleChange:r,handleSubmit:n}=Kt(),{transfers:c,isFetching:i}=Pt(),[o,x]=h.useState(!1),[m,u]=h.useState(!1),[d,y]=h.useState(null),p=f=>c.find(g=>f===g.id),[N,j]=h.useState();return h.useEffect(()=>{if(N){const f=ea(N,l.id,new Date(l.created_at));r("code",f)}},[N]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async f=>{u(!m),f.preventDefault(),n({action:"update",id:l.id,data:a}).then(()=>{u(!1),V.success("Inventory updated successfully."),t()}).catch(g=>{u(!1),g.response.data.message?V.error(g.response.data.message):V.error("Failed to update inventory.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"code",className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx(I,{id:"code",name:"code",type:"text",value:a.code||l.code||"",readOnly:!0,placeholder:"Code..."})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"warehouse",className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs(J,{onValueChange:f=>{var g;r("warehouse_id",Number(f)),j((g=s.find(v=>v.id===Number(f)))==null?void 0:g.code)},defaultValue:l.warehouse.id.toString(),required:!0,children:[e.jsx(ee,{name:"warehouse",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:"Choose warehouse..."})}),e.jsx(te,{className:"bg-white font-medium",children:s.map((f,g)=>e.jsxs(H,{value:f.id.toString(),className:"text-sm font-medium text-slate-700",children:[f.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+f.code+" • "+f.location})]},g))})]})]})]}),e.jsx("hr",{className:"col-span-12 my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"type",className:"text-sm font-bold text-gray-600",children:"Type"}),e.jsxs(J,{defaultValue:l.type,onValueChange:f=>r("type",f),children:[e.jsx(ee,{name:"type",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm capitalize",children:e.jsx(se,{placeholder:"Choose type..."})}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx(H,{value:"supplier",className:"text-sm font-medium text-slate-700",children:"Supplier"}),e.jsx(H,{value:"transfer",className:"text-sm font-medium text-slate-700",children:"Transfer"})]})]})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"date_received",className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsxs(ye,{children:[e.jsx(fe,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(A,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(fs,{size:18,strokeWidth:1.5}),a.date_received?a.date_received:l.date_received]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(as,{mode:"single",initialFocus:!0,required:!0,month:a.date_received?new Date(a.date_received):new Date(l.date_received),onDayClick:f=>{const g=new Date(f),v=`${g.getFullYear()}-${(g.getMonth()+1).toString().padStart(2,"0")}-${g.getDate().toString().padStart(2,"0")}`;r("date_received",v)},selected:a.date_received?new Date(a.date_received):new Date(l.date_received)})})]})]}),(l.type==="transfer"||a.type==="transfer")&&e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"transfer_id",className:"text-sm font-bold text-gray-600",children:"Transfer Item"}),e.jsxs(ye,{open:o,onOpenChange:x,children:[e.jsx(fe,{className:"relative my-2 w-full",asChild:!0,children:e.jsxs(A,{role:"combobox",className:"my-0 w-full justify-between text-sm text-slate-700",variant:"outline",children:[c?a.transfer_id?(()=>{const f=p(a.transfer_id);return e.jsx("div",{className:"flex items-baseline gap-4",children:f==null?void 0:f.code})})():l.transfer_id?(()=>{const f=p(l.transfer_id);return e.jsx("div",{className:"flex items-baseline gap-4",children:f?f.code:"Loading..."})})():"Select inventory item...":"Loading...",e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"w-[462px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ve,{children:[e.jsx($e,{id:"transfer_id",name:"transfer_id",placeholder:"Transfer code..."}),i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:c.map(f=>e.jsxs(Te,{value:f.id.toString()+f.code,onSelect:()=>{r("transfer_id",f.id),x(!1)},className:"cursor-pointer justify-between rounded-sm",children:[e.jsx("span",{children:f.code}),e.jsxs("span",{className:"text-xs font-semibold text-slate-700/50",children:[f.approval_status," • ",f.source.code,"->",f.destination.code," • ",f.transfer_status]})]},f.id))})})]})})]})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(I,{id:"notes",name:"notes",type:"text",defaultValue:a.notes?a.notes:l.notes?l.notes:void 0,maxLength:1e3,placeholder:"Notes...",onChange:f=>r("notes",f.target.value)})]})]}),e.jsx("div",{className:"flex w-full flex-row pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4 whitespace-nowrap",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:m||Object.keys(a).length===0,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying changes...":"Apply changes"})]})}),d&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:d})})]})})})},cc=()=>{const{warehouses:t}=ss(),[s,l]=h.useState(0),[a,r]=h.useState(0),{openModal:n,isOpen:c,closeModal:i}=de(),[o,x]=h.useState(""),m=(u,d)=>{x(d),n()};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Inventory",children:e.jsxs(Tt,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:u=>l(Number(u)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx(H,{value:"0",children:"All"},"all"),t.map(u=>e.jsxs(H,{value:u.id.toString(),children:[u.name," (",u.code,")"]},u.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Hr,{filterWarehouse:s>0?s:void 0,openModal:m,setTotalInventories:r})})]}),e.jsx(pe,{isOpen:c,onClose:i,title:o==="add"?"Add Inventory":o==="view_details"?"Details":o==="edit"?"Edit Inventory":"",closeOnOverlayClick:o==="view_details",children:e.jsxs(e.Fragment,{children:[o==="add"&&e.jsx($r,{warehouses:t,totalInventories:a,onClose:i}),o==="view_details"&&e.jsx(Br,{onClose:i}),o==="edit"&&e.jsx(Qr,{warehouses:t,onClose:i})]})})]})})})},Yr=({handleViewDetails:t,handleEditInventoryProduct:s,handleApproveInventoryProduct:l})=>[{id:"product_name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Name"," ",r.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Cap. Price"}),cell:({row:r})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(r.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:r.original.capital_price?n:"—"})})}},{accessorKey:"stocks_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Stocks"})},{accessorKey:"approved_stocks",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Approved"})},{accessorKey:"sold_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Sold"})},{accessorKey:"remaining_stocks_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Remaining"}),cell:({row:r})=>{const n=r.original.remaining_stocks_count??0,c=r.original.stocks_count*.2,i=r.original.stocks_count*.5;return e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx("span",{className:`${c>=n?"font-bold text-red-700":i>=n?"font-semibold text-amber-700":""}`,children:n})}),e.jsx(Re,{children:c>=n?"Remaining stocks are low!":i>=n?"Remaining stocks are below 50%":"Remaining stocks are above 50%"})]})}},{accessorKey:"status",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Status"}),cell:({row:r})=>e.jsx(Me,{children:e.jsxs("div",{className:"group relative flex w-fit items-center",children:[e.jsx(Oe,{children:r.original.approved_stocks>0?e.jsx(cs,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-gray-600"})}),e.jsx(Re,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:r.original.approved_stocks>0?"Approved":"Pending"})})]})})},{id:"actions",cell:({row:r})=>{const n=r.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>{t(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(Q,{onClick:()=>{s(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsxs(Q,{onClick:()=>l(n),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(cs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve stocks"})]})]})]})})},enableGlobalFilter:!1}],Gr=({openModal:t,inventory:s})=>{const{data:l,isLoading:a,setSelectedInventoryProduct:r}=Ss(),n=()=>{t({},"add")},c=x=>{r(x),t(x,"view_details")},i=x=>{r(x),t(x,"edit")},o=x=>{r(x),t(x,"approve")};return e.jsxs(Ye,{children:[e.jsxs(_,{fill:a?"default":"primary",onClick:()=>{window.api.invSend({inventory:s,products:l})},className:"ml-4 mt-2 flex h-8 flex-row disabled:cursor-not-allowed disabled:opacity-40",children:[e.jsx($t,{size:26,strokeWidth:2})," Print Inventory Details"]}),e.jsx(Z,{columns:Yr({handleViewDetails:c,handleEditInventoryProduct:i,handleApproveInventoryProduct:o}),data:l||[],filterWhat:"product_name",dataType:"Items",openModal:n,isLoading:a})]})},Xr=({setInventoryProductsQueue:t,inventoryId:s,products:l,productsLoading:a,suppliers:r,suppliersLoading:n,currentId:c,handleNavigation:i,selectedProduct:o})=>{var k,P,C,M,L,D,K;const{auth:x}=ae(),m=!!((k=x.rolePermissions)!=null&&k.find(S=>S.permission_id===7)),{value:u,handleChange:d}=ls(),[y,p]=h.useState(!1),[N,j]=h.useState(!1),[f,g]=h.useState(null),v=Le();h.useEffect(()=>{console.log(x.rolePermissions),d("inventory_id",s),d("unit","pcs"),o&&(d("product_id",o.data.product_id),d("supplier_id",o.data.supplier_id),d("capital_price",o.data.capital_price),d("unit",o.data.unit),d("stocks_count",o.data.stocks_count),d("damage_count",o.data.damage_count),d("total_count",o.data.total_count)),!o&&!m&&d("capital_price",0)},[]);const[F,w]=h.useState();return h.useEffect(()=>{const S=$s(u.stocks_count||0,u.damage_count||0);w(S),d("total_count",S)},[u.damage_count,u.stocks_count,F]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:S=>{S.preventDefault(),u.product_id===void 0?g("Please select a product first."):u.supplier_id===void 0?g("Please select a supplier first."):(t(o?re=>[...re.filter(O=>O.id!==o.id),{id:o.id,data:u}]:re=>[...re,{id:c+1,data:u}]),i())},children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-8 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(ye,{open:y,onOpenChange:p,children:[e.jsx(fe,{id:"product_id",className:"relative w-full",asChild:!0,autoFocus:!0,children:e.jsxs(A,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[u.product_id?e.jsx(e.Fragment,{children:(()=>{const S=l.find(re=>re.id===u.product_id);return e.jsxs("div",{className:"flex w-full flex-row items-baseline gap-4",children:[e.jsx("span",{children:S==null?void 0:S.name}),e.jsxs("div",{className:"flex gap-4 truncate text-xs font-semibold",children:[(S==null?void 0:S.brand)&&e.jsx("span",{children:`Brand: ${S==null?void 0:S.brand}`}),(S==null?void 0:S.size)&&e.jsx("span",{children:`Size: ${S==null?void 0:S.size}`}),(S==null?void 0:S.color)&&e.jsx("span",{children:`Color: ${S==null?void 0:S.color}`})]})]})})()}):e.jsx("span",{children:"Select a product..."}),e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"min-w-[756px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ve,{children:[e.jsx($e,{placeholder:"Product name or serial number..."}),a&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsxs(We,{className:"max-h-[200px] overflow-y-scroll",children:[e.jsx(Ee,{forceMount:!0,children:e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{v("/products"),j(!1)},forceMount:!0,children:[e.jsx("span",{children:"Add new product..."}),e.jsx(et,{size:16,strokeWidth:2.25,className:"text-slate-700/50"})]},"create-new-product")}),e.jsx(st,{}),e.jsx(Ee,{children:l.map((S,re)=>e.jsx(Te,{className:"cursor-pointer justify-between rounded-sm border-b",value:S.id+"_"+S.name+"_"+S.serial_no,onSelect:()=>{d("product_id",S.id),p(!1)},children:`${S.name} • ${S.brand} • ${S.size} • ${S.color}`},re))})]})]})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(ye,{open:N,onOpenChange:j,children:[e.jsx(fe,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(A,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[u.supplier_id?e.jsx(e.Fragment,{children:(()=>{const S=r.find(re=>re.id===u.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:S==null?void 0:S.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:S==null?void 0:S.address})]})})()}):e.jsx("span",{children:"Select a supplier..."}),e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"min-w-[315px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ve,{children:[e.jsx($e,{placeholder:"Supplier name or address..."}),n&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsxs(We,{className:"max-h-[200px] overflow-y-scroll",children:[e.jsx(Ee,{forceMount:!0,children:e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{v("/supplier"),j(!1)},children:[e.jsx("span",{children:"Add new supplier..."}),e.jsx(et,{size:16,strokeWidth:2.25,className:"text-slate-700/50"})]},"create-new-supplier")}),e.jsx(st,{}),e.jsx(Ee,{children:r.map((S,re)=>e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{d("supplier_id",S.id),j(!1)},children:[e.jsx("span",{children:S.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:S.address})]},re))})]})]})})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"relative col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",disabled:!m,value:u.capital_price||"",onBlur:S=>{u.capital_price!==void 0&&(S.target.value=Number(S.target.value).toFixed(2))},onChange:S=>{d("capital_price",Number(Number(S.target.value).toFixed(2)))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(I,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,value:u.unit||"",onChange:S=>d("unit",S.target.value)})]}),e.jsxs("div",{className:`${(P=x.role)!=null&&P.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(b,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(I,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:(C=u.stocks_count)==null?void 0:C.toFixed(0),required:!0,onChange:S=>{d("stocks_count",Number(Number(S.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:`${(M=x.role)!=null&&M.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(b,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(I,{id:"damage_count",name:"damage_count",type:"number",min:0,max:u.stocks_count??0,step:1,required:!0,value:(L=u.damage_count)==null?void 0:L.toFixed(0),onChange:S=>d("damage_count",Number(Number(S.target.value).toFixed(0)))})]}),e.jsxs("div",{className:`${(D=x.role)!=null&&D.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(b,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(I,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,readOnly:!0,value:F??"0",className:`${F&&F<0&&"text-red-600"}`})]}),((K=x.role)==null?void 0:K.includes("admin"))&&e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(I,{id:"total_count",name:"total_count",type:"number",min:0,max:u.stocks_count??0,step:1,value:u.approved_stocks!==void 0?String(u.approved_stocks):"",onChange:S=>d("approved_stocks",S.target.value),onBlur:S=>{d("approved_stocks",Number(S.target.value))}})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsx("div",{className:"ml-auto flex flex-row gap-4",children:e.jsx(_,{type:"submit",fill:"green",disabled:u.product_id===void 0||u.supplier_id===void 0,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:o?"Save changes":"Add item to queue"})})}),f&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:f})})]})})})},Zr=["","Name","Brand","Size","Color","Supplier","Capital price","Unit","Stocks","Damaged","Total","Approved"],Jr=({data:t,products:s,suppliers:l,handleEditItem:a,handleRemoveItem:r,handleSubmit:n,onClose:c})=>{const[i,o]=h.useState(!1),[x,m]=h.useState(null),u=()=>{o(!0),n({action:"add",data:t.map(d=>d==null?void 0:d.data)}).then(()=>{V.success("Items added to inventory."),o(!1),c()}).catch(d=>{m("Error adding items to inventory"),d.response.data.message?V.error(d.response.data.message):V.error("Error adding items to inventory.")})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative flex h-full flex-col",children:e.jsxs(Ye,{children:[e.jsxs(We,{type:"always",className:"flex-1 rounded-md border border-gray-200 bg-white",style:{"--border":"216 12% 84%"},children:[t.length<=0&&e.jsx("div",{className:"absolute z-10 flex h-full w-full items-center justify-center",children:e.jsx("p",{className:"text-lg font-medium text-gray-500/50",children:"No items in queue"})}),e.jsx(tt,{orientation:"horizontal",className:"z-50 h-3"}),e.jsx(tt,{orientation:"vertical",className:"z-50 h-3",style:{"--border":"216 12% 84%"},asChild:!0}),e.jsxs(_t,{children:[e.jsx(St,{children:e.jsx(ns,{id:"tHeaderRow",className:"hover:bg-white",children:Zr.map(d=>e.jsx(Ct,{className:"whitespace-nowrap px-5 py-3 text-xs font-bold uppercase",children:d},d+"_head"))},"tHeaderRow")}),e.jsx(kt,{className:"[&>*:nth-child(even)]:bg-white [&>*:nth-child(odd)]:bg-gray-50",children:t.length>0&&t.map(d=>{var y,p,N,j,f;return e.jsxs(ns,{className:"text-sm font-medium text-gray-700",children:[e.jsx(oe,{className:"p-3 pr-0",children:e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-200/70 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white font-medium",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>{d!=null&&d.id&&a(d)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2})}),e.jsx("span",{children:"Edit"})]},(d==null?void 0:d.id)+"edit"),e.jsxs(Q,{onClick:()=>{d!=null&&d.id&&r(d.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 focus:bg-red-50 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ml,{size:16,strokeWidth:2})}),e.jsx("span",{children:"Remove"})]},(d==null?void 0:d.id)+"remove")]})]})})},(d==null?void 0:d.id)+"action"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.product_id?(y=s.find(g=>g.id===d.data.product_id))==null?void 0:y.name:d==null?void 0:d.data.product_id},(d==null?void 0:d.id)+"product_id"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.product_id?(p=s.find(g=>g.id===d.data.product_id))==null?void 0:p.brand:"No brand"},(d==null?void 0:d.id)+"product_brand"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.product_id?(N=s.find(g=>g.id===d.data.product_id))==null?void 0:N.size:"No data"},(d==null?void 0:d.id)+"product_size"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.product_id?(j=s.find(g=>g.id===d.data.product_id))==null?void 0:j.color:"No data"},(d==null?void 0:d.id)+"product_color"),e.jsx(oe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.supplier_id?(f=l.find(g=>g.id===d.data.supplier_id))==null?void 0:f.name:d==null?void 0:d.data.supplier_id},(d==null?void 0:d.id)+"supplier_id"),e.jsx(oe,{className:"px-5 py-3",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((d==null?void 0:d.data.capital_price)||0)},(d==null?void 0:d.id)+"capital_price"),e.jsx(oe,{className:"px-5 py-3",children:d==null?void 0:d.data.unit},(d==null?void 0:d.id)+"unit"),e.jsx(oe,{className:"px-5 py-3",children:d==null?void 0:d.data.stocks_count},(d==null?void 0:d.id)+"stocks_count"),e.jsx(oe,{className:"px-5 py-3",children:d==null?void 0:d.data.damage_count},(d==null?void 0:d.id)+"damage_count"),e.jsx(oe,{className:"px-5 py-3",children:d==null?void 0:d.data.total_count},(d==null?void 0:d.id)+"total_count"),e.jsx(oe,{className:"px-5 py-3",children:d==null?void 0:d.data.approved_stocks},(d==null?void 0:d.id)+"approved_stocks")]},(d==null?void 0:d.id)+"row")})})]})]}),e.jsxs("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:[x&&e.jsx("div",{className:"flex w-full flex-row items-center justify-start gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:x})}),e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>c(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:t.length<=0||i,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",onClick:d=>{d.preventDefault(),u()},children:t.length<=1?"Add item to inventory":`Add ${t.length} items to inventory`})]})]})]})})})},en={hidden:{opacity:0,x:"-100%"},animate:{opacity:1,x:"0%",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,x:"-100%",transition:{duration:.3,ease:"easeInOut"}}},sn={hidden:{opacity:0,x:"100%"},animate:{opacity:1,x:"0%",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,x:"100%",transition:{duration:.3,ease:"easeInOut"}}},tn=({onClose:t,inventoryId:s})=>{ae();const{data:l,isLoading:a}=it(),{suppliers:r,isFetching:n}=Us(),{handleSubmit:c}=ls(),[i,o]=h.useState([]),[x,m]=h.useState({}),[u,d]=h.useState("main"),y=()=>{m({}),d(u==="main"?"form":"main")},p=j=>{m(j),d("form")},N=j=>{o(f=>f.filter(g=>g.id!==j))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:u==="main"?"ml-auto":"",children:e.jsx(A,{className:"flex flex-row items-center gap-2 bg-gray-200 text-sm font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",onClick:()=>{y()},children:e.jsxs(e.Fragment,{children:[u==="main"?e.jsx(Bs,{size:20,strokeWidth:2.5}):e.jsx(Ns,{size:20,strokeWidth:2.5}),u==="main"?"Add an item":"Back"]})})}),e.jsx("div",{className:`relative min-w-[850px] overflow-x-clip transition-all duration-300 
					${u==="form"?"min-h-[330px]":"min-h-[540px]"}`,children:e.jsx(Qa,{initial:!1,children:u==="main"?e.jsx(at.div,{variants:en,initial:"hidden",animate:"animate",exit:"exit",className:"absolute h-full w-full overflow-x-auto antialiased",children:e.jsx(Jr,{data:i,products:l,suppliers:r,handleEditItem:p,handleRemoveItem:N,handleSubmit:c,onClose:t})},"main"):e.jsx(at.div,{variants:sn,initial:"hidden",animate:"animate",exit:"exit",className:"absolute max-h-[406px] w-full p-1",children:e.jsx(Xr,{setInventoryProductsQueue:o,inventoryId:s,products:l,productsLoading:a,suppliers:r,suppliersLoading:n,currentId:i.reduce((j,f)=>f.id>j?f.id:j,0),handleNavigation:y,selectedProduct:Object.keys(x).length?x:void 0})},"form")})})]})})},an=({onClose:t})=>{var f,g;const{auth:s}=ae(),l=!!((f=s.rolePermissions)!=null&&f.find(v=>v.permission_id===7)),{selectedInventoryProduct:a}=Ss(),{value:r,handleChange:n,handleSubmit:c}=ls(),{suppliers:i,isFetching:o}=Us(),[x,m]=h.useState(!1),[u,d]=h.useState(!1),[y,p]=h.useState(null),[N,j]=h.useState();return h.useEffect(()=>{const v=$s(r.stocks_count??a.stocks_count,r.damage_count??a.damage_count);j(v),n("total_count",v)},[r.damage_count,r.stocks_count,N]),e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:async v=>{d(!u),v.preventDefault(),c({action:"update",id:a.id,data:r}).then(()=>{d(!1),V.success("Inventory product updated successfully."),t()}).catch(()=>{d(!1),V.error("Failed to update inventory product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:a.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:a.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:a.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:a.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:a.product.color})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(ye,{open:x,onOpenChange:m,children:[e.jsx(fe,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(A,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[r.supplier_id?e.jsx(e.Fragment,{children:(()=>{const v=i.find(F=>F.id===r.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:v==null?void 0:v.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:v==null?void 0:v.address})]})})()}):e.jsx("span",{children:a.supplier_id.name}),e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ve,{children:[e.jsx($e,{placeholder:"Supplier name or address..."}),i===void 0&&o&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:i.map((v,F)=>e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{n("supplier_id",v.id),m(!1)},children:[e.jsx("span",{children:v.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:v.address})]},F))})})]})})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",readOnly:!l,defaultValue:a==null?void 0:a.capital_price.toFixed(2),onBlur:v=>{v.target.value=Number(v.target.value).toFixed(2)},onChange:v=>{const F=Number(v.target.value).toFixed(2);n("capital_price",Number(F))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(I,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,defaultValue:a==null?void 0:a.unit,onChange:v=>n("unit",v.target.value)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(I,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:((g=r.stocks_count)==null?void 0:g.toFixed(0))??(a==null?void 0:a.stocks_count)??0,onChange:v=>{n("stocks_count",Number(Number(v.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(I,{id:"damage_count",name:"damage_count",type:"number",min:0,max:r.stocks_count??a.stocks_count,step:1,required:!0,value:r.damage_count!==void 0?String(r.damage_count):String(a==null?void 0:a.damage_count)||"",onBlur:v=>{v.target.value=Number(v.target.value).toFixed(0)},onChange:v=>n("damage_count",Number(Number(v.target.value).toFixed(0)))})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(I,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,value:N||0,className:`${N&&N<0&&"text-red-600"}`,readOnly:!0})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:u,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:u?"Applying...":"Apply changes"})]})}),y&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:y})})]})})})},ln=()=>{const{selectedInventoryProduct:t}=Ss();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:t.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:t.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:t.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:t.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:t.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:t.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:t.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:t.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:t.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Status"}),e.jsx("p",{className:"text-sm",children:t.status?"Approved":"Pending"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx("p",{className:"text-sm",children:t.approved_stocks})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unapproved stocks"}),e.jsx("p",{className:"text-sm",children:t.remaining_unapproved_stocks})]})]})]})})},rn=({onClose:t})=>{const{selectedInventoryProduct:s}=Ss(),{value:l,handleChange:a,handleSubmit:r}=ls(),[n,c]=h.useState(!1),i=o=>{o.preventDefault(),c(!0),r({action:"update",id:s.id,data:l}).then(()=>{V.success("Inventory product successfully approved."),c(!1),t()}).catch(x=>{var m,u;V.error((u=(m=x==null?void 0:x.response)==null?void 0:m.data)==null?void 0:u.message),c(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[24rem] max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.capital_price)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:s.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:s.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:s.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:s.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:s.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:s.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:s.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("form",{className:"grid w-full grid-flow-row grid-cols-11 gap-3",onSubmit:i,children:[e.jsxs("div",{className:"relative col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"approved_stocks",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(I,{id:"approved_stocks",name:"approved_stocks",type:"number",min:0,step:1,max:s.remaining_unapproved_stocks,required:!0,autoFocus:!0,value:l.approved_stocks!==void 0?String(l.approved_stocks):"",onChange:o=>{a("approved_stocks",o.target.value)},onBlur:o=>{a("approved_stocks",Number(o.target.value))}}),e.jsxs("span",{className:"absolute bottom-0 right-0 -translate-x-4 -translate-y-2 pb-[2px] text-sm font-medium text-slate-700",children:["/ ",s.remaining_unapproved_stocks]})]}),e.jsx("div",{className:"col-span-1 flex items-center pt-6",children:e.jsx(Vt,{size:24,strokeWidth:2,className:"mx-auto text-slate-600"})}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"prev_approved_stocks",className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx(I,{id:"prev_approved_stocks",name:"prev_approved_stocks",type:"number",readOnly:!0,value:s.approved_stocks||0})]}),e.jsx("div",{className:"col-span-11 flex w-full justify-between whitespace-nowrap pt-3",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:n,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Approving...":"Approve"})]})})]})]})})},ic=()=>{const{id:t}=Rs(),{data:s,isLoading:l}=Ya(Number(t)),a=Le(),r=()=>{a(-1)},{openModal:n,isOpen:c,closeModal:i}=de(),[o,x]=h.useState(""),m=(u,d)=>{x(d),n()};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Inventory items",children:e.jsxs(Ga,{inventoryId:Number(t),children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:[e.jsxs(A,{onClick:()=>r(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(Ns,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Inventory code:"}),e.jsx("span",{children:l?"Loading...":s==null?void 0:s.code})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Gr,{openModal:m,inventory:s})})]}),e.jsx(pe,{isOpen:c,onClose:i,closeOnOverlayClick:o==="view_details",title:o==="add"?"Add Items":o==="edit"?"Edit Item":o==="view_details"?"Item Details":o==="approve"?"Approve Item":"",children:e.jsxs(e.Fragment,{children:[o==="add"&&e.jsx(tn,{inventoryId:Number(t),onClose:i}),o==="view_details"&&e.jsx(ln,{}),o==="edit"&&e.jsx(an,{onClose:i}),o==="approve"&&e.jsx(rn,{onClose:i})]})})]})})})},nn=()=>{const t=je(),{selectedExpenses:s}=qs(),[l,a]=h.useState({id:s.id,title:s.title,date_of_operation:s.date_of_operation,amount:s.amount,notes:s.notes,created_by:s.created_by.id,created_at:s.created_at,updated_at:s.updated_at}),[r,n]=h.useState(!1),[c,i]=h.useState(!1),[o,x]=h.useState(null),[m,u]=h.useState(null),d=()=>Object.keys(l).map(g=>({text:g})).length>=8?l.amount?l.title?[!0,""]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"],y=f=>{n(!0),u(null),x(null),a(g=>({...g,[f.target.name]:f.target.value}))},p=async()=>{const f=d();i(!0),f[0]?await j(l):(x(f[1]),i(!1))},N={onSuccess:async()=>{await t.invalidateQueries({queryKey:["expenses"]}),i(!1),n(!1),u("Expenses info has been edited")},onError:f=>{console.error(f),x(f.message),i(!1)}},{mutateAsync:j}=Y({mutationKey:["editExpenses"],mutationFn:Xa,...N});return{expensesEdit:l,isChanged:r,isSubmitting:c,error:o,success:m,handleSubmit:p,handleChange:y,editExpensesMutation:j}},cn=()=>{const t=je(),{expenses:s,dateToday:l}=qs(),a=s.length+1,{auth:r}=ae(),[n,c]=h.useState({id:a,title:"",date_of_operation:l,amount:0,notes:"",created_by:r.user.id,created_at:"",updated_at:""}),[i,o]=h.useState(!1),[x,m]=h.useState(!1),[u,d]=h.useState(null),[y,p]=h.useState(null),N=()=>Object.keys(n).map(w=>({text:w})).length>=5?n.amount?n.title?[!0,""]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"],j=F=>{o(!0),p(null),d(null),c(w=>({...w,[F.target.name]:F.target.value}))},f=async()=>{const F=N();m(!0),F[0]?await v(n):(d(F[1]),m(!1))},g={onSuccess:async()=>{await t.invalidateQueries({queryKey:["expenses"]}),m(!1),o(!1),p("Expenses info has been added")},onError:F=>{console.error(F),d(F.message),m(!1)}},{mutateAsync:v}=Y({mutationKey:["addExpenses"],mutationFn:Za,...g});return{dateToday:l,expensesAdd:n,isChanged:i,isSubmitting:x,error:u,success:y,handleSubmit:f,handleChange:j,addExpensesMutation:v}},on=({openModal:t})=>{const{expenses:s,isFetching:l,selectedExpenses:a,setSelectedExpenses:r,dateToday:n}=qs(),c=()=>{t({},"add")},i=m=>{r(m[0]),t(m,"edit")},o=[{accessorKey:"date_of_operation",sortingFn:"datetime",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{m.toggleSorting(m.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["DATE OF OPERATION ",m.getIsSorted()==="asc"?e.jsx(z,{}):m.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:m})=>{const u=m.getValue("date_of_operation");if(u.toString()!=="0000-00-00"){const d={year:"numeric",month:"long",day:"numeric"},y=new Date(u).toLocaleDateString([],d);return e.jsx("div",{className:"text-center",children:y})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"title",header:({column:m})=>e.jsx("div",{className:"text-center",children:" TITLE "}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.title})},{accessorKey:"amount",header:({column:m})=>e.jsx("div",{className:"text-center",children:" AMOUNT "}),cell:({row:m})=>{const u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m.original.amount);return e.jsx("div",{className:"text-center",children:u})}},{accessorKey:"notes",header:({column:m})=>e.jsx("div",{className:"text-center",children:" NOTES "}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.notes})},{accessorKey:"created_by",header:({column:m})=>e.jsx("div",{className:"text-center",children:" CREATED BY "}),cell:({row:m})=>e.jsxs("div",{className:"text-center",children:[m.original.created_by.firstname," ",m.original.created_by.lastname]})},{id:"actions",header:()=>e.jsx("div",{className:"flex flex-row justify-center",children:"ACTIONS"}),cell:({row:m})=>{const u=m.original;if(u.date_of_operation===n)return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(_,{fill:"empty",textColor:"black",onClick:()=>i([u]),className:"flex flex-row items-center gap-2",children:[e.jsx(Qs,{})," Edit"]})})}}],x=s.some(m=>m.date_of_operation===n);return s.sort((m,u)=>{let d=m.date_of_operation,y=u.date_of_operation;return d<y?1:d>y?-1:0}),e.jsx(e.Fragment,{children:e.jsx(Z,{data:s,columns:o,filterWhat:"notes",dataType:"Today's Expenses",openModal:x?void 0:c,isLoading:l})})},dn=({onClose:t})=>{const{expensesEdit:s,isChanged:l,isSubmitting:a,error:r,success:n,handleSubmit:c,handleChange:i}=nn();return n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async o=>{o.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Date of Operation"}),e.jsx(B,{type:"text",name:"date_of_operation",placeholder:"2024-04-06",className:"inputbox rounded-md",value:s.date_of_operation,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"Title"}),e.jsx(B,{type:"text",name:"title",placeholder:"Title",className:"inputbox rounded-md bg-slate-100",value:s.title,onChange:i,required:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Amount"}),e.jsx(B,{type:"number",name:"amount",placeholder:"₱500.00",className:"inputbox rounded-md bg-slate-100",value:s.amount,onChange:i,required:!0})]})]}),e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-12 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Notes"}),e.jsx(bs,{name:"notes",placeholder:"Notes here....",className:"text-base rounded-md bg-slate-100",value:s.notes,onChange:i})]})}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4 text-center",children:[e.jsx("div",{className:"flex flex-col col-span-3 gap-3",children:e.jsx(_,{type:"submit",fill:l?"green":null,disabled:!l,onClick:c,children:a?"Submitting":"Edit Expenses"})}),e.jsxs("div",{className:"flex flex-col col-span-6 items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),a?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-3 gap-3 items-end",children:e.jsx(_,{type:"reset",fill:"red",onClick:t,children:"Cancel"})})]})]})})})},xn=({onClose:t})=>{const{expensesAdd:s,isChanged:l,isSubmitting:a,error:r,success:n,handleSubmit:c,handleChange:i,dateToday:o}=cn();return n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async x=>{x.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Date of Operation"}),e.jsx(B,{type:"text",name:"date_of_operation",placeholder:"2024-04-06",className:"inputbox rounded-md",value:o,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"Title"}),e.jsx(B,{type:"text",name:"title",placeholder:"Title",className:"inputbox rounded-md bg-slate-100",value:s.title||"",onChange:i,required:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Amount"}),e.jsx(B,{type:"number",name:"amount",placeholder:"₱500.00",className:"inputbox rounded-md bg-slate-100",value:s.amount||"",onChange:i,required:!0})]})]}),e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-12 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Notes"}),e.jsx(bs,{name:"notes",placeholder:"Notes here....",className:"text-base rounded-md bg-slate-100",value:s.notes||"",onChange:i})]})}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),a?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),l&&e.jsx(_,{type:"submit",fill:l?"green":null,disabled:!l,onClick:c,children:a?"Submitting":"Add Expenses"})]})})]})})]})})})},oc=()=>{const{openModal:t,isOpen:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{r(i),t()};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Expenses",children:e.jsxs(Ja,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(on,{openModal:n})})}),e.jsx(pe,{isOpen:s,onClose:l,title:a==="add"?"Add Expenses":"Edit Expenses",children:e.jsxs(e.Fragment,{children:[a==="edit"&&e.jsx(dn,{onClose:l}),a==="add"&&e.jsx(xn,{onClose:l})]})})]})})})},mn=()=>{const{reports:t,isReportsFetching:s}=Je(),l=[(t==null?void 0:t.new_customers)??0,(t==null?void 0:t.returning_customers)??0],a={series:[(t==null?void 0:t.new_customers)??0,(t==null?void 0:t.returning_customers)??0],labels:["New customers","Returning customers"],colors:["#3b82f6","#1e3a8a"],legend:{show:!0,fontFamily:"sans-serif",fontSize:"14px",fontWeight:500,itemMargin:{vertical:4}},dataLabels:{enabled:!0,dropShadow:{top:2,blur:3,opacity:.5},style:{fontFamily:"Inter",fontSize:"12px",fontWeight:600}},tooltip:{style:{fontFamily:"Inter",fontSize:"14px"}},plotOptions:{pie:{donut:{size:"50%"}}},chart:{animations:{speed:600}}};return e.jsx(e.Fragment,{children:s?e.jsxs("div",{className:"flex h-72 w-full animate-pulse justify-center p-4",children:[e.jsx("div",{className:"mx-auto h-full w-72 rounded-2xl bg-slate-200"}),e.jsx("div",{className:"h-20 w-44 rounded-2xl bg-slate-200"})]}):e.jsx(At,{series:l,options:a,type:"donut",height:"100%",width:"100%"})})},un=()=>e.jsx(e.Fragment,{children:e.jsxs(Dt,{className:"flex min-h-[24rem] flex-col gap-4",children:[e.jsxs(zt,{className:"flex flex-none flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(Et,{className:"text-base font-bold",children:"Customers"}),e.jsx(Wt,{className:"text-sm font-medium",children:"Shows new and returning customers for the selected date range"})]}),e.jsx(Mt,{className:"flex-1",children:e.jsx(mn,{})})]})}),hn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(ms,{title:"Profit",tooltip:"Calculated by subtracting the sum of capital and expenses from sales.",bgClassName:`${t!=null&&t.total_profit?t.total_profit>=0?"bg-blue-50":"bg-red-50":"bg-blue-50"}`,textColorClassName:`${t!=null&&t.total_profit?t.total_profit>=0?"text-blue-800":"text-red-800":"text-blue-800"}`,children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-blue-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_profit)??0)})})})},pn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(ms,{title:"Sales",tooltip:"Calculated by adding up the total amount due in paid transactions.",bgClassName:"bg-green-50",textColorClassName:"text-green-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-green-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_sales)??0)})})})},fn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(ms,{title:"Capital",tooltip:"Calculated capital of sold products.",bgClassName:"bg-orange-50",textColorClassName:"text-orange-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-orange-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_overall_capital)??0)})})})},jn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(ms,{title:"Expenses",tooltip:"Calculated by adding up the operational expenses.",bgClassName:"bg-violet-50",textColorClassName:"text-violet-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-violet-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_expenses)??0)})})})},gn=()=>{const{reports:t,isReportsFetching:s}=Je();return e.jsx(e.Fragment,{children:e.jsx(ms,{title:"Collectibles",tooltip:"Total amount owed from customers for non-payment type transactions.",bgClassName:"bg-stone-50",textColorClassName:"text-stone-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-stone-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_collectibles)??0)})})})};function Nn({className:t}){const{dateRange:s,setDateRange:l}=Je();return e.jsx("div",{className:lt("grid gap-2",t),children:e.jsxs(ye,{children:[e.jsx(fe,{asChild:!0,children:e.jsxs(A,{id:"date",variant:"outline",className:lt("w-[300px] justify-start text-left font-medium",!s&&"text-muted-foreground"),children:[e.jsx(qt,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?e.jsxs(e.Fragment,{children:[Ds(s.from,"LLL dd, y")," —"," ",Ds(s.to,"LLL dd, y")]}):Ds(s.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(ve,{className:"w-auto p-0",align:"start",children:e.jsx(as,{initialFocus:!0,mode:"range",defaultMonth:s!=null&&s.to?new Date(s.to.getFullYear(),s.to.getMonth()-1,1):new Date,selected:s,onSelect:l,classNames:{day:"text-sm flex items-center justify-center w-full h-full rounded-md font-medium",months:"flex flex-row gap-6"},numberOfMonths:2})})]})})}const yn=()=>{const{setDateRange:t,isFetching:s}=Je(),l=()=>{t({from:new Date(new Date().setDate(new Date().getDate()-90)),to:new Date})};return e.jsx(A,{variant:"outline",disabled:s,onClick:l,children:"Reset date"})},vn=()=>{const{year:t,setYear:s}=Hs(),l=h.useMemo(()=>{const a=new Date().getFullYear(),r=2020,n=[];for(let c=r;c<=a;c++)n.push(c);return n.sort((c,i)=>i-c)},[]);return e.jsx(e.Fragment,{children:e.jsxs(J,{value:t.toString(),onValueChange:a=>{s(Number(a))},children:[e.jsx(ee,{className:"w-32 flex-none",children:e.jsx(se,{placeholder:"Choose year...",children:e.jsx("span",{className:"text-slate-600",children:t})})}),e.jsx(te,{children:l.map(a=>e.jsx(H,{value:a.toString(),className:"text-sm font-medium",children:a},`${a}-item`))})]})})},bn=()=>{var a;const{warehouseId:t,setWarehouseId:s}=Hs(),{warehouses:l}=ss();return e.jsx(e.Fragment,{children:e.jsxs(J,{value:t==null?void 0:t.toString(),onValueChange:r=>{s(r!=="0"?Number(r):0)},children:[e.jsx(ee,{className:"w-44",children:e.jsx(se,{placeholder:"Select warehouse...",children:e.jsx("span",{className:"text-slate-600",children:((a=l.find(r=>r.id===t))==null?void 0:a.name)??"All"})})}),e.jsxs(te,{children:[e.jsx(H,{value:"0",className:"text-sm font-medium",children:"All"},"all-warehouses-item"),l&&l.map(r=>e.jsx(H,{value:r.id.toString(),className:"text-sm font-medium",children:r.name},`${r.id}-item`))]})]})})},wn=()=>{const{reportAnalytics:t,isReportAnalyticsFetching:s}=Hs();return e.jsx(e.Fragment,{children:e.jsxs(Dt,{className:"flex min-h-[36rem] w-full flex-col gap-4",children:[e.jsxs(zt,{className:"flex w-full flex-none flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(Et,{className:"flex w-full flex-row justify-between text-base font-bold",children:"Reports Analytics"}),e.jsxs(Wt,{className:"!mt-1 flex flex-row gap-2 font-bold uppercase",children:[e.jsx(bn,{}),e.jsx(vn,{})]})]}),e.jsx(Mt,{className:"mx-auto w-[99%] flex-1 overflow-hidden",children:s?e.jsx("div",{className:"h-[350px] w-full animate-pulse rounded-2xl bg-slate-200/50"}):e.jsx(At,{type:"line",height:"100%",width:"100%",series:[{name:"Sales",data:(t==null?void 0:t.map(l=>l.gross_income??0))??[]},{name:"Profit",data:(t==null?void 0:t.map(l=>l.net_profit??0))??[]},{name:"Capital",data:(t==null?void 0:t.map(l=>l.capital??0))??[]},{name:"Expenses",data:(t==null?void 0:t.map(l=>l.expenses??0))??[]},{name:"Collectibles",data:(t==null?void 0:t.map(l=>l.collectibles??0))??[]}],options:{markers:{size:5},stroke:{width:4},colors:["#16a34a","#2563eb","#f59e0b","#7c3aed","#525252"],xaxis:{tooltip:{enabled:!1},categories:(t==null?void 0:t.map(l=>l.Month??""))??[],labels:{style:{fontFamily:"sans-serif",fontSize:"12px",fontWeight:600}}},yaxis:{labels:{style:{fontFamily:"sans-serif",fontSize:"12px",fontWeight:600},formatter:l=>Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l)}},tooltip:{style:{fontFamily:"sans-serif",fontSize:"14px"}},legend:{position:"top",horizontalAlign:"right"},chart:{toolbar:{show:!1}}}})})]})})},dc=()=>e.jsx(e.Fragment,{children:e.jsx(le,{title:"Reports",children:e.jsx(el,{children:e.jsx(sl,{children:e.jsx("div",{className:"flex h-full w-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"h-full max-h-full w-full max-w-full overflow-auto",children:e.jsxs("div",{className:"flex w-full max-w-full flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(Nn,{}),e.jsx(yn,{})]}),e.jsx("div",{className:"flex flex-1 flex-col gap-4",children:e.jsxs("div",{className:"flex flex-row gap-2 rounded-lg border p-2 shadow-sm",children:[e.jsx(pn,{}),e.jsx(hn,{}),e.jsx(fn,{}),e.jsx(jn,{}),e.jsx(gn,{})]})}),e.jsx(un,{}),e.jsx(wn,{})]})})})})})})}),xc=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(Lt,{}),e.jsx("div",{id:"main",className:"flex w-screen flex-row",children:e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[e.jsx("div",{className:"flex w-full flex-row justify-between",children:e.jsx("h1",{className:"text-primary-dark-gray text-2xl font-bold",children:"Return Item"})}),e.jsx(Dr,{})]})})]})}),_n=({onClose:t})=>{const{invoices:s,isFetching:l,customers:a,selectedInvoice:r}=Ot(),n=r[0],c=[{id:"select",header:({table:i})=>e.jsx("input",{type:"checkbox",checked:i.getIsAllPageRowsSelected(),onChange:o=>i.toggleAllPageRowsSelected(!!o.target.checked),"aria-label":"Select all"}),cell:({row:i})=>e.jsx("input",{type:"checkbox",checked:i.getIsSelected(),onChange:o=>i.toggleSelected(!!o.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"or_no",sortingFn:"alphanumeric",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["OR NUMBER ",i.getIsSorted()==="asc"?e.jsx(z,{}):i.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.or_no})},{accessorKey:"created_at",sortingFn:"datetime",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["CREATED AT ",i.getIsSorted()==="asc"?e.jsx(z,{}):i.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:i})=>{const o=i.getValue("created_at");if(o.toString()!=="0000-00-00 00:00:00"){const x={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},m=new Date(o).toLocaleDateString([],x);return e.jsx("div",{className:"text-center",children:m})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"warehouse",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE CODE"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.warehouse.code})},{id:"customer",header:()=>e.jsx("div",{className:"text-center",children:"CUSTOMER NAME"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.customer.firstname+" "+i.original.customer.lastname})},{accessorKey:"type",sortingFn:"text",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TRANSACTION TYPE ",i.getIsSorted()==="asc"?e.jsx(z,{}):i.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.type})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"STATUS"}),cell:({row:i})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:i.original.status.toLowerCase()==="approved"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):i.original.status.toLowerCase()==="rejected"?e.jsx(es,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500"})})},{accessorKey:"subtotal",header:()=>e.jsx("div",{className:"text-center",children:" SUBTOTAL "}),cell:({row:i})=>{const o=i.original.subtotal,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"total_discount",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL DISCOUNT "}),cell:({row:i})=>{const o=i.original.total_discount,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"total_tax",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL TAX "}),cell:({row:i})=>{const o=i.original.total_tax,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"delivery_charge",header:()=>e.jsx("div",{className:"text-center",children:" DELIVERY CHARGE "}),cell:({row:i})=>{const o=i.original.delivery_charge,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"total_amount_due",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL AMOUNT DUE "}),cell:({row:i})=>{const o=i.original.total_amount_due,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"paid_amount",header:()=>e.jsx("div",{className:"text-center",children:" PAID AMOUNT "}),cell:({row:i})=>{const o=i.original.paid_amount,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"change_amount",header:()=>e.jsx("div",{className:"text-center",children:" CHANGE AMOUNT "}),cell:({row:i})=>{const o=i.original.change_amount,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"payment_method",header:()=>e.jsx("div",{className:"text-center",children:" PAYMENT METHOD "}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.payment_method||"N/A"})},{accessorKey:"reference_no",header:({column:i})=>e.jsx("div",{className:"text-center",children:"REF #"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.reference_no||"--"})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl max-h-96 flex-col gap-4",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Issuer: ",n.issued_by.firstname+" "+n.issued_by.lastname]}),e.jsx("div",{className:"overflow-x-hidden",children:e.jsx(Z,{data:r,columns:c,filterWhat:"or_no",dataType:"",openModal:void 0,isLoading:l})})]})})},Sn=({openModal:t})=>{const{customersList:s,isFetching:l}=Ot(),a=[{accessorKey:"customer.firstname",id:"customer",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["NAME"," ",r.getIsSorted()==="asc"?e.jsx(z,{}):r.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.firstname+" "+r.original.customer.lastname})},{id:"address",header:()=>e.jsx("div",{children:"ADDRESS"}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.address})},{id:"contact_no",header:()=>e.jsx("div",{children:"CONTACT NO"}),cell:({row:r})=>e.jsx("div",{children:r.original.customer.contact_no})},{accessorKey:"customer.total_balance",id:"total_balance",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["BALANCE"," ",r.getIsSorted()==="asc"?e.jsx(z,{}):r.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.customer.total_balance)})},{accessorKey:"customer.total_credit",id:"total_credit",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["CREDITS"," ",r.getIsSorted()==="asc"?e.jsx(z,{}):r.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.customer.total_credit)})},{accessorKey:"total_transactions",id:"total_transactions",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["TRANSACTIONS"," ",r.getIsSorted()==="asc"?e.jsx(z,{}):r.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]}),cell:({row:r})=>e.jsx("div",{children:r.original.total_transactions})},{accessorKey:"total_sales",id:"amount_sales",sortingFn:"basic",enableSorting:!0,header:({column:r})=>e.jsxs(_,{onClick:()=>{r.toggleSorting(r.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["SALES"," ",r.getIsSorted()==="asc"?e.jsx(z,{}):r.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]}),cell:({row:r})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(r.original.total_sales)})}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:s.sort((r,n)=>n.total_sales>r.total_sales?1:-1),columns:a,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:l})})},mc=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Customer Sales",children:e.jsxs(tl,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Sn,{openModal:n})})}),e.jsx(pe,{isOpen:t,onClose:l,title:a==="details"?"Invoice Details":"",closeOnOverlayClick:a==="details",children:e.jsx(e.Fragment,{children:a==="details"&&e.jsx(_n,{onClose:l})})})]})})})},Cn=({openModal:t})=>{const{returns:s,selectedReturn:l,setSelectedReturn:a,isFetching:r}=Os(),n=s.filter(x=>{if(x.refund_status==="pending")return x});ae();const c=x=>{a(x),t(x,"details")},i=x=>{a(x),t(x,"edit")},o=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:x})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>x.toggleSorting(x.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["RETURN CODE ",x.getIsSorted()==="asc"?e.jsx(z,{}):x.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:x})=>e.jsx("div",{className:"text-center",children:x.original.code?x.original.code:"N/A"})},{accessorKey:"invoice",sortingFn:"alphanumeric",enableSorting:!0,header:({column:x})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>x.toggleSorting(x.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["INVOICE CODE ",x.getIsSorted()==="asc"?e.jsx(z,{}):x.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:x})=>e.jsx("div",{className:"text-center",children:x.original.invoice.code?x.original.invoice.code:"N/A"})},{accessorKey:"customer",sortingFn:"alphanumeric",enableSorting:!0,header:({column:x})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>x.toggleSorting(x.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["CUSTOMER NAME ",x.getIsSorted()==="asc"?e.jsx(z,{}):x.getIsSorted()==="desc"?e.jsx(E,{}):e.jsx(W,{})]})}),cell:({row:x})=>e.jsx("div",{className:"text-center",children:x.original.invoice.customer.firstname+" "+x.original.invoice.customer.lastname})},{accessorKey:"refundable_amount",sortingFn:"text",enableSorting:!0,header:({column:x})=>e.jsx("div",{className:"flex flex-row justify-center text-center mx-auto",children:" REFUNDABLE AMOUNT "}),cell:({row:x})=>{const m=x.original.refundable_amount,u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m);return e.jsx("div",{className:"text-center",children:u})}},{accessorKey:"refund_status",sortingFn:"text",enableSorting:!0,header:({column:x})=>e.jsx("div",{className:"flex flex-row justify-center text-center mx-auto",children:" REFUND STATUS "}),cell:({row:x})=>e.jsx("div",{className:"flex items-center",children:x.original.refund_status&&e.jsx(ts,{size:20,strokeWidth:2,className:"text-amber-500 mx-auto"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:x})=>{const m=x.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>c(m),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(Q,{onClick:()=>i(m),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve Return/Refund"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(Z,{data:n,columns:o,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:r})})},kn=({onClose:t})=>{const{selectedReturn:s}=Os();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-6xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Return Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.code})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.issued_by.firstname+" "+s.issued_by.lastname})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Payment method"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.payment_method.charAt(0).toUpperCase()+s.invoice.payment_method.slice(1)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Reference number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.reference_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Refundable amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.refundable_amount)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-amber-600",children:s.refund_status.charAt(0).toUpperCase()+s.refund_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(s.updated_at)})]})]})]})})},Fn=({onClose:t})=>{const{selectedReturn:s,success:l,error:a,isSubmitting:r,handleSubmit:n}=Nl();return l&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsx("p",{className:"font-bold text-red-900",children:" Are you sure you want to set this return as done? "}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Return Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.code})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.issued_by.firstname+" "+s.issued_by.lastname})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Payment method"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.payment_method.charAt(0).toUpperCase()+s.invoice.payment_method.slice(1)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Reference number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.reference_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Refundable amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.refundable_amount)})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[l&&e.jsx("div",{className:"font-bold text-green-700",children:l}),a&&e.jsx("div",{className:"font-bold text-red-700",children:a}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Ae,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-4 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",onClick:n,fill:"green",children:r?"Submitting":"Mark as done"})]})})]})})]})})},uc=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{s(),r(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Pending Return",children:e.jsxs(al,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(Cn,{openModal:n})})}),e.jsx(pe,{title:a==="details"?"Return Details":"Approve Return",isOpen:t,onClose:l,children:e.jsxs(e.Fragment,{children:[a==="details"&&e.jsx(kn,{onClose:l}),a==="edit"&&e.jsx(Fn,{onClose:l})]})})]})})})},In=()=>{const{selectedProductPrice:t}=Vs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Unit"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.warehouse.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Capital price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup percent"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[ne(t.markup_price/t.capital_price*100,{precision:3}).value,"%"]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.markup_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Cost"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.cost)})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sale discount"}),e.jsx("p",{className:"text-sm",children:t.on_sale===1?Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.sale_discount):"—"}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex flex-none flex-row items-center justify-end gap-1 pb-[0.1rem] pr-1",children:[t.on_sale===1?e.jsx(He,{size:14,strokeWidth:3.5,className:"text-green-600"}):e.jsx(ys,{size:14,strokeWidth:3.5,className:"text-gray-600"}),e.jsx("div",{className:"text-xs font-semibold leading-4 text-gray-900",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.price)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Active status"}),e.jsxs("span",{className:"flex flex-row items-center gap-2",children:[t.active_status==="active"?e.jsx(cs,{size:16,strokeWidth:2.5,className:"text-green-600"}):e.jsx(Ht,{size:16,strokeWidth:2.5,className:"text-gray-600"}),e.jsx("p",{className:"text-sm capitalize text-gray-800",children:t.active_status})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.created_by.firstname+" "+t.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(t.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm capitalize",children:t.approval_status})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.approved_by?t.approved_by.firstname+" "+t.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ie(t.updated_at)})]})]})]})})},Pn=({onClose:t})=>{var v,F;const{auth:s}=ae(),{selectedProductPrice:l}=Vs(),{value:a,handleChange:r,handleSubmit:n}=Ys(),[c,i]=h.useState(!1),[o,x]=h.useState(null),[m,u]=h.useState(l.capital_price),[d,y]=h.useState(js(l.capital_price,l.markup_price,3)),[p,N]=h.useState(l.markup_price),j=w=>{const k=w.target.value;u(ne(k).value),r("capital_price",ne(k).value),N(Ws(ne(k).value,d||0))},f=w=>{const k=Number(w.target.value);y(k),N(Ws(m,k))},g=w=>{const k=ne(w.target.value).value;N(k),y(js(m,k,3))};return h.useEffect(()=>{r("capital_price",m),r("markup_price",p),r("cost",gs(m,p))},[m,d,p]),h.useEffect(()=>{r("price",Bt(a.cost??l.cost,a.sale_discount??l.sale_discount))},[a.cost,a.sale_discount]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async w=>{i(!c),w.preventDefault(),n({action:"update",id:l.id,data:a}).then(()=>{i(!c),V.success("Product price edited successfully"),t()}).catch(()=>{i(!c),x("Failed to add product listing"),V.error("Failed to add product listing")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-4 gap-y-5 font-medium text-gray-700",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:l.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:l.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-sm",children:l.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(I,{id:"unit",name:"unit",type:"text",maxLength:20,required:!0,value:a.unit||l.unit,onChange:w=>{r("unit",w.target.value)}})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:l.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:l.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsx("p",{className:"text-sm",children:l.warehouse.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",inputMode:"numeric",min:0,step:.01,required:!0,className:"pl-7",value:m||"",onChange:j,onBlur:w=>{w.target.value=Number(m).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"markup_percent",className:"text-sm font-bold text-gray-600",children:"Markup percent"}),e.jsx(I,{id:"markup_percent",name:"markup_percent",type:"number",inputMode:"numeric",min:0,max:1e3,step:.001,required:!0,value:d||"",onChange:f,onBlur:w=>{w.target.value=ne(d,{precision:3}).value.toString()}}),e.jsx("span",{className:"absolute bottom-0 right-0 mr-2 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"%"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"markup_price",className:"text-sm font-bold text-gray-600",children:"Markup price"}),e.jsx(I,{id:"markup_price",name:"markup_price",type:"number",min:0,max:1e3,step:.01,className:"pl-7",value:p||"",onChange:g,onBlur:w=>{w.target.value=Number(p).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"cost",className:"text-sm font-bold text-gray-600",children:"Cost"}),e.jsx(I,{id:"cost",name:"cost",type:"number",min:0,required:!0,className:"pl-7",readOnly:!0,value:gs(m,p).toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"sale_discount",className:"text-sm font-bold text-gray-600",children:"Sale discount"}),e.jsx(I,{id:"sale_discount",name:"sale_discount",type:"number",inputMode:"numeric",min:0,step:.01,max:a.cost!==void 0?a.cost:l.cost,disabled:a.on_sale===void 0?l.on_sale===0:a.on_sale===0,required:!0,className:"pl-7",value:a.sale_discount??((v=l.sale_discount)==null?void 0:v.toFixed(2))??"",onChange:w=>{r("sale_discount",ne(w.target.value).value)},onBlur:w=>{w.target.value=Number(a.sale_discount!==void 0?a.sale_discount:l.sale_discount).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"}),e.jsxs("div",{className:"absolute right-0 top-1/2 mr-2 flex flex-none translate-y-1/4 flex-row items-center justify-start gap-2",children:[e.jsx(I,{name:"on_sale",id:"on_sale",type:"checkbox",checked:a.on_sale===void 0?l.on_sale===1:a.on_sale===1,className:"h-4 w-fit",onChange:w=>{const k=document.getElementById("sale_discount");r("on_sale",w.target.checked?1:0),!w.target.checked&&(r("sale_discount",0),k&&(k.value="0.00"))}}),e.jsx(b,{htmlFor:"on_sale",className:"text-xs font-bold text-slate-700",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"price",className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx(I,{id:"price",name:"price",type:"number",min:0,step:.01,required:!0,readOnly:!0,className:"pl-7",value:((F=a.price)==null?void 0:F.toFixed(2))||l.price.toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-row items-center justify-start	gap-3",children:[e.jsx(qe,{id:"active_status",name:"active_status",checked:a.active_status?a.active_status==="active":l.active_status==="active",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",onCheckedChange:w=>{r("active_status",w?"active":"inactive")}}),e.jsx(b,{htmlFor:"active_status",className:"text-sm font-bold text-gray-600",children:"Active"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:l.created_by.firstname+" "+l.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm",children:ie(l.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"approval_status",className:"text-sm font-bold text-gray-600",children:"Approval status"}),e.jsxs(J,{onValueChange:w=>{r("approval_status",w),w==="approved"?r("approved_by",s.user.id):r("approved_by","")},value:a.approval_status||l.approval_status||"",required:!0,children:[e.jsx(ee,{name:"approval_status",className:"flex flex-row items-center gap-3 bg-white text-sm capitalize",children:e.jsx(se,{placeholder:a.approval_status||l.approval_status||"Select status..."})}),e.jsxs(te,{className:"bg-white",children:[e.jsx(H,{className:"rounded-md",value:"pending",children:"Pending"},"pending"),e.jsx(H,{className:"rounded-md",value:"approved",children:"Approved"},"approved"),e.jsx(H,{className:"rounded-md",value:"rejected",children:"Rejected"},"rejected")]})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Approved by"}),e.jsx("p",{className:"text-sm",children:l.approved_by?l.approved_by.firstname+" "+l.approved_by.lastname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm",children:ie(l.updated_at)})]})]}),e.jsx("div",{className:"col-span-12 flex w-full justify-between whitespace-nowrap pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:c,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Applying changes...":"Apply changes"})]})}),o&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:o})})]})})})},Tn=({handleProdPriceDetails:t,handleEditProdPrice:s,handleApproveProdPrice:l,handleRejectProdPrice:a})=>[{id:"name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",n.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):n.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"warehouse.code",sortingFn:"basic",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["WHS"," ",n.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):n.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Unit"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Capital"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:n.original.capital_price?c:"—"})})}},{accessorKey:"markup_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Markup"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.markup_price||0),i=ne(n.original.markup_price/n.original.capital_price*100,{precision:3}).value;return e.jsxs("div",{className:"flex items-center uppercase",children:[e.jsx("span",{children:c}),e.jsxs("span",{className:"text-gray-500",children:[" (",i,"%)"]})]})}},{accessorKey:"sale_discount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Discount"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.sale_discount||0);return e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:n.original.on_sale?c:e.jsx("div",{className:"group relative flex w-fit items-center",children:e.jsxs(Me,{children:[e.jsx(Oe,{children:e.jsx(ys,{size:20,strokeWidth:2,className:"text-gray-700"})}),e.jsx(Re,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:"Not on sale"})})]})})})})}},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Price"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:n.original.price?c:"—"})})}},{accessorKey:"active_status",sortingFn:"basic",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"ml-auto mr-auto flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Active"," ",n.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):n.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})}),cell:({row:n})=>{const c=n.original.active_status;return e.jsx("div",{className:"group relative mx-auto flex w-fit items-center justify-center",children:e.jsxs(Me,{children:[e.jsx(Oe,{children:c==="active"?e.jsx(He,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(Ht,{size:20,strokeWidth:2,className:"text-gray-600"})}),e.jsx(Re,{children:e.jsx("p",{className:"text-sm font-medium capitalize",children:c})})]})})},enableGlobalFilter:!1},{id:"actions",cell:({row:n})=>{const c=n.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>t(c),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(Q,{onClick:()=>s(c),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>{l(c.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(cs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve"})]}),e.jsxs(Q,{onClick:()=>{a(c.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(es,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Reject"})]})]})]})})},enableGlobalFilter:!1}],An=({openModal:t,isModalOpen:s,filterWarehouse:l})=>{const{data:a,isLoading:r,setSelectedProductPrice:n}=Vs(),c=u=>{n(u),t(u,"details")},i=u=>{n(u),t(u,"edit")},{handleSubmit:o}=Ys(),x=u=>{o({action:"update",id:u,data:{approval_status:"approved"}}).then(()=>V.success("Product price approved")).catch(()=>V.error("Failed to approve product price"))},m=u=>{o({action:"update",id:u,data:{approval_status:"rejected"}}).then(()=>V.success("Product price rejected")).catch(()=>V.error("Failed to reject product price"))};return e.jsx(e.Fragment,{children:e.jsx(Ye,{children:e.jsx(Z,{columns:Tn({handleProdPriceDetails:c,handleEditProdPrice:i,handleApproveProdPrice:x,handleRejectProdPrice:m}),data:l?a.filter(u=>u.warehouse.id===l):a,filterWhat:"name",dataType:"Listing",isLoading:r})})})},hc=()=>{const{warehouses:t}=ss(),[s,l]=h.useState(0),{isOpen:a,openModal:r,closeModal:n}=de(),[c,i]=h.useState(""),o=(x,m)=>{i(m),r()};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Pending Listing",children:e.jsxs(ll,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:x=>l(Number(x)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx(H,{value:"0",children:"All"},"all"),t.map(x=>e.jsxs(H,{value:x.id.toString(),children:[x.name," (",x.code,")"]},x.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(An,{openModal:o,isModalOpen:a,filterWarehouse:s})})]}),e.jsx(pe,{title:c==="details"?"Price Details":c==="edit"?"Edit Price":"",isOpen:a,onClose:n,closeOnOverlayClick:c==="details"||c==="toggle_active_stat",children:e.jsxs(e.Fragment,{children:[c==="details"&&e.jsx(In,{}),c==="edit"&&e.jsx(Pn,{onClose:n})]})})]})})})},Dn=({inventories:t,handleViewDetails:s,handleEditInventoryProduct:l,handleApproveInventoryProduct:a})=>[{accessorKey:"inventory_id",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Inventory"}),cell:({row:n})=>{var c;return e.jsx("div",{children:t?(c=t.find(i=>i.id===n.original.inventory_id))==null?void 0:c.code:n.original.inventory_id})}},{id:"product",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Name"," ",n.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):n.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Cap. Price"}),cell:({row:n})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:n.original.capital_price?c:"—"})})}},{accessorKey:"total_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Total"})},{accessorKey:"sold_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Sold"})},{accessorKey:"approved_stocks",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Approved"}),cell:({row:n})=>e.jsx("div",{children:e.jsx("span",{children:n.original.approved_stocks??0})})},{id:"actions",cell:({row:n})=>{const c=n.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>{s(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ne,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(Q,{onClick:()=>{l(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsxs(Q,{onClick:()=>{a(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(cs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve stocks"})]})]})]})})},enableGlobalFilter:!1}],zn=({openModal:t})=>{const{data:s,isLoading:l,setSelectedInventoryProduct:a}=Cs(),{data:r}=_s(),n=o=>{a(o),t(o,"view_details")},c=o=>{a(o),t(o,"edit")},i=o=>{a(o),t(o,"approve")};return e.jsx(e.Fragment,{children:e.jsx(Z,{columns:Dn({inventories:r,handleViewDetails:n,handleEditInventoryProduct:c,handleApproveInventoryProduct:i}),data:s.sort((o,x)=>x.inventory_id-o.inventory_id),filterWhat:"product",isLoading:l,dataType:"Inventory Product"})})},En=()=>{const{selectedInventoryProduct:t}=Cs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:(t==null?void 0:t.product.brand)||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.capital_price)??0)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.remaining_stocks_count})]})]})]})})},Wn=({onClose:t})=>{const{selectedInventoryProduct:s}=Cs(),{value:l,handleChange:a,handleSubmit:r}=ls(),[n,c]=h.useState(!1),i=o=>{o.preventDefault(),c(!0),r({action:"update",id:s.id,data:l}).then(()=>{V.success("Inventory product successfully approved."),c(!1),t()}).catch(()=>{V.error("Failed to approve inventory product."),c(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[24rem] max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:(s==null?void 0:s.product.brand)||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((s==null?void 0:s.capital_price)||0)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("form",{className:"grid w-full grid-flow-row grid-cols-11 gap-3",onSubmit:i,children:[e.jsxs("div",{className:"relative col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"approved_stocks",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(I,{id:"approved_stocks",name:"approved_stocks",type:"number",min:0,step:1,max:(s==null?void 0:s.remaining_unapproved_stocks)??0,required:!0,autoFocus:!0,value:l.approved_stocks!==void 0?String(l.approved_stocks):"",onChange:o=>{a("approved_stocks",o.target.value)},onBlur:o=>{a("approved_stocks",Number(o.target.value))}}),e.jsxs("span",{className:"absolute bottom-0 right-0 -translate-x-4 -translate-y-2 pb-[2px] text-sm font-medium text-slate-700",children:["/ ",s==null?void 0:s.remaining_unapproved_stocks]})]}),e.jsx("div",{className:"col-span-1 flex items-center pt-6",children:e.jsx(Vt,{size:24,strokeWidth:2,className:"mx-auto text-slate-600"})}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"prev_approved_stocks",className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx(I,{id:"prev_approved_stocks",name:"prev_approved_stocks",type:"number",readOnly:!0,value:(s==null?void 0:s.approved_stocks)||0})]}),e.jsx("div",{className:"col-span-11 flex w-full justify-between whitespace-nowrap pt-3",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:n,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Approving...":"Approve"})]})})]})]})})},Mn=({onClose:t})=>{var j;const{auth:s}=ae(),{selectedInventoryProduct:l}=Cs(),{value:a,handleChange:r,handleSubmit:n}=ls(),{suppliers:c,isFetching:i}=Us(),[o,x]=h.useState(!1),[m,u]=h.useState(!1),[d,y]=h.useState(null),[p,N]=h.useState();return h.useEffect(()=>{const f=$s(a.stocks_count??((l==null?void 0:l.stocks_count)||0),a.damage_count??((l==null?void 0:l.damage_count)||0));N(f),r("total_count",f)},[a.damage_count,a.stocks_count,p]),e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:async f=>{u(!m),f.preventDefault(),n({action:"update",id:l.id,data:a}).then(()=>{u(!1),V.success("Inventory product successfully updated."),t()}).catch(()=>{u(!1),V.error("Failed to update inventory product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"product",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsx(I,{id:"product",name:"product",type:"text",readOnly:!0,value:l==null?void 0:l.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"product_brand",className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx(I,{id:"product_brand",name:"product_brand",type:"text",readOnly:!0,value:l==null?void 0:l.product.brand})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"product_size",className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx(I,{id:"product_size",name:"product_size",type:"text",readOnly:!0,value:l==null?void 0:l.product.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"product_color",className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx(I,{id:"product_color",name:"product_color",type:"text",readOnly:!0,value:l==null?void 0:l.product.color})]}),e.jsxs("div",{className:`${s.role==="admin"||s.role==="super_admin"?"col-span-6":"col-span-12"} flex flex-col justify-center gap-1`,children:[e.jsx(b,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(ye,{open:o,onOpenChange:x,children:[e.jsx(fe,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(A,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[a.supplier_id?e.jsx(e.Fragment,{children:(()=>{const f=c.find(g=>g.id===a.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:f==null?void 0:f.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:f==null?void 0:f.address})]})})()}):e.jsx("span",{children:l==null?void 0:l.supplier_id.name}),e.jsx(Xe,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"p-0 text-sm font-medium text-slate-700",children:e.jsxs(Ve,{children:[e.jsx($e,{placeholder:"Supplier name or address..."}),c===void 0&&i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ge,{children:"No match found"}),e.jsx(We,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Ee,{children:c.map((f,g)=>e.jsxs(Te,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{r("supplier_id",f.id),x(!1)},children:[e.jsx("span",{children:f.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:f.address})]},g))})})]})})]})]}),(s.role==="admin"||s.role==="super_admin")&&e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"status",className:"text-sm font-bold text-gray-600",children:"Status"}),e.jsxs(J,{value:a.status?a.status.toString():l==null?void 0:l.status.toString(),required:!0,onValueChange:f=>r("status",f),children:[e.jsx(ee,{name:"status",id:"status",className:"w-full px-4 text-sm font-bold text-slate-700",children:e.jsx(se,{placeholder:"Select status..."})}),e.jsxs(te,{className:"text-sm font-medium",children:[e.jsx(H,{value:"1",children:"Approved"}),e.jsx(H,{value:"0",children:"Pending"})]})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(I,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",readOnly:s.role!=="admin",defaultValue:l==null?void 0:l.capital_price.toFixed(2),onBlur:f=>{f.target.value=Number(f.target.value).toFixed(2)},onChange:f=>{const g=Number(f.target.value).toFixed(2);r("capital_price",Number(g))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(I,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,defaultValue:l==null?void 0:l.unit,onChange:f=>r("unit",f.target.value)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(I,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:((j=a.stocks_count)==null?void 0:j.toFixed(0))??(l==null?void 0:l.stocks_count)??0,onChange:f=>{r("stocks_count",Number(Number(f.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(I,{id:"damage_count",name:"damage_count",type:"number",min:0,max:a.stocks_count??(l==null?void 0:l.stocks_count),step:1,required:!0,value:a.damage_count!==void 0?String(a.damage_count):String(l==null?void 0:l.damage_count)||"",onBlur:f=>{f.target.value=Number(f.target.value).toFixed(0)},onChange:f=>r("damage_count",Number(Number(f.target.value).toFixed(0)))})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(b,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(I,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,value:p||0,className:`${p&&p<0&&"text-red-600"}`,readOnly:!0})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(_,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(_,{type:"submit",fill:"green",disabled:m,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying...":"Apply changes"})]})}),d&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:d})})]})})})},pc=()=>{const{isOpen:t,openModal:s,closeModal:l}=de(),[a,r]=h.useState(""),n=(c,i)=>{r(i),s()};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Pending Inventory Products",children:e.jsx(rl,{children:e.jsxs(Tt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border",children:e.jsx(zn,{openModal:n})})}),e.jsx(pe,{title:a==="add"?"Add Items":a==="edit"?"Edit Item":a==="view_details"?"Item Details":a==="approve"?"Approve Item":"",isOpen:t,onClose:l,closeOnOverlayClick:a==="view_details",children:e.jsxs(e.Fragment,{children:[a==="view_details"&&e.jsx(En,{}),a==="edit"&&e.jsx(Mn,{onClose:l}),a==="approve"&&e.jsx(Wn,{onClose:l})]})})]})})})})},On=({handleViewItems:t})=>[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",l.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"invoice.code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(_,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Invoice code"," ",l.getIsSorted()==="asc"?e.jsx(z,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(E,{size:18,strokeWidth:2}):e.jsx(W,{size:18,strokeWidth:2})]})})},{accessorKey:"refundable_amount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Refundable"}),cell:({row:l})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(l.original.refundable_amount)})})},{accessorKey:"issued_by",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Issued by"}),cell:({row:l})=>e.jsx("div",{children:e.jsx("span",{children:l.original.issued_by?`${l.original.issued_by.firstname} ${l.original.issued_by.lastname}`:"—"})})},{accessorKey:"created_at",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Issued at"}),cell:({row:l})=>e.jsx("div",{children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.DateTimeFormat("en-PH",{year:"numeric",month:"long",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(new Date(l.original.created_at))})})},{id:"actions",cell:({row:l})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(he,{className:"bg-gray-200"}),e.jsxs(Q,{onClick:()=>{t(l.original.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(It,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View items"})]})]})]})}),enableGlobalFilter:!1}],Rn=()=>{const{data:t,isFetching:s}=nl(),l=Le(),a=r=>{l(`/returns/${r}`)};return e.jsx(e.Fragment,{children:e.jsx(Z,{columns:On({handleViewItems:a}),data:t?t.sort((r,n)=>new Date(n.created_at).getTime()-new Date(r.created_at).getTime()):[],isLoading:s,dataType:"Returns",filterWhat:"code"})})},fc=()=>e.jsx(e.Fragment,{children:e.jsx(le,{title:"Returns",children:e.jsx(cl,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Rn,{})})})})})}),Ln=()=>[{id:"product",accessorKey:"invoice_item.product.name",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Product"}),cell:({row:s})=>e.jsx("div",{children:e.jsx("span",{className:"max-w-[20ch] truncate",children:s.original.invoice_item.product.name})})},{accessorKey:"invoice_item.product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"invoice_item.product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"invoice_item.product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"invoice_item.product.serial_no",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Serial"})},{accessorKey:"quantity",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"QTY"})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Unit"})},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Selling price"}),cell:({row:s})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s.original.price)})})},{id:"subtotal",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Subtotal"}),cell:({row:s})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format((s.original.price??0)*(s.original.quantity??0))})})}],Kn=()=>{const{data:t,isFetching:s}=il();return e.jsx(e.Fragment,{children:e.jsx(Z,{columns:Ln(),data:t??[],isLoading:s,dataType:"Return Items",filterWhat:"product"})})},jc=()=>{const{id:t}=Rs(),s=Le(),l=()=>{s(-1)};return e.jsx(e.Fragment,{children:e.jsx(le,{title:"Return items",children:e.jsx(ol,{returnTransactionId:Number(t??0),children:e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsx("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:e.jsxs(A,{onClick:()=>l(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(Ns,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]})}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Kn,{})})]})})})})};export{mc as Customers,oc as ExpensesPage,cc as Inventory,ic as InventoryItemsPage,Yn as Invoice,Gn as InvoiceItems,yc as Login,pc as PendingInventoryProduct,hc as PendingProductPrice,uc as PendingReturn,lc as PendingTransfer,tc as PointOfSalePage,xc as PosReturnsPage,ec as ProductPrices,Jn as Products,dc as Reports,jc as ReturnItems,fc as Returns,nc as RolePermissions,Zn as Supplier,ac as Transaction,sc as Transfer,Xn as UserInfo,rc as UserSales,Qn as Warehouse};
