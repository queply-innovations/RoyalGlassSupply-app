import{p as fe,t as Ls,r as h,v as ja,w as ga,x as Na,y as Ie,m as oe,z as ts,D as ya,E as va,G as ba,H as ht,I as wa,J as _a,K as Sa,L as Ca,O as ka,Q as Fa,R as Ia,U as pt,V as Pa,W as ft,X as jt,Y as qs,Z as Aa,$ as Ne,j as e,B as b,a0 as Te,M as ae,a1 as Ta,a2 as gt,a3 as De,b as as,a4 as we,a5 as _e,a6 as Se,a7 as Ce,a8 as me,a9 as B,aa as Nt,ab as Da,ac as Hs,ad as za,ae as Ea,af as F,ag as Ss,ah as Ma,ai as Ge,aj as Wa,d as vs,ak as yt,al as vt,am as bt,an as wt,ao as J,ap as ee,aq as se,ar as te,as as V,at as G,au as lt,av as rt,aw as Re,ax as w,ay as Ve,az as _t,aA as St,aB as Oa,aC as Ra,aD as Ua,aE as re,aF as Ue,aG as Ke,aH as Cs,aI as Le,aJ as Vs,aK as ms,aL as Xe,C as $e,aM as R,aN as P,aO as Ct,aP as qe,aQ as ye,aR as je,aS as ve,aT as ns,aU as Be,aV as Qe,aW as Ze,aX as Oe,aY as Ae,aZ as ks,a_ as $s,a$ as Bs,b0 as cs,b1 as bs,b2 as Ka,b3 as La,b4 as qa,T as kt,b5 as Ha,b6 as Va,b7 as Ye,b8 as us,b9 as hs,ba as ps,bb as fs,bc as Ft,bd as $a,be as Ba,bf as Qa,bg as Ya,bh as Ga,bi as Xa,bj as le,bk as ze,bl as Qs,bm as Fs,bn as nt,bo as It,bp as Pt,bq as At,br as Tt,bs as Dt,bt as zt,bu as Et,bv as Za,bw as Mt,bx as ds,by as Wt,bz as Ot,bA as xe,bB as Ja,bC as el,bD as sl,bE as tl,bF as Rt,bG as al,bH as Ut,bI as Ys,u as Kt,bJ as ll,bK as js,bL as ct,bM as it,bN as ot,bO as Gs,bP as rl,bQ as dt,bR as nl,bS as cl,bT as Xs,bU as il,bV as ol,bW as dl,bX as es,_ as Lt,h as qt,i as Ht,k as Vt,bY as $t,l as Bt,bZ as xt,b_ as Os,b$ as Zs,c0 as xl,c1 as ml,c2 as Qt,c3 as ul,c4 as hl,c5 as Js,c6 as pl,c7 as Is,c8 as fl,c9 as jl,ca as gl,cb as Nl,cc as yl,o as Yt,A as Gt,cd as Xt}from"./index-6462efb5.js";import{ce as Kc}from"./index-6462efb5.js";import{M as ue,f as ie,a as ke,P as be,T as is,b as vl,u as Zt,A as bl,C as Je,N as et,c as ls,g as st,d as wl}from"./useInventoryProductCalculations-a60a0311.js";import{a as Y,I as Q,D as X,A as D,b as z,c as E,u as de,f as Jt,d as ne,P as tt}from"./timeUtils-368e2f9b.js";import{F as at,B as ss,M as _l,R as gs}from"./ReportCard-03a4bff3.js";import{P as Sl}from"./PosTable-2acfe816.js";import"./index-00fdda1d.js";const Cl=()=>{const t=fe(),{warehouses:s}=Ls(),[a,r]=h.useState({id:s.length+1||0,code:"",name:"",location:""}),l=x=>{const{name:m,value:u}=x.target;r(d=>({...d,[m]:u}))},c={onSuccess:async()=>{await t.invalidateQueries({queryKey:["warehouses"]}),r({id:s.length+1||0,code:"",name:"",location:""})},onError:x=>{console.error("Warehouse Data failed",x)}},{mutateAsync:n}=Y({mutationKey:["removeWarehouse"],mutationFn:ja,...c}),{mutateAsync:i}=Y({mutationKey:["addWarehouse"],mutationFn:ga,...c}),{mutateAsync:o}=Y({mutationKey:["updateWarehouse"],mutationFn:Na,...c});return{value:a,setValue:r,handleChange:l,removeWarehouseMutation:n,addWarehouseMutation:i,updateWarehouseMutation:o}},kl=()=>{const t=fe(),{transfers:s}=Ie(),{auth:a}=oe(),{warehouses:r}=ts(),l=s[0]?s[s.length-1].id+1:1,[c,n]=h.useState(!1),[i,o]=h.useState(!1),[x,m]=h.useState(null),[u,d]=h.useState(null),[y,p]=h.useState(null),[N,j]=h.useState(),[f,g]=h.useState(),[v,I]=h.useState(),[_,k]=h.useState({});h.useEffect(()=>{k(O=>({...O,approval_status:"pending",created_by:a.user.id,transfer_schedule:""}))},[]);const A=()=>{const O=Object.keys(_).map(T=>({text:T})),U=O.length===6||O.length>6;if(U){const T=_.source!==_.destination;if(T){const Z=_.transfer_schedule!=="";return Z?[Z,""]:[Z,"Please fill up transfer schedule"]}else return[T,"You cannot have the same source and destination"]}else return[U,"Please fill up all fields"]},C=O=>{n(!0),d(null),m(null),k(U=>({...U,[O.target.name]:O.target.value}))},W=O=>{if(n(!0),d(null),m(null),O){p(O);const U=O.$H<10?"0"+O.$H.toString():O.$H.toString(),T=O.$m<10?"0"+O.$m.toString():O.$m.toString(),Z=O.$s<10?"0"+O.$s.toString():O.$s.toString();k($=>({...$,transfer_schedule:_.transfer_schedule+" "+U+":"+T+":"+Z}))}else p(null),k(U=>({...U,transfer_schedule:_.transfer_schedule.split(" ")[0]}))},K=(O,U)=>{var T,Z,$,Pe;n(!0),d(null),m(null),k(he=>({...he,[O]:U})),console.log(O,U),O==="source"&&U==1?(j((T=r.find(he=>he.id===U))==null?void 0:T.code),g((Z=r.find(he=>he.id===U+1))==null?void 0:Z.code),k(he=>({...he,destination:U+1}))):O==="source"&&U==2?(j(($=r.find(he=>he.id===U))==null?void 0:$.code),g((Pe=r.find(he=>he.id===U-1))==null?void 0:Pe.code),k(he=>({...he,destination:U-1}))):O==="transfer_schedule"&&(I(U.replace(/-/g,"")),p(U))},M=async()=>{if(console.log(N,f,v),console.log(_),N&&f&&v){const O="TRF-"+N+"-"+f+"-"+v+"-"+l;k(U=>({...U,code:O}))}};h.useEffect(()=>{async function O(){if(_.code){const U=A();if(o(!0),U[0])return S(_);m(U[1]),o(!1)}}O()},[_.code]);const L={onSuccess:async()=>{await t.invalidateQueries({predicate:O=>["transfers","transfer_products"].includes(O.queryKey[0])}),o(!1),n(!1),d("Transfer info has been added")},onError:O=>{console.error(O),m(O.message),o(!1)}},{mutateAsync:S,isPending:ce}=Y({mutationKey:["addTransfer"],mutationFn:ya,...L});return{transfer:_,lastId:l,isChanged:c,isSubmitting:i,isPending:ce,error:x,success:u,dateDisplay:y,handleSubmit:M,handleChange:C,handleChangeSelect:K,handleChangeDateTime:W,addTransferMutation:S}},ea=()=>{const t=fe(),[s,a]=h.useState({}),r=(o,x)=>{a(m=>({...m,[o]:x}))},l=async o=>{if(console.log("Submitting: ",o),o.action==="add")return await n(o.data);if(o.action==="update")return await i({id:o.id,data:o.data});{const x="No data to submit. Function requires at least one parameter.";return console.error(x),{status:400,data:x}}},c={onSuccess:async()=>{await t.invalidateQueries({queryKey:["inventory"]})},onError:o=>{console.error("Inventory Data failed",o)}},{mutateAsync:n}=Y({mutationKey:["addInventory"],mutationFn:va,...c}),{mutateAsync:i}=Y({mutationKey:["patchInventory"],mutationFn:ba,...c});return{value:s,setValue:a,handleChange:r,handleSubmit:l}},Fl=()=>{const t=fe(),{transfers:s,transferProducts:a,selectedTransfer:r}=Ie(),l=a.filter(q=>q.transfer_id===r.id),{auth:c}=oe(),{warehouses:n}=ts(),[i,o]=h.useState(!1),[x,m]=h.useState(!1);h.useState(!1);const[u,d]=h.useState(!1);h.useState(!1);const[y,p]=h.useState(!1),{data:N}=ht(),[j,f]=h.useState(0),[g,v]=h.useState(!1),[I,_]=h.useState(!1),[k,A]=h.useState(null),[C,W]=h.useState(null),[K,M]=h.useState(new Date),[L,S]=h.useState(new Date),[ce,O]=h.useState(""),[U,T]=h.useState(),Z=s[s.length-1].id+1,[$,Pe]=h.useState({});if(h.useEffect(()=>{r&&(Pe({id:r.id,code:r.code,created_by:r.created_by.id,source:r.source.id,destination:r.destination.id,transfer_schedule:r.transfer_schedule,approval_status:r.approval_status,approved_by:r.approved_by?r.approved_by.id:null,transfer_status:r.transfer_status,date_received:r.date_received,received_by:r.received_by?r.received_by.id:null,notes:r.notes}),M(new Date(r.transfer_schedule)),r.date_received?S(new Date(r.date_received)):S(new Date(r.transfer_schedule)))},[r]),$.code==""){const q=$.transfer_schedule.split(" ")[0].split("-").join(""),pe="TRF-"+r.source.code+"-"+r.destination.code+"-"+q+"-"+Z;Pe(He=>({...He,code:pe}))}const he=()=>{const q=$.source!==$.destination;if(q){const pe=$.transfer_status==="arrived"?!!($.received_by&&$.date_received):!0;if(pe)return[pe,""];{const He=`Fields you need to fill: ${$.received_by?"":"received by"} 
									${!$.date_received&&!$.received_by?" and ":""}
									${$.date_received?"":"date received"}`;return[pe,He]}}else return[q,"You cannot have the same source and destination"]},zs=q=>{v(!0),W(null),A(null),Pe(pe=>({...pe,[q.target.name]:q.target.value}))},Ns=(q,pe)=>{v(!0),W(null),A(null),O(q),T(pe),q==="transfer_schedule"?M(pe):S(pe)};h.useEffect(()=>{async function q(){if(ce&&U){const pe=U.getFullYear()+"-"+(U.getMonth()+1)+"-"+U.getDate()+" "+U.getHours()+":"+U.getMinutes()+":"+U.getSeconds();Pe(He=>({...He,[ce]:pe}))}}q()},[K,L]);const ys=(q,pe)=>{console.log(q,pe),v(!0),W(null),A(null),Pe(He=>({...He,[q]:pe}))};h.useEffect(()=>{$.approval_status==="approved"?Pe(q=>({...q,approved_by:c.user.id})):$.approval_status==="rejected"&&p(!0)},[$.approval_status]),h.useEffect(()=>{$.transfer_status==="arrived"?o(!0):o(!1)},[$.transfer_status]),h.useEffect(()=>{if(x){async function q(){const He={code:"INV-"+n.filter(fa=>fa.id===$.destination)[0].code+"-TRA-"+r.code.split("-")[3]+"-"+(Number(N.length)+1).toString(),warehouse_id:$.destination,created_by:$.created_by,date_received:$.date_received,type:"transfer",transfer_id:$.id,notes:$.notes},pa=await os(He);f(pa.data.data.id)}q()}},[x]);async function Es(){await Ca(l,j).then(async q=>{_(!1),v(!1),W("Transfer info has been edited")}).catch(q=>{throw console.error("Error updating inventory products:",q),q})}h.useEffect(()=>{j!=0&&Es()},[j]);const H=async()=>{const q=he();if(_(!0),q[0])if(i)await Ee($);else return await Ee($);else A(q[1]),_(!1)},Fe={onSuccess:async()=>{if(await t.invalidateQueries({queryKey:["transfers"]}),i)m(!0);else{if(y)return await Ws(l);_(!1),v(!1),W("Transfer info has been edited")}},onError:q=>{console.error(q),A(q.message),_(!1)}},{mutateAsync:Ee}=Y({mutationKey:["transfers"],mutationFn:wa,...Fe}),Me={onSuccess:async()=>{await t.invalidateQueries({queryKey:["inventory"]}),d(!0)},onError:q=>{console.error(q),A(q.message),_(!1)}},{mutateAsync:os}=Y({mutationKey:["addInventory"],mutationFn:_a,...Me}),Ms={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfer_products"]}),_(!1),v(!1),W("Transfer info has been edited")},onError:q=>{console.error(q),A(q.message),_(!1)}},{mutateAsync:Ws}=Y({mutationKey:["initInventoryProduct"],mutationFn:Sa,...Ms});return{transfer:$,selectedTransfer:r,lastId:Z,isChanged:g,isSubmitting:I,error:k,success:C,dateDisplay:K,dateDisplayArrived:L,handleSubmit:H,handleChange:zs,handleChangeSelect:ys,handleChangeDateTime:Ns,editTransferMutation:Ee}},Ps=()=>{const t=fe(),[s,a]=h.useState({}),r=(x,m)=>{a(u=>({...u,[x]:m}))},l=async x=>{if(console.log("Submitting: ",x),x.action==="add")return await n(x.data);if(x.action==="update")return await i({id:x.id,data:x.data});{const m="No data to submit. Function requires at least one parameter.";return console.error(m),{status:400,data:m}}},c={onSuccess:async()=>{await t.invalidateQueries({predicate:x=>["productPrices","pendingProductPrices","approvedProductPrices","productPricesTEST"].includes(x.queryKey[0])}),a({})},onError:x=>{console.error("Product Prices Data failed",x)}},{mutateAsync:n}=Y({mutationKey:["addProductListing"],mutationFn:ka,...c}),{mutateAsync:i}=Y({mutationKey:["patchProductListing"],mutationFn:Fa,...c}),{mutateAsync:o}=Y({mutationKey:["deleteProductListing"],mutationFn:Ia,...c});return{value:s,setValue:a,handleChange:r,handleSubmit:l,addProductPricesMutation:n,patchProductPricesMutation:i,deleteProductPricesMutation:o}},As=()=>{const t=fe(),{transfers:s,transferProducts:a,selectedProduct:r,selectedTransfer:l,addProd:c}=Ie();oe();const{data:n,isLoading:i}=pt(),{data:o}=Pa(),{data:x,isLoading:m}=ht(),u=x.filter(H=>H.warehouse.id===l.source.id&&o.some(Fe=>Fe.inventory_id===H.id)),[d,y]=h.useState([]),[p,N]=h.useState(0),[j,f]=h.useState(""),[g,v]=h.useState(r.id?r.product.name:""),[I,_]=h.useState(0),[k,A]=h.useState(0),[C,W]=h.useState(!1),[K,M]=h.useState(!1),[L,S]=h.useState(null),[ce,O]=h.useState(null),[U,T]=h.useState({});function Z(){r.id?T(H=>({...H,id:r.id,transfer_id:r.transfer_id,unit:r.unit,source_inventory:p})):T(H=>({...H,id:a.length+1,transfer_id:l.id}))}h.useEffect(()=>{T(c?H=>({...H,id:a.length+1,transfer_id:l.id}):{id:r.id,transfer_id:r.transfer_id,product_id:r.product.id,total_quantity:r.total_quantity,capital_price:r.capital_price,unit:r.unit,source_inventory:r.source_inventory})},[]),h.useEffect(()=>{if(!c){const H=o.find(Fe=>Fe.id===r.source_inventory);_(H!=null&&H.remaining_stocks_count?H.remaining_stocks_count:0),A(H!=null&&H.damage_count?H.damage_count:0),N(r.source_inventory)}},[o]);const $=(H,Fe)=>{W(!0),O(null),S(null),T(Ee=>({...Ee,[H.target.name]:Number(H.target.value)}))},Pe=(H,Fe,Ee)=>{if(W(!0),O(null),S(null),H==="product_id"&&Ee!=null){const Me=d[Ee];v(Me.product.name);const os=Me.capital_price,Ms=Me.unit,Ws=Number(Fe);T(q=>({...q,[H]:Ws,capital_price:os,unit:Ms,source_inventory:p})),_(Me.remaining_stocks_count?Me.remaining_stocks_count:0),A(Me.damage_count)}else if(H==="inventory_id"){f(Fe.toString());const Me=u==null?void 0:u.filter(os=>os.id===Fe)[0].id;N(Me),v(""),U.capital_price&&(Z(),T({}))}};h.useEffect(()=>{o.length!=0&&y(o.filter(H=>H.inventory_id===p&&H.remaining_stocks_count&&H.remaining_stocks_count>0))},[p]);const he=()=>{const Fe=Object.keys(U).map(Ee=>({text:Ee})).length===7;return Fe?U.total_quantity>I?[!1,"Quantity input is greater than the current stock quantity."]:[!0,""]:[Fe,"Please fill up all fields"]},zs=async()=>{M(!0);const H=he();if(H[0])return c?await ys(U):await Es(U);S(H[1]),M(!1)},Ns={onSuccess:async()=>{await t.invalidateQueries({queryKey:["transfer_products"]}),M(!1),W(!1),O(c?"Transfer product has been added":"Transfer product has been edited")},onError:H=>{console.error(H),S(H.message),M(!1)}},{mutateAsync:ys}=Y({mutationKey:["transfer_product"],mutationFn:ft,...Ns}),{mutateAsync:Es}=Y({mutationKey:["transfer_product"],mutationFn:jt,...Ns});return{product:U,allProducts:n,allInventoryProducts:o,isInventoryLoading:m,isAllProductsLoading:i,inventoryID:p,invCode:j,prodName:g,filteredInventoriesSrc:u,filteredProductsSrc:d,quantityLimit:I,damagedCount:k,isChanged:C,isSubmitting:K,error:L,success:ce,handleSubmit:zs,handleChange:$,handleChangeSelect:Pe,addProductMutation:ys}},Il=()=>{const{selectedReturn:t}=qs(),[s,a]=h.useState(!1),[r,l]=h.useState(null),[c,n]=h.useState(null),[i,o]=h.useState({id:t.id,code:t.code,invoice_id:t.invoice.id,issued_by:t.issued_by.id,refundable_amount:t.refundable_amount,voucher_id:t.voucher?t.voucher.id:null,refund_status:"done",created_at:t.created_at,updated_at:t.updated_at}),x=async()=>{a(!0),await u(i)},m={onSuccess:async()=>{a(!1),n("Return info has been edited")},onError:d=>{console.error(d),l(d.response.data.message),a(!1)}},{mutateAsync:u}=Y({mutationKey:["returns"],mutationFn:Aa,...m});return{selectedReturn:t,isSubmitting:s,error:r,success:c,handleSubmit:x}};/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Ne("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Ne("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=Ne("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=Ne("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Ne("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=Ne("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=Ne("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=Ne("CircleOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.35 2.69A10 10 0 0 1 21.3 15.65",key:"1pfsoa"}],["path",{d:"M19.08 19.08A10 10 0 1 1 4.92 4.92",key:"1ablyi"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=Ne("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=Ne("MapPinned",[["path",{d:"M18 8c0 4.5-6 9-6 9s-6-4.5-6-9a6 6 0 0 1 12 0",key:"yrbn30"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M8.835 14H5a1 1 0 0 0-.9.7l-2 6c-.1.1-.1.2-.1.3 0 .6.4 1 1 1h18c.6 0 1-.4 1-1 0-.1 0-.2-.1-.3l-2-6a1 1 0 0 0-.9-.7h-3.835",key:"112zkj"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=Ne("MoveRight",[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=Ne("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=Ne("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Ne("ShoppingBasket",[["path",{d:"m15 11-1 9",key:"5wnq3a"}],["path",{d:"m19 11-4-7",key:"cnml18"}],["path",{d:"M2 11h20",key:"3eubbj"}],["path",{d:"m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4",key:"yiazzp"}],["path",{d:"M4.5 15.5h15",key:"13mye1"}],["path",{d:"m5 11 4-7",key:"116ra9"}],["path",{d:"m9 11 1 9",key:"1ojof7"}]]);/**
 * @license lucide-react v0.338.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=Ne("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),El=({isUpdate:t=!1,onClose:s,isDelete:a})=>{const{warehouseSelected:r}=Ls(),{value:l,setValue:c,handleChange:n,addWarehouseMutation:i,updateWarehouseMutation:o,removeWarehouseMutation:x}=Cl();h.useEffect(()=>{(t||a)&&c(r)},[t,a,r,c]);const[m,u]=h.useState(!1),[d,y]=h.useState(null),[p,N]=h.useState(null),j=async()=>{u(!0);try{await new Promise(f=>setTimeout(f,1e3)),t&&(await o(l),u(!1),y("Warehouse updated successfully"),s()),a?(await x(l.id),u(!1),y("Warehouse deleted successfully"),s()):!t&&!a&&(await i(l),u(!1),y("Warehouse added successfully"),s())}catch(f){console.error("Warehouse data submission failed",f),u(!1),N(f.message)}};return e.jsx(e.Fragment,{children:a?e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:f=>{f.preventDefault(),j()},children:e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx(b,{type:"submit",fill:"red",children:a?"Delete Warehouse":"Add Warehouse"})})})}):e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:f=>{f.preventDefault(),j()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse ID"}),e.jsx(Q,{name:"id",value:(l==null?void 0:l.id)||0,type:"number",disabled:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Code"}),e.jsx(Q,{name:"code",placeholder:"Warehouse Code",value:(l==null?void 0:l.code)||"",onChange:n,maxLength:3})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Name"}),e.jsx(Q,{name:"name",placeholder:"Warehouse Name",value:(l==null?void 0:l.name)||"",onChange:n,required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Warehouse Location"}),e.jsx(Q,{name:"location",placeholder:"Warehouse Location",type:"string",value:(l==null?void 0:l.location)||"",onChange:n,required:!0})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[d&&e.jsx("div",{className:"font-bold text-green-700",children:d}),p&&e.jsx("div",{className:"font-bold text-red-700",children:p}),m?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:s,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",children:t?"Update Warehouse":"Add Warehouse"})]})})]})})]})})})})},Ml=({openModal:t})=>{const{warehouses:s,setWarehouseSelected:a,isFetching:r,progress:l}=Ls(),c=[{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE ID"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.id})},{accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:i})=>e.jsx("div",{className:"items-center",children:e.jsxs(b,{onClick:()=>i.toggleSorting(i.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["WAREHOUSE NAME ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.name})},{accessorKey:"code",header:()=>e.jsx("div",{className:"text-center",children:"code"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.code})},{accessorKey:"location",header:()=>e.jsx("div",{className:"text-center",children:"LOCATION"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.location})},{id:"actions",header:()=>e.jsx("div",{className:"flex flex-row justify-center",children:"ACTIONS"}),cell:({row:i})=>{const o=i.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(b,{fill:"empty",textColor:"black",onClick:()=>n(o),className:"flex flex-row items-center gap-2",children:[e.jsx(at,{})," Edit"]})})}}],n=i=>{a(i),t(i,"edit")};return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:c,filterWhat:"location",dataType:"",isLoading:r,openModal:void 0})})},uc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Warehouse",children:e.jsxs(Ta,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Ml,{openModal:c})})}),e.jsx(ue,{isOpen:t,onClose:a,title:r==="edit"?"Edit Warehouse":r==="remove"?"Remove Warehouse":"Add Warehouse",children:e.jsx(El,{onClose:a,isUpdate:r==="edit",isDelete:r==="remove"})})]})})})},Wl=({openModal:t})=>{const{invoices:s}=gt(),a=De(),r=[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx(e.Fragment,{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:l})=>e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{className:"font-bold",children:l.original.code})})},{accessorKey:"warehouse.code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Warehouse"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"payment_method",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Type"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:l})=>{const c=l.original.payment_method.split("_").join(" ");return e.jsx(e.Fragment,{children:e.jsx("span",{className:"capitalize",children:c})})}},{accessorKey:"is_paid",header:({})=>e.jsx("span",{children:"Balance Amount"}),cell:({row:l})=>{const c=l.original.is_paid;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"group relative flex w-fit items-center justify-center",children:c===1?e.jsx("span",{children:"——"}):c===0?e.jsx("span",{className:"",children:ie(l.original.balance_amount)}):e.jsx(as,{size:20,strokeWidth:2,className:"text-amber-500"})})})}},{accessorKey:"total_amount_due",header:({column:l})=>e.jsx("span",{children:"Total Amount"}),cell:({row:l})=>ie(l.original.total_amount_due)},{id:"actions",cell:({row:l})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{a(`/transaction/items/${l.original.id}`)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Dl,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View Invoice"})]})]})]})}),enableGlobalFilter:!1}];return e.jsx(e.Fragment,{children:e.jsx(X,{columns:r,data:s.sort((l,c)=>{const n=new Date(l.updated_at??l.created_at);return new Date(c.updated_at??c.created_at).getTime()-n.getTime()}),filterWhat:"code",dataType:"Invoices"})})},hc=({})=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i),console.log("modalAction:",r)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Transactions",children:e.jsx(Nt,{children:e.jsx(Da,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Wl,{openModal:c})})})})})})})},Ol=({items:t})=>{const s=[{id:"orderItem",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Item #"}),cell:({row:a})=>e.jsxs("div",{className:"flex flex-row gap-2 ",children:[a.original.product.brand?e.jsx(e.Fragment,{children:e.jsxs("span",{children:["(",a.original.product.brand,")"]})}):null,e.jsx("span",{className:"font-bold",children:a.original.product.name}),e.jsx("span",{className:"",children:a.original.product.size}),e.jsx("span",{className:"",children:a.original.product.color})]}),size:200},{id:"quantity",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Quantity"}),cell:({row:a})=>e.jsx("div",{className:"flex ",children:a.original.quantity})},{id:"price",enableResizing:!1,header:()=>e.jsx("div",{className:"flex ",children:"Price"}),cell:({row:a})=>e.jsx("div",{className:"flex ",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a.original.product_price??0)})}];return e.jsx(e.Fragment,{children:e.jsx(X,{columns:s,data:t,dataType:"orderItem",filterWhat:"price",hideFilter:!0})})},pc=({})=>{const t=De(),{id:s}=Hs(),{data:a,isLoading:r}=za(Number(s)),{invoiceItems:l,isLoading:c}=Ea(Number(s)),n=()=>{t(-1)},i=o=>o?o.split("_").map(x=>x.charAt(0).toUpperCase()+x.slice(1)).join(" "):"";return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Transaction Items",children:e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:[e.jsxs(F,{onClick:()=>n(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(Ss,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]}),!r&&e.jsxs("div",{className:"flex w-full flex-row justify-between gap-4 text-xs font-medium text-slate-800",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(We,{label:"Code",type:"string",value:a==null?void 0:a.code}),e.jsx(We,{label:"Total due",type:"currency",value:a==null?void 0:a.total_amount_due})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(We,{label:"Billed to",type:"string",value:(a==null?void 0:a.customer.firstname)+" "+(a==null?void 0:a.customer.lastname)}),e.jsx(We,{label:"Delivery",type:"currency",value:a==null?void 0:a.delivery_charge})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(We,{label:"Issued by",type:"string",value:(a==null?void 0:a.issued_by.firstname)+" "+(a==null?void 0:a.issued_by.lastname)}),e.jsx(We,{label:"Discount",type:"currency",value:a==null?void 0:a.total_discount})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(We,{label:"Reference number",type:"string",value:a!=null&&a.reference_no?a==null?void 0:a.reference_no:"N/A"}),e.jsx(We,{label:"Balance",type:"currency",value:a==null?void 0:a.balance_amount})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(We,{label:"Date issued",type:"string",value:`${Jt(a==null?void 0:a.created_at)} (${a==null?void 0:a.warehouse.code})`}),e.jsx(We,{label:"Paid amount",type:"string",value:`${ie(a==null?void 0:a.paid_amount)} (${i(a==null?void 0:a.payment_method)})`})]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:!c&&e.jsx(e.Fragment,{children:e.jsx(Ol,{items:l})})})]})})})},We=({type:t="string",label:s,value:a})=>{const r=l=>{switch(t){case"string":return l;case"number":return Number(l);case"date":return Jt(l);case"currency":return ie(l);default:return l}};return a!==void 0?e.jsxs("div",{className:"flex flex-1 gap-1",children:[e.jsxs("h3",{className:"font-extrabold",children:[s,":"]}),e.jsx("p",{children:r(a)})]}):null},Rl=(t,s)=>{const a=fe(),[r,l]=h.useState(""),[c,n]=h.useState(""),[i,o]=h.useState({firstname:t.firstname,lastname:t.lastname,username:t.username,email:t.email,contact_no:t.contact_no,position:t.position,user_id:t.id,role_id:0});h.useEffect(()=>{s&&o(k=>{var A;return{...k,role_id:(A=s.find(C=>C.title===t.position))==null?void 0:A.id}})},[s]);const[x,m]=h.useState(!1),[u,d]=h.useState(!1),[y,p]=h.useState(null),[N,j]=h.useState(null),f=(k,A)=>{m(!0),j(null),p(null),o(C=>({...C,[k]:A}))},g=k=>{m(!0),j(null),k.target.name==="position"?o(A=>{var C;return{...A,[k.target.name]:k.target.value,role_id:(C=s.find(W=>W.title===k.target.value))==null?void 0:C.id}}):k.target.name==="new_password"?l(k.target.value):k.target.name==="confirm_password"?n(k.target.value):o(A=>({...A,[k.target.name]:k.target.value}))};h.useEffect(()=>{r!=c?p("Passwords don't match"):p(null)},[r,c]);const v=async()=>{var k,A;((k=i.contact_no)==null?void 0:k.length)>11||((A=i.contact_no)==null?void 0:A.length)<11?p("Contact number must be 11 digits"):(d(!0),r!==""&&c!==""&&o(C=>({...C,password:c})))};h.useEffect(()=>{u&&_(i)},[i,u]);const I={onSuccess:async()=>{await a.invalidateQueries({queryKey:["users"]}),d(!1),m(!1),j("User info has been updated")},onError:k=>{console.error(k),p(k.message),d(!1)}},{mutateAsync:_}=Y({mutationKey:["editUser"],mutationFn:Ma,...I});return{user:i,isChanged:x,isSubmitting:u,password:r,compPassword:c,error:y,setError:p,success:N,handleSubmit:v,handleChangeSelect:f,handleChange:g,editUserMutation:_}},Ul=()=>{const t=fe(),{users:s}=Ge(),{roles:a}=Ge();s[s.length-1].id+1;const[r,l]=h.useState({});h.useEffect(()=>{l(v=>({...v,active_status:"active"}))},[]);const[c,n]=h.useState(!1),[i,o]=h.useState(!1),[x,m]=h.useState(null),[u,d]=h.useState(null),y=()=>{var _,k;const I=Object.keys(r).map(A=>({text:A})).length===10;if(I){const A=r.password===r.password_confirmation;if(!A)return[A,"Passwords do not match"];const C=!(((_=r.contact_no)==null?void 0:_.length)>11||((k=r.contact_no)==null?void 0:k.length)<11);return C?[I&&A&&C,""]:[C,"Please input a valid contact number"]}else{const A=!!r.position;return A?[I,"Please correctly fill up all fields"]:[A,"Please choose a position"]}},p=v=>{n(!0),d(null),m(null),l(I=>({...I,[v.target.name]:v.target.value}))},N=(v,I)=>{n(!0),d(null),m(null),l(_=>{var k;return{..._,[v]:I,role_id:(k=a.find(A=>A.title===I))==null?void 0:k.id}})},j=async()=>{const v=y();if(o(!0),v[0])return await g(r);m(v[1]),o(!1)},f={onSuccess:async()=>{await t.invalidateQueries({queryKey:["users"]}),o(!1),n(!1),d("User info has been added")},onError:v=>{console.error(v),m(v.response.data.message),o(!1)}},{mutateAsync:g}=Y({mutationKey:["addUser"],mutationFn:Wa,...f});return{user:r,isChanged:c,isSubmitting:i,error:x,setError:m,success:u,handleSubmit:j,handleChange:p,handleChangeSelect:N,addUserMutation:g}},Kl=()=>{const t=fe(),{roles:s,selectedUser:a}=Ge(),r=s.filter(K=>K.title===a.position),[l,c]=h.useState([]),[n,i]=h.useState([]),[o,x]=h.useState([]),{data:m}=vs({queryKey:["all-permissions"],queryFn:()=>yt(),refetchOnWindowFocus:!1});h.useEffect(()=>{const K=m;K&&i(K)},[m]);const{isFetching:u,data:d}=vs({queryKey:["permissions"],queryFn:()=>vt(r[0].id),refetchOnWindowFocus:!1});h.useEffect(()=>{const K=d;K&&(c(K),x(K))},[d]);const[y,p]=h.useState(!1),[N,j]=h.useState(!1),[f,g]=h.useState(null),[v,I]=h.useState(null),_=(K,M)=>{p(!0),I(null),g(null),x(K?[...o,{id:null,role_id:r,permission_id:M}]:o.filter(L=>L.permission_id!==M))},k=async()=>{if(j(!0),o.length>l.length){const K=o.filter(M=>M.id===null);if(K.length>1)K.forEach(async M=>{await C(M)});else return await C(K)}else if(o.length<l.length){const K=l.filter(M=>o.find(L=>L.permission_id===M.permission_id)===void 0);if(K.length>1)K.forEach(async M=>{await W(M)});else return await W(K[0])}else j(!1),p(!1),I("No changes made")},A={onSuccess:async()=>{await t.invalidateQueries({queryKey:["all-permissions"]}),j(!1),p(!1),I("Role permissions have been updated")},onError:K=>{console.error(K),g(K.message),j(!1)}},{mutateAsync:C}=Y({mutationKey:["addpermission"],mutationFn:bt,...A}),{mutateAsync:W}=Y({mutationKey:["deletepermission"],mutationFn:wt,...A});return{permissions:l,allPermissions:n,permissionChange:o,isChanged:y,isSubmitting:N,error:f,success:v,handleSubmit:k,handleChange:_}},Ll=()=>{const t=fe(),{roles:s}=Ge(),[a,r]=h.useState(),[l,c]=h.useState(0);h.useState();const[n,i]=h.useState([]),[o,x]=h.useState([]),[m,u]=h.useState([]),{data:d}=vs({queryKey:["all-permissions"],queryFn:()=>yt(),refetchOnWindowFocus:!1});h.useEffect(()=>{const M=d;M&&x(M)},[d]);const[y,p]=h.useState(!1),[N,j]=h.useState(!1),[f,g]=h.useState(null),[v,I]=h.useState(null),_=(M,L)=>{I(null),g(null),r(s.find(S=>S.title===L)),c(s.find(S=>S.title===L).id)};h.useEffect(()=>{async function M(){const L=await vt(l);i(L),u(L)}M()},[l]);const k=(M,L)=>{p(!0),I(null),g(null),u(M?[...m,{id:null,role_id:l,permission_id:L}]:m.filter(S=>S.permission_id!==L))},A=async()=>{if(j(!0),m.length>n.length){const M=m.filter(L=>L.id===null);if(M.length>1)M.forEach(async L=>{await W(L)});else return await W(M[0])}else if(m.length<n.length){const M=n.filter(L=>m.find(S=>S.permission_id===L.permission_id)===void 0);if(M.length>1)M.forEach(async L=>{await K(L)});else return await K(M[0])}else j(!1),p(!1),I("No changes made")},C={onSuccess:async()=>{await t.invalidateQueries({queryKey:["all-permissions"]}),j(!1),p(!1),I("Role permissions have been updated")},onError:M=>{console.error(M),g(M.message),j(!1)}},{mutateAsync:W}=Y({mutationKey:["addpermission"],mutationFn:bt,...C}),{mutateAsync:K}=Y({mutationKey:["deletepermission"],mutationFn:wt,...C});return{roles:s,roleSelect:a,permissions:n,allPermissions:o,permissionChange:m,roleId:l,isChanged:y,isSubmitting:N,error:f,success:v,handleSubmit:A,handleChange:k,handleChangeSelect:_}},ql=({openModal:t})=>{const{users:s,isFetching:a,progress:r,progress2:l,setSelectedUser:c}=Ge(),n=m=>{c(m),t(m,"edit")},i=m=>{c(m),t(m,"editPerms")},o=()=>{t({},"add")},x=[{accessorKey:"lastname",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{m.toggleSorting(m.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["LAST NAME ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.lastname})},{accessorKey:"firstname",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>m.toggleSorting(m.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["FIRST NAME ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.firstname})},{accessorKey:"position",sortingFn:"text",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>m.toggleSorting(m.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["ROLE ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.position})},{accessorKey:"username",header:()=>e.jsx("div",{className:"text-center",children:"USERNAME"}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.username})},{accessorKey:"email",header:()=>e.jsx("div",{className:"text-center",children:"EMAIL ADDRESS"}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.email})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:m})=>{const u=m.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>n(u),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit User"})]}),e.jsxs(B,{onClick:()=>i(u),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit User Permission"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:x,filterWhat:"username",dataType:"User",openModal:o,isLoading:a})})},Hl=({onClose:t})=>{const{user:s,isChanged:a,isSubmitting:r,error:l,setError:c,success:n,handleSubmit:i,handleChange:o,handleChangeSelect:x}=Ul(),{roles:m}=Ge(),u=m==null?void 0:m.filter(d=>d.title!=="super_admin");return u&&u.map(d=>d.title.replace("_"," ")),n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:d=>{d.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User ID"}),e.jsx(Q,{name:"id",value:s.id,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User First Name"}),e.jsx(Q,{name:"firstname",placeholder:"User First Name",value:s.firstname||"",onChange:o,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Last Name"}),e.jsx(Q,{name:"lastname",placeholder:"User Last Name",value:s.lastname||"",onChange:o,required:!0})]})]}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Email Address"}),e.jsx(Q,{name:"email",placeholder:"User Email Address",type:"email",value:s.email||"",onChange:o,onKeyDown:d=>{d.code==="Space"?(d.preventDefault(),c("Space not allowed")):c(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Contact Number"}),e.jsx(Q,{name:"contact_no",placeholder:"User Contact Number",type:"number",value:s.contact_no||"",onChange:o,onKeyDown:d=>{d.code==="Space"?(d.preventDefault(),c("Space not allowed")):c(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Position"}),e.jsxs(J,{onValueChange:d=>x("position",d),children:[e.jsx(ee,{name:"position",className:"flex flex-row items-center gap-3 truncate text-md rounded-md bg-slate-100",children:e.jsx(se,{placeholder:s.position?s.position.charAt(0).toUpperCase()+s.position.slice(1):"Choose position..."})}),e.jsx(te,{className:"bg-white font-medium text-md",children:m.length>0?m.map(d=>{if(d.title!=="super_admin")return e.jsx(V,{value:d.title,children:d.title.charAt(0).toUpperCase()+d.title.slice(1).replace("_"," ")},d.id)}):e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]})]}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Username"}),e.jsx(Q,{name:"username",placeholder:"User Username",type:"string",value:s.username||"",onChange:o,onKeyDown:d=>{d.code==="Space"?(d.preventDefault(),c("Space not allowed")):c(null)},required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"User Password"}),e.jsx(Q,{name:"password",placeholder:"User Password",type:"password",value:s.password||"",onChange:o,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Confirm Password"}),e.jsx(Q,{name:"password_confirmation",placeholder:"Confirm Password",type:"password",value:s.password_confirmation||"",onChange:o,required:!0})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),l&&e.jsx("div",{className:"font-bold text-red-700",children:l}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),a&&e.jsx(b,{type:"submit",fill:"green",onClick:i,children:r?"Submitting":"Add User"})]})})]})})]})})})},Vl=({onClose:t})=>{const{selectedUser:s,roles:a}=Ge(),{auth:r}=oe(),{user:l,isChanged:c,isSubmitting:n,password:i,compPassword:o,error:x,setError:m,success:u,handleSubmit:d,handleChange:y,handleChangeSelect:p}=Rl(s,a),[N,j]=h.useState(!1),f=()=>{j(!N)},[g,v]=h.useState(!1),I=()=>{v(!g)};return u&&setTimeout(()=>{t()},1e3),e.jsxs(e.Fragment,{children:[s.id===r.user.id&&e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-6 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-6 font-bold text-red-700 text-start",children:["Warning: Be careful! You are editing your own account.",e.jsx("br",{}),"You are at risk of locking yourself out."]})}),e.jsx("form",{onSubmit:async _=>{_.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"id",children:"User ID"}),e.jsx(Q,{type:"text",name:"id",placeholder:"User ID",className:"inputbox",value:l.user_id,disabled:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"First name"}),e.jsx(Q,{type:"text",name:"firstname",placeholder:"First name",className:"inputbox rounded-md bg-slate-100",value:l.firstname,onChange:y})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Last name"}),e.jsx(Q,{type:"text",name:"lastname",placeholder:"Last name",className:"inputbox rounded-md bg-slate-100",value:l.lastname,onChange:y})]}),e.jsxs("div",{className:"flex flex-col col-span-3 gap-3",children:[e.jsx("label",{htmlFor:"username",children:"Username"}),e.jsx(Q,{type:"text",name:"username",placeholder:"Username",className:"inputbox rounded-md bg-slate-100",value:l.username,onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Email address"}),e.jsx(Q,{type:"email",name:"email",placeholder:"Email address",className:"inputbox rounded-md bg-slate-100",value:l.email,onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Contact number"}),e.jsx(Q,{type:"number",name:"contact_no",placeholder:"09XXXXXXXXX",className:"inputbox rounded-md bg-slate-100",value:l.contact_no,onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"position",children:"Position"}),e.jsxs(J,{onValueChange:_=>p("position",_),children:[e.jsx(ee,{name:"position",className:"flex flex-row items-center gap-3 truncate text-md rounded-md bg-slate-100",children:e.jsx(se,{placeholder:l.position?l.position.charAt(0).toUpperCase()+l.position.slice(1):"Choose position..."})}),e.jsx(te,{className:"bg-white font-medium text-md",children:a.length>0?a.map(_=>{if(_.title!=="super_admin")return e.jsx(V,{value:_.title,children:_.title.charAt(0).toUpperCase()+_.title.slice(1)},_.id)}):e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-6 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Change password (optional)"}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx(Q,{type:N?"text":"password",name:"new_password",placeholder:"New pasword",className:"inputbox rounded-md bg-slate-100",value:i||"",onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}}),N?e.jsx(lt,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:f}):e.jsx(rt,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:f})]})]}),e.jsxs("div",{className:"flex flex-col col-span-6 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Confirm new password"}),e.jsxs("div",{className:"flex flex-row",children:[e.jsx(Q,{type:g?"text":"password",name:"confirm_password",placeholder:"Confirm password",className:"inputbox rounded-md bg-slate-100",value:o,onChange:y,onKeyDown:_=>{_.code==="Space"?(_.preventDefault(),m("Space not allowed")):m(null)}}),g?e.jsx(lt,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:I}):e.jsx(rt,{size:26,strokeWidth:1,className:"relative flex flex-row mt-2 cursor-pointer",onClick:I})]})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[u&&e.jsx("div",{className:"font-bold text-green-700",children:u}),x&&e.jsx("div",{className:"font-bold text-red-700",children:x}),n?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),c&&i===o&&e.jsx(b,{type:"submit",fill:c?"green":null,disabled:!c,onClick:d,children:n?"Submitting":"Edit User"})]})})]})})]})})]})},$l=({onClose:t})=>{const{selectedUser:s}=Ge(),{permissions:a,allPermissions:r,permissionChange:l,isChanged:c,isSubmitting:n,error:i,success:o,handleChange:x,handleSubmit:m}=Kl(),{auth:u}=oe(),d=r.filter(j=>Object.keys(j).some(f=>!j.title.includes("view".toLowerCase())&&j.title.includes("users".toLowerCase()))),y=r.filter(j=>Object.keys(j).some(f=>!j.title.includes("view".toLowerCase())&&!j.title.includes("transfer".toLowerCase())&&j.title.includes("product".toLowerCase())||j.title.includes("catalog".toLowerCase()))),p=r.filter(j=>Object.keys(j).some(f=>!j.title.includes("view".toLowerCase())&&j.title.includes("transfer".toLowerCase()))),N=r.filter(j=>Object.keys(j).some(f=>j.title.includes("view".toLowerCase())));return o&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto flex h-72 w-full flex-row divide-x",children:[e.jsxs("div",{className:"flex w-60 flex-none flex-col p-2 pt-8",children:[e.jsx("h3",{className:"ml-4 pb-1 text-xs font-semibold text-slate-500/80",children:"Roles"}),e.jsx("div",{className:"w-full",children:e.jsx(F,{variant:"ghost",className:"w-full justify-start capitalize text-slate-700 bg-slate-300/40",children:s.position.split("_").join(" ")},s.id+s.position)}),e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-slate-500/80",children:"After saving changes, affected users must log out and log back in to apply the changes."}),s.position===u.role&&e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-red-500/80",children:"You are editing your current role. Review your changes carefully."}),e.jsxs("div",{className:"mt-auto w-full space-y-3",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[o&&e.jsx("p",{className:"text-green-600",children:o}),i&&e.jsx("p",{className:"text-red-600",children:i})]}),c&&e.jsx(F,{type:"submit",className:"w-full disabled:cursor-not-allowed",disabled:!!n,onClick:m,children:n?"Saving...":"Save changes"})]})]}),e.jsx(Re,{className:"w-full",type:"auto",style:{"--border":"216 12% 84%"},children:e.jsxs("div",{className:`mx-auto flex w-full max-w-[700px] flex-1 flex-col gap-8 p-6 pt-8 ${n?"pointer-events-none opacity-50":null}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"User Management"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:d.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):d.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:`${s.position!=="admin"&&"cursor-pointer"} text-sm capitalize text-slate-700`,children:j.title.split("_").join(" ")}),e.jsx(Ve,{id:j.title,name:j.title,value:j.id,disabled:s.position==="admin",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:l.some(f=>f.permission_id===j.id),onCheckedChange:f=>x(f,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Products"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:y.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):y.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(Ve,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:l.some(f=>f.permission_id===j.id),onCheckedChange:f=>x(f,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Transfers"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:p.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):p.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(Ve,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:l.some(f=>f.permission_id===j.id),onCheckedChange:f=>x(f,j.id)})]},j.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Views"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:N.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):N.map(j=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:j.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:j.title.split("_").join(" ")}),e.jsx(Ve,{id:j.title,name:j.title,value:j.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:l.some(f=>f.permission_id===j.id),onCheckedChange:f=>x(f,j.id)})]},j.id))})]})]})})]})})},fc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"User Information",children:e.jsxs(_t,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(ql,{openModal:c})})}),e.jsx(ue,{isOpen:t,onClose:a,title:r==="edit"?"Edit User":r==="add"?"Add User":"Edit User Role Permissions",children:e.jsxs(e.Fragment,{children:[r==="add"&&e.jsx(Hl,{onClose:a}),r==="edit"&&e.jsx(Vl,{onClose:a}),r==="editPerms"&&e.jsx($l,{onClose:a})]})})]})})})},Bl=()=>{const t=fe(),{selectedSupplier:s,setSelectedSupplier:a}=St(),[r,l]=h.useState({});h.useEffect(()=>{s&&l(s)},[s]);const[c,n]=h.useState({}),[i,o]=h.useState(!1),[x,m]=h.useState(!1),[u,d]=h.useState(null),[y,p]=h.useState(null),N=k=>{var A,C,W,K;if(k){const M=Object.keys(r).map(S=>({text:S})),L=M.length===3||M.length>3;if(L){const S=!(((A=r.contact_no)==null?void 0:A.length)>11||((C=r.contact_no)==null?void 0:C.length)<11);return S?[S,""]:[S,"Contact number must be 11 digits"]}else return[L,"Please fill up all fields"]}else{const M=Object.keys(c).map(S=>({text:S})),L=M.length===3||M.length>3;if(L){const S=!(((W=c.contact_no)==null?void 0:W.length)>11||((K=c.contact_no)==null?void 0:K.length)<11);return S?[S,""]:[S,"Contact number must be 11 digits"]}else return[L,"Please fill up all fields"]}},j=(k,A)=>{o(!0),p(null),d(null),A?l(C=>({...C,[k.target.name]:k.target.value})):n(C=>({...C,[k.target.name]:k.target.value}))},f=async k=>{const A=N(k);if(m(!0),A[0])return k?await v(r):await _(c);d(A[1]),m(!1),console.log(c)},g={onSuccess:async()=>{await t.invalidateQueries({queryKey:["supplier"]}),m(!1),o(!1),p("Supplier info has been edited")},onError:k=>{console.error(k),d(k.message),m(!1)}},{mutateAsync:v}=Y({mutationKey:["updateSupplier"],mutationFn:Oa,...g}),I={onSuccess:async()=>{await t.invalidateQueries({queryKey:["supplier"]}),m(!1),o(!1),p("Supplier info has been added")},onError:k=>{console.error(k),d(k.message),m(!1)}},{mutateAsync:_}=Y({mutationKey:["addSupplier"],mutationFn:Ra,...I});return{supplier:r,selectedSupplier:s,newSupplier:c,isChanged:i,isSubmitting:x,error:u,success:y,handleSubmit:f,handleChange:j,editSupplierMutation:v}},Ql=({onClose:t,isUpdate:s})=>{const{supplier:a,newSupplier:r,isSubmitting:l,error:c,success:n,isChanged:i,handleChange:o,handleSubmit:x}=Bl();return n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:m=>{m.preventDefault()},children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"name",children:"Supplier Name"}),e.jsx(Q,{type:"text",name:"name",placeholder:"Supplier Name",value:s?a.name||"":r.name||"",className:"inputbox rounded-md bg-slate-100",onChange:m=>o(m,s),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"contact_no",children:"Supplier Contact Number"}),e.jsx(Q,{type:"text",name:"contact_no",placeholder:"Supplier Contact Number",className:"inputbox rounded-md bg-slate-100",value:s?a.contact_no||"":r.contact_no||"",onChange:m=>o(m,s),required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"address",children:"Supplier Address"}),e.jsx(Q,{type:"text",name:"address",placeholder:"Supplier Address",className:"inputbox rounded-md bg-slate-100",value:s?a.address||"":r.address||"",onChange:m=>o(m,s),required:!0})]})]}),e.jsx("div",{className:"flex flex-col mt-4 gap-5",children:e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),c&&e.jsx("div",{className:"font-bold text-red-700",children:c}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:i?"green":"default",disabled:!i,onClick:()=>x(s),children:l?"Submitting":s?"Edit Supplier":"Add Supplier"})]})})]})})})]})})},Yl=({openModal:t})=>{const{suppliers:s,isFetching:a,progress:r,setSelectedSupplier:l}=St(),c=()=>{t({},"add")},n=o=>{l(o),t(o,"edit")},i=[{accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:o})=>e.jsx("div",{className:"text-center",children:e.jsxs(b,{onClick:()=>o.toggleSorting(o.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row ml-auto mr-auto items-center",children:["NAME ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.name})},{accessorKey:"contact_no",header:()=>e.jsx("div",{className:"text-center",children:"CONTACT NUMBER"}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.contact_no})},{accessorKey:"address",header:()=>e.jsx("div",{className:"text-center",children:"ADDRESS"}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.address})},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"ACTION"}),cell:({row:o})=>{const x=o.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(b,{fill:"empty",textColor:"black",onClick:()=>n(x),className:"flex flex-row items-center gap-2",children:[e.jsx(at,{})," Edit"]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:i,filterWhat:"address",dataType:"Supplier",openModal:c,isLoading:a})})},jc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Supplier",children:e.jsxs(Ua,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Yl,{openModal:c})})}),e.jsx(ue,{isOpen:t,onClose:a,title:r==="edit"?"Edit Supplier":"Add Supplier",children:e.jsx(e.Fragment,{children:e.jsx(Ql,{onClose:a,isUpdate:r==="edit"})})})]})})})},Gl=({handleEditProduct:t,handleDeleteProduct:s})=>[{accessorKey:"serial_no",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Serial Number"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{id:"name",accessorKey:"name",sortingFn:"text",enableSorting:!0,header:({column:r})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>r.toggleSorting(r.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",r.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):r.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"notes",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Notes"})},{id:"actions",cell:({row:r})=>{const l=r.original;return e.jsx("div",{className:"flex flex-row justify-end text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>t(l),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{className:"font-medium",children:"Edit"})]}),e.jsxs(B,{onClick:()=>s(l),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-red-50 hover:text-red-700 focus:bg-red-50 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(is,{size:16,strokeWidth:2.25})}),e.jsx("span",{className:"font-medium",children:"Delete"})]})]})]})})},enableGlobalFilter:!1}],Xl=({handleProdPriceDetails:t,handleEditProdPrice:s,handleDeleteProdPrice:a})=>[{id:"name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"inventory_product.inventory.code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Inventory"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Capital"}),cell:({row:l})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:l.original.capital_price?c:"—"})})}},{accessorKey:"markup_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Markup"}),cell:({row:l})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.markup_price||0),n=re(l.original.markup_price/l.original.capital_price*100,{precision:3}).value;return e.jsxs("div",{className:"flex items-center uppercase",children:[e.jsx("span",{children:c}),e.jsxs("span",{className:"text-gray-500",children:[" (",n,"%)"]})]})}},{accessorKey:"sale_discount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Discount"}),cell:({row:l})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.sale_discount||0);return e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:l.original.on_sale?c:e.jsx("div",{className:"group relative flex w-fit items-center",children:e.jsxs(Ue,{children:[e.jsx(Ke,{children:e.jsx(Cs,{size:20,strokeWidth:2,className:"text-gray-700"})}),e.jsx(Le,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:"Not on sale"})})]})})})})}},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Price"}),cell:({row:l})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:l.original.price?c:"—"})})}},{accessorKey:"inventory_product.remaining_stocks_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Remaining"}),cell:({row:l})=>{const c=l.original.inventory_product.remaining_stocks_count??0,n=l.original.inventory_product.stocks_count*.2,i=l.original.inventory_product.stocks_count*.5;return e.jsxs(Ue,{children:[e.jsx(Ke,{children:e.jsx("span",{className:`${n>=c?"font-bold text-red-700":i>=c?"font-semibold text-amber-700":""}`,children:c})}),e.jsx(Le,{children:n>=c?"Remaining stocks are low!":i>=c?"Remaining stocks are below 50%":"Remaining stocks are above 50%"})]})}},{id:"actions",cell:({row:l})=>{const c=l.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>t(c),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>s(c),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>a(c),className:"flex flex-row items-center gap-3 rounded-md p-2 focus:bg-red-100 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(is,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Delete"})]})]})]})})},enableGlobalFilter:!1}],Zl=({openModal:t})=>{const{auth:s}=oe(),{data:a,isLoading:r,setSelectedProduct:l}=Vs(),c=()=>{t({},"add")},n=o=>{l(o),t(o,"edit")},i=o=>{l(o),t(o,"delete")};return e.jsx(e.Fragment,{children:e.jsx(X,{columns:(s==null?void 0:s.role)==="super_admin"||(s==null?void 0:s.role)==="admin"?Gl({handleEditProduct:n,handleDeleteProduct:i}):vl,data:a.sort((o,x)=>x.id-o.id),filterWhat:"name",dataType:"Product",openModal:c,isLoading:r})})},Jl=({openModal:t,isModalOpen:s,filterWarehouse:a})=>{const{data:r,isLoading:l,setSelectedProductPrice:c}=ms(),n=x=>{c(x),t(x,"details")},i=x=>{c(x),t(x,"edit")},o=x=>{c(x),t(x,"delete")};return e.jsx(e.Fragment,{children:e.jsx(Xe,{children:e.jsx(X,{columns:Xl({handleProdPriceDetails:n,handleEditProdPrice:i,handleDeleteProdPrice:o}),data:a?r.filter(x=>x.warehouse.id===a).sort((x,m)=>{let u=new Date(x.updated_at??x.created_at);return new Date(m.updated_at??m.created_at).getTime()-u.getTime()}):r.sort((x,m)=>{let u=new Date(x.updated_at??x.created_at);return new Date(m.updated_at??m.created_at).getTime()-u.getTime()}),filterWhat:"name",dataType:"Listing",isLoading:l})})})},er=()=>{const{selectedProductPrice:t}=ms();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Unit"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.inventory_product.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Inventory"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.inventory_product.inventory.code})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Capital price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup percent"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[re(t.markup_price/t.capital_price*100,{precision:3}).value,"%"]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.markup_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Cost"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.cost)})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sale discount"}),e.jsx("p",{className:"text-sm",children:t.on_sale===1?Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.sale_discount):"—"}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex flex-none flex-row items-center justify-end gap-1 pb-[0.1rem] pr-1",children:[t.on_sale===1?e.jsx($e,{size:14,strokeWidth:3.5,className:"text-green-600"}):e.jsx(Cs,{size:14,strokeWidth:3.5,className:"text-gray-600"}),e.jsx("div",{className:"text-xs font-semibold leading-4 text-gray-900",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.price)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.created_by.firstname+" "+t.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(t.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(t.updated_at)})]})]})]})})},rs=(t,s,a=2)=>re(s/t*100,{precision:a}).value,Us=(t,s,a=2)=>re(re(t).multiply(s/100),{precision:a}).value,_s=(t,s,a=2)=>re(re(t).add(s),{precision:a}).value,ca=(t,s,a=2)=>re(re(t).subtract(s),{precision:a}).value,sr=({onClose:t})=>{const{selectedProductPrice:s}=ms(),{deleteProductPricesMutation:a}=Ps(),[r,l]=h.useState(!1),c=()=>{l(!0),a(s.id).then(n=>{R.success(n.message),t()}).catch(n=>{R.error(n.message?n.message:"Failed to delete product listing.")}).finally(()=>{l(!1)})};return e.jsxs("div",{className:"flex max-w-md flex-col gap-4",children:[e.jsxs("h2",{className:"text-sm font-medium text-slate-800",children:["Are you sure you would like to delete this item? This action"," ",e.jsx("strong",{children:"cannot"}),"  be undone."]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||"No brand"})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:s.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsx("p",{className:"text-sm",children:s.warehouse.code})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.price)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Markup Price"}),e.jsx("p",{className:"text-sm",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.markup_price)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx("p",{className:"text-sm",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.price)})]})]}),e.jsxs("div",{className:"mt-4 flex flex-row justify-end gap-4",children:[e.jsx(b,{fill:"red",type:"submit",onClick:c,disabled:r,className:"py-2 text-sm font-bold disabled:cursor-not-allowed disabled:opacity-50",children:r?"Deleting...":"Yes, delete"}),e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),disabled:r,className:"py-2 text-sm font-bold text-slate-700 hover:text-white disabled:cursor-not-allowed disabled:opacity-50",children:"No, cancel"})]})]})},tr=({onClose:t})=>{const{value:s,handleChange:a,handleSubmit:r}=Zt(),{selectedProduct:l}=Vs(),[c,n]=h.useState(!1),[i,o]=h.useState(null),[x,m]=h.useState(),u=(d,y,p,N)=>{p.test(d.target.value)?(d.target.value=d.target.value,a(y,d.target.value),m(void 0)):m({type:y,error:N})};return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async d=>{n(!c),d.preventDefault(),r({action:"update",id:l.id,data:s}).then(()=>{n(!1),R.success("Product updated successfully."),t()}).catch(y=>{n(!1),y.response.data.message?R.error(y.response.data.message):R.error("Failed to update product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"serial_no",className:"text-sm font-bold text-gray-600",children:"Serial number"}),e.jsx(P,{id:"serial_no",name:"serial_no",type:"text",maxLength:100,required:!0,placeholder:"Serial number...",value:s.serial_no!==void 0?s.serial_no:(l==null?void 0:l.serial_no)||"",onChange:d=>{u(d,"serial_no",/^[a-zA-Z0-9-]{0,100}$/,"Must only contain A-Z, 0-9, and -")}}),e.jsx("span",{hidden:!(x&&x.type==="serial_no"),className:"text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"name",className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx(P,{id:"name",name:"name",type:"text",maxLength:100,required:!0,placeholder:"Product name...",value:s.name!==void 0?s.name:(l==null?void 0:l.name)||"",onChange:d=>{u(d,"name",/^[0-9a-zA-Z\s\-.,/+:_=]{0,100}$/,"Must only contain alphanumeric and limited special characters")}})," ",e.jsx("span",{hidden:!(x&&x.type==="name"),className:"max-w-[225px] text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"brand",className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx(P,{id:"brand",name:"brand",type:"text",maxLength:100,required:!0,placeholder:"Brand...",value:s.brand!==void 0?s.brand:(l==null?void 0:l.brand)||"",onChange:d=>{u(d,"brand",/^[0-9a-zA-Z\s\-.,/+:_=]{0,100}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(x&&x.type==="brand"),className:"max-w-[225px] text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsx("hr",{className:"col-span-12 my-3 border-t border-slate-200"}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"size",className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx(P,{id:"size",name:"size",type:"text",maxLength:100,required:!0,placeholder:"e.g. medium...",value:s.size!==void 0?s.size:(l==null?void 0:l.size)||"",onChange:d=>{u(d,"size",/^[0-9a-zA-Z\s\-.,/+:_="']{0,100}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(x&&x.type==="size"),className:"max-w-[225px] text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"color",className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx(P,{id:"color",name:"color",type:"text",maxLength:40,required:!0,placeholder:"e.g. white...",value:s.color!==void 0?s.color:(l==null?void 0:l.color)||"",onChange:d=>{u(d,"color",/^[0-9a-zA-Z\s\-.,/+:_="']{0,40}$/,"Must only contain alphanumeric and limited special characters")}}),e.jsx("span",{hidden:!(x&&x.type==="color"),className:"max-w-[225px] text-xs font-bold text-red-600",children:x==null?void 0:x.error})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-start gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(P,{id:"notes",name:"notes",type:"text",placeholder:"Type product notes here...",defaultValue:s.notes!==void 0?s.notes:(l==null?void 0:l.notes)||"",onBlur:d=>a("notes",d.target.value)})]})]}),e.jsxs("div",{className:"ml-auto flex flex-row gap-4 whitespace-nowrap",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:c||x!==void 0||s.name===""||s.serial_no==="",className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Applying...":"Apply changes"})]}),i&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:i})})]})})})},ar=({onClose:t})=>{const{selectedProduct:s,setSelectedProduct:a,isDeletable:r}=Vs(),{handleDeleteProduct:l}=Zt();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[42rem] max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"col-span-8 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:(s==null?void 0:s.brand)||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.color})]}),(s==null?void 0:s.notes)&&e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s==null?void 0:s.notes})]})]}),e.jsx("hr",{className:"h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("p",{className:`max-w-[50%] text-sm ${r!==void 0&&!r&&"text-red-700"}`,children:r!==void 0?r?"This product can be deleted. Are you sure you want to proceed? This action cannot be undone.":"This product cannot be deleted because it is associated with existing product price and inventory items.":"Checking if the product can be deleted..."}),e.jsxs("div",{className:"mt-auto flex-none space-x-4",children:[r&&e.jsx(b,{className:"flex-1 cursor-pointer bg-red-600 py-2 text-sm font-bold text-white hover:bg-red-700 disabled:pointer-events-none disabled:opacity-50",disabled:!r,onClick:()=>{s&&l(s.id).then(()=>{R.success("Product deleted successfully."),a(void 0),t()}).catch(()=>{R.error("An error occurred while deleting the product.")})},children:"Yes, delete"}),e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:r?"No, cancel":"Close"})]})]})]})})},gc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Products",children:e.jsxs(Ct,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Zl,{openModal:c})})}),e.jsx(ue,{isOpen:t,onClose:a,closeOnOverlayClick:r==="delete",title:r==="add"?"Add Product":r==="edit"?"Edit Product":r==="delete"?"Delete Product":"",children:e.jsxs(e.Fragment,{children:[r==="add"&&e.jsx(bl,{onClose:a}),r==="edit"&&e.jsx(tr,{onClose:a}),r==="delete"&&e.jsx(ar,{onClose:a})]})})]})})})},lr=({onClose:t})=>{var N,j;const{selectedProductPrice:s}=ms(),{value:a,handleChange:r,handleSubmit:l}=Ps(),[c,n]=h.useState(!1),[i,o]=h.useState(null),[x,m]=h.useState(rs(s.capital_price,s.markup_price,3)),[u,d]=h.useState(s.markup_price),y=f=>{const g=Number(f.target.value);m(g),d(Us(s.capital_price,g))},p=f=>{const g=re(f.target.value).value;d(g),m(rs(s.capital_price,g,3))};return h.useEffect(()=>{r("markup_price",u),r("cost",_s(s.capital_price,u))},[x,u]),h.useEffect(()=>{r("price",ca(a.cost??s.cost,a.sale_discount??s.sale_discount))},[a.cost,a.sale_discount]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async f=>{n(!c),f.preventDefault(),l({action:"update",id:s.id,data:a}).then(()=>{n(!c),R.success("Product price edited successfully"),t()}).catch(()=>{n(!c),o("Failed to add product listing"),R.error("Failed to add product listing")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-4 gap-y-5 font-medium text-gray-700",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:s.inventory_product.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Inventory"}),e.jsx("p",{className:"text-sm",children:s.inventory_product.inventory.code})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(P,{id:"capital_price",name:"capital_price",type:"number",disabled:!0,className:"pl-7",value:re(s.capital_price).value}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_percent",className:"text-sm font-bold text-gray-600",children:"Markup percent"}),e.jsx(P,{id:"markup_percent",name:"markup_percent",type:"number",inputMode:"numeric",min:0,step:.001,required:!0,value:x||"",onChange:y,onBlur:f=>{if(f.target.value===""||f.target.value==="0")m(0),d(0);else{const v=Math.round((s.capital_price+s.capital_price*(Number(f.target.value)/100))*2)/2-s.capital_price;d(re(v).value),m(rs(s.capital_price,v,3))}}}),e.jsx("span",{className:"absolute bottom-0 right-0 mr-2 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"%"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_price",className:"text-sm font-bold text-gray-600",children:"Markup price"}),e.jsx(P,{id:"markup_price",name:"markup_price",type:"number",min:0,step:.01,className:"pl-7",value:u||"",onChange:p,onBlur:f=>{if(f.target.value===""||f.target.value==="0")d(0),m(0);else{const v=Math.round((s.capital_price+Number(f.target.value))*2)/2-s.capital_price;d(re(v).value),m(rs(s.capital_price,v,3))}}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"cost",className:"text-sm font-bold text-gray-600",children:"Cost"}),e.jsx(P,{id:"cost",name:"cost",type:"number",min:0,required:!0,className:"pl-7",readOnly:!0,value:_s(s.capital_price,u).toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"sale_discount",className:"text-sm font-bold text-gray-600",children:"Sale discount"}),e.jsx(P,{id:"sale_discount",name:"sale_discount",type:"number",inputMode:"numeric",min:0,step:.01,max:a.cost!==void 0?a.cost:s.cost,disabled:a.on_sale===void 0?s.on_sale===0:a.on_sale===0,required:!0,className:"pl-7",value:a.sale_discount??((N=s.sale_discount)==null?void 0:N.toFixed(2))??"",onChange:f=>{r("sale_discount",re(f.target.value).value)},onBlur:f=>{f.target.value=Number(a.sale_discount!==void 0?a.sale_discount:s.sale_discount).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"}),e.jsxs("div",{className:"absolute right-0 top-1/2 mr-2 flex flex-none translate-y-1/4 flex-row items-center justify-start gap-2",children:[e.jsx(P,{name:"on_sale",id:"on_sale",type:"checkbox",checked:a.on_sale===void 0?s.on_sale===1:a.on_sale===1,className:"h-4 w-fit",onChange:f=>{const g=document.getElementById("sale_discount");r("on_sale",f.target.checked?1:0),!f.target.checked&&(r("sale_discount",0),g&&(g.value="0.00"))}}),e.jsx(w,{htmlFor:"on_sale",className:"text-xs font-bold text-slate-700",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"price",className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx(P,{id:"price",name:"price",type:"number",min:0,step:.01,required:!0,readOnly:!0,className:"pl-7",value:((j=a.price)==null?void 0:j.toFixed(2))||s.price.toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm",children:ne(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm",children:ne(s.updated_at)})]})]}),e.jsx("div",{className:"col-span-12 flex w-full justify-between whitespace-nowrap pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:c,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Applying changes...":"Apply changes"})]})}),i&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:i})})]})})})},Nc=()=>{const{warehouses:t}=ts(),[s,a]=h.useState(0),{isOpen:r,openModal:l,closeModal:c}=de(),[n,i]=h.useState(""),o=(x,m)=>{i(m),l()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Product Listings",children:e.jsx(Ct,{children:e.jsxs(Nt,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:x=>a(Number(x)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx(V,{value:"0",children:"All"},"all"),t.map(x=>e.jsxs(V,{value:x.id.toString(),children:[x.name," (",x.code,")"]},x.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Jl,{openModal:o,isModalOpen:r,filterWarehouse:s>0?s:void 0})})]}),e.jsx(ue,{title:n==="details"?"Listing Details":n==="edit"?"Edit Listing":n==="delete"?"Delete Listing":"",isOpen:r,onClose:c,closeOnOverlayClick:n==="details",children:e.jsxs(e.Fragment,{children:[n==="details"&&e.jsx(er,{}),n==="edit"&&e.jsx(lr,{onClose:c}),n==="delete"&&e.jsx(sr,{onClose:c})]})})]})})})})},rr=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:r,setSelectedTransfer:l}=Ie();oe(),De();function c(u){window.api.transferSend({transfer:u,products:a.filter(d=>d.transfer_id===u.id)})}const n=u=>{l(u),t(u,"details")},i=u=>{l(u),t(u,"edit")},o=u=>{l(u),t(u,"products")},x=()=>{t({},"add")},m=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["TRANSFER CODE"," ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>e.jsx("div",{className:"text-center",children:u.original.code?u.original.code:"N/A"})},{accessorKey:"source",header:()=>e.jsx("div",{className:"text-center",children:"SOURCE-DESTINATION"}),cell:({row:u})=>{const d=u.original.source,y=u.original.destination;return e.jsxs("div",{className:"text-center",children:[d.code,"-",y.code]})}},{id:"transfer_products",header:()=>e.jsx("div",{className:"text-center",children:"PRODUCTS ADDED?"}),cell:()=>e.jsx("div",{className:"flex justify-center",children:a.length>0?e.jsx($e,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(ss,{size:20,strokeWidth:2,className:"text-red-600"})})},{accessorKey:"transfer_status",sortingFn:"text",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["TRANSFER STATUS"," ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>e.jsx("div",{className:"text-center",children:u.original.transfer_status?u.original.transfer_status:"N/A"})},{accessorKey:"transfer_schedule",sortingFn:"datetime",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["SCHEDULE"," ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>{const d=u.getValue("transfer_schedule");if(d.toString()!=="0000-00-00"){const y={year:"numeric",month:"long",day:"numeric"},p=new Date(d).toLocaleDateString([],y);return e.jsx("div",{className:"text-center",children:p})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"date_received",enableSorting:!0,header:({column:u})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>u.toggleSorting(u.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["DATE RECEIVED"," ",u.getIsSorted()==="asc"?e.jsx(D,{}):u.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:u})=>{const d=u.getValue("date_received");if(d){const y={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},p=new Date(d).toLocaleDateString([],y);return e.jsx("div",{className:"text-center",children:p})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"approval_status",header:()=>e.jsx("div",{className:"text-center",children:"APPROVAL STATUS"}),cell:({row:u})=>e.jsx("div",{className:"mx-auto flex items-center justify-center",children:u.original.approval_status.toLowerCase()==="approved"?e.jsx($e,{size:20,strokeWidth:2,className:"text-green-600"}):u.original.approval_status.toLowerCase()==="rejected"?e.jsx(ss,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(as,{size:20,strokeWidth:2,className:"text-amber-500"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:u})=>{const d=u.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>n(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Details"})]}),e.jsxs(B,{onClick:()=>i(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit Transfer"})]}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>o(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:d.transfer_status!="arrived"&&d.approval_status!="rejected"?e.jsx(be,{size:16,strokeWidth:2.25}):e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Products"})]}),d.transfer_status=="enroute"||d.transfer_status=="arrived"&&e.jsxs(B,{onClick:()=>c(d),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(na,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Print Transfer"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:m,filterWhat:"approval_status",dataType:"Transfer",openModal:x,isLoading:r})})},nr=({onClose:t})=>{const{selectedTransfer:s}=Ie();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Source"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.source.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.destination.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer schedule"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_schedule.toString()==="0000-00-00 00:00:00"?"N/A":ne(s.transfer_schedule)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Received by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.received_by?s.received_by.firstname+" "+s.received_by.lastname:"N/A"})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Date received"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.date_received?ne(s.date_received):"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approved_by?s.approved_by.firstname+" "+s.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(s.updated_at)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.notes?s.notes:"N/A"})]})})]})})},cr=()=>{var a,r;const{newTransfer:t,handleChange:s}=qe();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-span-5 flex flex-col gap-1",children:[e.jsx(w,{htmlFor:"source",className:"text-sm font-bold text-slate-800",children:"Source"}),e.jsxs(J,{name:"source",value:((a=t.source)==null?void 0:a.toString())??"",onValueChange:l=>{s("source",Number(l)),s("destination",l==="1"?2:1)},required:!0,children:[e.jsx(ee,{name:"source",id:"source",className:"flex flex-row items-center gap-3 truncate bg-white text-sm font-medium",children:e.jsx(se,{placeholder:"Select warehouse..."})}),e.jsxs(te,{className:"text-sm font-medium text-slate-700",children:[e.jsx(V,{value:"1",children:"Cagayan de Oro"}),e.jsx(V,{value:"2",children:"Iligan"})]})]})]}),e.jsx("div",{className:"col-span-1 mt-3 flex h-full items-center justify-center",children:e.jsx(Pl,{size:20,strokeWidth:2,className:"text-slate-800"})}),e.jsxs("div",{className:"col-span-5 flex flex-col gap-1",children:[e.jsx(w,{htmlFor:"destination",className:"text-sm font-bold text-slate-800",children:"Destination"}),e.jsxs(J,{name:"destination",value:((r=t.destination)==null?void 0:r.toString())??"",onValueChange:l=>{s("destination",Number(l)),s("source",l==="1"?2:1)},required:!0,children:[e.jsx(ee,{name:"destination",id:"destination",className:"flex flex-row items-center gap-3 truncate bg-white text-sm font-medium",children:e.jsx(se,{placeholder:"Select warehouse..."})}),e.jsxs(te,{className:"text-sm font-medium text-slate-700",children:[e.jsx(V,{value:"1",children:"Cagayan de Oro"}),e.jsx(V,{value:"2",children:"Iligan"})]})]})]})]})},ir=()=>{const{newTransfer:t,handleChange:s}=qe();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-span-11 flex flex-col gap-1",children:[e.jsx(w,{htmlFor:"transfer_schedule",className:"text-sm font-bold text-slate-800",children:"Schedule"}),e.jsxs(ye,{children:[e.jsx(je,{id:"transfer_schedule",name:"transfer_schedule",asChild:!0,children:e.jsxs(F,{variant:"outline",className:"w-full justify-start",children:[e.jsx(ta,{className:"mr-2 h-4 w-4"}),t.transfer_schedule?new Date(t.transfer_schedule).toLocaleString("en-PH",{dateStyle:"full"}):e.jsx("span",{children:"Pick a date..."})]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(ns,{required:!0,mode:"single",disabled:{before:new Date},selected:new Date(t.transfer_schedule??""),onDayClick:a=>{const r=new Date(a).toISOString();s("transfer_schedule",r)},initialFocus:!0})})]})]})})},Ks=({tabState:t,from:s})=>{var m,u,d,y;const{inventoriesList:a,inventoriesLoading:r,selectedInventory:l,setSelectedInventory:c,newTransfer:n,setNewTransfer:i}=qe(),[o,x]=h.useState(!1);return e.jsxs("div",{className:`${t==="details"?"col-span-11":"col-span-8"} flex flex-col gap-1`,children:[e.jsxs(w,{htmlFor:"inventory",className:"text-sm font-bold capitalize text-slate-800",children:["Inventory ",s]}),e.jsxs(ye,{open:o,onOpenChange:x,children:[e.jsx(je,{asChild:!0,children:e.jsxs(F,{id:"inventory",variant:"outline",role:"combobox","aria-expanded":o,className:"justify-between",disabled:n.source===void 0||r[s]||t==="items",children:[r[s]?"Loading...":l[s]?(u=(m=a[s])==null?void 0:m.find(p=>{var N;return p.id===((N=l[s])==null?void 0:N.id)}))==null?void 0:u.code:"Select inventory...",e.jsx(Je,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ve,{className:"max-h-[300px] w-[568px] overflow-auto p-0",children:e.jsxs(Be,{defaultValue:((d=l[s])==null?void 0:d.id.toString())??"",children:[e.jsx(Qe,{placeholder:"Search inventory...",className:"text-sm font-medium"}),e.jsx(Ze,{className:"p-4 text-center text-sm font-medium",children:"No inventory found."}),e.jsx(Oe,{children:(y=a[s])==null?void 0:y.map(p=>e.jsxs(Ae,{className:"flex justify-between text-sm",value:p.id.toString(),onSelect:()=>{c(N=>({...N,[s]:p})),s=="destination"&&i(N=>({...N,destination_inventory:p.id})),x(!1)},children:[e.jsx("span",{className:"font-semibold",children:p.code}),e.jsxs("span",{className:"inline-block text-xs font-bold text-slate-600",children:["Created:"," ",new Date(p.created_at??"").toLocaleDateString("en-PH",{dateStyle:"long"})]})]},p.id))})]})})]})]})},or=({activeView:t,setActiveView:s,setEditProduct:a})=>{const{selectedInventory:r}=qe();return e.jsx("div",{className:"col-span-3 col-start-10 flex h-full items-end",children:e.jsx(F,{variant:"secondary",disabled:!r,className:"w-full text-sm font-bold text-slate-800 hover:bg-slate-300",onClick:t==="table"?()=>{s("form"),a(null)}:()=>s("table"),children:e.jsx("span",{children:t==="table"?e.jsxs("span",{className:"flex gap-2",children:[e.jsx(tt,{size:20})," ",e.jsx("span",{children:"Add an item"})]}):e.jsxs("span",{className:"flex gap-2",children:[e.jsx(sa,{size:20})," ",e.jsx("span",{children:"Cancel"})]})})})})},dr=({onClose:t})=>{const{newTransfer:s,handleChange:a,setActiveTab:r}=qe();return e.jsx("div",{className:"flex flex-col gap-5",children:e.jsxs("div",{className:"grid grid-cols-11 gap-4",children:[e.jsx(cr,{}),e.jsx(Ks,{tabState:"details",from:"source"}),e.jsx(Ks,{tabState:"details",from:"destination"}),e.jsx(ir,{}),e.jsxs("div",{className:"col-span-11 flex flex-col gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-slate-800",children:"Notes"}),e.jsx(ks,{id:"notes",placeholder:"Type the notes for this transfer...",className:"text-sm",value:s.notes??"",onChange:l=>a("notes",l.target.value)})]}),e.jsxs("div",{className:"col-span-11 flex justify-end gap-4",children:[e.jsx(b,{fill:"default",className:"py-2 text-sm font-bold text-slate-900",onClick:()=>t(),children:"Cancel"}),e.jsx(b,{fill:"green",className:"py-2 text-sm font-bold disabled:cursor-not-allowed disabled:opacity-50",disabled:!s.source||!s.destination||!s.transfer_schedule,onClick:()=>r("items"),children:"Proceed to add items"})]})]})})},ia=({selectedProduct:t,setSelectedProduct:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex w-1/2 flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(P,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",value:(t==null?void 0:t.capital_price)||0,onBlur:()=>{},onChange:a=>{s(r=>({...r,capital_price:a.target.value}))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]})}),xr=({selectedProduct:t})=>{const{inventoryProducts:s,inventoryProductsLoading:a}=qe();return e.jsx(e.Fragment,{children:a?e.jsx(je,{asChild:!0,children:e.jsx(F,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:!0,children:e.jsx(G,{className:"h-4 w-4 animate-spin"})})}):e.jsx(je,{asChild:!0,children:e.jsxs(F,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:s.source.length===0,children:[s.source.length>0?t?t.product_name:"Select product...":"No products",e.jsx(Je,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})})})},mr=({selectedProduct:t,setSelectedProduct:s})=>{const{inventoryProducts:a,handleChange:r,newTransfer:l}=qe(),[c,n]=h.useState(!1);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(ye,{open:c,onOpenChange:n,children:[e.jsx(xr,{selectedProduct:t}),e.jsx(ve,{className:"min-w-[53rem] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Be,{children:[e.jsx(Qe,{placeholder:"Product name or serial number..."}),e.jsx(Ze,{children:"No match found"}),e.jsx(Re,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Oe,{children:a.source.map(i=>e.jsx(Ae,{className:"cursor-pointer justify-between rounded-sm border-b",value:i.product.id+"_"+i.product.name+"_"+i.product.brand+"_"+i.id,onSelect:()=>{s({id:i.id,product_id:i.product.id,product_name:`${i.product.name} • ${i.product.brand} • ${i.product.size} • ${i.product.color}`,unit:i.unit,source_inventory:i.inventory_id,total_quantity:1,capital_price:i.capital_price}),n(!1)},children:`${i.product.name} • ${i.product.brand} • ${i.product.size} • ${i.product.color}`},i==null?void 0:i.id))})})]})})]})]})})},oa=({selectedProduct:t,setSelectedProduct:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex w-1/2 flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks Count"}),e.jsx(P,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:(t==null?void 0:t.total_quantity)||0,required:!0,onChange:a=>{s(r=>({...r,total_quantity:a.target.value}))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500"})]})}),ur=({setActiveView:t,editProduct:s})=>{const{newTransfer:a,handleChange:r}=qe(),[l,c]=h.useState(s||null),n=i=>{i.preventDefault();const o=[...a.transferItems];let x=o.findIndex(m=>m.id===l.id);x!==-1?o[x]={...o[x],...l}:o.push({...l}),r("transferItems",o),t("table")};return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:n,children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsx(mr,{selectedProduct:l,setSelectedProduct:c}),e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-row justify-between gap-2",children:[e.jsx(ia,{selectedProduct:l,setSelectedProduct:c}),e.jsx(oa,{selectedProduct:l,setSelectedProduct:c})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(b,{type:"submit",fill:"green",className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:"Add Item to Queue"})})]})})})},hr=({onClose:t})=>{const{newTransfer:s,handleChange:a}=qe(),[r,l]=h.useState(null),{addTransferMutation:c,isPending:n,success:i}=kl(),o=[{id:"select",header:({table:d})=>e.jsx("input",{type:"checkbox",checked:d.getIsAllPageRowsSelected(),onChange:y=>d.toggleAllPageRowsSelected(!!y.target.checked),"aria-label":"Select all"}),cell:({row:d})=>e.jsx("input",{type:"checkbox",checked:d.getIsSelected(),onChange:y=>d.toggleSelected(!!y.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:d})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>d.toggleSorting(d.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",d.getIsSorted()==="asc"?e.jsx(D,{}):d.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:d})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:d.original.product_name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:d.original.total_quantity})},{accessorKey:"capital price",header:()=>e.jsx("div",{className:"text-center",children:"Capital Price"}),cell:({row:d})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(d.original.capital_price)})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:d})=>{const y=d.original;return e.jsxs("div",{className:"flex flex-row justify-center gap-3 text-xs font-normal uppercase",children:[e.jsx(Xe,{children:e.jsxs(Ue,{children:[e.jsx(Ke,{children:e.jsx(be,{onClick:()=>{m("form"),l(y)},size:20,className:" text-yellow-500"})}),e.jsx(Le,{children:e.jsx("p",{children:"Edit"})})]})}),e.jsx(Xe,{children:e.jsxs(Ue,{children:[e.jsx(Ke,{children:e.jsx(is,{onClick:()=>{const p=s.transferItems.filter(N=>N.id!==y.id);a("transferItems",p)},size:20,className:"text-red-500"})}),e.jsx(Le,{children:e.jsx("p",{children:"Remove"})})]})})]})}}],[x,m]=h.useState("table"),u=async()=>{c(s).catch(d=>{R.error(d.response.data.message)})};return console.log(s),h.useEffect(()=>{i&&(R(i,{position:"top-right",closeOnClick:!0,type:"success"}),t())},[i]),e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"absolute left-[45%] top-[43%] z-50",children:e.jsx(Te,{})}),e.jsxs("div",{className:`flex flex-col gap-4 ${n?"blur-sm":""}`,children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsx(Ks,{tabState:"items",from:"source"}),e.jsx(or,{activeView:x,setActiveView:m,setEditProduct:l})]}),x==="table"&&e.jsx("div",{className:"h-[400px] w-full bg-slate-100",children:e.jsx(X,{data:s.transferItems,columns:o,dataType:"Transfer Products",isLoading:!1,hideFilter:!0,filterWhat:""})}),x==="form"&&e.jsx("div",{className:"h-[200px] w-full ",children:e.jsx(ur,{setActiveView:m,editProduct:r})}),e.jsx("div",{className:`flex flex-col items-end ${x==="form"?"hidden":""}`,children:e.jsx(b,{disabled:s.transferItems.length<=0||n,onClick:u,fill:"green",className:"disabled:opacity-50",children:"Submit Request"})})]})]})},pr=({onClose:t})=>{const{newTransfer:s,activeTab:a,setActiveTab:r}=qe();return e.jsx(e.Fragment,{children:e.jsxs($s,{value:a,onValueChange:l=>r(l),className:"w-full",children:[e.jsxs(Bs,{className:"mb-4 flex w-full",children:[e.jsx(cs,{value:"details",className:"flex-1 font-semibold",children:"Details"}),e.jsx(cs,{value:"items",className:"flex-1 font-semibold",disabled:!s.source||!s.destination||!s.transfer_schedule,children:"Items"})]}),e.jsx(bs,{value:"details",className:"min-w-[540px]",children:e.jsx(dr,{onClose:t})}),e.jsx(bs,{value:"items",className:"min-w-[860px]",children:e.jsx(hr,{onClose:t})})]})})},fr=({selectedProduct:t,products:s})=>{const{isInventoryLoading:a}=As();return e.jsx(e.Fragment,{children:a?e.jsx(je,{asChild:!0,children:e.jsx(F,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:!0,children:e.jsx(G,{className:"h-4 w-4 animate-spin"})})}):e.jsx(je,{asChild:!0,children:e.jsxs(F,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700 disabled:cursor-not-allowed",variant:"outline",disabled:s.length===0,children:[s.length>0||!a?t?t.product_name:"Select product...":"No products",e.jsx(Je,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})})})},jr=({selectedProduct:t,setSelectedProduct:s})=>{const[a,r]=h.useState(!1),{filteredProductsSrc:l,filteredInventoriesSrc:c,handleChangeSelect:n,isInventoryLoading:i}=As(),{selectedTransfer:o}=Ie(),x=c.find(m=>(m==null?void 0:m.warehouse.id)===o.source.id);return h.useEffect(()=>{x&&!i&&n("inventory_id",x.id)},[x,i]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(ye,{open:a,onOpenChange:r,children:[e.jsx(fr,{selectedProduct:t,products:l}),e.jsx(ve,{className:"min-w-[53rem] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Be,{children:[e.jsx(Qe,{placeholder:"Product name or serial number..."}),e.jsx(Ze,{children:"No match found"}),e.jsx(Re,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Oe,{children:l.map(m=>e.jsx(Ae,{className:"cursor-pointer justify-between rounded-sm border-b",value:m.product.id+"_"+m.product.name+"_"+m.product.brand+"_"+m.id,onSelect:()=>{s({id:m.id,product_id:m.product.id,product_name:`${m.product.name} • ${m.product.brand} • ${m.product.size} • ${m.product.color}`,unit:m.unit,source_inventory:m.inventory_id,total_quantity:1,capital_price:m.capital_price}),r(!1)},children:`${m.product.name} • ${m.product.brand} • ${m.product.size} • ${m.product.color}`},m==null?void 0:m.id))})})]})})]})]})})},gr=({onClose:t})=>{var k,A;const[s,a]=h.useState(null),[r,l]=h.useState({isDeleting:!1,product:null}),[c,n]=h.useState(),i=fe(),o=[{id:"select",header:({table:C})=>e.jsx("input",{type:"checkbox",checked:C.getIsAllPageRowsSelected(),onChange:W=>C.toggleAllPageRowsSelected(!!W.target.checked),"aria-label":"Select all"}),cell:({row:C})=>e.jsx("input",{type:"checkbox",checked:C.getIsSelected(),onChange:W=>C.toggleSelected(!!W.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:C})=>e.jsx("div",{children:e.jsxs(F,{onClick:()=>C.toggleSorting(C.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",C.getIsSorted()==="asc"?e.jsx(D,{}):C.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:C})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:C.original.product.name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:C})=>e.jsx("div",{className:"text-center",children:C.original.total_quantity})},{accessorKey:"capital price",header:()=>e.jsx("div",{className:"text-center",children:"Capital Price"}),cell:({row:C})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(C.original.capital_price)})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:C})=>{const W=C.original;return e.jsxs("div",{className:"flex flex-row justify-center gap-3 text-xs font-normal uppercase",children:[e.jsx(Xe,{children:e.jsxs(Ue,{children:[e.jsx(Ke,{children:e.jsx(be,{onClick:()=>{_("form"),a(W),n({...W,product_name:`${W.product.name} • ${W.product.brand} • ${W.product.size} • ${W.product.color}`})},size:20,className:" text-yellow-500"})}),e.jsx(Le,{children:e.jsx("p",{children:"Edit"})})]})}),e.jsx(Xe,{children:e.jsxs(Ue,{children:[e.jsx(Ke,{children:e.jsx(is,{onClick:()=>{l({isDeleting:!0,product:W})},size:20,className:"text-red-500"})}),e.jsx(Le,{children:e.jsx("p",{children:"Remove"})})]})})]})}}],{mutateAsync:x,isPending:m}=Y({mutationKey:["transfer_product"],mutationFn:ft,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),R("Product has been added",{position:"top-right",closeOnClick:!0,type:"success"}),_("table")},onError:C=>{console.error(C)}}),{mutateAsync:u,isPending:d}=Y({mutationKey:["transfer_product"],mutationFn:jt,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),R("Product has been edited",{position:"top-right",closeOnClick:!0,type:"success"}),a(void 0),_("table")},onError:C=>{console.error(C)}}),{mutateAsync:y,isPending:p}=Y({mutationKey:["transfer_product"],mutationFn:Ka,onSuccess:async()=>{await i.invalidateQueries({queryKey:["transfer_products"]}),l(C=>({...C,isDeleting:!1})),R("Product has been removed",{position:"top-right",closeOnClick:!0,type:"success"})},onError:C=>{console.error(C)}}),{filteredInventoriesSrc:N}=As(),{transferProducts:j,selectedTransfer:f}=Ie(),g=j.filter(C=>C.transfer_id===f.id),v=N.find(C=>(C==null?void 0:C.warehouse.id)===f.source.id),[I,_]=h.useState("table");return h.useEffect(()=>{I==="table"&&n(void 0)},[I]),e.jsxs(e.Fragment,{children:[(m||p||d)&&e.jsx("div",{className:"absolute left-[45%] top-[43%] z-50",children:e.jsx(Te,{})}),e.jsx(_l,{isOpen:r.isDeleting,onClose:()=>{l(C=>({...C,isDeleting:!1}))},children:e.jsxs("div",{className:"",children:[e.jsxs("p",{className:"text-center font-semibold",children:["Are you sure you want to delete"," ",(A=(k=r==null?void 0:r.product)==null?void 0:k.product)==null?void 0:A.name," from this transfer?"]}),e.jsx("p",{className:"pt-2 text-center text-sm opacity-80",children:"This process cannot be undone."}),e.jsxs("div",{className:"flex gap-2 pt-3",children:[e.jsx(F,{onClick:()=>{l(C=>({...C,isDeleting:!1}))},className:"w-full bg-red-400 hover:bg-red-800",disabled:p,children:"Cancel"}),e.jsx(F,{onClick:()=>{y({id:r.product.id})},disabled:p,className:"w-full bg-green-400 hover:bg-green-800",children:p?e.jsx(La,{type:"spin",width:20,className:"relative top-[22px]"}):"Confirm"})]})]})}),e.jsxs("div",{className:`flex flex-col gap-4 ${m||p||d?"blur-sm":""}`,children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsxs("div",{children:[e.jsx(w,{className:"text-sm font-bold text-slate-800",children:"Inventory"}),e.jsx(F,{id:"inventory",variant:"outline",className:"w-fit justify-between",disabled:!0,children:v!=null&&v.code?v==null?void 0:v.code:"Loading..."})]}),e.jsx("div",{className:"col-span-3 col-start-10 flex h-full items-end",children:e.jsx(F,{variant:"secondary",onClick:()=>{I==="form"&&_("table"),I==="table"&&_("form")},disabled:!(v!=null&&v.code),className:`w-full text-sm font-bold text-slate-800 hover:bg-slate-300 ${I==="table"&&"hidden"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[I=="table"&&e.jsxs(e.Fragment,{children:[e.jsx(tt,{}),e.jsx("span",{children:"Add Item"})]}),I=="form"&&e.jsxs(e.Fragment,{children:[e.jsx(sa,{}),e.jsx("span",{children:"Cancel"})]})]})})})]}),I==="table"&&e.jsx("div",{className:"h-[400px] w-full bg-slate-100",children:e.jsx(X,{data:g,columns:o,dataType:"Transfer Products",isLoading:!1,hideFilter:!0,filterWhat:""})}),I==="form"&&e.jsxs("div",{className:"flex h-[200px] w-full flex-col",children:[e.jsx(jr,{selectedProduct:c,setSelectedProduct:n}),e.jsxs("div",{className:"mt-5 flex gap-3",children:[e.jsx(oa,{selectedProduct:c,setSelectedProduct:n}),e.jsx(ia,{selectedProduct:c,setSelectedProduct:n})]}),e.jsx(F,{variant:"secondary",onClick:()=>{if(s){u({...c,transfer_id:f.id});return}x({...c,transfer_id:f.id})},disabled:!(c||d||m),className:"mt-5 w-full text-sm font-bold text-slate-800 hover:bg-slate-300",children:e.jsx("p",{children:s?"Apply changes":"Add Product"})})]})]})]})},Nr=({onClose:t})=>e.jsx(e.Fragment,{children:e.jsx(gr,{onClose:t})}),da=({onClose:t})=>{var A,C,W,K,M,L,S,ce,O,U;const{transfer:s,lastId:a,isChanged:r,isSubmitting:l,error:c,success:n,dateDisplay:i,dateDisplayArrived:o,handleSubmit:x,handleChange:m,handleChangeSelect:u,handleChangeDateTime:d}=Fl(),{selectedTransfer:y,transferProducts:p}=Ie(),{warehouses:N}=ts(),{users:j}=qa(),{auth:f}=oe();h.useEffect(()=>{console.log(s)},[s]);const g=e.jsxs(e.Fragment,{children:[e.jsx(J,{onValueChange:T=>u("approval_status",T),name:"approval_status",value:s.approval_status||"",children:e.jsxs(ee,{name:"approval_status",value:y.approval_status||"",children:[e.jsx(se,{placeholder:s.approval_status?s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1):"Choose status..."}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx(V,{value:"pending",className:"text-sm font-medium text-slate-700",children:"Pending"},"pending"),e.jsx(V,{value:"approved",className:"text-sm font-medium text-slate-700",children:"Approved"},"approved"),e.jsx(V,{value:"rejected",className:"text-sm font-medium text-slate-700",children:"Rejected"},"rejected")]})]})}),p.filter(T=>T.transfer_id===s.id).length===0&&e.jsxs("div",{className:"align-center group flex",children:[e.jsx(Rs,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsx("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-7 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:"No products have been added yet."})]}),p.filter(T=>T.transfer_id===y.id).length===0&&e.jsxs("div",{className:"align-center group flex",children:[e.jsx(Rs,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsx("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-7 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:"No products have been added yet."})]})]}),v=e.jsxs(J,{onValueChange:T=>u("source",Number(T)),name:"source",children:[e.jsx(ee,{name:"source",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsxs(e.Fragment,{children:[(A=N[s.source-1])==null?void 0:A.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","• ",(C=N[s.source-1])==null?void 0:C.code," •"," ",(W=N[s.source-1])==null?void 0:W.location]})]})})}),e.jsx(te,{className:"bg-white font-medium",children:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):N.map((T,Z)=>e.jsxs(V,{value:T.id.toString(),className:`text-sm font-medium text-slate-700 
								${T.id===s.source&&"selected"}`,children:[T.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+T.code+" • "+T.location})]},Z))})]}),I=e.jsxs(J,{onValueChange:T=>u("destination",Number(T)),name:"destination",children:[e.jsx(ee,{name:"destination",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsxs(e.Fragment,{children:[(K=N[s.destination-1])==null?void 0:K.name,e.jsxs("span",{className:"truncate text-xs text-slate-700/60",children:[" ","• ",(M=N[s.destination-1])==null?void 0:M.code," •"," ",(L=N[s.destination-1])==null?void 0:L.location]})]})})}),e.jsx(te,{className:"bg-white font-medium",children:N.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):N.map((T,Z)=>e.jsxs(V,{value:T.id.toString(),className:`text-sm font-medium text-slate-700 
								${T.id===s.destination&&"selected"}`,children:[T.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+T.code+" • "+T.location})]},T.code))})]}),_=e.jsx(J,{onValueChange:T=>u("transfer_status",T),name:"transfer_status",value:s.transfer_status||"",children:e.jsxs(ee,{name:"transfer_status",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:[e.jsx(se,{placeholder:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"Choose status..."}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx(V,{value:"loading",className:"text-sm font-medium text-slate-700",children:"Loading"},"loading"),e.jsx(V,{value:"en route",className:"text-sm font-medium text-slate-700",children:"En route"},"en route"),e.jsx(V,{value:"arrived",className:"text-sm font-medium text-slate-700",children:"Arrived"},"arrived")]})]})}),k=e.jsxs(J,{onValueChange:T=>u("received_by",Number(T)),name:"received_by",children:[e.jsx(ee,{name:"received_by",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:j.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):e.jsx(e.Fragment,{children:s.received_by?j[Number(s.received_by)-1].firstname+" "+j[Number(s.received_by)-1].lastname:"Choose user..."})})}),e.jsx(te,{className:"bg-white font-medium",children:j.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):j.map((T,Z)=>e.jsx(V,{value:T.id.toString(),className:`text-sm font-medium text-slate-700 
								${s.received_by&&T.id===s.received_by&&"selected"}`,children:T.firstname+" "+T.lastname},Z))})]});return n&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:T=>{T.preventDefault()},children:[e.jsxs("div",{className:"flex max-w-3xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer Code"}),e.jsx("p",{className:"text-sm",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Source"}),v]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Destination"}),I]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4 pb-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:y.created_by.firstname+" "+y.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Approval status"}),e.jsxs("p",{className:"flex flex-row gap-2 text-sm",children:[((S=s.approval_status)==null?void 0:S.toLowerCase())==="approved"&&e.jsxs(e.Fragment,{children:[s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1),e.jsx($e,{size:20,strokeWidth:2,className:"text-green-600"})]}),((ce=s.approval_status)==null?void 0:ce.toLowerCase())==="rejected"&&e.jsxs(e.Fragment,{children:[s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1),e.jsx(ss,{size:20,strokeWidth:2,className:"text-red-600"})]}),((O=s.approval_status)==null?void 0:O.toLowerCase())==="pending"&&f.rolePermissions.some(T=>T.permission_id===22)&&((U=s.approval_status)==null?void 0:U.toLowerCase())==="pending"&&g]})]}),s.approved_by&&s.approval_status!="pending"&&e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-600",children:[s.approval_status==="approved"&&"Approved by",s.approval_status==="rejected"&&"Rejected by"]}),e.jsx("p",{className:"flex flex-row text-sm",children:j.length>0?j[s.approved_by-1].firstname+" "+j[s.approved_by-1].lastname:e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})})})]})]}),s.approval_status=="approved"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-8 gap-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer status"}),e.jsx("p",{className:"text-sm",children:_})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer schedule"}),e.jsx("div",{className:"text-sm",children:e.jsxs(ye,{children:[e.jsx(je,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(F,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ws,{size:18,strokeWidth:1.5}),s.transfer_schedule?s.transfer_schedule.split(" ")[0]:"Choose date..."]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(ns,{mode:"single",initialFocus:!0,required:!0,onDayClick:T=>{const Z=new Date(T),$=`${Z.getFullYear()}-${(Z.getMonth()+1).toString().padStart(2,"0")}-${Z.getDate().toString().padStart(2,"0")}`;u("transfer_schedule",$)},selected:s.transfer_schedule?new Date(s.transfer_schedule.split(" ")[0]):new Date})})]})})]}),s.transfer_status==="arrived"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Received by"}),e.jsx("p",{className:"text-sm",children:k})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsx("div",{className:"text-sm",children:e.jsxs(ye,{children:[e.jsx(je,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(F,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ws,{size:18,strokeWidth:1.5}),s.date_received?s.date_received.split(" ")[0]:"Choose date..."]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(ns,{mode:"single",initialFocus:!0,required:!0,onDayClick:T=>{const Z=new Date(T),$=`${Z.getFullYear()}-${(Z.getMonth()+1).toString().padStart(2,"0")}-${Z.getDate().toString().padStart(2,"0")}`;u("date_received",$)},selected:s.date_received?new Date(s.date_received.split(" ")[0]):new Date(s.transfer_schedule.split(" ")[0])})})]})})]})]})]})}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex w-full flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(ks,{name:"notes",value:s.notes||"",placeholder:"Add notes here....",onChange:m})]})})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"col-span-5 flex flex-col items-start",children:[n&&e.jsx("div",{className:"font-bold text-green-700",children:n}),c&&e.jsx("div",{className:"font-bold text-red-700",children:c}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"col-span-5 flex flex-col items-end gap-3",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:r?"green":null,disabled:!r,onClick:x,children:l?"Submitting":"Edit Transfer"})]})})]})})]})})},yc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Transfer",children:e.jsxs(kt,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border",children:e.jsx(rr,{openModal:c})})}),e.jsx(ue,{title:r==="details"?"Transfer Details":r==="edit"?"Edit Transfer":r==="add"?"Add Transfer":"Transfer Products",isOpen:t,onClose:a,closeOnOverlayClick:r==="details",children:e.jsxs(e.Fragment,{children:[r==="details"&&e.jsx(nr,{onClose:a}),r==="edit"&&e.jsx(da,{onClose:a}),r==="add"&&e.jsx(Ha,{children:e.jsx(pr,{onClose:a})}),r==="products"&&e.jsx(Nr,{onClose:a})]})})]})})})},yr=()=>{const t=fe(),[s,a]=h.useState({}),r=(i,o)=>{a(x=>({...x,[i]:o}))},l=async i=>(console.log("Submitting: ",i),await n(i)),c={onSuccess:async()=>{await t.invalidateQueries({queryKey:["customers"]}),a({})},onError:i=>{console.error("Error adding customer:",i.message)}},{mutateAsync:n}=Y({mutationKey:["addCustomer"],mutationFn:Va,...c});return{value:s,setValue:a,handleChange:r,handleSubmit:l}},vr=({onClose:t})=>{const{value:s,setValue:a,handleChange:r,handleSubmit:l}=yr(),{setSelectedCustomer:c}=Ye();h.useEffect(()=>{a(m=>({...m}))},[]);const[n,i]=h.useState(!1),[o,x]=h.useState(null);return e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async m=>{i(!n),m.preventDefault();const u=await l(s);(u==null?void 0:u.status)===201?(i(!n),c(u.data.data),t(),console.log(u.data)):(i(!n),x("Failed to add inventory"))},children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-2 ",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"firstname",children:"First Name"}),e.jsx(P,{id:"firstname",name:"firstname",required:!0,type:"text",placeholder:"First Name",onChange:m=>r("firstname",m.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"lastname",children:"Last Name"}),e.jsx(P,{id:"lastname",name:"lastname",required:!0,type:"text",placeholder:"Last Name",onChange:m=>r("lastname",m.target.value)})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"address",children:"Address"}),e.jsxs("div",{className:"relative flex flex-col ",children:[e.jsx(Al,{color:"#2D2D2D",className:"absolute top-0 translate-x-3 translate-y-1/2",size:20}),e.jsx(P,{id:"address",name:"address",type:"text",placeholder:"Address",defaultValue:"",className:"pl-10",onChange:m=>r("address",m.target.value),required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(w,{className:"text-sm font-semibold uppercase",htmlFor:"contact_no",children:"Contact Number"}),e.jsxs("div",{className:"relative flex flex-col",children:[e.jsx(Tl,{color:"#2D2D2D",className:"absolute top-0 translate-x-3 translate-y-1/2",size:20}),e.jsx(P,{required:!0,id:"contact_no",name:"contact_no",type:"text",inputMode:"numeric",placeholder:"Contact Number",className:"pl-10",defaultValue:"",max:11,maxLength:11,onChange:m=>r("contact_no",m.target.value)})]})]})]}),e.jsxs("div",{className:"flex flex-row justify-end gap-4",children:[e.jsx(b,{onClick:()=>t(),type:"reset",className:'hover:text-white"  py-2 text-sm font-bold text-slate-700',children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:n||Object.keys(s).length<=2,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Submitting...":"Add Customer"})]}),o&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-semibold text-red-600",children:o})})]})})})},br=({})=>{const{data:t,isLoading:s,selectedCustomer:a,setSelectedCustomer:r,openSearchCustomer:l,setOpenSearchCustomer:c,setSearchFullName:n}=Ye(),[i,o]=h.useState(""),[x,m]=h.useState(""),{isOpen:u,closeModal:d,openModal:y}=de();function p(){n(i)}return h.useEffect(()=>{if(x!==""){const N=t.find(j=>j.id===parseInt(x));N&&r(N)}},[x]),e.jsxs(e.Fragment,{children:[e.jsx(us,{open:l,onOpenChange:c,children:e.jsxs(hs,{children:[e.jsx(ps,{className:"items-start",children:e.jsx(fs,{children:"Search Customer"})}),e.jsx("form",{className:"flex flex-col",onSubmit:N=>{N.preventDefault(),p()},children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(P,{placeholder:"Enter customer name",onChange:N=>{o(N.target.value)},className:"w-[90%]"}),e.jsx(F,{type:"submit",size:"icon",children:s?e.jsx(G,{className:"animate-spin"}):e.jsx(Ft,{size:18})})]})}),t.length!==0&&!s&&e.jsx(e.Fragment,{children:e.jsxs(J,{onValueChange:m,children:[e.jsx(ee,{className:"h-15 text-left ",children:e.jsx(se,{placeholder:"Select Customer"})}),e.jsx(te,{children:e.jsx($a,{children:t.map((N,j)=>e.jsx(V,{value:N.id.toString(),onClick:()=>{o("")},children:e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("span",{className:"w-full font-bold",children:[N.firstname," ",N.lastname]}),e.jsxs("span",{className:"w-full",children:[N.contact_no," •"," ",N.address]})]})},j))})})]})}),e.jsxs(Ba,{className:"flex flex-row gap-2",children:[e.jsx(F,{variant:"outline",className:"flex-1 font-medium",onClick:()=>{c(!1),y()},children:"Add new customer"}),e.jsx(F,{className:"flex-1",onClick:()=>{c(!1)},children:"Close"})]})]})}),e.jsx(ue,{isOpen:u,onClose:d,title:"Add Customer",children:e.jsx(vr,{onClose:d})})]})},Ts=()=>{const t=fe(),[s,a]=h.useState({}),r=(m,u)=>{a(d=>({...d,[m]:u}))},l=m=>{a(u=>({...u,...m}))},c={onSuccess:async()=>{await t.invalidateQueries({queryKey:["invoices"]}),a({}),R.success("Submitted successfully!",{autoClose:3e3})},onError:m=>{console.error("Invoices Data failed",m.message)}},{mutateAsync:n}=Y({mutationKey:["addInvoice"],mutationFn:Qa,...c}),{mutateAsync:i}=Y({mutationKey:["updateInvoice"],mutationFn:Ya,...c}),{mutateAsync:o}=Y({mutationKey:["removeInvoice"],mutationFn:Ga,...c}),{mutateAsync:x}=Y({mutationKey:["updatePendingInvoice"],mutationFn:Xa,...c});return{value:s,setValue:a,selectChange:l,handleChange:r,addInvoiceMutation:n,updateInvoiceMutation:i,removeInvoiceMutation:o,updatePendingInvoiceMutation:x}},wr=()=>{const{currentInvoiceItemsQueue:t}=le();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Items"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.length>0?e.jsx(e.Fragment,{children:t.length}):0})]})})},_r=()=>{const{invoiceItemsDatabase:t}=le();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Subtotal"}),e.jsx(w,{className:"font-bold text-slate-700",children:ie(t.reduce((s,a)=>s+(a.total_price??0),0))})]})})},Sr=()=>{const{currentInvoicePos:t}=le();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Discount"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.total_discount?ie(t.total_discount):"₱0.00"})]})})},Cr=()=>{const{currentInvoicePos:t}=le();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Delivery Charge"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.delivery_charge?ie(t.delivery_charge):"₱0.00"})]})})},kr=()=>{const{currentInvoicePos:t}=le(),s=t.total_amount_due;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex w-full flex-col justify-between gap-2 py-2",children:e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx(w,{className:"text-lg font-bold text-gray-700",children:"Total"}),e.jsx(w,{className:"text-lg font-bold text-black",children:ie(s??0)})]})})})},Fr=()=>{const{currentInvoicePos:t}=le();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Paid Amount"}),e.jsx(w,{className:"font-bold text-slate-700",children:t.paid_amount?ie(t.paid_amount):"₱0.00"})]})})},Ir=()=>{var s,a;const{currentInvoicePos:t}=le();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Payment Type"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:(s=t.type)==null?void 0:s.replace("_"," ")})]}),t.type!=="exit"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Payment Method"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:(a=t.payment_method)==null?void 0:a.replace("_"," ")})]}),t.payment_method!=="cash"&&t.payment_method!==""&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Reference Number"}),e.jsx(w,{className:"font-bold capitalize text-slate-700",children:t.reference_no})]})})]})]})},mt=()=>{const{currentInvoicePos:t}=le();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-col justify-between gap-2 border-t-2 border-dashed py-2",children:[e.jsx(Ir,{}),t.payment_method!=="purchase_order"&&e.jsx(Fr,{}),e.jsxs("div",{className:"flex flex-row justify-between",children:[(t.change_amount??0)<0?e.jsx("span",{className:"text-lg font-bold text-gray-700",children:"Balance"}):e.jsx("span",{className:"text-lg font-bold text-gray-700",children:"Change"}),e.jsx("span",{className:"text-lg font-bold text-black",children:ie(t.change_amount??0)})]})]})})},Pr=()=>{const{currentInvoicePos:t,setCurrentInvoicePos:s}=le(),{selectedCustomer:a}=Ye();return h.useEffect(()=>{t.payment_method==="balance_payment"&&s({...t,subtotal:(a==null?void 0:a.total_balance)??0,total_amount_due:(a==null?void 0:a.total_balance)??0})},[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"my-2 flex w-full flex-row justify-between",children:[e.jsx(w,{className:"text-medium font-medium text-slate-700",children:"Remaining Balance"}),e.jsx(w,{className:"font-bold text-slate-700",children:a!=null&&a.total_balance?ie(a.total_balance??0):"₱0.00"})]})})},Ar=({})=>{const{setDialogOptions:t,dialogOptions:s}=ze(),{handleInvoicePosChange:a,currentInvoicePos:r}=le(),{selectedCustomer:l,vouchers:c,selectedVoucher:n,setSelectedVoucher:i}=Ye(),[o,x]=h.useState(r.total_discount??0),m=()=>{a("total_discount",o),t({open:!1,title:""})};return e.jsx(us,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(hs,{children:[e.jsxs(ps,{className:"items-start",children:[e.jsx(fs,{children:"Add Discount Amount"}),e.jsx(Qs,{children:"Contact admininstrator for approval"})]}),e.jsxs("form",{className:"flex flex-col gap-2 ",onSubmit:u=>{u.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(P,{className:"pl-8",value:o,type:"number",onChange:u=>{x(Number(u.target.value)),i(void 0)},onBlur:u=>{u.target.value=o.toString()}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-800",children:"Claim voucher"}),e.jsxs(J,{disabled:Object.keys(l).length===0,value:n?n==null?void 0:n.id.toString():"",onValueChange:u=>{const d=c==null?void 0:c.find(y=>y.id===Number(u));x((d==null?void 0:d.discounted_price)??0),i(d??void 0)},children:[e.jsx(ee,{className:"w-full",children:e.jsx(se,{placeholder:"Select voucher..."})}),e.jsx(te,{children:c==null?void 0:c.map(u=>e.jsxs(V,{value:`${u.id}`,children:[e.jsx("span",{className:"font-bold",children:u.code})," • ",e.jsx("span",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(u.discounted_price??0)})]},u.id))})]})]}),e.jsx(Fs,{asChild:!0,children:e.jsx(F,{className:"w-full ",type:"submit",onClick:()=>{m()},children:"Apply"})})]})]})})},Tr=({})=>{const{setDialogOptions:t,dialogOptions:s}=ze(),{handleInvoicePosChange:a,currentInvoicePos:r}=le(),[l,c]=h.useState(r.paid_amount??0),n=()=>{a("paid_amount",l),t({open:!1,title:""})};return e.jsx(us,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(hs,{children:[e.jsxs(ps,{className:"items-start",children:[e.jsx(fs,{children:"Add Paid Amount"}),e.jsx(Qs,{children:"Input the exact amount paid by the customer"})]}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:i=>{i.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(P,{className:"pl-8",defaultValue:l,type:"number",onChange:i=>{c(Number(i.target.value))}})]}),e.jsx(Fs,{asChild:!0,children:e.jsx(F,{className:"w-full ",type:"submit",onClick:()=>{n()},children:"Apply"})})]})]})})},Dr=({})=>{const{setDialogOptions:t,dialogOptions:s}=ze(),{selectedCustomer:a}=Ye(),{handleInvoicePosChange:r,currentInvoicePos:l,setCurrentInvoiceItemsQueue:c,setInvoiceItemsDatabase:n}=le(),[i,o]=h.useState(l.type??"payment");return h.useEffect(()=>{l.type==="exit"&&r("payment_method","exit")},[l.type]),e.jsx(us,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(hs,{children:[e.jsxs(ps,{className:"items-start",children:[e.jsx(fs,{children:"Select Payment Type"}),e.jsxs(Qs,{children:["Payment Type:"," ",l.type==="payment"?"Payment":"Exit"]})]}),e.jsx($s,{id:"type",value:i,onValueChange:x=>{r("type",x),o(x)},children:e.jsxs(Bs,{className:"flex h-12 flex-row gap-1 p-2",children:[e.jsx(cs,{value:"payment",className:`data-[state=active]:bg-primary h-10 w-full rounded-md font-medium
                                text-slate-800 hover:bg-slate-200 data-[state=active]:text-white`,children:"Payment"}),e.jsx(cs,{value:"exit",className:`data-[state=active]:bg-primary h-10 w-full rounded-md font-medium
                                text-slate-800 hover:bg-slate-200 data-[state=active]:text-white`,children:"Exit"})]})}),l.type==="payment"&&e.jsxs("div",{className:"grid columns-4 grid-cols-2 gap-2",children:[e.jsx(F,{variant:"outline",className:`h-16 font-medium ${l.payment_method==="cash"&&"bg-primary text-white"}`,onClick:()=>{r("payment_method","cash")},children:"Cash"}),e.jsx(F,{variant:"outline",className:`h-16 font-medium ${l.payment_method==="cheque"&&"bg-primary text-white"}`,onClick:()=>{r("payment_method","cheque")},children:"Cheque"}),e.jsx(F,{variant:"outline",className:`h-16 font-medium ${l.payment_method==="e-wallet"&&"bg-primary text-white"}`,onClick:()=>{r("payment_method","e-wallet")},children:"E-Wallet"}),e.jsx(F,{variant:"outline",className:`h-16 font-medium ${l.payment_method==="purchase_order"&&"bg-primary text-white"}`,onClick:()=>{r("payment_method","purchase_order")},children:"Purchase Order"}),e.jsx(F,{variant:"outline",disabled:!(a!=null&&a.total_balance),className:`h-16 font-medium ${l.payment_method==="balance_payment"&&"bg-primary text-white"}`,onClick:()=>{c([]),n([]),r("payment_method","balance_payment")},children:"Balance Payment"})]}),e.jsx("div",{children:(l.payment_method==="cheque"||l.payment_method==="voucher"||l.payment_method==="e-wallet"||l.payment_method==="purchase_order")&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full flex-col justify-between gap-2",children:[e.jsx(w,{children:"Input Reference Code:"}),e.jsx(P,{placeholder:"Reference Code"})]})})}),e.jsx(Fs,{asChild:!0,children:e.jsx(F,{type:"button",onClick:()=>{t({open:!1,title:""})},children:"Close"})})]})})},zr=()=>{const{auth:t}=oe(),{searchFilterItems:s}=ze(),a=De();return e.jsx(e.Fragment,{children:e.jsx("div",{children:t.role==="admin"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row items-center justify-between px-2 py-4 ",children:[e.jsxs("span",{className:"flex flex-col font-bold text-slate-700",children:["Warehouse"," ",e.jsx("span",{className:"font-medium text-slate-800",children:s.warehouse_id===1?"Cagayan De Oro":"Iligan"})]}),e.jsx(F,{onClick:()=>{a("/pos")},size:"icon",children:e.jsx(nt,{size:18})})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row justify-between p-2 bg-white",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"flex flex-row items-center gap-2 font-bold uppercase text-slate-800",children:s.warehouse_id===1?"Cagayan De Oro Branch":"Iligan Branch"}),e.jsx("span",{className:"font-medium capitalize text-slate-900",children:t.user.firstname+" "+t.user.lastname})]}),e.jsx(F,{className:"hover:cursor-default",size:"icon",children:e.jsx(nt,{size:18})})]})})})})},Er=({})=>{const{selectedCustomer:t,setOpenSearchCustomer:s}=Ye();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex max-w-2xl flex-col gap-1 border-y-[1px] border-slate-200 bg-white px-2 py-4 pb-5",children:e.jsxs("div",{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx(w,{className:"text-[16px] font-bold text-slate-700",children:"Customer"}),Object.keys(t).length===0?e.jsx("span",{className:"text-sm font-medium",children:"Select Customer"}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2 pt-2 ",children:[e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs(w,{className:"font-medium text-normal text-slate-800",children:["Full Name:"," "]}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.firstname+" "+t.lastname})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx(w,{className:"font-medium text-normal text-slate-800",children:"Address:"}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.address})]}),e.jsxs("div",{className:"flex flex-col ",children:[e.jsx(w,{className:"font-medium text-normal text-slate-800",children:"Contact Number:"}),e.jsx("span",{className:"text-sm font-bold capitalize text-slate-800",children:t.contact_no})]})]})})]}),e.jsx(F,{onClick:()=>s(!0),size:"icon",children:e.jsx(Ft,{size:18})})]})})})},Mr=({})=>{const{setDialogOptions:t,dialogOptions:s}=ze(),{currentInvoicePos:a}=le();Ts();const{selectedCustomer:r,selectedVoucher:l}=Ye();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-1 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(F,{className:"flex-1",onClick:()=>{t({open:!0,title:"delivery_charge"})},disabled:a.payment_method==="balance_payment",children:"Set Delivery"}),e.jsx(F,{className:"flex-1",onClick:()=>{t({open:!0,title:"discount"})},disabled:a.payment_method==="balance_payment",children:"Set Discount"})]}),e.jsx(F,{onClick:()=>{t({open:!0,title:"payment_type"}),console.log("Options:",s)},children:"Set Payment Type"}),e.jsx(F,{onClick:()=>{t({open:!0,title:"paid_amount"}),console.log("Options:",s)},children:"Add Paid Amount"}),e.jsx("hr",{className:"my-1 w-full"}),e.jsx(F,{className:"w-full disabled:cursor-not-allowed",onClick:()=>{t({open:!0,title:"checkout_discount"})},disabled:Object.keys(r).length===0||a.type==="payment"&&a.payment_method!=="purchase_order"&&a.payment_method!=="balance_payment"&&(a.change_amount??0)<0||l!==void 0,children:"Checkout with Discount"}),e.jsx(F,{className:"w-full disabled:cursor-not-allowed",onClick:()=>{t({open:!0,title:"checkout"})},disabled:Object.keys(r).length===0||a.type==="payment"&&a.payment_method!=="purchase_order"&&a.payment_method!=="balance_payment"&&(a.change_amount??0)<0,children:"Checkout"})]})})},Ds=()=>{const{currentInvoicePos:t}=le();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-full flex-col justify-between p-4 px-2",children:e.jsx("div",{className:"flex flex-col gap-2",children:t.payment_method!=="balance_payment"?e.jsxs(e.Fragment,{children:[e.jsx(wr,{}),e.jsx(_r,{}),e.jsx(Sr,{}),e.jsx(Cr,{}),e.jsx(kr,{}),e.jsx(mt,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(Pr,{}),e.jsx(mt,{})]})})})})},Wr=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-pos-primary-background flex h-screen w-full max-w-[375px] flex-col gap-2 overflow-auto p-5",children:e.jsxs("div",{className:"flex flex-col rounded-md bg-white p-2 px-4",children:[e.jsx(zr,{}),e.jsx(br,{}),e.jsx(Er,{}),e.jsx(Ds,{}),e.jsx(Mr,{})]})})}),Or=()=>{const{dialogOptions:t}=ze();return e.jsxs(e.Fragment,{children:[t.title==="payment_type"&&e.jsx(Dr,{}),t.title==="discount"&&e.jsx(Ar,{}),t.title==="paid_amount"&&e.jsx(Tr,{}),t.title==="checkout"&&e.jsx(qr,{}),t.title==="checkout_discount"&&e.jsx(Vr,{}),t.title==="delivery_charge"&&e.jsx(Hr,{})]})},Rr=({isSubmitting:t,setisSubmitting:s,setPage:a,setInvoiceID:r})=>{const{setDialogOptions:l}=ze(),{invoiceItemsDatabase:c,currentInvoicePos:n}=le(),{addInvoiceMutation:i}=Ts(),{selectedVoucher:o,setSelectedVoucher:x}=Ye();async function m(){s(!0);const u=n;u.invoice_items=c.map(d=>({...d,product_id:d.product_id})),await i(u).then(d=>{o&&It(o.id).then(()=>x(void 0)),s(!1),a("awaitingApproval"),r(d.data.id)}).catch(()=>{s(!1),R.error("Transaction failed. Please try again.",{autoClose:3e3})})}return e.jsxs(e.Fragment,{children:[e.jsx(Ds,{}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(F,{variant:"outline",className:"flex-1 font-medium",type:"reset",onClick:()=>{l({open:!1,title:""})},children:"Cancel"}),e.jsx(F,{className:"flex-1",disabled:t||(n.change_amount??0)<0,type:"submit",onClick:u=>{u.preventDefault(),s(!0),m()},children:t?"Submitting...":"Request approval"})]})]})},Ur=({invoiceID:t,isSubmitting:s,setisSubmitting:a,setPage:r})=>{const{currentInvoicePos:l,setFullData:c}=le(),{updatePendingInvoiceMutation:n}=Ts();async function i(){a(!0);const o={status:"approved",total_discount:l.total_discount,paid_amount:l.paid_amount,change_amount:l.change_amount,total_amount_due:l.total_amount_due};await n({id:t,data:o}).then(x=>{a(!1),r("success"),c(x.data)}).catch(()=>{a(!1),R.error("An error occurred. Please try again.",{autoClose:3e3})})}return e.jsxs(e.Fragment,{children:[e.jsx(Ds,{}),e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(F,{className:"flex-1 font-medium",onClick:()=>r("editPaidAmount"),children:"Edit paid amount"}),e.jsx(F,{className:"flex-1 font-medium",onClick:()=>r("editDiscount"),children:"Edit discount"})]}),e.jsx("hr",{className:"my-1 border-slate-300"}),e.jsx(F,{className:"font-medium",disabled:t===void 0||s||(l.change_amount??0)<0,onClick:i,children:"Submit transaction"})]})]})},Kr=({setPage:t})=>{var l;const s=h.useRef(null),{currentInvoicePos:a,setCurrentInvoicePos:r}=le();return e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:c=>{c.preventDefault(),r(n=>{var i;return{...n,total_discount:Number(((i=s.current)==null?void 0:i.value)??a.total_discount)}}),t("awaitingApproval")},children:[e.jsxs("div",{className:"relative flex flex-col gap-2",children:[e.jsxs("h2",{className:"mb-2 text-sm text-slate-500",children:["Input the discount as ",e.jsx("strong",{children:"advised by the admin"}),"."]}),e.jsx(w,{htmlFor:"discount",className:"font-bold text-slate-800",children:"Discount"}),e.jsx(P,{id:"discount",ref:s,type:"number",min:0,max:a.subtotal,step:.01,defaultValue:a.total_discount,placeholder:(l=a.total_discount)==null?void 0:l.toString(),className:"pl-8",required:!0,autoFocus:!0}),e.jsx("span",{className:"absolute bottom-0 left-0 -translate-y-2 translate-x-3",children:"₱"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(F,{type:"reset",variant:"outline",className:"flex-1 font-medium",onClick:()=>t("awaitingApproval"),children:"Cancel"}),e.jsx(F,{type:"submit",className:"flex-1",children:"Update discount"})]})]})},Lr=({setPage:t})=>{var l;const s=h.useRef(null),{currentInvoicePos:a,setCurrentInvoicePos:r}=le();return e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:c=>{c.preventDefault(),r(n=>{var i;return{...n,paid_amount:Number(((i=s.current)==null?void 0:i.value)??a.paid_amount)}}),t("awaitingApproval")},children:[e.jsxs("div",{className:"relative flex flex-col gap-2",children:[e.jsx(w,{htmlFor:"discount",className:"font-bold text-slate-800",children:"Paid amount"}),e.jsx(P,{id:"discount",ref:s,type:"number",min:0,step:.01,defaultValue:a.paid_amount,placeholder:(l=a.paid_amount)==null?void 0:l.toString(),className:"pl-8",required:!0,autoFocus:!0}),e.jsx("span",{className:"absolute bottom-0 left-0 -translate-y-2 translate-x-3",children:"₱"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(F,{type:"reset",variant:"outline",className:"flex-1 font-medium",onClick:()=>t("awaitingApproval"),children:"Cancel"}),e.jsx(F,{type:"submit",className:"flex-1",children:"Update paid amount"})]})]})},qr=()=>{const{setDialogOptions:t,dialogOptions:s}=ze(),{invoiceItemsDatabase:a,currentInvoiceItemsQueue:r,fullData:l,setFullData:c,currentInvoicePos:n,setCurrentInvoicePos:i}=le(),[o,x]=h.useState("confirming"),{addInvoiceMutation:m}=Ts(),{selectedVoucher:u,setSelectedVoucher:d}=Ye();async function y(){x("submitting"),console.log("Invoice:",n);const j=n;j.invoice_items=a.map(f=>({...f,product_id:f.product_id})),await m(j).then(f=>{u&&It(u.id).then(()=>d(void 0)),c(f.data),x("success"),R.success("Transaction successful.",{autoClose:3e3})}).catch(()=>{x("confirming"),R.error("Transaction failed. Please try again.",{autoClose:3e3})})}h.useEffect(()=>{s.title==="checkout_discount"?i(j=>({...j,status:"pending"})):i(j=>({...j,status:"approved"}))},[s.title]);const p=De();function N(){window.api.send({fullData:l,invoiceItems:r,invoiceItemsDatabase:a})}return e.jsx(Pt,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(At,{children:[e.jsxs(Tt,{className:"items-start",children:[e.jsx(Dt,{children:o!=="success"?`${s.title==="checkout"?"Checkout":"Checkout with Discount"}`:"Transaction successful"}),o!=="success"&&e.jsx(zt,{children:"Confirm the details of this transaction"})]}),o!=="success"?e.jsx(Ds,{}):e.jsxs("div",{className:"my-4 w-full space-y-2 text-center",children:[e.jsx(aa,{size:80,className:"mx-auto text-green-500"}),e.jsx("h3",{className:"text-base font-medium text-slate-700",children:"Transaction has been successully submitted!"})]}),e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(F,{variant:"outline",className:`font-medium ${o!=="confirming"&&"hidden"} flex-1`,type:"reset",onClick:()=>{t({open:!1,title:""})},children:"Cancel"}),o==="success"?e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(F,{className:"flex-1",onClick:()=>{p(0)},children:"New transaction"}),e.jsx(F,{className:"flex-1",type:"submit",onClick:j=>{j.preventDefault(),N()},children:"Print invoice"})]}):e.jsx(F,{className:"flex-1",disabled:o==="submitting",type:"submit",onClick:j=>{j.preventDefault(),x("submitting"),y()},children:o==="confirming"?"Confirm transaction":o==="submitting"?"Submitting...":""})]})]})})},Hr=()=>{const{setDialogOptions:t,dialogOptions:s}=ze(),{handleInvoicePosChange:a,currentInvoicePos:r}=le(),[l,c]=h.useState(r.delivery_charge??0),n=()=>{a("delivery_charge",l),t({open:!1,title:""})};return e.jsx(us,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(hs,{children:[e.jsx(ps,{className:"items-start",children:e.jsx(fs,{children:"Add Delivery Charge"})}),e.jsxs("form",{className:"flex flex-col gap-6",onSubmit:i=>{i.preventDefault()},children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-4 text-black",children:"₱"}),e.jsx(P,{className:"pl-8",defaultValue:l,type:"number",onChange:i=>{c(Number(i.target.value))}})]}),e.jsx(Fs,{asChild:!0,children:e.jsx(F,{className:"w-full ",type:"submit",onClick:()=>{n()},children:"Apply"})})]})]})})},Vr=()=>{const{setDialogOptions:t,dialogOptions:s}=ze(),{invoiceItemsDatabase:a,currentInvoiceItemsQueue:r,fullData:l,currentInvoicePos:c,setCurrentInvoicePos:n}=le(),i=De(),[o,x]=h.useState(!1),[m,u]=h.useState("confirmation"),[d,y]=h.useState();h.useEffect(()=>{s.title==="checkout_discount"&&n(N=>({...N,status:"pending"}))},[s.title]),h.useEffect(()=>{console.log(c)},[c]);function p(){window.api.send({fullData:l,invoiceItems:r,invoiceItemsDatabase:a})}return e.jsx(Pt,{onOpenChange:()=>{t({open:!1,title:""})},open:s.open,children:e.jsxs(At,{onEscapeKeyDown:N=>{N.preventDefault()},children:[e.jsxs(Tt,{className:"items-start",children:[e.jsx(Dt,{children:"Checkout with Discount"}),e.jsxs(zt,{className:"text-left",children:[m==="confirmation"&&"Confirm the details of this transaction, especially the discount. This will be sent to the admin for approval.",m==="awaitingApproval"&&"Please wait for the admin to approve the transaction details."]})]}),m==="confirmation"&&e.jsx(Rr,{isSubmitting:o,setisSubmitting:x,setPage:u,setInvoiceID:y}),m==="awaitingApproval"&&e.jsx(Ur,{invoiceID:d,isSubmitting:o,setisSubmitting:x,setPage:u}),m==="success"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"my-4 w-full space-y-2 text-center",children:[e.jsx(aa,{size:80,className:"mx-auto text-green-500"}),e.jsx("h3",{className:"text-base font-medium text-slate-700",children:"Transaction has been successully submitted!"})]}),e.jsxs("div",{className:"flex w-full flex-row gap-2",children:[e.jsx(F,{className:"flex-1",onClick:()=>{i(0)},children:"New transaction"}),e.jsx(F,{className:"flex-1",type:"submit",onClick:N=>{N.preventDefault(),p()},children:"Print invoice"})]})]}),m==="editDiscount"&&e.jsx(Kr,{setPage:u}),m==="editPaidAmount"&&e.jsx(Lr,{setPage:u})]})})},$r=({})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center",children:[e.jsx(zl,{width:150,height:150,color:"#888888",strokeWidth:-1}),e.jsx("span",{className:"max-w-[300px] text-center text-[#888]",children:"Start entering products / product code / serial number / brand"})]})}),Br=({})=>{const{currentInvoiceItemsQueue:t,handleInvoicePosChange:s,handleInvoiceItemQuantity:a,removeInvoiceItem:r,invoiceItemsDatabase:l}=le();console.log(),h.useEffect(()=>{s("subtotal",t.reduce((n,i)=>n+i.total_price,0))},[t]);const c=[{id:"orderItem",enableResizing:!1,enableHiding:!1,header:()=>e.jsx("div",{className:"flex justify-center",children:"Item #"}),cell:({row:n})=>e.jsx("div",{className:"flex justify-center",children:n.index+1}),size:100},{accessorKey:"name",enableHiding:!1,header:()=>e.jsx("div",{className:"justify-center",children:"Product"}),cell:({row:n})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"text-sm font-bold",children:n.original.product.name}),e.jsx("span",{className:"font-medium",children:n.original.product.size})]}),e.jsxs("div",{className:"flex flex-row items-center gap-1",children:[n.original.product.brand?e.jsx("span",{className:"",children:n.original.product.brand}):e.jsx("span",{className:"font-light",children:"(No Brand)"}),e.jsxs("span",{className:"",children:["• ",n.original.product.color]})]})]}),size:350},{enableHiding:!1,accessorKey:"quantity",header:()=>e.jsx("div",{className:"flex justify-center",children:"Quantity"}),size:150,cell:({row:n})=>{const i=n.index,o=n.original.inventory_product.approved_stocks-n.original.inventory_product.sold_count||0;return e.jsx("div",{className:"flex justify-center ",children:e.jsxs("div",{className:"flex flex-row border drop-shadow-sm",children:[e.jsx(F,{className:"rounded-sm bg-red-300 hover:bg-red-500 disabled:opacity-100",onClick:()=>{a(i,o,l[n.index].quantity-1)},disabled:l[n.index].quantity===1,children:e.jsx("span",{children:"-"})}),e.jsx(P,{id:"quantity",className:"w-20 rounded-none text-center drop-shadow-none",type:"number",defaultValue:l[i].quantity,onChange:x=>{console.log(x.target.value),setTimeout(()=>{a(i,o,Number(x.target.value))},1e3)}}),e.jsx(F,{className:"rounded-sm bg-slate-500 hover:bg-slate-700 disabled:bg-slate-200",onClick:()=>{a(i,o,l[n.index].quantity+1)},disabled:l[n.index].quantity>=o,children:e.jsx("span",{children:"+"})})]})})}},{id:"item_capital_price",size:125,header:()=>e.jsx("div",{className:"justify-center",children:"Capital Price"}),cell:({row:n})=>e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx("span",{children:ie(n.original.capital_price)})})},{accessorKey:"price",enableHiding:!1,header:()=>e.jsx("div",{className:"justify-center",children:"Product Price"}),cell:({row:n})=>e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{children:ie(n.original.price)}),n.original.on_sale?e.jsxs("span",{className:"text-sm font-light",children:["(",ie(n.original.sale_discount??0),")"]}):null]})},{id:"item_total_capital_price",size:125,header:()=>e.jsx("div",{className:"justify-center",children:"Total Capital Price"}),cell:({row:n})=>e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx("span",{children:ie(n.original.capital_price*l[n.index].quantity)})})},{id:"total_price",enableHiding:!1,accessorKey:"total_price",header:()=>e.jsx("div",{className:"justify-center",children:"Subtotal"}),cell:({row:n})=>e.jsx("div",{className:"",children:e.jsx("span",{children:ie(l[n.index].quantity*n.original.price)})}),size:250},{enableHiding:!1,id:"actions",size:100,cell:({row:n})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsx(F,{className:"bg-red-500 hover:bg-red-700",onClick:()=>{r(n.index)},children:e.jsx(is,{color:"#FFF"})})})}];return e.jsx("div",{className:"h-full overflow-y-scroll",children:t.length===0?e.jsx(e.Fragment,{children:e.jsx($r,{})}):e.jsx(Sl,{data:t,columns:c})})},Qr=()=>{const t=["","Product name","Price","Qty","Total"],{selectedInvoiceCode:s}=gt(),{data:a}=ms();return console.log(s),e.jsx(e.Fragment,{children:e.jsxs(Et,{children:[e.jsxs(Za,{children:["Select items the customer wants to return for invoice"," "]}),e.jsx(Mt,{children:e.jsx(ds,{id:"tHeaderRow",className:"hover:bg-white",children:t.map(r=>e.jsx(Wt,{className:"whitespace-nowrap px-5 py-3 text-left text-xs font-bold uppercase",children:r},r+"_head"))},"tHeaderRow")}),e.jsx(Ot,{children:s.invoice_items.length>0&&s.invoice_items.map((r,l)=>e.jsxs(ds,{className:"text-sm font-medium text-gray-700",children:[e.jsx(xe,{className:"p-3 pr-0",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4",name:"return",id:"return"})}),e.jsx(xe,{className:"text-sm font-medium text-gray-700",children:r==null?void 0:r.product.name},(r==null?void 0:r.product.name)+"Product Name"),e.jsx(xe,{children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{children:ie(a.find(c=>c.id===r.product_price_id).cost)}),a.find(c=>c.id===r.product_price_id).on_sale?e.jsxs("span",{className:"text-muted-foreground",children:["(",ie(a.find(c=>c.id===r.product_price_id).sale_discount),")"]}):null]})}),e.jsx(xe,{children:r==null?void 0:r.quantity}),e.jsx(xe,{children:ie(r==null?void 0:r.total_price)})]},(r==null?void 0:r.id)+"row"))}),e.jsx(Ja,{children:e.jsxs(ds,{children:[e.jsx(xe,{colSpan:4,className:"text-right",children:"Total:"}),e.jsx(xe,{children:ie(s.paid_amount)})]})})]})})},Yr=()=>{const[t,s]=h.useState(""),{sellableItems:a,fetchingProducts:r}=ze(),{currentInvoiceItemsQueue:l,setCurrentInvoiceItemsQueue:c,invoiceItemsDatabase:n,setInvoiceItemsDatabase:i,currentInvoicePos:o}=le();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative z-20 pb-10",children:e.jsx("div",{className:"absolute box-content flex w-full ",children:e.jsxs(Be,{className:"rounded-lg border p-1 shadow-md",children:[e.jsx(Qe,{value:t,onValueChange:s,placeholder:r?"Loading Products":"Enter Product Name",disabled:a.length===0||o.payment_method==="balance_payment"}),e.jsx(el,{className:"",children:t?e.jsx(e.Fragment,{children:a.filter(x=>x.inventory_product.approved_stocks>(x.inventory_product.sold_count??0)).map((x,m)=>{var d;const u=x.inventory_product.approved_stocks-x.inventory_product.sold_count;return e.jsx(Ae,{onSelect:()=>{const y=l.findIndex(p=>p.inventory_product.product.id===x.inventory_product.product.id);y!==-1&&(n[y].quantity+=1,s("")),y===-1&&(c([...l,x]),i([...n,{product_id:x.product.id,product_price_id:x.inventory_product.product_price.id,product_price:x.inventory_product.product_price.price,quantity:1,unit:x.unit,item_discount:0,price:x.price,created_by:x.created_by,active_status:x.active_status,created_at:x.created_at,updated_at:x.updated_at,total_price:x.price,source_inventory:x.warehouse.id}]),s(""))},value:`${x.product.id} ${x.id} ${x.product.name} ${x.product.serial_no} ${x.product.brand} ${x.product.color}`,children:e.jsxs("div",{className:"flex flex-1 flex-row justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("span",{className:"font-bold",children:x.product.name}),e.jsx("span",{className:"font-medium",children:(d=x.product.size)==null?void 0:d.replace("inch",'"')})]}),e.jsxs("div",{className:"flex flex-row gap-1",children:[x.product.brand?e.jsxs("span",{className:"text-[12px]",children:["(",x.product.brand,")"]}):e.jsx("span",{className:"text-[12px]",children:"(No Brand)"}),e.jsxs("span",{className:"",children:["• ",x.product.color]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-bold ",children:ie(x.price)}),e.jsxs("span",{className:"font-medium",children:[u," ",u>1?"items":"item"]})]})]})},m)})}):null})]})})})})},vc=({})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex h-full flex-row",children:[e.jsx(et,{}),e.jsxs("div",{className:"flex h-full w-screen flex-row",children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx(Yr,{}),e.jsx(Br,{})]}),e.jsx(Wr,{}),e.jsx(Or,{})]})]})}),Gr=({openModal:t})=>{const{transactions:s,isFetching:a,progress:r}=sl(),l=[{id:"select",header:({table:c})=>e.jsx("input",{type:"checkbox",checked:c.getIsAllPageRowsSelected(),onChange:n=>c.toggleAllPageRowsSelected(!!n.target.checked),"aria-label":"Select all"}),cell:({row:c})=>e.jsx("input",{type:"checkbox",checked:c.getIsSelected(),onChange:n=>c.toggleSelected(!!n.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:()=>e.jsx("div",{className:"text-center",children:"Product ID"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.id})},{accessorKey:"price",header:()=>e.jsx("div",{className:"text-center",children:"Price"}),cell:({row:c})=>{const n=parseFloat(c.getValue("amount")),i=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(n);return e.jsx("div",{className:"text-center",children:i})}},{accessorKey:"product_name",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["PRODUCT NAME ",c.getIsSorted()==="asc"?e.jsx(D,{}):c.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.product_name})},{accessorKey:"dimensions",header:()=>e.jsx("div",{className:"text-center",children:"DIMENSIONS"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.dimensions})},{accessorKey:"serial",header:()=>e.jsx("div",{className:"text-center",children:"SERIAL"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.serial})},{accessorKey:"sku",header:()=>e.jsx("div",{className:"text-center",children:"SKU"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.sku})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"INVENTORY STATUS"}),cell:({row:c})=>{const n=c.getValue("status"),i=n==="LOW"?"bg-red-500":n==="MEDIUM"?"bg-amber-500":"bg-lime-600";return e.jsx("div",{className:`flex w-full flex-1 flex-col text-center ${i}`,children:c.getValue("status")})}},{accessorKey:"type",header:()=>e.jsx("div",{className:"text-center",children:"ORDER TYPE"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.type})},{accessorKey:"quantity",header:()=>e.jsx("div",{className:"text-center",children:"QUANTITY"}),cell:({row:c})=>e.jsx("div",{className:"text-center",children:c.original.quantity})}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:l,filterWhat:"serial",dataType:"Transaction",openModal:()=>t,isLoading:a})})},bc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Transaction",children:e.jsx(tl,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Gr,{openModal:c})})})})})})},Xr=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:r,progress:l,setSelectedTransfer:c}=Ie(),n=a.map(p=>({transfer_id:p.transfer_id})),o=s.filter(p=>{if(n.some(N=>N.transfer_id===p.id))return p}).filter(p=>{if(p.approval_status==="pending")return p}),{auth:x}=oe(),m=p=>{c(p),t(p,"details")},u=p=>{c(p),t(p,"edit")},d=p=>{c(p),t(p,"products")},y=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:p})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>p.toggleSorting(p.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center",children:["TRANSFER CODE ",p.getIsSorted()==="asc"?e.jsx(D,{}):p.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:p})=>e.jsx("div",{children:p.original.code?p.original.code:"N/A"})},{accessorKey:"source",header:()=>e.jsx("div",{className:"text-center",children:"SOURCE-DESTINATION"}),cell:({row:p})=>{const N=p.original.source,j=p.original.destination;return e.jsxs("div",{className:"text-center",children:[N.code,"-",j.code]})}},{accessorKey:"transfer_status",sortingFn:"text",enableSorting:!0,header:({column:p})=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(b,{onClick:()=>p.toggleSorting(p.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center z-10",children:["TRANSFER STATUS ",p.getIsSorted()==="asc"?e.jsx(D,{}):p.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:p})=>e.jsx("div",{className:"text-center",children:p.original.transfer_status?p.original.transfer_status:"N/A"})},{accessorKey:"transfer_schedule",sortingFn:"datetime",enableSorting:!0,header:({column:p})=>e.jsx("div",{className:"flex justify-center",children:e.jsxs(b,{onClick:()=>p.toggleSorting(p.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center z-10",children:["SCHEDULE ",p.getIsSorted()==="asc"?e.jsx(D,{}):p.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:p})=>{const N=p.getValue("transfer_schedule");if(N.toString()!=="0000-00-00 00:00:00"){const j={year:"numeric",month:"long",day:"numeric"},f=new Date(N).toLocaleDateString([],j);return e.jsx("div",{className:"text-center",children:f})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"approval_status",header:()=>e.jsx("div",{className:"text-center",children:"APPROVAL STATUS"}),cell:({row:p})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:p.original.approval_status.toLowerCase()==="approved"?e.jsx($e,{size:20,strokeWidth:2,className:"text-green-600"}):p.original.approval_status.toLowerCase()==="rejected"?e.jsx(ss,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(as,{size:20,strokeWidth:2,className:"text-amber-500"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:p})=>{var j;const N=p.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>m(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),((j=x.role)==null?void 0:j.toLowerCase())!="encoder"&&e.jsxs(B,{onClick:()=>u(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:N.transfer_status!="arrived"&&N.approval_status!="rejected"?e.jsx(be,{size:16,strokeWidth:2.25}):e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>d(N),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:N.transfer_status!="arrived"&&N.approval_status!="rejected"?e.jsx(be,{size:16,strokeWidth:2.25}):e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Transfer Products"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:o,columns:y,filterWhat:"approval_status",dataType:"",openModal:void 0,isLoading:r})})},Zr=({onClose:t})=>{const{selectedTransfer:s}=Ie();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Source"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.source.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.destination.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_status?s.transfer_status.charAt(0).toUpperCase()+s.transfer_status.slice(1):"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Transfer schedule"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.transfer_schedule.toString()==="0000-00-00 00:00:00"?"N/A":ne(s.transfer_schedule)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Received by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.received_by?s.received_by.firstname+" "+s.received_by.lastname:"N/A"})]}),e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Date received"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.date_received?ne(s.date_received):"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.created_by.firstname+" "+s.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approval_status.charAt(0).toUpperCase()+s.approval_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.approved_by?s.approved_by.firstname+" "+s.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(s.updated_at)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.notes?s.notes:"N/A"})]})})]})})},Jr=({openModal:t})=>{const{transfers:s,transferProducts:a,isFetching:r,selectedTransfer:l,setSelectedTransfer:c,selectedProduct:n,setSelectedProduct:i,addProd:o,setAddProd:x}=Ie();oe();const m=a.filter(p=>p.transfer_id===l.id),u=p=>{i(p),x(!1),t(p,"edit")},d=()=>{x(!0),t({},"add")},y=[{id:"select",header:({table:p})=>e.jsx("input",{type:"checkbox",checked:p.getIsAllPageRowsSelected(),onChange:N=>p.toggleAllPageRowsSelected(!!N.target.checked),"aria-label":"Select all"}),cell:({row:p})=>e.jsx("input",{type:"checkbox",checked:p.getIsSelected(),onChange:N=>p.toggleSelected(!!N.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{id:"product_name",sortingFn:"text",enableSorting:!0,header:({column:p})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>p.toggleSorting(p.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",p.getIsSorted()==="asc"?e.jsx(D,{}):p.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:p})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:p.original.product.name})},{accessorKey:"total_quantity",header:()=>e.jsx("div",{className:"text-center",children:"TOTAL QUANTITY"}),cell:({row:p})=>e.jsx("div",{className:"text-center",children:p.original.total_quantity})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"text-center",children:"UNIT"}),cell:({row:p})=>e.jsx("div",{className:"text-center",children:p.original.unit})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:p})=>{const N=p.original;return l.transfer_status!="arrived"&&l.approval_status!="rejected"&&e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsx(b,{fill:"yellow",textColor:"black",onClick:()=>u(N),children:"Edit Product"})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:m,columns:y,filterWhat:"product_name",dataType:"Transfer Products",openModal:l.transfer_status!="arrived"&&l.approval_status!="rejected"?d:void 0,isLoading:r})})},ut=({onClose:t})=>{const{addProd:s,selectedProduct:a}=Ie(),{product:r,allProducts:l,allInventoryProducts:c,inventoryID:n,invCode:i,prodName:o,filteredProductsSrc:x,filteredInventoriesSrc:m,quantityLimit:u,damagedCount:d,isChanged:y,isSubmitting:p,error:N,success:j,handleSubmit:f,handleChange:g,handleChangeSelect:v}=As(),I=r.capital_price?r.capital_price:0,_=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(I);j&&setTimeout(()=>{t()},1e3);const[k,A]=h.useState(s?i:"Loading...");return h.useEffect(()=>{m.length>0&&!s&&r.source_inventory&&A(m.filter(C=>C.id===r.source_inventory)[0].code)},[r.source_inventory,m]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:C=>{C.preventDefault()},children:e.jsxs("div",{className:"flex max-w-6xl flex-col gap-5",children:[e.jsxs("div",{className:"grid grid-cols-12 justify-center gap-3",children:[e.jsxs("div",{className:"col-span-3 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer Product"}),e.jsx(Q,{name:"id",value:r.id,type:"number",disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"col-span-3 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Transfer ID"}),e.jsx(Q,{name:"created_by",placeholder:"User ID",value:r.transfer_id,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Inventory source:"}),e.jsxs(J,{onValueChange:C=>v("inventory_id",C),required:!0,name:"inventory_id",value:k!="Loading..."?s?i:k:"",children:[e.jsx(ee,{name:"inventory_id",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:s?i||"Choose inventory...":k})}),e.jsx(te,{className:"bg-white font-medium",children:m.length<=0?e.jsx("div",{className:"flex h-12 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}):m.map((C,W)=>e.jsx(V,{value:C.code,className:"text-sm font-medium text-slate-700",children:C.code},W))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 justify-center gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Product to transfer:"}),e.jsxs(J,{onValueChange:C=>v("product_id",Number(C.split("-")[0]),Number(C.split("-")[1])),required:!0,name:"product_id",disabled:!n,children:[e.jsx(ee,{name:"product_id",className:"flex flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:s?n?"Choose product...":"Select inventory first":k!="Loading..."?o==""?"Choose product...":o:"Loading..."})}),e.jsx(te,{className:"bg-white font-medium",children:x.length<=0?!s&&k!="Loading..."?e.jsx("div",{className:"flex h-12 w-full items-center justify-center px-2",children:"No items in selected inventory."}):e.jsx("div",{className:"px-2",children:" Loading... "}):x.map((C,W)=>e.jsx(V,{value:C.product.id?C.product.id.toString()+"-"+W.toString():"",className:`text-sm font-medium text-slate-700
												${!s&&C.product.id==a.product.id&&"selected"}`,children:C.product.name},W))})]})]}),e.jsxs("div",{className:"col-span-6 flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"Capital Price:"}),e.jsx(Q,{name:"capital_price",type:"string",value:_,disabled:!0,readOnly:!0})]})]}),e.jsxs("div",{className:"flex flex-row justify-center gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"TOTAL QUANTITY"}),e.jsx(Q,{name:"total_quantity",type:"string",value:r.total_quantity||"",placeholder:`Available stocks: ${u}`,disabled:!r.capital_price,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-bold uppercase",children:"UNIT"}),e.jsx(Q,{name:"unit",type:"string",value:r.unit||"",placeholder:"box, pieces, etc.",disabled:!0,readOnly:!0})]}),r.total_quantity!=0&&d!=0&&r.total_quantity==u&&e.jsxs("div",{className:"group mb-2 grid content-end",children:[e.jsx(Rs,{size:30,strokeWidth:2,className:"self-center text-yellow-600"}),e.jsxs("span",{className:"text-nowrap absolute left-1/2 mx-auto -translate-x-10 -translate-y-2 rounded-md bg-gray-800 px-1 text-sm text-gray-100 opacity-0 transition-opacity group-hover:opacity-100",children:["Some damaged goods (",d," ",r.unit,") are included in the transfer."]})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"col-span-5 flex flex-col items-start",children:[j&&e.jsx("div",{className:"font-bold text-green-700",children:j}),N&&e.jsx("div",{className:"font-bold text-red-700",children:N}),p?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"col-span-5 flex flex-col items-end gap-3",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),y&&e.jsx(b,{type:"submit",fill:y?"green":null,disabled:!y,onClick:f,children:p?"Submitting":s?"Add Product":"Edit Product"})]})})]})})]})})})},en=({onClose:t})=>{const{isOpen:s,openModal:a,closeModal:r}=de(),[l,c]=h.useState("");oe();const n=(i,o)=>{a(),c(o)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col gap-5",children:e.jsx(Jr,{openModal:n})}),e.jsx(ue,{title:l==="edit"?"Edit Transfer Product":"Add Transfer Product",isOpen:s,onClose:r,children:e.jsxs(e.Fragment,{children:[l==="edit"&&e.jsx(ut,{onClose:r}),l==="add"&&e.jsx(ut,{onClose:r})]})})]})},wc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Transfer",children:e.jsxs(kt,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(Xr,{openModal:c})})}),e.jsx(ue,{title:r==="details"?"Transfer Details":r==="edit"?"Edit Transfer":"Transfer Products",isOpen:t,onClose:a,closeOnOverlayClick:r==="details",children:e.jsxs(e.Fragment,{children:[r==="details"&&e.jsx(Zr,{onClose:a}),r==="edit"&&e.jsx(da,{onClose:a}),r==="products"&&e.jsx(en,{onClose:a})]})})]})})})},sn=({openModal:t})=>{const{invoices:s,isFetching:a,users:r,userSales:l,setSelectedInvoice:c}=Rt(),n=o=>{c(o.invoices),t(o,"details")},i=[{accessorKey:"issued_by",sortingFn:"text",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["FULL NAME ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.invoices[0].issued_by.firstname+" "+o.original.invoices[0].issued_by.lastname})},{id:"total_sales",sortingFn:"basic",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["NUMBER OF SALES ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>e.jsx("div",{className:"text-center",children:o.original.invoices.length})},{id:"amount_sales",sortingFn:"basic",enableSorting:!0,header:({column:o})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{o.toggleSorting(o.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TOTAL AMOUNT OF SALES ",o.getIsSorted()==="asc"?e.jsx(D,{}):o.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:o})=>{const m=o.original.invoices.filter(d=>d.status==="approved").reduce((d,y)=>d+y.paid_amount,0),u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m);return e.jsx("div",{className:"text-center",children:u})}},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:o})=>{const x=o.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>n(x),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:l,columns:i,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:a})})},tn=({onClose:t})=>{const{invoices:s,selectedInvoice:a,isFetching:r}=Rt(),l=a[0],c=[{id:"select",header:({table:n})=>e.jsx("input",{type:"checkbox",checked:n.getIsAllPageRowsSelected(),onChange:i=>n.toggleAllPageRowsSelected(!!i.target.checked),"aria-label":"Select all"}),cell:({row:n})=>e.jsx("input",{type:"checkbox",checked:n.getIsSelected(),onChange:i=>n.toggleSelected(!!i.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"or_no",sortingFn:"alphanumeric",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{n.toggleSorting(n.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["OR NUMBER ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.or_no})},{accessorKey:"created_at",sortingFn:"datetime",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{n.toggleSorting(n.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["CREATED AT ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>{const i=n.getValue("created_at");if(i.toString()!=="0000-00-00 00:00:00"){const o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},x=new Date(i).toLocaleDateString([],o);return e.jsx("div",{className:"text-center",children:x})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"warehouse",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE CODE"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.warehouse.code})},{id:"customer",header:()=>e.jsx("div",{className:"text-center",children:"CUSTOMER NAME"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.customer.firstname+" "+n.original.customer.lastname})},{accessorKey:"type",sortingFn:"text",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{n.toggleSorting(n.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TRANSACTION TYPE ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.type})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"STATUS"}),cell:({row:n})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:n.original.status.toLowerCase()==="approved"?e.jsx($e,{size:20,strokeWidth:2,className:"text-green-600"}):n.original.status.toLowerCase()==="rejected"?e.jsx(ss,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(as,{size:20,strokeWidth:2,className:"text-amber-500"})})},{accessorKey:"subtotal",header:()=>e.jsx("div",{className:"text-center",children:" SUBTOTAL "}),cell:({row:n})=>{const i=n.original.subtotal,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_discount",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL DISCOUNT "}),cell:({row:n})=>{const i=n.original.total_discount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_tax",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL TAX "}),cell:({row:n})=>{const i=n.original.total_tax,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"delivery_charge",header:()=>e.jsx("div",{className:"text-center",children:" DELIVERY CHARGE "}),cell:({row:n})=>{const i=n.original.delivery_charge,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_amount_due",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL AMOUNT DUE "}),cell:({row:n})=>{const i=n.original.total_amount_due,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"paid_amount",header:()=>e.jsx("div",{className:"text-center",children:" PAID AMOUNT "}),cell:({row:n})=>{const i=n.original.paid_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"change_amount",header:()=>e.jsx("div",{className:"text-center",children:" CHANGE AMOUNT "}),cell:({row:n})=>{const i=n.original.change_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"payment_method",header:()=>e.jsx("div",{className:"text-center",children:" PAYMENT METHOD "}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.payment_method||"N/A"})},{accessorKey:"reference_no",header:({column:n})=>e.jsx("div",{className:"text-center",children:"REF #"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.reference_no||"--"})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl max-h-96 flex-col gap-4",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Issuer: ",l.issued_by.firstname+" "+l.issued_by.lastname]}),e.jsx("div",{className:"overflow-x-hidden",children:e.jsx(X,{data:a,columns:c,filterWhat:"or_no",dataType:"",openModal:void 0,isLoading:r})})]})})},_c=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"User Sales",children:e.jsxs(al,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(sn,{openModal:c})})}),e.jsx(ue,{isOpen:t,onClose:a,title:r==="details"?"Invoice Details":"",closeOnOverlayClick:r==="details",children:e.jsx(e.Fragment,{children:r==="details"&&e.jsx(tn,{onClose:a})})})]})})})},an=()=>{const{roles:t,roleSelect:s,permissions:a,allPermissions:r,permissionChange:l,roleId:c,isChanged:n,isSubmitting:i,error:o,success:x,handleChange:m,handleChangeSelect:u,handleSubmit:d}=Ll(),{auth:y}=oe(),p=r.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&g.title.includes("users".toLowerCase()))),N=r.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&!g.title.includes("transfer".toLowerCase())&&g.title.includes("product".toLowerCase())||g.title.includes("capital".toLowerCase()))),j=r.filter(g=>Object.keys(g).some(v=>!g.title.includes("view".toLowerCase())&&g.title.includes("transfer".toLowerCase()))),f=r.filter(g=>Object.keys(g).some(v=>g.title.includes("view".toLowerCase())));return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto flex h-full max-h-full w-full flex-row divide-x",children:[e.jsxs("div",{className:"flex w-60 flex-none flex-col p-2 pt-8",children:[e.jsx("h3",{className:"ml-4 pb-1 text-xs font-semibold text-slate-500/80",children:"Roles"}),e.jsx("div",{className:"w-full",children:t?t.map(g=>g.title!=="super_admin"&&e.jsx(F,{variant:"ghost",className:`w-full justify-start capitalize text-slate-700 ${(s==null?void 0:s.title)===g.title&&"bg-slate-300/40"}`,onClick:()=>u("roles",g.title),children:g.title.split("_").join(" ")},g.id+g.title)):e.jsx("div",{className:"flex h-16 w-full items-center justify-center text-slate-500",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})})}),e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-slate-500/80",children:"After saving changes, affected users must log out and log back in to apply the changes."}),(s==null?void 0:s.title)===y.role&&e.jsx("p",{className:"ml-4 pt-6 text-xs font-semibold text-red-500/80",children:"You are editing your current role. Review your changes carefully."}),e.jsxs("div",{className:"mt-auto w-full space-y-3",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[x&&e.jsx("p",{className:"text-green-600",children:x}),o&&e.jsx("p",{className:"text-red-600",children:o})]}),n&&e.jsx(F,{type:"submit",className:"w-full disabled:cursor-not-allowed",disabled:!!i,onClick:d,children:i?"Saving...":"Save changes"})]})]}),s?e.jsx(Re,{className:"w-full",type:"auto",style:{"--border":"216 12% 84%"},children:e.jsxs("div",{className:`mx-auto flex w-full max-w-[700px] flex-1 flex-col gap-8 p-6 pt-8 ${!s||i?"pointer-events-none opacity-50":null}`,children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"User Management"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:p.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):p.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:`${!((s==null?void 0:s.title)==="super_admin"||(s==null?void 0:s.title)==="admin")&&"cursor-pointer"} text-sm capitalize text-slate-700`,children:g.title.split("_").join(" ")}),e.jsx(Ve,{id:g.title,name:g.title,value:g.id,disabled:(s==null?void 0:s.title)==="super_admin"||(s==null?void 0:s.title)==="admin",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:l.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Products"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:N.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):N.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(Ve,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:l.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Transfers"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:j.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):j.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(Ve,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:l.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"ml-4 text-sm font-semibold text-slate-500/80",children:"Views"}),e.jsx("div",{className:"w-full divide-y rounded-lg border",children:f.length===0?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(G,{size:28,strokeWidth:2,className:"animate-spin"})}):f.map(g=>e.jsxs("div",{className:"flex w-full flex-row items-center justify-between p-4",children:[e.jsx(w,{htmlFor:g.title,className:"cursor-pointer text-sm capitalize text-slate-700",children:g.title.split("_").join(" ")}),e.jsx(Ve,{id:g.title,name:g.title,value:g.id,className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",checked:l.some(v=>v.permission_id===g.id),onCheckedChange:v=>m(v,g.id)})]},g.id))})]})]})}):e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsx("p",{className:"text-lg font-medium text-slate-700/50",children:"Select a role to view and modify permissions"})})]})})},Sc=()=>e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Role Permissions",children:e.jsx(_t,{children:e.jsx("div",{className:"flex h-full max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(an,{})})})})})}),ln=({handleViewItems:t,handleViewDetails:s,handleEditInventory:a})=>[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"warehouse.code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["WHS"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"date_received",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Received"})},{accessorKey:"transfer_id",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Transer Id"}),cell:({row:l})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{children:l.original.transfer_id?l.original.transfer_id:"—"})})},{accessorKey:"created_by",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Created by"}),cell:({row:l})=>e.jsx("div",{className:"uppercase",children:e.jsxs("span",{className:"max-w-[25ch] truncate",children:[l.original.created_by.firstname," ",l.original.created_by.lastname]})})},{accessorKey:"notes",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Notes"}),cell:({row:l})=>e.jsx("div",{children:e.jsx("p",{className:"max-w-[25ch] truncate",children:l.original.notes?l.original.notes:"—"})})},{id:"actions",cell:({row:l})=>{const c=l.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{t(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ut,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View items"})]}),e.jsxs(B,{onClick:()=>{s(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>{a(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]})]})]})})},enableGlobalFilter:!1}],rn=({openModal:t,filterWarehouse:s,setTotalInventories:a})=>{const[r,l]=h.useState([]),{data:c,isLoading:n,setSelectedInventory:i}=Ys(),o=De();h.useEffect(()=>{l(s?c.filter(y=>y.warehouse.id===s):c),a(c.length)},[c,s]);const x=()=>{t({},"add")},m=y=>{i(y),t(y,"edit")},u=y=>{i(y),o(`/inventory/items/${y.id}`)},d=y=>{i(y),t(y,"view_details")};return e.jsx(e.Fragment,{children:e.jsx(X,{columns:ln({handleViewItems:u,handleViewDetails:d,handleEditInventory:m}),data:r.sort((y,p)=>{let N=new Date(y.updated_at??y.created_at);return new Date(p.updated_at??p.created_at).getTime()-N.getTime()}),filterWhat:"code",dataType:"Inventory",openModal:x,isLoading:n})})},nn=({FormValue:t,handleChange:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"date_received",className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsxs(ye,{children:[e.jsx(je,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(F,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ws,{size:18,strokeWidth:1.5}),t.date_received?t.date_received:"Choose date..."]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(ns,{mode:"single",initialFocus:!0,required:!0,onDayClick:a=>{const r=new Date(a),l=`${r.getFullYear()}-${(r.getMonth()+1).toString().padStart(2,"0")}-${r.getDate().toString().padStart(2,"0")}`;s("date_received",l)},selected:t.date_received?new Date(t.date_received):new Date})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(P,{id:"notes",name:"notes",type:"text",defaultValue:t.notes?t.notes:void 0,maxLength:1e3,placeholder:"Notes...",onChange:a=>s("notes",a.target.value)})]})]})}),xa=(t,s,a)=>{const r=a||new Date,l=r.getFullYear()+"-"+("0"+(r.getMonth()+1)).slice(-2)+"-"+("0"+r.getDate()).slice(-2),c=t.slice(0,3),n=s.toString().padStart(4,"0");return`${c}-${l}-${n}`.toUpperCase()},cn=({onClose:t,totalInventories:s,warehouses:a})=>{const{auth:r}=oe(),{value:l,setValue:c,handleChange:n,handleSubmit:i}=ea(),[o,x]=h.useState(!1),[m,u]=h.useState(null);h.useEffect(()=>{n("created_by",r.user.id),n("type","supplier")},[]);const[d,y]=h.useState();return h.useEffect(()=>{if(d){const p=xa(d,s+1);n("code",p)}},[d]),e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:async p=>{p.preventDefault(),l.date_received===void 0?u("Please select a date for date received."):(x(!o),i({action:"add",data:l}).then(()=>{x(!1),R.success("Inventory added successfully."),t()}).catch(N=>{x(!1),N.response.data.message?R.error(N.response.data.message):R.error("Failed to add inventory.")}))},children:[e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"code",className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx(P,{id:"code",name:"code",type:"text",value:l.code||"",readOnly:!0,placeholder:"Code..."})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"warehouse",className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs(J,{onValueChange:p=>{var N;n("warehouse_id",Number(p)),y((N=a.find(j=>j.id===Number(p)))==null?void 0:N.code)},required:!0,children:[e.jsx(ee,{name:"warehouse",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:"Choose warehouse..."})}),e.jsx(te,{className:"bg-white font-medium",children:a.map((p,N)=>e.jsxs(V,{value:p.id.toString(),className:"text-sm font-medium text-slate-700",children:[p.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+p.code+" • "+p.location})]},N))})]})]})]}),e.jsx("hr",{className:"col-span-12 my-2 h-px w-full border-0 bg-gray-200"}),e.jsx("div",{className:"flex flex-col justify-center gap-1",children:e.jsx(nn,{FormValue:l,handleChange:n})})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:o||Object.keys(l).length<=2||!d,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:o?"Submitting...":"Add inventory"})]})}),m&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-semibold text-red-600",children:m})})]})})},on=({onClose:t})=>{const{selectedInventory:s}=Ys(),{transfers:a,isFetching:r}=Kt(),l=a.find(c=>c.id===s.transfer_id);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx("p",{className:"text-sm",children:s.code})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Type"}),e.jsx("p",{className:"text-sm capitalize",children:s.type})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"ID"}),e.jsx("p",{className:"text-sm",children:s.id})]}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs("p",{className:"text-sm",children:[s.warehouse.name," (",s.warehouse.code,")"]})]}),s.type==="transfer"&&e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transfer Code"}),e.jsx("p",{className:"text-sm capitalize",children:r?"Loading...":l==null?void 0:l.code})]}),e.jsxs("div",{className:`flex flex-col justify-center gap-1 ${s.type==="supplier"?"col-span-7":"col-span-3"}`,children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsx("p",{className:"text-sm capitalize",children:s.date_received?s.date_received:"—"})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx("p",{className:"text-sm capitalize",children:s.notes?s.notes:"—"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsxs("p",{className:"text-sm capitalize",children:[s.created_by.firstname," ",s.created_by.lastname]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm capitalize",children:ne(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm capitalize",children:s.updated_at?ne(s.updated_at):"—"})]})]})]})})},dn=({onClose:t,warehouses:s})=>{const{selectedInventory:a}=Ys(),{value:r,handleChange:l,handleSubmit:c}=ea(),{transfers:n,isFetching:i}=Kt(),[o,x]=h.useState(!1),[m,u]=h.useState(!1),[d,y]=h.useState(null),p=f=>n.find(g=>f===g.id),[N,j]=h.useState();return h.useEffect(()=>{if(N){const f=xa(N,a.id,new Date(a.created_at));l("code",f)}},[N]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async f=>{u(!m),f.preventDefault(),c({action:"update",id:a.id,data:r}).then(()=>{u(!1),R.success("Inventory updated successfully."),t()}).catch(g=>{u(!1),g.response.data.message?R.error(g.response.data.message):R.error("Failed to update inventory.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"code",className:"text-sm font-bold text-gray-600",children:"Code"}),e.jsx(P,{id:"code",name:"code",type:"text",value:r.code||a.code||"",readOnly:!0,placeholder:"Code..."})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"warehouse",className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsxs(J,{onValueChange:f=>{var g;l("warehouse_id",Number(f)),j((g=s.find(v=>v.id===Number(f)))==null?void 0:g.code)},defaultValue:a.warehouse.id.toString(),required:!0,children:[e.jsx(ee,{name:"warehouse",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm",children:e.jsx(se,{placeholder:"Choose warehouse..."})}),e.jsx(te,{className:"bg-white font-medium",children:s.map((f,g)=>e.jsxs(V,{value:f.id.toString(),className:"text-sm font-medium text-slate-700",children:[f.name,e.jsx("span",{className:"truncate text-xs text-slate-700/60",children:" • "+f.code+" • "+f.location})]},g))})]})]})]}),e.jsx("hr",{className:"col-span-12 my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"type",className:"text-sm font-bold text-gray-600",children:"Type"}),e.jsxs(J,{defaultValue:a.type,onValueChange:f=>l("type",f),children:[e.jsx(ee,{name:"type",className:"flex max-w-[30ch] flex-row items-center gap-3 truncate bg-white text-sm capitalize",children:e.jsx(se,{placeholder:"Choose type..."})}),e.jsxs(te,{className:"bg-white font-medium",children:[e.jsx(V,{value:"supplier",className:"text-sm font-medium text-slate-700",children:"Supplier"}),e.jsx(V,{value:"transfer",className:"text-sm font-medium text-slate-700",children:"Transfer"})]})]})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"date_received",className:"text-sm font-bold text-gray-600",children:"Date received"}),e.jsxs(ye,{children:[e.jsx(je,{id:"date_received",name:"date_received",asChild:!0,children:e.jsxs(F,{variant:"outline",className:"flex w-full flex-row items-center justify-start gap-2 bg-white text-sm font-normal",children:[e.jsx(ws,{size:18,strokeWidth:1.5}),r.date_received?r.date_received:a.date_received]})}),e.jsx(ve,{className:"w-auto p-0",children:e.jsx(ns,{mode:"single",initialFocus:!0,required:!0,month:r.date_received?new Date(r.date_received):new Date(a.date_received),onDayClick:f=>{const g=new Date(f),v=`${g.getFullYear()}-${(g.getMonth()+1).toString().padStart(2,"0")}-${g.getDate().toString().padStart(2,"0")}`;l("date_received",v)},selected:r.date_received?new Date(r.date_received):new Date(a.date_received)})})]})]}),(a.type==="transfer"||r.type==="transfer")&&e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"transfer_id",className:"text-sm font-bold text-gray-600",children:"Transfer Item"}),e.jsxs(ye,{open:o,onOpenChange:x,children:[e.jsx(je,{className:"relative my-2 w-full",asChild:!0,children:e.jsxs(F,{role:"combobox",className:"my-0 w-full justify-between text-sm text-slate-700",variant:"outline",children:[n?r.transfer_id?(()=>{const f=p(r.transfer_id);return e.jsx("div",{className:"flex items-baseline gap-4",children:f==null?void 0:f.code})})():a.transfer_id?(()=>{const f=p(a.transfer_id);return e.jsx("div",{className:"flex items-baseline gap-4",children:f?f.code:"Loading..."})})():"Select inventory item...":"Loading...",e.jsx(Je,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"w-[462px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Be,{children:[e.jsx(Qe,{id:"transfer_id",name:"transfer_id",placeholder:"Transfer code..."}),i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ze,{children:"No match found"}),e.jsx(Re,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Oe,{children:n.map(f=>e.jsxs(Ae,{value:f.id.toString()+f.code,onSelect:()=>{l("transfer_id",f.id),x(!1)},className:"cursor-pointer justify-between rounded-sm",children:[e.jsx("span",{children:f.code}),e.jsxs("span",{className:"text-xs font-semibold text-slate-700/50",children:[f.approval_status," • ",f.source.code,"->",f.destination.code," • ",f.transfer_status]})]},f.id))})})]})})]})]}),e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"notes",className:"text-sm font-bold text-gray-600",children:"Notes"}),e.jsx(P,{id:"notes",name:"notes",type:"text",defaultValue:r.notes?r.notes:a.notes?a.notes:void 0,maxLength:1e3,placeholder:"Notes...",onChange:f=>l("notes",f.target.value)})]})]}),e.jsx("div",{className:"flex w-full flex-row pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4 whitespace-nowrap",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:m||Object.keys(r).length===0,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying changes...":"Apply changes"})]})}),d&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:d})})]})})})},Cc=()=>{const{warehouses:t}=ts(),[s,a]=h.useState(0),[r,l]=h.useState(0),{openModal:c,isOpen:n,closeModal:i}=de(),[o,x]=h.useState(""),m=(u,d)=>{x(d),c()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Inventory",children:e.jsxs(ll,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:u=>a(Number(u)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx(V,{value:"0",children:"All"},"all"),t.map(u=>e.jsxs(V,{value:u.id.toString(),children:[u.name," (",u.code,")"]},u.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(rn,{filterWarehouse:s>0?s:void 0,openModal:m,setTotalInventories:l})})]}),e.jsx(ue,{isOpen:n,onClose:i,title:o==="add"?"Add Inventory":o==="view_details"?"Details":o==="edit"?"Edit Inventory":"",closeOnOverlayClick:o==="view_details",children:e.jsxs(e.Fragment,{children:[o==="add"&&e.jsx(cn,{warehouses:t,totalInventories:r,onClose:i}),o==="view_details"&&e.jsx(on,{onClose:i}),o==="edit"&&e.jsx(dn,{warehouses:t,onClose:i})]})})]})})})},xn=({handleViewDetails:t,handleEditInventoryProduct:s,handleApproveInventoryProduct:a,handleDeleteInventoryProduct:r})=>[{id:"product_name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Name"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Cap. Price"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:c.original.capital_price?n:"—"})})}},{accessorKey:"stocks_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Stocks"})},{accessorKey:"approved_stocks",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Approved"})},{accessorKey:"sold_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Sold"})},{accessorKey:"remaining_stocks_count",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Remaining"}),cell:({row:c})=>{const n=c.original.remaining_stocks_count??0,i=c.original.stocks_count*.2,o=c.original.stocks_count*.5;return e.jsxs(Ue,{children:[e.jsx(Ke,{children:e.jsx("span",{className:`${i>=n?"font-extrabold text-red-600 drop-shadow":o>=n?"font-extrabold text-amber-600 drop-shadow":""}`,children:n})}),e.jsx(Le,{children:i>=n?"Remaining stocks are low!":o>=n?"Remaining stocks are below 50%":"Remaining stocks are above 50%"})]})}},{accessorKey:"status",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Status"}),cell:({row:c})=>e.jsx(Ue,{children:e.jsxs("div",{className:"group relative flex w-fit items-center",children:[e.jsx(Ke,{children:c.original.approved_stocks>0?e.jsx(xs,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(as,{size:20,strokeWidth:2,className:"text-gray-600"})}),e.jsx(Le,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:c.original.approved_stocks>0?"Approved":"Pending"})})]})})},{id:"actions",cell:({row:c})=>{const n=c.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{t(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>{s(n)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsxs(B,{onClick:()=>a(n),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(xs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve stocks"})]}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>r(n),className:"flex flex-row items-center gap-3 rounded-md p-2 focus:bg-red-100 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(is,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Delete"})]})]})]})})},enableGlobalFilter:!1}],mn=({openModal:t,inventory:s})=>{const{data:a,isLoading:r,setSelectedInventoryProduct:l}=js(),c=()=>{t({},"add")},n=m=>{l(m),t(m,"view_details")},i=m=>{l(m),t(m,"edit")},o=m=>{l(m),t(m,"approve")},x=m=>{l(m),t(m,"delete")};return e.jsxs(Xe,{children:[e.jsxs(b,{fill:r?"default":"primary",onClick:()=>{window.api.invSend({inventory:s,products:a})},className:"ml-4 mt-2 flex h-8 flex-row disabled:cursor-not-allowed disabled:opacity-40",children:[e.jsx(na,{size:26,strokeWidth:2})," Print Inventory Details"]}),e.jsx(X,{columns:xn({handleViewDetails:n,handleEditInventoryProduct:i,handleApproveInventoryProduct:o,handleDeleteInventoryProduct:x}),data:a||[],filterWhat:"product_name",dataType:"Items",openModal:c,isLoading:r})]})},un=({setInventoryProductsQueue:t,inventoryId:s,products:a,productsLoading:r,suppliers:l,suppliersLoading:c,currentId:n,handleNavigation:i,selectedProduct:o})=>{var k,A,C,W,K,M,L;const{auth:x}=oe(),m=!!((k=x.rolePermissions)!=null&&k.find(S=>S.permission_id===7)),{value:u,handleChange:d}=ls(),[y,p]=h.useState(!1),[N,j]=h.useState(!1),[f,g]=h.useState(null),v=De();h.useEffect(()=>{console.log(x.rolePermissions),d("inventory_id",s),d("unit","pcs"),o&&(d("product_id",o.data.product_id),d("supplier_id",o.data.supplier_id),d("capital_price",o.data.capital_price),d("unit",o.data.unit),d("stocks_count",o.data.stocks_count),d("damage_count",o.data.damage_count),d("total_count",o.data.total_count),d("approved_stocks",o.data.approved_stocks)),!o&&!m&&d("capital_price",0)},[]);const[I,_]=h.useState();return h.useEffect(()=>{const S=st(u.stocks_count||0,u.damage_count||0);_(S),d("total_count",S)},[u.damage_count,u.stocks_count,I]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:S=>{S.preventDefault(),u.product_id===void 0?g("Please select a product first."):u.supplier_id===void 0?g("Please select a supplier first."):(t(o?ce=>[...ce.filter(O=>O.id!==o.id),{id:o.id,data:u}]:ce=>[...ce,{id:n+1,data:u}]),i())},children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-8 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_id",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsxs(ye,{open:y,onOpenChange:p,children:[e.jsx(je,{id:"product_id",className:"relative w-full",asChild:!0,autoFocus:!0,children:e.jsxs(F,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[u.product_id?e.jsx(e.Fragment,{children:(()=>{const S=a.find(ce=>ce.id===u.product_id);return e.jsxs("div",{className:"flex w-full flex-row items-baseline gap-4",children:[e.jsx("span",{children:S==null?void 0:S.name}),e.jsxs("div",{className:"flex gap-4 truncate text-xs font-semibold",children:[(S==null?void 0:S.brand)&&e.jsx("span",{children:`Brand: ${S==null?void 0:S.brand}`}),(S==null?void 0:S.size)&&e.jsx("span",{children:`Size: ${S==null?void 0:S.size}`}),(S==null?void 0:S.color)&&e.jsx("span",{children:`Color: ${S==null?void 0:S.color}`})]})]})})()}):e.jsx("span",{children:"Select a product..."}),e.jsx(Je,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"min-w-[756px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Be,{children:[e.jsx(Qe,{placeholder:"Product name or serial number..."}),r&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ze,{children:"No match found"}),e.jsxs(Re,{className:"max-h-[200px] overflow-y-scroll",children:[e.jsx(Oe,{forceMount:!0,children:e.jsxs(Ae,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{v("/products"),j(!1)},forceMount:!0,children:[e.jsx("span",{children:"Add new product..."}),e.jsx(ct,{size:16,strokeWidth:2.25,className:"text-slate-700/50"})]},"create-new-product")}),e.jsx(it,{}),e.jsx(Oe,{children:a.map((S,ce)=>e.jsx(Ae,{className:"cursor-pointer justify-between rounded-sm border-b",value:S.id+"_"+S.name+"_"+S.serial_no,onSelect:()=>{d("product_id",S.id),p(!1)},children:`${S.name} • ${S.brand} • ${S.size} • ${S.color}`},ce))})]})]})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(ye,{open:N,onOpenChange:j,children:[e.jsx(je,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(F,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[u.supplier_id?e.jsx(e.Fragment,{children:(()=>{const S=l.find(ce=>ce.id===u.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:S==null?void 0:S.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:S==null?void 0:S.address})]})})()}):e.jsx("span",{children:"Select a supplier..."}),e.jsx(Je,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"min-w-[315px] p-0 text-sm font-medium text-slate-700",children:e.jsxs(Be,{children:[e.jsx(Qe,{placeholder:"Supplier name or address..."}),c&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ze,{children:"No match found"}),e.jsxs(Re,{className:"max-h-[200px] overflow-y-scroll",children:[e.jsx(Oe,{forceMount:!0,children:e.jsxs(Ae,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{v("/supplier"),j(!1)},children:[e.jsx("span",{children:"Add new supplier..."}),e.jsx(ct,{size:16,strokeWidth:2.25,className:"text-slate-700/50"})]},"create-new-supplier")}),e.jsx(it,{}),e.jsx(Oe,{children:l.map((S,ce)=>e.jsxs(Ae,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{d("supplier_id",S.id),j(!1)},children:[e.jsx("span",{children:S.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:S.address})]},ce))})]})]})})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"relative col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(P,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",disabled:!m,value:u.capital_price||"",onBlur:S=>{u.capital_price!==void 0&&(S.target.value=Number(S.target.value).toFixed(2))},onChange:S=>{d("capital_price",Number(Number(S.target.value).toFixed(2)))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(P,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,value:u.unit||"",onChange:S=>d("unit",S.target.value)})]}),e.jsxs("div",{className:`${(A=x.role)!=null&&A.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(P,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:(C=u.stocks_count)==null?void 0:C.toFixed(0),required:!0,onChange:S=>{d("stocks_count",Number(Number(S.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:`${(W=x.role)!=null&&W.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(P,{id:"damage_count",name:"damage_count",type:"number",min:0,max:u.stocks_count??0,step:1,required:!0,value:(K=u.damage_count)==null?void 0:K.toFixed(0),onChange:S=>d("damage_count",Number(Number(S.target.value).toFixed(0)))})]}),e.jsxs("div",{className:`${(M=x.role)!=null&&M.includes("admin")?"col-span-3":"col-span-4"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(P,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,readOnly:!0,value:I??"0",className:`${I&&I<0&&"text-red-600"}`})]}),((L=x.role)==null?void 0:L.includes("admin"))&&e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(P,{id:"total_count",name:"total_count",type:"number",min:0,max:u.stocks_count??0,step:1,value:u.approved_stocks!==void 0?String(u.approved_stocks):"",onChange:S=>d("approved_stocks",S.target.value),onBlur:S=>{d("approved_stocks",Number(S.target.value))}})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsx("div",{className:"ml-auto flex flex-row gap-4",children:e.jsx(b,{type:"submit",fill:"green",disabled:u.product_id===void 0||u.supplier_id===void 0,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:o?"Save changes":"Add item to queue"})})}),f&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:f})})]})})})},hn=["","Name","Brand","Size","Color","Supplier","Capital price","Unit","Stocks","Damaged","Total","Approved"],pn=({data:t,products:s,suppliers:a,handleEditItem:r,handleRemoveItem:l,handleSubmit:c,onClose:n})=>{const[i,o]=h.useState(!1),[x,m]=h.useState(null),u=()=>{o(!0),c({action:"add",data:t.map(d=>d==null?void 0:d.data)}).then(()=>{R.success("Items added to inventory."),o(!1),n()}).catch(d=>{m("Error adding items to inventory"),d.response.data.message?R.error(d.response.data.message):R.error("Error adding items to inventory.")})};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative flex h-full flex-col",children:e.jsxs(Xe,{children:[e.jsxs(Re,{type:"always",className:"flex-1 rounded-md border border-gray-200 bg-white",style:{"--border":"216 12% 84%"},children:[t.length<=0&&e.jsx("div",{className:"absolute z-10 flex h-full w-full items-center justify-center",children:e.jsx("p",{className:"text-lg font-medium text-gray-500/50",children:"No items in queue"})}),e.jsx(ot,{orientation:"horizontal",className:"z-50 h-3"}),e.jsx(ot,{orientation:"vertical",className:"z-50 h-3",style:{"--border":"216 12% 84%"},asChild:!0}),e.jsxs(Et,{children:[e.jsx(Mt,{children:e.jsx(ds,{id:"tHeaderRow",className:"hover:bg-white",children:hn.map(d=>e.jsx(Wt,{className:"whitespace-nowrap px-5 py-3 text-xs font-bold uppercase",children:d},d+"_head"))},"tHeaderRow")}),e.jsx(Ot,{className:"[&>*:nth-child(even)]:bg-white [&>*:nth-child(odd)]:bg-gray-50",children:t.length>0&&t.map(d=>{var y,p,N,j,f;return e.jsxs(ds,{className:"text-sm font-medium text-gray-700",children:[e.jsx(xe,{className:"p-3 pr-0",children:e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-200/70 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white font-medium",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{d!=null&&d.id&&r(d)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2})}),e.jsx("span",{children:"Edit"})]},(d==null?void 0:d.id)+"edit"),e.jsxs(B,{onClick:()=>{d!=null&&d.id&&l(d.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 focus:bg-red-50 focus:text-red-700",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(wl,{size:16,strokeWidth:2})}),e.jsx("span",{children:"Remove"})]},(d==null?void 0:d.id)+"remove")]})]})})},(d==null?void 0:d.id)+"action"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.product_id?(y=s.find(g=>g.id===d.data.product_id))==null?void 0:y.name:d==null?void 0:d.data.product_id},(d==null?void 0:d.id)+"product_id"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.product_id?(p=s.find(g=>g.id===d.data.product_id))==null?void 0:p.brand:"No brand"},(d==null?void 0:d.id)+"product_brand"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.product_id?(N=s.find(g=>g.id===d.data.product_id))==null?void 0:N.size:"No data"},(d==null?void 0:d.id)+"product_size"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.product_id?(j=s.find(g=>g.id===d.data.product_id))==null?void 0:j.color:"No data"},(d==null?void 0:d.id)+"product_color"),e.jsx(xe,{className:"max-w-[200px] truncate px-5 py-3",children:d!=null&&d.data.supplier_id?(f=a.find(g=>g.id===d.data.supplier_id))==null?void 0:f.name:d==null?void 0:d.data.supplier_id},(d==null?void 0:d.id)+"supplier_id"),e.jsx(xe,{className:"px-5 py-3",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((d==null?void 0:d.data.capital_price)||0)},(d==null?void 0:d.id)+"capital_price"),e.jsx(xe,{className:"px-5 py-3",children:d==null?void 0:d.data.unit},(d==null?void 0:d.id)+"unit"),e.jsx(xe,{className:"px-5 py-3",children:d==null?void 0:d.data.stocks_count},(d==null?void 0:d.id)+"stocks_count"),e.jsx(xe,{className:"px-5 py-3",children:d==null?void 0:d.data.damage_count},(d==null?void 0:d.id)+"damage_count"),e.jsx(xe,{className:"px-5 py-3",children:d==null?void 0:d.data.total_count},(d==null?void 0:d.id)+"total_count"),e.jsx(xe,{className:"px-5 py-3",children:d==null?void 0:d.data.approved_stocks},(d==null?void 0:d.id)+"approved_stocks")]},(d==null?void 0:d.id)+"row")})})]})]}),e.jsxs("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:[x&&e.jsx("div",{className:"flex w-full flex-row items-center justify-start gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:x})}),e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>n(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:t.length<=0||i,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",onClick:d=>{d.preventDefault(),u()},children:t.length<=1?"Add item to inventory":`Add ${t.length} items to inventory`})]})]})]})})})},fn={hidden:{opacity:0,x:"-100%"},animate:{opacity:1,x:"0%",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,x:"-100%",transition:{duration:.3,ease:"easeInOut"}}},jn={hidden:{opacity:0,x:"100%"},animate:{opacity:1,x:"0%",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,x:"100%",transition:{duration:.3,ease:"easeInOut"}}},gn=({onClose:t,inventoryId:s})=>{oe();const{data:a,isLoading:r}=pt(),{suppliers:l,isFetching:c}=Gs(),{handleSubmit:n}=ls(),[i,o]=h.useState([]),[x,m]=h.useState({}),[u,d]=h.useState("main"),y=()=>{m({}),d(u==="main"?"form":"main")},p=j=>{m(j),d("form")},N=j=>{o(f=>f.filter(g=>g.id!==j))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:u==="main"?"ml-auto":"",children:e.jsx(F,{className:"flex flex-row items-center gap-2 bg-gray-200 text-sm font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",onClick:()=>{y()},children:e.jsxs(e.Fragment,{children:[u==="main"?e.jsx(tt,{size:20,strokeWidth:2.5}):e.jsx(Ss,{size:20,strokeWidth:2.5}),u==="main"?"Add an item":"Back"]})})}),e.jsx("div",{className:`relative min-w-[850px] overflow-x-clip transition-all duration-300 
					${u==="form"?"min-h-[330px]":"min-h-[540px]"}`,children:e.jsx(rl,{initial:!1,children:u==="main"?e.jsx(dt.div,{variants:fn,initial:"hidden",animate:"animate",exit:"exit",className:"absolute h-full w-full overflow-x-auto antialiased",children:e.jsx(pn,{data:i,products:a,suppliers:l,handleEditItem:p,handleRemoveItem:N,handleSubmit:n,onClose:t})},"main"):e.jsx(dt.div,{variants:jn,initial:"hidden",animate:"animate",exit:"exit",className:"absolute max-h-[406px] w-full p-1",children:e.jsx(un,{setInventoryProductsQueue:o,inventoryId:s,products:a,productsLoading:r,suppliers:l,suppliersLoading:c,currentId:i.reduce((j,f)=>f.id>j?f.id:j,0),handleNavigation:y,selectedProduct:Object.keys(x).length?x:void 0})},"form")})})]})})},Nn=({onClose:t})=>{var f,g;const{auth:s}=oe(),a=!!((f=s.rolePermissions)!=null&&f.find(v=>v.permission_id===7)),{selectedInventoryProduct:r}=js(),{value:l,handleChange:c,handleSubmit:n}=ls(),{suppliers:i,isFetching:o}=Gs(),[x,m]=h.useState(!1),[u,d]=h.useState(!1),[y,p]=h.useState(null),[N,j]=h.useState();return h.useEffect(()=>{const v=st(l.stocks_count??r.stocks_count,l.damage_count??r.damage_count);j(v),c("total_count",v)},[l.damage_count,l.stocks_count,N]),e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:async v=>{d(!u),v.preventDefault(),n({action:"update",id:r.id,data:l}).then(()=>{d(!1),R.success("Inventory product updated successfully."),t()}).catch(()=>{d(!1),R.error("Failed to update inventory product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:r.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:r.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:r.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:r.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:r.product.color})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(ye,{open:x,onOpenChange:m,children:[e.jsx(je,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(F,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[l.supplier_id?e.jsx(e.Fragment,{children:(()=>{const v=i.find(I=>I.id===l.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:v==null?void 0:v.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:v==null?void 0:v.address})]})})()}):e.jsx("span",{children:r.supplier_id.name}),e.jsx(Je,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"p-0 text-sm font-medium text-slate-700",children:e.jsxs(Be,{children:[e.jsx(Qe,{placeholder:"Supplier name or address..."}),i===void 0&&o&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ze,{children:"No match found"}),e.jsx(Re,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Oe,{children:i.map((v,I)=>e.jsxs(Ae,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{c("supplier_id",v.id),m(!1)},children:[e.jsx("span",{children:v.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:v.address})]},I))})})]})})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(P,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",readOnly:!a,defaultValue:r==null?void 0:r.capital_price.toFixed(2),onBlur:v=>{v.target.value=Number(v.target.value).toFixed(2)},onChange:v=>{const I=Number(v.target.value).toFixed(2);c("capital_price",Number(I))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(P,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,defaultValue:r==null?void 0:r.unit,onChange:v=>c("unit",v.target.value)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(P,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:((g=l.stocks_count)==null?void 0:g.toFixed(0))??(r==null?void 0:r.stocks_count)??0,onChange:v=>{c("stocks_count",Number(Number(v.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(P,{id:"damage_count",name:"damage_count",type:"number",min:0,max:l.stocks_count??r.stocks_count,step:1,required:!0,value:l.damage_count!==void 0?String(l.damage_count):String(r==null?void 0:r.damage_count)||"",onBlur:v=>{v.target.value=Number(v.target.value).toFixed(0)},onChange:v=>c("damage_count",Number(Number(v.target.value).toFixed(0)))})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(P,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,value:N||0,className:`${N&&N<0&&"text-red-600"}`,readOnly:!0})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:u,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:u?"Applying...":"Apply changes"})]})}),y&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:y})})]})})})},yn=()=>{const{selectedInventoryProduct:t}=js();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:t.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:t.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:t.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:t.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:t.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:t.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:t.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:t.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:t.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Status"}),e.jsx("p",{className:"text-sm",children:t.status?"Approved":"Pending"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx("p",{className:"text-sm",children:t.approved_stocks})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unapproved stocks"}),e.jsx("p",{className:"text-sm",children:t.remaining_unapproved_stocks})]})]})]})})},vn=({onClose:t})=>{const{selectedInventoryProduct:s}=js(),{value:a,handleChange:r,handleSubmit:l}=ls(),[c,n]=h.useState(!1),i=o=>{o.preventDefault(),n(!0),l({action:"update",id:s.id,data:a}).then(()=>{R.success("Inventory product successfully approved."),n(!1),t()}).catch(x=>{var m,u;R.error((u=(m=x==null?void 0:x.response)==null?void 0:m.data)==null?void 0:u.message),n(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[24rem] max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.capital_price)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:s.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:s.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:s.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:s.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:s.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:s.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:s.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("form",{className:"grid w-full grid-flow-row grid-cols-11 gap-3",onSubmit:i,children:[e.jsxs("div",{className:"relative col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approved_stocks",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(P,{id:"approved_stocks",name:"approved_stocks",type:"number",min:0,step:1,max:s.remaining_unapproved_stocks,required:!0,autoFocus:!0,value:a.approved_stocks!==void 0?String(a.approved_stocks):"",onChange:o=>{r("approved_stocks",o.target.value)},onBlur:o=>{r("approved_stocks",Number(o.target.value))}}),e.jsxs("span",{className:"absolute bottom-0 right-0 -translate-x-4 -translate-y-2 pb-[2px] text-sm font-medium text-slate-700",children:["/ ",s.remaining_unapproved_stocks]})]}),e.jsx("div",{className:"col-span-1 flex items-center pt-6",children:e.jsx(ra,{size:24,strokeWidth:2,className:"mx-auto text-slate-600"})}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"prev_approved_stocks",className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx(P,{id:"prev_approved_stocks",name:"prev_approved_stocks",type:"number",readOnly:!0,value:s.approved_stocks||0})]}),e.jsx("div",{className:"col-span-11 flex w-full justify-between whitespace-nowrap pt-3",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:c,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Approving...":"Approve"})]})})]})]})})},bn=({onClose:t})=>{const{selectedInventoryProduct:s}=js(),{deleteInventoryProductMutation:a}=ls(),[r,l]=h.useState(!1),c=()=>{l(!0),a(s.id).then(n=>{R.success(n.message),t()}).catch(n=>{R.error(n.message?n.message:"Failed to delete inventory product.")}).finally(()=>{l(!1)})};return e.jsxs("div",{className:"flex max-w-md flex-col gap-4",children:[e.jsxs("h2",{className:"text-sm font-medium text-slate-800",children:["Are you sure you would like to delete this item? This action"," ",e.jsx("strong",{children:"cannot"}),"  be undone."]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:s.product.brand||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s.product.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s.product.color})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s.supplier_id.name})]})]}),e.jsxs("div",{className:"mt-4 flex flex-row justify-end gap-4",children:[e.jsx(b,{fill:"red",type:"submit",onClick:c,disabled:r,className:"py-2 text-sm font-bold disabled:cursor-not-allowed disabled:opacity-50",children:r?"Deleting...":"Yes, delete"}),e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),disabled:r,className:"py-2 text-sm font-bold text-slate-700 hover:text-white disabled:cursor-not-allowed disabled:opacity-50",children:"No, cancel"})]})]})},kc=()=>{const{id:t}=Hs(),{data:s,isLoading:a}=nl(Number(t)),r=De(),l=()=>{r(-1)},{openModal:c,isOpen:n,closeModal:i}=de(),[o,x]=h.useState(""),m=(u,d)=>{x(d),c()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Inventory items",children:e.jsxs(cl,{inventoryId:Number(t),children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:[e.jsxs(F,{onClick:()=>l(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(Ss,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("h2",{className:"font-bold",children:"Inventory code:"}),e.jsx("span",{children:a?"Loading...":s==null?void 0:s.code})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(mn,{openModal:m,inventory:s})})]}),e.jsx(ue,{isOpen:n,onClose:i,closeOnOverlayClick:o==="view_details",title:o==="add"?"Add Items":o==="edit"?"Edit Item":o==="view_details"?"Item Details":o==="approve"?"Approve Item":o==="delete"?"Delete Item":"",children:e.jsxs(e.Fragment,{children:[o==="add"&&e.jsx(gn,{inventoryId:Number(t),onClose:i}),o==="view_details"&&e.jsx(yn,{}),o==="edit"&&e.jsx(Nn,{onClose:i}),o==="approve"&&e.jsx(vn,{onClose:i}),o==="delete"&&e.jsx(bn,{onClose:i})]})})]})})})},wn=()=>{const t=fe(),{selectedExpenses:s}=Xs(),[a,r]=h.useState({id:s.id,title:s.title,date_of_operation:s.date_of_operation,amount:s.amount,notes:s.notes,created_by:s.created_by.id,created_at:s.created_at,updated_at:s.updated_at}),[l,c]=h.useState(!1),[n,i]=h.useState(!1),[o,x]=h.useState(null),[m,u]=h.useState(null),d=()=>Object.keys(a).map(g=>({text:g})).length>=8?a.amount?a.title?[!0,""]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"],y=f=>{c(!0),u(null),x(null),r(g=>({...g,[f.target.name]:f.target.value}))},p=async()=>{const f=d();i(!0),f[0]?await j(a):(x(f[1]),i(!1))},N={onSuccess:async()=>{await t.invalidateQueries({queryKey:["expenses"]}),i(!1),c(!1),u("Expenses info has been edited")},onError:f=>{console.error(f),x(f.message),i(!1)}},{mutateAsync:j}=Y({mutationKey:["editExpenses"],mutationFn:il,...N});return{expensesEdit:a,isChanged:l,isSubmitting:n,error:o,success:m,handleSubmit:p,handleChange:y,editExpensesMutation:j}},_n=()=>{const t=fe(),{expenses:s,dateToday:a}=Xs(),r=s.length+1,{auth:l}=oe(),[c,n]=h.useState({id:r,title:"",date_of_operation:a,amount:0,notes:"",created_by:l.user.id,created_at:"",updated_at:""}),[i,o]=h.useState(!1),[x,m]=h.useState(!1),[u,d]=h.useState(null),[y,p]=h.useState(null),N=()=>Object.keys(c).map(_=>({text:_})).length>=5?c.amount?c.title?[!0,""]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"]:[!1,"Please fill up all fields (notes are optional)"],j=I=>{o(!0),p(null),d(null),n(_=>({..._,[I.target.name]:I.target.value}))},f=async()=>{const I=N();m(!0),I[0]?await v(c):(d(I[1]),m(!1))},g={onSuccess:async()=>{await t.invalidateQueries({queryKey:["expenses"]}),m(!1),o(!1),p("Expenses info has been added")},onError:I=>{console.error(I),d(I.message),m(!1)}},{mutateAsync:v}=Y({mutationKey:["addExpenses"],mutationFn:ol,...g});return{dateToday:a,expensesAdd:c,isChanged:i,isSubmitting:x,error:u,success:y,handleSubmit:f,handleChange:j,addExpensesMutation:v}},Sn=({openModal:t})=>{const{expenses:s,isFetching:a,selectedExpenses:r,setSelectedExpenses:l,dateToday:c}=Xs(),n=()=>{t({},"add")},i=m=>{l(m[0]),t(m,"edit")},o=[{accessorKey:"date_of_operation",sortingFn:"datetime",enableSorting:!0,header:({column:m})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{m.toggleSorting(m.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["DATE OF OPERATION ",m.getIsSorted()==="asc"?e.jsx(D,{}):m.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:m})=>{const u=m.getValue("date_of_operation");if(u.toString()!=="0000-00-00"){const d={year:"numeric",month:"long",day:"numeric"},y=new Date(u).toLocaleDateString([],d);return e.jsx("div",{className:"text-center",children:y})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"title",header:({column:m})=>e.jsx("div",{className:"text-center",children:" TITLE "}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.title})},{accessorKey:"amount",header:({column:m})=>e.jsx("div",{className:"text-center",children:" AMOUNT "}),cell:({row:m})=>{const u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m.original.amount);return e.jsx("div",{className:"text-center",children:u})}},{accessorKey:"notes",header:({column:m})=>e.jsx("div",{className:"text-center",children:" NOTES "}),cell:({row:m})=>e.jsx("div",{className:"text-center",children:m.original.notes})},{accessorKey:"created_by",header:({column:m})=>e.jsx("div",{className:"text-center",children:" CREATED BY "}),cell:({row:m})=>e.jsxs("div",{className:"text-center",children:[m.original.created_by.firstname," ",m.original.created_by.lastname]})},{id:"actions",header:()=>e.jsx("div",{className:"flex flex-row justify-center",children:"ACTIONS"}),cell:({row:m})=>{const u=m.original;if(u.date_of_operation===c)return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(b,{fill:"empty",textColor:"black",onClick:()=>i([u]),className:"flex flex-row items-center gap-2",children:[e.jsx(at,{})," Edit"]})})}}],x=s.some(m=>m.date_of_operation===c);return s.sort((m,u)=>{let d=m.date_of_operation,y=u.date_of_operation;return d<y?1:d>y?-1:0}),e.jsx(e.Fragment,{children:e.jsx(X,{data:s,columns:o,filterWhat:"notes",dataType:"Today's Expenses",openModal:x?void 0:n,isLoading:a})})},Cn=({onClose:t})=>{const{expensesEdit:s,isChanged:a,isSubmitting:r,error:l,success:c,handleSubmit:n,handleChange:i}=wn();return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async o=>{o.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Date of Operation"}),e.jsx(Q,{type:"text",name:"date_of_operation",placeholder:"2024-04-06",className:"inputbox rounded-md",value:s.date_of_operation,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"Title"}),e.jsx(Q,{type:"text",name:"title",placeholder:"Title",className:"inputbox rounded-md bg-slate-100",value:s.title,onChange:i,required:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Amount"}),e.jsx(Q,{type:"number",name:"amount",placeholder:"₱500.00",className:"inputbox rounded-md bg-slate-100",value:s.amount,onChange:i,required:!0})]})]}),e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-12 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Notes"}),e.jsx(ks,{name:"notes",placeholder:"Notes here....",className:"text-base rounded-md bg-slate-100",value:s.notes,onChange:i})]})}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4 text-center",children:[e.jsx("div",{className:"flex flex-col col-span-3 gap-3",children:e.jsx(b,{type:"submit",fill:a?"green":null,disabled:!a,onClick:n,children:r?"Submitting":"Edit Expenses"})}),e.jsxs("div",{className:"flex flex-col col-span-6 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),l&&e.jsx("div",{className:"font-bold text-red-700",children:l}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-3 gap-3 items-end",children:e.jsx(b,{type:"reset",fill:"red",onClick:t,children:"Cancel"})})]})]})})})},kn=({onClose:t})=>{const{expensesAdd:s,isChanged:a,isSubmitting:r,error:l,success:c,handleSubmit:n,handleChange:i,dateToday:o}=_n();return c&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async x=>{x.preventDefault()},children:e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"lastname",children:"Date of Operation"}),e.jsx(Q,{type:"text",name:"date_of_operation",placeholder:"2024-04-06",className:"inputbox rounded-md",value:o,disabled:!0,readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"firstname",children:"Title"}),e.jsx(Q,{type:"text",name:"title",placeholder:"Title",className:"inputbox rounded-md bg-slate-100",value:s.title||"",onChange:i,required:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-4 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Amount"}),e.jsx(Q,{type:"number",name:"amount",placeholder:"₱500.00",className:"inputbox rounded-md bg-slate-100",value:s.amount||"",onChange:i,required:!0})]})]}),e.jsx("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:e.jsxs("div",{className:"flex flex-col col-span-12 gap-3",children:[e.jsx("label",{htmlFor:"email",children:"Notes"}),e.jsx(ks,{name:"notes",placeholder:"Notes here....",className:"text-base rounded-md bg-slate-100",value:s.notes||"",onChange:i})]})}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[c&&e.jsx("div",{className:"font-bold text-green-700",children:c}),l&&e.jsx("div",{className:"font-bold text-red-700",children:l}),r?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-3 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),a&&e.jsx(b,{type:"submit",fill:a?"green":null,disabled:!a,onClick:n,children:r?"Submitting":"Add Expenses"})]})})]})})]})})})},Fc=()=>{const{openModal:t,isOpen:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{l(i),t()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Expenses",children:e.jsxs(dl,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Sn,{openModal:c})})}),e.jsx(ue,{isOpen:s,onClose:a,title:r==="add"?"Add Expenses":"Edit Expenses",children:e.jsxs(e.Fragment,{children:[r==="edit"&&e.jsx(Cn,{onClose:a}),r==="add"&&e.jsx(kn,{onClose:a})]})})]})})})},Fn=()=>{const{reports:t,isReportsFetching:s}=es(),a=[(t==null?void 0:t.new_customers)??0,(t==null?void 0:t.returning_customers)??0],r={series:[(t==null?void 0:t.new_customers)??0,(t==null?void 0:t.returning_customers)??0],labels:["New customers","Returning customers"],colors:["#3b82f6","#1e3a8a"],legend:{show:!0,fontFamily:"sans-serif",fontSize:"14px",fontWeight:500,itemMargin:{vertical:4}},dataLabels:{enabled:!0,dropShadow:{top:2,blur:3,opacity:.5},style:{fontFamily:"Inter",fontSize:"12px",fontWeight:600}},tooltip:{style:{fontFamily:"Inter",fontSize:"14px"}},plotOptions:{pie:{donut:{size:"50%"}}},chart:{animations:{speed:600}}};return e.jsx(e.Fragment,{children:s?e.jsxs("div",{className:"flex h-72 w-full animate-pulse justify-center p-4",children:[e.jsx("div",{className:"mx-auto h-full w-72 rounded-2xl bg-slate-200"}),e.jsx("div",{className:"h-20 w-44 rounded-2xl bg-slate-200"})]}):e.jsx(Lt,{series:a,options:r,type:"donut",height:"100%",width:"100%"})})},In=()=>e.jsx(e.Fragment,{children:e.jsxs(qt,{className:"flex min-h-[24rem] flex-col gap-4",children:[e.jsxs(Ht,{className:"flex flex-none flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(Vt,{className:"text-base font-bold",children:"Customers"}),e.jsx($t,{className:"text-sm font-medium",children:"Shows new and returning customers for the selected date range"})]}),e.jsx(Bt,{className:"flex-1",children:e.jsx(Fn,{})})]})}),Pn=()=>{const{reports:t,isReportsFetching:s}=es();return e.jsx(e.Fragment,{children:e.jsx(gs,{title:"Profit",tooltip:"Calculated by subtracting the sum of capital and expenses from sales.",bgClassName:`${t!=null&&t.total_profit?t.total_profit>=0?"bg-blue-50":"bg-red-50":"bg-blue-50"}`,textColorClassName:`${t!=null&&t.total_profit?t.total_profit>=0?"text-blue-800":"text-red-800":"text-blue-800"}`,children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-blue-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_profit)??0)})})})},An=()=>{const{reports:t,isReportsFetching:s}=es();return e.jsx(e.Fragment,{children:e.jsx(gs,{title:"Sales",tooltip:"Calculated by adding up the total amount due in paid transactions.",bgClassName:"bg-green-50",textColorClassName:"text-green-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-green-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_sales)??0)})})})},Tn=()=>{const{reports:t,isReportsFetching:s}=es();return e.jsx(e.Fragment,{children:e.jsx(gs,{title:"Capital",tooltip:"Calculated capital of sold products.",bgClassName:"bg-orange-50",textColorClassName:"text-orange-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-orange-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_overall_capital)??0)})})})},Dn=()=>{const{reports:t,isReportsFetching:s}=es();return e.jsx(e.Fragment,{children:e.jsx(gs,{title:"Expenses",tooltip:"Calculated by adding up the operational expenses.",bgClassName:"bg-violet-50",textColorClassName:"text-violet-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-violet-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_expenses)??0)})})})},zn=()=>{const{reports:t,isReportsFetching:s}=es();return e.jsx(e.Fragment,{children:e.jsx(gs,{title:"Collectibles",tooltip:"Total amount owed from customers for non-payment type transactions.",bgClassName:"bg-stone-50",textColorClassName:"text-stone-800",children:s?e.jsx("div",{className:"h-7 w-full animate-pulse rounded-md bg-stone-700/10"}):e.jsx("p",{className:"text-right text-xl font-semibold tracking-tight",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.total_collectibles)??0)})})})};function En({className:t}){const{dateRange:s,setDateRange:a}=es();return e.jsx("div",{className:xt("grid gap-2",t),children:e.jsxs(ye,{children:[e.jsx(je,{asChild:!0,children:e.jsxs(F,{id:"date",variant:"outline",className:xt("w-[300px] justify-start text-left font-medium",!s&&"text-muted-foreground"),children:[e.jsx(ta,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?e.jsxs(e.Fragment,{children:[Os(s.from,"LLL dd, y")," —"," ",Os(s.to,"LLL dd, y")]}):Os(s.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(ve,{className:"w-auto p-0",align:"start",children:e.jsx(ns,{initialFocus:!0,mode:"range",defaultMonth:s!=null&&s.to?new Date(s.to.getFullYear(),s.to.getMonth()-1,1):new Date,selected:s,onSelect:a,classNames:{day:"text-sm flex items-center justify-center w-full h-full rounded-md font-medium",months:"flex flex-row gap-6"},numberOfMonths:2})})]})})}const Mn=()=>{const{setDateRange:t,isFetching:s}=es(),a=()=>{t({from:new Date(new Date().setDate(new Date().getDate()-90)),to:new Date})};return e.jsx(F,{variant:"outline",disabled:s,onClick:a,children:"Reset date"})},Wn=()=>{const{year:t,setYear:s}=Zs(),a=h.useMemo(()=>{const r=new Date().getFullYear(),l=2020,c=[];for(let n=l;n<=r;n++)c.push(n);return c.sort((n,i)=>i-n)},[]);return e.jsx(e.Fragment,{children:e.jsxs(J,{value:t.toString(),onValueChange:r=>{s(Number(r))},children:[e.jsx(ee,{className:"w-32 flex-none",children:e.jsx(se,{placeholder:"Choose year...",children:e.jsx("span",{className:"text-slate-600",children:t})})}),e.jsx(te,{children:a.map(r=>e.jsx(V,{value:r.toString(),className:"text-sm font-medium",children:r},`${r}-item`))})]})})},On=()=>{var r;const{warehouseId:t,setWarehouseId:s}=Zs(),{warehouses:a}=ts();return e.jsx(e.Fragment,{children:e.jsxs(J,{value:t==null?void 0:t.toString(),onValueChange:l=>{s(l!=="0"?Number(l):0)},children:[e.jsx(ee,{className:"w-44",children:e.jsx(se,{placeholder:"Select warehouse...",children:e.jsx("span",{className:"text-slate-600",children:((r=a.find(l=>l.id===t))==null?void 0:r.name)??"All"})})}),e.jsxs(te,{children:[e.jsx(V,{value:"0",className:"text-sm font-medium",children:"All"},"all-warehouses-item"),a&&a.map(l=>e.jsx(V,{value:l.id.toString(),className:"text-sm font-medium",children:l.name},`${l.id}-item`))]})]})})},Rn=()=>{const{reportAnalytics:t,isReportAnalyticsFetching:s}=Zs();return e.jsx(e.Fragment,{children:e.jsxs(qt,{className:"flex min-h-[36rem] w-full flex-col gap-4",children:[e.jsxs(Ht,{className:"flex w-full flex-none flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(Vt,{className:"flex w-full flex-row justify-between text-base font-bold",children:"Reports Analytics"}),e.jsxs($t,{className:"!mt-1 flex flex-row gap-2 font-bold uppercase",children:[e.jsx(On,{}),e.jsx(Wn,{})]})]}),e.jsx(Bt,{className:"mx-auto w-[99%] flex-1 overflow-hidden",children:s?e.jsx("div",{className:"h-[350px] w-full animate-pulse rounded-2xl bg-slate-200/50"}):e.jsx(Lt,{type:"line",height:"100%",width:"100%",series:[{name:"Sales",data:(t==null?void 0:t.map(a=>a.gross_income??0))??[]},{name:"Profit",data:(t==null?void 0:t.map(a=>a.net_profit??0))??[]},{name:"Capital",data:(t==null?void 0:t.map(a=>a.capital??0))??[]},{name:"Expenses",data:(t==null?void 0:t.map(a=>a.expenses??0))??[]},{name:"Collectibles",data:(t==null?void 0:t.map(a=>a.collectibles??0))??[]}],options:{markers:{size:5},stroke:{width:4},colors:["#16a34a","#2563eb","#f59e0b","#7c3aed","#525252"],xaxis:{tooltip:{enabled:!1},categories:(t==null?void 0:t.map(a=>a.Month??""))??[],labels:{style:{fontFamily:"sans-serif",fontSize:"12px",fontWeight:600}}},yaxis:{labels:{style:{fontFamily:"sans-serif",fontSize:"12px",fontWeight:600},formatter:a=>Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a)}},tooltip:{style:{fontFamily:"sans-serif",fontSize:"14px"}},legend:{position:"top",horizontalAlign:"right"},chart:{toolbar:{show:!1}}}})})]})})},Ic=()=>e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Reports",children:e.jsx(xl,{children:e.jsx(ml,{children:e.jsx("div",{className:"flex h-full w-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"h-full max-h-full w-full max-w-full overflow-auto",children:e.jsxs("div",{className:"flex w-full max-w-full flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(En,{}),e.jsx(Mn,{})]}),e.jsx("div",{className:"flex flex-1 flex-col gap-4",children:e.jsxs("div",{className:"flex flex-row gap-2 rounded-lg border p-2 shadow-sm",children:[e.jsx(An,{}),e.jsx(Pn,{}),e.jsx(Tn,{}),e.jsx(Dn,{}),e.jsx(zn,{})]})}),e.jsx(In,{}),e.jsx(Rn,{})]})})})})})})}),Pc=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(et,{}),e.jsx("div",{id:"main",className:"flex w-screen flex-row",children:e.jsxs("div",{className:"flex flex-1 flex-col gap-6 p-6",children:[e.jsx("div",{className:"flex w-full flex-row justify-between",children:e.jsx("h1",{className:"text-primary-dark-gray text-2xl font-bold",children:"Return Item"})}),e.jsx(Qr,{})]})})]})}),Un=({onClose:t})=>{const{invoices:s,isFetching:a,customers:r,selectedInvoice:l}=Qt(),c=l[0],n=[{id:"select",header:({table:i})=>e.jsx("input",{type:"checkbox",checked:i.getIsAllPageRowsSelected(),onChange:o=>i.toggleAllPageRowsSelected(!!o.target.checked),"aria-label":"Select all"}),cell:({row:i})=>e.jsx("input",{type:"checkbox",checked:i.getIsSelected(),onChange:o=>i.toggleSelected(!!o.target.checked),"aria-label":"Select row",className:"justify-center"}),enableSorting:!1,enableHiding:!1},{accessorKey:"or_no",sortingFn:"alphanumeric",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["OR NUMBER ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.or_no})},{accessorKey:"created_at",sortingFn:"datetime",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["CREATED AT ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>{const o=i.getValue("created_at");if(o.toString()!=="0000-00-00 00:00:00"){const x={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},m=new Date(o).toLocaleDateString([],x);return e.jsx("div",{className:"text-center",children:m})}else return e.jsx("div",{className:"text-center",children:"N/A"})}},{accessorKey:"warehouse",header:()=>e.jsx("div",{className:"text-center",children:"WAREHOUSE CODE"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.warehouse.code})},{id:"customer",header:()=>e.jsx("div",{className:"text-center",children:"CUSTOMER NAME"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.customer.firstname+" "+i.original.customer.lastname})},{accessorKey:"type",sortingFn:"text",enableSorting:!0,header:({column:i})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>{i.toggleSorting(i.getIsSorted()==="asc")},className:"bg-transparent text-black flex flex-row items-center ml-auto mr-auto",children:["TRANSACTION TYPE ",i.getIsSorted()==="asc"?e.jsx(D,{}):i.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.type})},{accessorKey:"status",header:()=>e.jsx("div",{className:"text-center",children:"STATUS"}),cell:({row:i})=>e.jsx("div",{className:"flex mx-auto items-center justify-center",children:i.original.status.toLowerCase()==="approved"?e.jsx($e,{size:20,strokeWidth:2,className:"text-green-600"}):i.original.status.toLowerCase()==="rejected"?e.jsx(ss,{size:20,strokeWidth:2,className:"text-red-600"}):e.jsx(as,{size:20,strokeWidth:2,className:"text-amber-500"})})},{accessorKey:"subtotal",header:()=>e.jsx("div",{className:"text-center",children:" SUBTOTAL "}),cell:({row:i})=>{const o=i.original.subtotal,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"total_discount",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL DISCOUNT "}),cell:({row:i})=>{const o=i.original.total_discount,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"total_tax",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL TAX "}),cell:({row:i})=>{const o=i.original.total_tax,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"delivery_charge",header:()=>e.jsx("div",{className:"text-center",children:" DELIVERY CHARGE "}),cell:({row:i})=>{const o=i.original.delivery_charge,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"total_amount_due",header:()=>e.jsx("div",{className:"text-center",children:" TOTAL AMOUNT DUE "}),cell:({row:i})=>{const o=i.original.total_amount_due,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"paid_amount",header:()=>e.jsx("div",{className:"text-center",children:" PAID AMOUNT "}),cell:({row:i})=>{const o=i.original.paid_amount,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"change_amount",header:()=>e.jsx("div",{className:"text-center",children:" CHANGE AMOUNT "}),cell:({row:i})=>{const o=i.original.change_amount,x=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(o);return e.jsx("div",{className:"text-center",children:x})}},{accessorKey:"payment_method",header:()=>e.jsx("div",{className:"text-center",children:" PAYMENT METHOD "}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.payment_method||"N/A"})},{accessorKey:"reference_no",header:({column:i})=>e.jsx("div",{className:"text-center",children:"REF #"}),cell:({row:i})=>e.jsx("div",{className:"text-center",children:i.original.reference_no||"--"})}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl max-h-96 flex-col gap-4",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Issuer: ",c.issued_by.firstname+" "+c.issued_by.lastname]}),e.jsx("div",{className:"overflow-x-hidden",children:e.jsx(X,{data:l,columns:n,filterWhat:"or_no",dataType:"",openModal:void 0,isLoading:a})})]})})},Kn=({openModal:t})=>{const{customersList:s,isFetching:a}=Qt(),r=[{accessorKey:"customer.firstname",id:"customer",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsxs(b,{onClick:()=>{l.toggleSorting(l.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["NAME"," ",l.getIsSorted()==="asc"?e.jsx(D,{}):l.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:l})=>e.jsx("div",{children:l.original.customer.firstname+" "+l.original.customer.lastname})},{id:"address",header:()=>e.jsx("div",{children:"ADDRESS"}),cell:({row:l})=>e.jsx("div",{children:l.original.customer.address})},{id:"contact_no",header:()=>e.jsx("div",{children:"CONTACT NO"}),cell:({row:l})=>e.jsx("div",{children:l.original.customer.contact_no})},{accessorKey:"customer.total_balance",id:"total_balance",sortingFn:"basic",enableSorting:!0,header:({column:l})=>e.jsxs(b,{onClick:()=>{l.toggleSorting(l.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["BALANCE"," ",l.getIsSorted()==="asc"?e.jsx(D,{}):l.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:l})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(l.original.customer.total_balance)})},{accessorKey:"customer.total_credit",id:"total_credit",sortingFn:"basic",enableSorting:!0,header:({column:l})=>e.jsxs(b,{onClick:()=>{l.toggleSorting(l.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["CREDITS"," ",l.getIsSorted()==="asc"?e.jsx(D,{}):l.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:l})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(l.original.customer.total_credit)})},{accessorKey:"total_transactions",id:"total_transactions",sortingFn:"basic",enableSorting:!0,header:({column:l})=>e.jsxs(b,{onClick:()=>{l.toggleSorting(l.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["TRANSACTIONS"," ",l.getIsSorted()==="asc"?e.jsx(D,{}):l.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:l})=>e.jsx("div",{children:l.original.total_transactions})},{accessorKey:"total_sales",id:"amount_sales",sortingFn:"basic",enableSorting:!0,header:({column:l})=>e.jsxs(b,{onClick:()=>{l.toggleSorting(l.getIsSorted()==="asc")},className:"flex flex-row items-center bg-transparent text-slate-800",children:["SALES"," ",l.getIsSorted()==="asc"?e.jsx(D,{}):l.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]}),cell:({row:l})=>e.jsx("div",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(l.original.total_sales)})}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:s.sort((l,c)=>c.total_sales>l.total_sales?1:-1),columns:r,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:a})})},Ac=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Customer Sales",children:e.jsxs(ul,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border border-black/10",children:e.jsx(Kn,{openModal:c})})}),e.jsx(ue,{isOpen:t,onClose:a,title:r==="details"?"Invoice Details":"",closeOnOverlayClick:r==="details",children:e.jsx(e.Fragment,{children:r==="details"&&e.jsx(Un,{onClose:a})})})]})})})},Ln=({openModal:t})=>{const{returns:s,selectedReturn:a,setSelectedReturn:r,isFetching:l}=qs(),c=s.filter(x=>{if(x.refund_status==="pending")return x});oe();const n=x=>{r(x),t(x,"details")},i=x=>{r(x),t(x,"edit")},o=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:x})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>x.toggleSorting(x.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["RETURN CODE ",x.getIsSorted()==="asc"?e.jsx(D,{}):x.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:x})=>e.jsx("div",{className:"text-center",children:x.original.code?x.original.code:"N/A"})},{accessorKey:"invoice",sortingFn:"alphanumeric",enableSorting:!0,header:({column:x})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>x.toggleSorting(x.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["INVOICE CODE ",x.getIsSorted()==="asc"?e.jsx(D,{}):x.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:x})=>e.jsx("div",{className:"text-center",children:x.original.invoice.code?x.original.invoice.code:"N/A"})},{accessorKey:"customer",sortingFn:"alphanumeric",enableSorting:!0,header:({column:x})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>x.toggleSorting(x.getIsSorted()==="asc"),className:"flex flex-row bg-transparent text-black items-center mx-auto",children:["CUSTOMER NAME ",x.getIsSorted()==="asc"?e.jsx(D,{}):x.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:x})=>e.jsx("div",{className:"text-center",children:x.original.invoice.customer.firstname+" "+x.original.invoice.customer.lastname})},{accessorKey:"refundable_amount",sortingFn:"text",enableSorting:!0,header:({column:x})=>e.jsx("div",{className:"flex flex-row justify-center text-center mx-auto",children:" REFUNDABLE AMOUNT "}),cell:({row:x})=>{const m=x.original.refundable_amount,u=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(m);return e.jsx("div",{className:"text-center",children:u})}},{accessorKey:"refund_status",sortingFn:"text",enableSorting:!0,header:({column:x})=>e.jsx("div",{className:"flex flex-row justify-center text-center mx-auto",children:" REFUND STATUS "}),cell:({row:x})=>e.jsx("div",{className:"flex items-center",children:x.original.refund_status&&e.jsx(as,{size:20,strokeWidth:2,className:"text-amber-500 mx-auto"})})},{id:"actions",header:()=>e.jsx("div",{}),cell:({row:x})=>{const m=x.original;return e.jsx("div",{className:"flex flex-row text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>n(m),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>i(m),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve Return/Refund"})]})]})]})})}}];return e.jsx(e.Fragment,{children:e.jsx(X,{data:c,columns:o,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:l})})},qn=({onClose:t})=>{const{selectedReturn:s}=qs();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-6xl flex-col gap-4",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Return Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.code})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.issued_by.firstname+" "+s.issued_by.lastname})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Payment method"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.payment_method.charAt(0).toUpperCase()+s.invoice.payment_method.slice(1)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Reference number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.reference_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Refundable amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.refundable_amount)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(s.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm text-amber-600",children:s.refund_status.charAt(0).toUpperCase()+s.refund_status.slice(1)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(s.updated_at)})]})]})]})})},Hn=({onClose:t})=>{const{selectedReturn:s,success:a,error:r,isSubmitting:l,handleSubmit:c}=Il();return a&&setTimeout(()=>{t()},1e3),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4",children:[e.jsx("p",{className:"font-bold text-red-900",children:" Are you sure you want to set this return as done? "}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Return Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.code?s.code:"N/A"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice Code"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.code})]})]}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.customer.firstname+" "+s.invoice.customer.lastname})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.issued_by.firstname+" "+s.issued_by.lastname})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-9 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Payment method"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.payment_method.charAt(0).toUpperCase()+s.invoice.payment_method.slice(1)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Reference number"}),e.jsx("p",{className:"text-sm text-gray-800",children:s.invoice.reference_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Refundable amount"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(s.refundable_amount)})]})]}),e.jsx("div",{className:"flex flex-row justify-center gap-1",children:e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-10 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col col-span-5 items-start",children:[a&&e.jsx("div",{className:"font-bold text-green-700",children:a}),r&&e.jsx("div",{className:"font-bold text-red-700",children:r}),l?e.jsx("div",{className:"flex flex-col flex-wrap items-start",children:e.jsx(Te,{width:30,height:30})}):""]}),e.jsx("div",{className:"flex flex-col col-span-5 gap-4 items-end",children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-gray-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",onClick:c,fill:"green",children:l?"Submitting":"Mark as done"})]})})]})})]})})},Tc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{s(),l(i),console.log("action",i)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Return",children:e.jsxs(hl,{children:[e.jsx("div",{className:"flex max-h-full flex-1 flex-col gap-5 rounded-lg border border-black/10 bg-white p-5",children:e.jsx("div",{className:"h-full w-full overflow-x-hidden rounded-lg border border-black/10",children:e.jsx(Ln,{openModal:c})})}),e.jsx(ue,{title:r==="details"?"Return Details":"Approve Return",isOpen:t,onClose:a,children:e.jsxs(e.Fragment,{children:[r==="details"&&e.jsx(qn,{onClose:a}),r==="edit"&&e.jsx(Hn,{onClose:a})]})})]})})})},Vn=()=>{const{selectedProductPrice:t}=Js();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Name"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Brand"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Serial number"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Unit"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Size"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Color"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Warehouse"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.warehouse.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Capital price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.capital_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup percent"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[re(t.markup_price/t.capital_price*100,{precision:3}).value,"%"]})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Markup price"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.markup_price)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Cost"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.cost)})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Sale discount"}),e.jsx("p",{className:"text-sm",children:t.on_sale===1?Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.sale_discount):"—"}),e.jsxs("div",{className:"absolute bottom-0 right-0 flex flex-none flex-row items-center justify-end gap-1 pb-[0.1rem] pr-1",children:[t.on_sale===1?e.jsx($e,{size:14,strokeWidth:3.5,className:"text-green-600"}):e.jsx(Cs,{size:14,strokeWidth:3.5,className:"text-gray-600"}),e.jsx("div",{className:"text-xs font-semibold leading-4 text-gray-900",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.price)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Active status"}),e.jsxs("span",{className:"flex flex-row items-center gap-2",children:[t.active_status==="active"?e.jsx(xs,{size:16,strokeWidth:2.5,className:"text-green-600"}):e.jsx(la,{size:16,strokeWidth:2.5,className:"text-gray-600"}),e.jsx("p",{className:"text-sm capitalize text-gray-800",children:t.active_status})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.created_by.firstname+" "+t.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(t.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approval status"}),e.jsx("p",{className:"text-sm capitalize",children:t.approval_status})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Approved by"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.approved_by?t.approved_by.firstname+" "+t.approved_by.firstname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Updated at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(t.updated_at)})]})]})]})})},$n=({onClose:t})=>{var v,I;const{auth:s}=oe(),{selectedProductPrice:a}=Js(),{value:r,handleChange:l,handleSubmit:c}=Ps(),[n,i]=h.useState(!1),[o,x]=h.useState(null),[m,u]=h.useState(a.capital_price),[d,y]=h.useState(rs(a.capital_price,a.markup_price,3)),[p,N]=h.useState(a.markup_price),j=_=>{const k=_.target.value;u(re(k).value),l("capital_price",re(k).value),N(Us(re(k).value,d||0))},f=_=>{const k=Number(_.target.value);y(k),N(Us(m,k))},g=_=>{const k=re(_.target.value).value;N(k),y(rs(m,k,3))};return h.useEffect(()=>{l("capital_price",m),l("markup_price",p),l("cost",_s(m,p))},[m,d,p]),h.useEffect(()=>{l("price",ca(r.cost??a.cost,r.sale_discount??a.sale_discount))},[r.cost,r.sale_discount]),e.jsx(e.Fragment,{children:e.jsx("form",{onSubmit:async _=>{i(!n),_.preventDefault(),c({action:"update",id:a.id,data:r}).then(()=>{i(!n),R.success("Product price edited successfully"),t()}).catch(()=>{i(!n),x("Failed to add product listing"),R.error("Failed to add product listing")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-x-4 gap-y-5 font-medium text-gray-700",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:a.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:a.product.brand||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-sm",children:a.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(P,{id:"unit",name:"unit",type:"text",maxLength:20,required:!0,value:r.unit||a.unit,onChange:_=>{l("unit",_.target.value)}})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:a.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:a.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Warehouse"}),e.jsx("p",{className:"text-sm",children:a.warehouse.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(P,{id:"capital_price",name:"capital_price",type:"number",inputMode:"numeric",min:0,step:.01,required:!0,className:"pl-7",value:m||"",onChange:j,onBlur:_=>{_.target.value=Number(m).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_percent",className:"text-sm font-bold text-gray-600",children:"Markup percent"}),e.jsx(P,{id:"markup_percent",name:"markup_percent",type:"number",inputMode:"numeric",min:0,max:1e3,step:.001,required:!0,value:d||"",onChange:f,onBlur:_=>{_.target.value=re(d,{precision:3}).value.toString()}}),e.jsx("span",{className:"absolute bottom-0 right-0 mr-2 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"%"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"markup_price",className:"text-sm font-bold text-gray-600",children:"Markup price"}),e.jsx(P,{id:"markup_price",name:"markup_price",type:"number",min:0,max:1e3,step:.01,className:"pl-7",value:p||"",onChange:g,onBlur:_=>{_.target.value=Number(p).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"cost",className:"text-sm font-bold text-gray-600",children:"Cost"}),e.jsx(P,{id:"cost",name:"cost",type:"number",min:0,required:!0,className:"pl-7",readOnly:!0,value:_s(m,p).toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"sale_discount",className:"text-sm font-bold text-gray-600",children:"Sale discount"}),e.jsx(P,{id:"sale_discount",name:"sale_discount",type:"number",inputMode:"numeric",min:0,step:.01,max:r.cost!==void 0?r.cost:a.cost,disabled:r.on_sale===void 0?a.on_sale===0:r.on_sale===0,required:!0,className:"pl-7",value:r.sale_discount??((v=a.sale_discount)==null?void 0:v.toFixed(2))??"",onChange:_=>{l("sale_discount",re(_.target.value).value)},onBlur:_=>{_.target.value=Number(r.sale_discount!==void 0?r.sale_discount:a.sale_discount).toFixed(2)}}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"}),e.jsxs("div",{className:"absolute right-0 top-1/2 mr-2 flex flex-none translate-y-1/4 flex-row items-center justify-start gap-2",children:[e.jsx(P,{name:"on_sale",id:"on_sale",type:"checkbox",checked:r.on_sale===void 0?a.on_sale===1:r.on_sale===1,className:"h-4 w-fit",onChange:_=>{const k=document.getElementById("sale_discount");l("on_sale",_.target.checked?1:0),!_.target.checked&&(l("sale_discount",0),k&&(k.value="0.00"))}}),e.jsx(w,{htmlFor:"on_sale",className:"text-xs font-bold text-slate-700",children:"On Sale"})]})]}),e.jsxs("div",{className:"relative col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"price",className:"text-sm font-bold text-gray-600",children:"Price"}),e.jsx(P,{id:"price",name:"price",type:"number",min:0,step:.01,required:!0,readOnly:!0,className:"pl-7",value:((I=r.price)==null?void 0:I.toFixed(2))||a.price.toFixed(2)||"0.00"}),e.jsx("span",{className:"absolute bottom-0 left-0 ml-3 -translate-y-1/2 text-sm font-semibold text-gray-500",children:"₱"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-row items-center justify-start	gap-3",children:[e.jsx(Ve,{id:"active_status",name:"active_status",checked:r.active_status?r.active_status==="active":a.active_status==="active",className:"data-[state=checked]:bg-primary-green data-[state=unchecked]:bg-gray-300",onCheckedChange:_=>{l("active_status",_?"active":"inactive")}}),e.jsx(w,{htmlFor:"active_status",className:"text-sm font-bold text-gray-600",children:"Active"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created by"}),e.jsx("p",{className:"text-sm",children:a.created_by.firstname+" "+a.created_by.lastname})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Created at"}),e.jsx("p",{className:"text-sm",children:ne(a.created_at)})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approval_status",className:"text-sm font-bold text-gray-600",children:"Approval status"}),e.jsxs(J,{onValueChange:_=>{l("approval_status",_),_==="approved"?l("approved_by",s.user.id):l("approved_by","")},value:r.approval_status||a.approval_status||"",required:!0,children:[e.jsx(ee,{name:"approval_status",className:"flex flex-row items-center gap-3 bg-white text-sm capitalize",children:e.jsx(se,{placeholder:r.approval_status||a.approval_status||"Select status..."})}),e.jsxs(te,{className:"bg-white",children:[e.jsx(V,{className:"rounded-md",value:"pending",children:"Pending"},"pending"),e.jsx(V,{className:"rounded-md",value:"approved",children:"Approved"},"approved"),e.jsx(V,{className:"rounded-md",value:"rejected",children:"Rejected"},"rejected")]})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Approved by"}),e.jsx("p",{className:"text-sm",children:a.approved_by?a.approved_by.firstname+" "+a.approved_by.lastname:"N/A"})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Updated at"}),e.jsx("p",{className:"text-sm",children:ne(a.updated_at)})]})]}),e.jsx("div",{className:"col-span-12 flex w-full justify-between whitespace-nowrap pt-4",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{type:"reset",fill:"default",className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",onClick:t,children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:n,className:"flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:n?"Applying changes...":"Apply changes"})]})}),o&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm text-red-600",children:o})})]})})})},Bn=({handleProdPriceDetails:t,handleEditProdPrice:s,handleApproveProdPrice:a,handleRejectProdPrice:r})=>[{id:"name",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Name"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"warehouse.code",sortingFn:"basic",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["WHS"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Unit"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Capital"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:c.original.capital_price?n:"—"})})}},{accessorKey:"markup_price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Markup"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.markup_price||0),i=re(c.original.markup_price/c.original.capital_price*100,{precision:3}).value;return e.jsxs("div",{className:"flex items-center uppercase",children:[e.jsx("span",{children:n}),e.jsxs("span",{className:"text-gray-500",children:[" (",i,"%)"]})]})}},{accessorKey:"sale_discount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Discount"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.sale_discount||0);return e.jsx("div",{className:"flex items-center",children:e.jsx("span",{children:c.original.on_sale?n:e.jsx("div",{className:"group relative flex w-fit items-center",children:e.jsxs(Ue,{children:[e.jsx(Ke,{children:e.jsx(Cs,{size:20,strokeWidth:2,className:"text-gray-700"})}),e.jsx(Le,{children:e.jsx("p",{className:"text-sm font-medium normal-case",children:"Not on sale"})})]})})})})}},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Price"}),cell:({row:c})=>{const n=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(c.original.price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:c.original.price?n:"—"})})}},{accessorKey:"active_status",sortingFn:"basic",enableSorting:!0,header:({column:c})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>c.toggleSorting(c.getIsSorted()==="asc"),className:"ml-auto mr-auto flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Active"," ",c.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):c.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:c})=>{const n=c.original.active_status;return e.jsx("div",{className:"group relative mx-auto flex w-fit items-center justify-center",children:e.jsxs(Ue,{children:[e.jsx(Ke,{children:n==="active"?e.jsx($e,{size:20,strokeWidth:2,className:"text-green-600"}):e.jsx(la,{size:20,strokeWidth:2,className:"text-gray-600"})}),e.jsx(Le,{children:e.jsx("p",{className:"text-sm font-medium capitalize",children:n})})]})})},enableGlobalFilter:!1},{id:"actions",cell:({row:c})=>{const n=c.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>t(n),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>s(n),className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{a(n.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(xs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve"})]}),e.jsxs(B,{onClick:()=>{r(n.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ss,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Reject"})]})]})]})})},enableGlobalFilter:!1}],Qn=({openModal:t,isModalOpen:s,filterWarehouse:a})=>{const{data:r,isLoading:l,setSelectedProductPrice:c}=Js(),n=u=>{c(u),t(u,"details")},i=u=>{c(u),t(u,"edit")},{handleSubmit:o}=Ps(),x=u=>{o({action:"update",id:u,data:{approval_status:"approved"}}).then(()=>R.success("Product price approved")).catch(()=>R.error("Failed to approve product price"))},m=u=>{o({action:"update",id:u,data:{approval_status:"rejected"}}).then(()=>R.success("Product price rejected")).catch(()=>R.error("Failed to reject product price"))};return e.jsx(e.Fragment,{children:e.jsx(Xe,{children:e.jsx(X,{columns:Bn({handleProdPriceDetails:n,handleEditProdPrice:i,handleApproveProdPrice:x,handleRejectProdPrice:m}),data:a?r.filter(u=>u.warehouse.id===a):r,filterWhat:"name",dataType:"Listing",isLoading:l})})})},Dc=()=>{const{warehouses:t}=ts(),[s,a]=h.useState(0),{isOpen:r,openModal:l,closeModal:c}=de(),[n,i]=h.useState(""),o=(x,m)=>{i(m),l()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Listing",children:e.jsxs(pl,{children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsxs("div",{className:"ml-auto flex flex-row items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Filter warehouse:"," "]}),e.jsxs(J,{defaultValue:"0",onValueChange:x=>a(Number(x)),children:[e.jsx(ee,{className:"w-[300px] text-sm font-medium",children:e.jsx(se,{placeholder:"All"})}),e.jsxs(te,{className:"text-sm font-medium capitalize",children:[e.jsx(V,{value:"0",children:"All"},"all"),t.map(x=>e.jsxs(V,{value:x.id.toString(),children:[x.name," (",x.code,")"]},x.id))]})]})]}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(Qn,{openModal:o,isModalOpen:r,filterWarehouse:s})})]}),e.jsx(ue,{title:n==="details"?"Price Details":n==="edit"?"Edit Price":"",isOpen:r,onClose:c,closeOnOverlayClick:n==="details"||n==="toggle_active_stat",children:e.jsxs(e.Fragment,{children:[n==="details"&&e.jsx(Vn,{}),n==="edit"&&e.jsx($n,{onClose:c})]})})]})})})},Yn=({handleViewDetails:t,handleEditInventoryProduct:s,handleApproveInventoryProduct:a})=>[{id:"inventory_code",accessorKey:"inventory.code",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Inventory"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})}),cell:({row:l})=>e.jsx("div",{children:l.original.inventory.code})},{id:"product",accessorKey:"product.name",sortingFn:"text",enableSorting:!0,header:({column:l})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"flex flex-row items-center whitespace-nowrap bg-transparent uppercase text-slate-700",children:["Name"," ",l.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):l.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"capital_price",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Cap. Price"}),cell:({row:l})=>{const c=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(l.original.capital_price);return e.jsx("div",{className:"flex items-center uppercase",children:e.jsx("span",{children:l.original.capital_price?c:"—"})})}},{accessorKey:"total_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Total"})},{accessorKey:"sold_count",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Sold"})},{accessorKey:"approved_stocks",header:()=>e.jsx("div",{className:"justify-center whitespace-nowrap uppercase",children:"Approved"}),cell:({row:l})=>e.jsx("div",{children:e.jsx("span",{children:l.original.approved_stocks??0})})},{id:"actions",cell:({row:l})=>{const c=l.original;return e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{t(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(ge,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Details"})]}),e.jsxs(B,{onClick:()=>{s(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(be,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Edit"})]}),e.jsxs(B,{onClick:()=>{a(c)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(xs,{size:16,strokeWidth:2.25})}),e.jsx("span",{children:"Approve stocks"})]})]})]})})},enableGlobalFilter:!1}],Gn=({openModal:t})=>{const{data:s,isLoading:a,setSelectedInventoryProduct:r}=Is(),l=i=>{r(i),t(i,"view_details")},c=i=>{r(i),t(i,"edit")},n=i=>{r(i),t(i,"approve")};return e.jsx(e.Fragment,{children:e.jsx(X,{columns:Yn({handleViewDetails:l,handleEditInventoryProduct:c,handleApproveInventoryProduct:n}),data:s?s.sort((i,o)=>o.inventory_id-i.inventory_id):[],filterWhat:"product",isLoading:a,dataType:"Inventory Product"})})},Xn=()=>{const{selectedInventoryProduct:t}=Is();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-2",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.name})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm capitalize",children:(t==null?void 0:t.product.brand)||e.jsx("span",{className:"opacity-60",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.serial_no})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.unit})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((t==null?void 0:t.capital_price)??0)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:t==null?void 0:t.remaining_stocks_count})]})]})]})})},Zn=({onClose:t})=>{const{selectedInventoryProduct:s}=Is(),{value:a,handleChange:r,handleSubmit:l}=ls(),[c,n]=h.useState(!1),i=o=>{o.preventDefault(),n(!0),l({action:"update",id:s.id,data:a}).then(()=>{R.success("Inventory product successfully approved."),n(!1),t()}).catch(()=>{R.error("Failed to approve inventory product."),n(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-[24rem] max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Name"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Serial No."}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.serial_no})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx("p",{className:"text-sm",children:(s==null?void 0:s.product.brand)||e.jsx("span",{className:"opacity-50",children:"No brand"})})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.size})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.product.color})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.supplier_id.name})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-12 gap-5",children:[e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Capital Price"}),e.jsx("p",{className:"text-sm",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format((s==null?void 0:s.capital_price)||0)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Stocks"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Damaged"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.damage_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Total"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.total_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Transferred"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.transferred_stocks_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Sold"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.sold_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Miscellaneous"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.miscellaneous_count})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-600",children:"Remaining Stocks"}),e.jsx("p",{className:"text-sm",children:s==null?void 0:s.remaining_stocks_count})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("form",{className:"grid w-full grid-flow-row grid-cols-11 gap-3",onSubmit:i,children:[e.jsxs("div",{className:"relative col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"approved_stocks",className:"text-sm font-bold text-gray-600",children:"Approve stocks"}),e.jsx(P,{id:"approved_stocks",name:"approved_stocks",type:"number",min:0,step:1,max:(s==null?void 0:s.remaining_unapproved_stocks)??0,required:!0,autoFocus:!0,value:a.approved_stocks!==void 0?String(a.approved_stocks):"",onChange:o=>{r("approved_stocks",o.target.value)},onBlur:o=>{r("approved_stocks",Number(o.target.value))}}),e.jsxs("span",{className:"absolute bottom-0 right-0 -translate-x-4 -translate-y-2 pb-[2px] text-sm font-medium text-slate-700",children:["/ ",s==null?void 0:s.remaining_unapproved_stocks]})]}),e.jsx("div",{className:"col-span-1 flex items-center pt-6",children:e.jsx(ra,{size:24,strokeWidth:2,className:"mx-auto text-slate-600"})}),e.jsxs("div",{className:"col-span-5 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"prev_approved_stocks",className:"text-sm font-bold text-gray-600",children:"Total approved stocks"}),e.jsx(P,{id:"prev_approved_stocks",name:"prev_approved_stocks",type:"number",readOnly:!0,value:(s==null?void 0:s.approved_stocks)||0})]}),e.jsx("div",{className:"col-span-11 flex w-full justify-between whitespace-nowrap pt-3",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:c,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:c?"Approving...":"Approve"})]})})]})]})})},Jn=({onClose:t})=>{var j;const{auth:s}=oe(),{selectedInventoryProduct:a}=Is(),{value:r,handleChange:l,handleSubmit:c}=ls(),{suppliers:n,isFetching:i}=Gs(),[o,x]=h.useState(!1),[m,u]=h.useState(!1),[d,y]=h.useState(null),[p,N]=h.useState();return h.useEffect(()=>{const f=st(r.stocks_count??((a==null?void 0:a.stocks_count)||0),r.damage_count??((a==null?void 0:a.damage_count)||0));N(f),l("total_count",f)},[r.damage_count,r.stocks_count,p]),e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:async f=>{u(!m),f.preventDefault(),c({action:"update",id:a.id,data:r}).then(()=>{u(!1),R.success("Inventory product successfully updated."),t()}).catch(()=>{u(!1),R.error("Failed to update inventory product.")})},children:e.jsxs("div",{className:"flex max-w-2xl flex-col gap-3",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-3",children:[e.jsxs("div",{className:"col-span-12 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product",className:"text-sm font-bold text-gray-600",children:"Product"}),e.jsx(P,{id:"product",name:"product",type:"text",readOnly:!0,value:a==null?void 0:a.product.name})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_brand",className:"text-sm font-bold text-gray-600",children:"Brand"}),e.jsx(P,{id:"product_brand",name:"product_brand",type:"text",readOnly:!0,value:a==null?void 0:a.product.brand})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_size",className:"text-sm font-bold text-gray-600",children:"Size"}),e.jsx(P,{id:"product_size",name:"product_size",type:"text",readOnly:!0,value:a==null?void 0:a.product.size})]}),e.jsxs("div",{className:"col-span-4 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"product_color",className:"text-sm font-bold text-gray-600",children:"Color"}),e.jsx(P,{id:"product_color",name:"product_color",type:"text",readOnly:!0,value:a==null?void 0:a.product.color})]}),e.jsxs("div",{className:`${s.role==="admin"||s.role==="super_admin"?"col-span-6":"col-span-12"} flex flex-col justify-center gap-1`,children:[e.jsx(w,{htmlFor:"supplier_id",className:"text-sm font-bold text-gray-600",children:"Supplier"}),e.jsxs(ye,{open:o,onOpenChange:x,children:[e.jsx(je,{id:"supplier_id",className:"relative w-full",asChild:!0,children:e.jsxs(F,{role:"combobox",className:"w-full justify-between text-sm font-bold text-slate-700",variant:"outline",children:[r.supplier_id?e.jsx(e.Fragment,{children:(()=>{const f=n.find(g=>g.id===r.supplier_id);return e.jsxs("div",{className:"flex w-full items-baseline gap-4 capitalize",children:[e.jsx("span",{className:"max-w-full truncate",children:f==null?void 0:f.name}),e.jsx("span",{className:"font-baseline text-xs text-slate-700/50",children:f==null?void 0:f.address})]})})()}):e.jsx("span",{children:a==null?void 0:a.supplier_id.name}),e.jsx(Je,{size:14,strokeWidth:2,className:"h-4 w-4 opacity-70"})]})}),e.jsx(ve,{className:"p-0 text-sm font-medium text-slate-700",children:e.jsxs(Be,{children:[e.jsx(Qe,{placeholder:"Supplier name or address..."}),n===void 0&&i&&e.jsx("div",{className:"flex h-16 w-full items-center justify-center",children:e.jsx(G,{size:22,strokeWidth:2.5,className:"animate-spin text-slate-700/50"})}),e.jsx(Ze,{children:"No match found"}),e.jsx(Re,{className:"max-h-[200px] overflow-y-scroll",children:e.jsx(Oe,{children:n.map((f,g)=>e.jsxs(Ae,{className:"cursor-pointer justify-between rounded-sm",onSelect:()=>{l("supplier_id",f.id),x(!1)},children:[e.jsx("span",{children:f.name}),e.jsx("span",{className:"text-xs font-semibold text-slate-700/50",children:f.address})]},g))})})]})})]})]}),(s.role==="admin"||s.role==="super_admin")&&e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"status",className:"text-sm font-bold text-gray-600",children:"Status"}),e.jsxs(J,{value:r.status?r.status.toString():a==null?void 0:a.status.toString(),required:!0,onValueChange:f=>l("status",f),children:[e.jsx(ee,{name:"status",id:"status",className:"w-full px-4 text-sm font-bold text-slate-700",children:e.jsx(se,{placeholder:"Select status..."})}),e.jsxs(te,{className:"text-sm font-medium",children:[e.jsx(V,{value:"1",children:"Approved"}),e.jsx(V,{value:"0",children:"Pending"})]})]})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-3",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"capital_price",className:"text-sm font-bold text-gray-600",children:"Capital price"}),e.jsx(P,{id:"capital_price",name:"capital_price",type:"number",min:0,step:.01,required:!0,className:"pl-8",placeholder:"0.00",readOnly:s.role!=="admin",defaultValue:a==null?void 0:a.capital_price.toFixed(2),onBlur:f=>{f.target.value=Number(f.target.value).toFixed(2)},onChange:f=>{const g=Number(f.target.value).toFixed(2);l("capital_price",Number(g))}}),e.jsx("span",{className:"absolute bottom-0 left-0 pb-[0.65rem] pl-3 text-sm font-semibold text-gray-500",children:"₱"})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"unit",className:"text-sm font-bold text-gray-600",children:"Unit"}),e.jsx(P,{id:"unit",name:"unit",type:"text",maxLength:40,required:!0,defaultValue:a==null?void 0:a.unit,onChange:f=>l("unit",f.target.value)})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"stocks_count",className:"text-sm font-bold text-gray-600",children:"Stocks count"}),e.jsx(P,{id:"stocks_count",name:"stocks_count",type:"number",min:0,max:9999999,step:1,value:((j=r.stocks_count)==null?void 0:j.toFixed(0))??(a==null?void 0:a.stocks_count)??0,onChange:f=>{l("stocks_count",Number(Number(f.target.value).toFixed(0)))}})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"damage_count",className:"text-sm font-bold text-gray-600",children:"Damage count"}),e.jsx(P,{id:"damage_count",name:"damage_count",type:"number",min:0,max:r.stocks_count??(a==null?void 0:a.stocks_count),step:1,required:!0,value:r.damage_count!==void 0?String(r.damage_count):String(a==null?void 0:a.damage_count)||"",onBlur:f=>{f.target.value=Number(f.target.value).toFixed(0)},onChange:f=>l("damage_count",Number(Number(f.target.value).toFixed(0)))})]}),e.jsxs("div",{className:"col-span-2 flex flex-col justify-center gap-1",children:[e.jsx(w,{htmlFor:"total_count",className:"text-sm font-bold text-gray-600",children:"Total count"}),e.jsx(P,{id:"total_count",name:"total_count",type:"number",min:0,max:9999999,step:1,value:p||0,className:`${p&&p<0&&"text-red-600"}`,readOnly:!0})]})]}),e.jsx("div",{className:"flex w-full justify-between whitespace-nowrap pt-6",children:e.jsxs("div",{className:"ml-auto flex flex-row gap-4",children:[e.jsx(b,{fill:"default",type:"reset",onClick:()=>t(),className:"flex-1 py-2 text-sm font-bold text-slate-700 hover:text-white",children:"Cancel"}),e.jsx(b,{type:"submit",fill:"green",disabled:m,className:"max-w-fit flex-1 py-2 text-sm font-bold text-white disabled:cursor-not-allowed disabled:opacity-50",children:m?"Applying...":"Apply changes"})]})}),d&&e.jsx("div",{className:"flex w-full flex-row justify-center gap-4",children:e.jsx("p",{className:"text-sm font-bold text-red-600",children:d})})]})})})},zc=()=>{const{isOpen:t,openModal:s,closeModal:a}=de(),[r,l]=h.useState(""),c=(n,i)=>{l(i),s()};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Pending Inventory Products",children:e.jsxs(fl,{children:[e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-full w-full flex-1 rounded-md border",children:e.jsx(Gn,{openModal:c})})}),e.jsx(ue,{title:r==="add"?"Add Items":r==="edit"?"Edit Item":r==="view_details"?"Item Details":r==="approve"?"Approve Item":"",isOpen:t,onClose:a,closeOnOverlayClick:r==="view_details",children:e.jsxs(e.Fragment,{children:[r==="view_details"&&e.jsx(Xn,{}),r==="edit"&&e.jsx(Jn,{onClose:a}),r==="approve"&&e.jsx(Zn,{onClose:a})]})})]})})})},ec=({handleViewItems:t})=>[{accessorKey:"code",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Code"," ",a.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"invoice.code",sortingFn:"text",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex flex-row items-center bg-transparent uppercase text-slate-700",children:["Invoice code"," ",a.getIsSorted()==="asc"?e.jsx(D,{size:18,strokeWidth:2}):a.getIsSorted()==="desc"?e.jsx(z,{size:18,strokeWidth:2}):e.jsx(E,{size:18,strokeWidth:2})]})})},{accessorKey:"refundable_amount",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Refundable"}),cell:({row:a})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a.original.refundable_amount)})})},{accessorKey:"issued_by",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Issued by"}),cell:({row:a})=>e.jsx("div",{children:e.jsx("span",{children:a.original.issued_by?`${a.original.issued_by.firstname} ${a.original.issued_by.lastname}`:"—"})})},{accessorKey:"created_at",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Issued at"}),cell:({row:a})=>e.jsx("div",{children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.DateTimeFormat("en-PH",{year:"numeric",month:"long",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(new Date(a.original.created_at))})})},{id:"actions",cell:({row:a})=>e.jsx("div",{className:"flex flex-row justify-center text-xs font-normal uppercase",children:e.jsxs(we,{children:[e.jsx(_e,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",children:e.jsx(ke,{size:16,strokeWidth:2.25})}),e.jsxs(Se,{className:"relative z-50 w-44 bg-white",children:[e.jsx(Ce,{children:"Actions"}),e.jsx(me,{className:"bg-gray-200"}),e.jsxs(B,{onClick:()=>{t(a.original.id)},className:"flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-200",children:[e.jsx("span",{className:"flex w-6 items-center justify-center",children:e.jsx(Ut,{size:16,strokeWidth:2})}),e.jsx("span",{children:"View items"})]})]})]})}),enableGlobalFilter:!1}],sc=()=>{const{data:t,isFetching:s}=jl(),a=De(),r=l=>{a(`/returns/${l}`)};return e.jsx(e.Fragment,{children:e.jsx(X,{columns:ec({handleViewItems:r}),data:t?t.sort((l,c)=>new Date(c.created_at).getTime()-new Date(l.created_at).getTime()):[],isLoading:s,dataType:"Returns",filterWhat:"code"})})},Ec=()=>e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Returns",children:e.jsx(gl,{children:e.jsx("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(sc,{})})})})})}),tc=()=>[{id:"product",accessorKey:"invoice_item.product.name",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Product"}),cell:({row:s})=>e.jsx("div",{children:e.jsx("span",{className:"max-w-[20ch] truncate",children:s.original.invoice_item.product.name})})},{accessorKey:"invoice_item.product.brand",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Brand"})},{accessorKey:"invoice_item.product.size",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Size"})},{accessorKey:"invoice_item.product.color",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Color"})},{accessorKey:"invoice_item.product.serial_no",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Serial"})},{accessorKey:"quantity",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"QTY"})},{accessorKey:"unit",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Unit"})},{accessorKey:"price",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Selling price"}),cell:({row:s})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s.original.price)})})},{id:"subtotal",header:()=>e.jsx("div",{className:"justify-center uppercase",children:"Subtotal"}),cell:({row:s})=>e.jsx("div",{className:"uppercase",children:e.jsx("span",{className:"max-w-[25ch] truncate",children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format((s.original.price??0)*(s.original.quantity??0))})})}],ac=()=>{const{data:t,isFetching:s}=Nl();return e.jsx(e.Fragment,{children:e.jsx(X,{columns:tc(),data:t??[],isLoading:s,dataType:"Return Items",filterWhat:"product"})})},Mc=()=>{const{id:t}=Hs(),s=De(),a=()=>{s(-1)};return e.jsx(e.Fragment,{children:e.jsx(ae,{title:"Return items",children:e.jsx(yl,{returnTransactionId:Number(t??0),children:e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-5 rounded-xl border border-black/10 bg-white p-4",children:[e.jsx("div",{className:"text-primary-dark-gray flex flex-row items-center gap-6 text-sm font-medium",children:e.jsxs(F,{onClick:()=>a(),className:"flex flex-row items-center gap-3 whitespace-nowrap bg-gray-200 pr-6 font-bold text-gray-700 hover:bg-gray-300 hover:text-gray-700",children:[e.jsx(Ss,{size:22,strokeWidth:2.25}),e.jsx("span",{children:"Go back"})]})}),e.jsx("div",{className:"max-h-[calc(100%-4rem)] w-full flex-1 rounded-md border",children:e.jsx(ac,{})})]})})})})},ma=({data:t,isLoading:s,openModal:a,setSelectedInvoice:r,setModalAction:l})=>{const c=[{accessorKey:"code",sortingFn:"alphanumeric",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["INVOICE CODE"," ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:n.original.code?n.original.code:"N/A"})},{accessorKey:"customer",sortingFn:"alphanumeric",enableSorting:!0,header:({column:n})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>n.toggleSorting(n.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["CUSTOMER"," ",n.getIsSorted()==="asc"?e.jsx(D,{}):n.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:`${n.original.customer.firstname} ${n.original.customer.lastname}`})},{accessorKey:"discount_amount",sortingFn:"text",enableSorting:!0,header:()=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"DISCOUNT"}),cell:({row:n})=>{const i=n.original.total_discount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"subtotal",sortingFn:"text",enableSorting:!0,header:()=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"SUBTOTAL"}),cell:({row:n})=>{const i=n.original.subtotal,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"total_amount_due",sortingFn:"text",enableSorting:!0,header:()=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"TOTAL AMOUNT DUE"}),cell:({row:n})=>{const i=n.original.total_amount_due,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"paid_amount",sortingFn:"text",enableSorting:!0,header:()=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"PAID AMOUNT"}),cell:({row:n})=>{const i=n.original.paid_amount,o=new Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(i);return e.jsx("div",{className:"text-center",children:o})}},{accessorKey:"created_at",sortingFn:"text",enableSorting:!0,header:()=>e.jsx("div",{className:"mx-auto flex flex-row justify-center text-center",children:"Created at"}),cell:({row:n})=>e.jsx("div",{className:"text-center",children:ne(n.original.created_at)})},{id:"view_items",header:()=>e.jsx("div",{}),cell:({row:n})=>{const i=n.original;return e.jsx(b,{className:"overflow-clip rounded-full bg-gray-100 p-1.5 hover:bg-gray-300",onClick:()=>{r(i),l("details"),a()},children:e.jsx("span",{className:"w-15 flex items-center justify-center text-black",children:e.jsx(ge,{size:16,strokeWidth:2.5})})})}}];return e.jsx(X,{data:t||[],columns:c,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0,isLoading:s})},lc=async()=>await Yt.post(`${Gt.INVOICE}/searches-filters-sorts`,{filter:{status:"pending"}},{headers:Xt()}).then(t=>t.data.data).catch(t=>{throw console.error("Error fetching pending invoices:",t),t}),rc=async t=>Yt.put(`${Gt.INVOICE}/${t}`,{status:"approved"},{headers:Xt()}).then(s=>s.data).catch(s=>{throw console.error("Error approving invoice:",s),s}),ua=({selectedInvoice:t,closeModal:s})=>{const a=fe(),{mutate:r,isPending:l}=Y({mutationKey:["approve-invoice"],mutationFn:rc,onSuccess:c=>{a.invalidateQueries({queryKey:["pending-invoices"]}),R.success("Invoice has been approved"),s()},onError:c=>{R.error("There was something wrong in approving the invoice")}});return e.jsxs("div",{className:"flex flex-col items-center justify-center ",children:[e.jsxs("h1",{className:"font-bold",children:["Are you sure you want to approve ",t.code]}),e.jsx("p",{className:" opacity-70",children:"This process cannot be undone."}),e.jsxs("div",{className:"mt-5 flex gap-3 self-end pb-0",children:[e.jsx(b,{className:"bg-red-500 hover:bg-red-600 disabled:opacity-50",onClick:s,disabled:l,children:"Cancel"}),e.jsx(b,{className:"bg-green-500 hover:bg-green-600 disabled:opacity-50",onClick:()=>{r(t.id)},disabled:l,children:l?"Approving...":"Confirm"})]})]})},nc=({invoiceItems:t})=>{const s=[{accessorKey:"product_name",sortingFn:"alphanumeric",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["PRODUCT NAME"," ",a.getIsSorted()==="asc"?e.jsx(D,{}):a.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:a.original.product?`${a.original.product.name} ${a.original.product.brand} ${a.original.product.size}`:"N/A"})},{accessorKey:"capital_price",sortingFn:"alphanumeric",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["CAPITAL PRICE"," ",a.getIsSorted()==="asc"?e.jsx(D,{}):a.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a.original.inventory_product.capital_price)})},{accessorKey:"selling_price",sortingFn:"alphanumeric",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["SELLING PRICE"," ",a.getIsSorted()==="asc"?e.jsx(D,{}):a.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(a.original.inventory_product.product_price.price)})},{accessorKey:"quantity",sortingFn:"alphanumeric",enableSorting:!0,header:({column:a})=>e.jsx("div",{children:e.jsxs(b,{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"mx-auto flex flex-row items-center bg-transparent text-black",children:["QUANTITY"," ",a.getIsSorted()==="asc"?e.jsx(D,{}):a.getIsSorted()==="desc"?e.jsx(z,{}):e.jsx(E,{})]})}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:a.original.quantity})}];return e.jsx(X,{data:t||[],columns:s,filterWhat:"",hideFilter:!0,dataType:"",openModal:void 0})},ha=({selectedInvoice:t})=>{const s=h.useMemo(()=>t!=null&&t.invoice_items?t.invoice_items.reduce((a,r)=>a+r.inventory_product.capital_price*r.quantity,0):0,[t]);return e.jsxs($s,{defaultValue:"details",className:"w-full",children:[e.jsxs(Bs,{className:"w-full",children:[e.jsx(cs,{value:"details",className:"flex-1 font-semibold",children:"Details"}),e.jsx(cs,{value:"items",className:"flex-1 font-semibold",children:"Items"})]}),e.jsx(bs,{value:"details",className:"w-[500px]",children:e.jsxs("div",{className:"flex max-w-4xl flex-col gap-4 font-medium",children:[e.jsxs("div",{className:"mt-3 grid w-full grid-flow-row grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Invoice code"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.code?t.code:"N/A"})]}),e.jsxs("div",{className:"col-span-6 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Customer"}),e.jsx("p",{className:"text-sm text-gray-800",children:t.customer?`${t.customer.firstname} ${t.customer.lastname}`:"N/A"})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-6 gap-4",children:[e.jsxs("div",{className:"relative col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Subtotal"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.subtotal)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Delivery charge"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.delivery_charge)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center	gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Total amount due"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.total_amount_due)})]}),e.jsxs("div",{className:"col-span-3 flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Requested discount"}),e.jsx("p",{className:"text-sm text-gray-800",children:Intl.NumberFormat("en-US",{style:"currency",currency:"PHP"}).format(t.total_discount)})]})]}),e.jsx("hr",{className:"my-2 h-px w-full border-0 bg-gray-200"}),e.jsxs("div",{className:"grid w-full grid-flow-row grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Issued by"}),e.jsx("p",{className:"text-sm text-gray-800",children:`${t.issued_by.firstname} ${t.issued_by.lastname}`})]}),e.jsxs("div",{className:"flex flex-col justify-center gap-1",children:[e.jsx("h3",{className:"text-sm font-bold",children:"Created at"}),e.jsx("p",{className:"text-sm text-gray-800",children:ne(t.created_at)})]})]})]})}),e.jsxs(bs,{value:"items",className:"flex h-auto max-h-[calc(100vh-12rem)] flex-col gap-4",children:[e.jsx("div",{className:"w-full flex-1 overflow-y-auto rounded-md border",children:e.jsx(nc,{invoiceItems:(t==null?void 0:t.invoice_items)||[]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm font-medium",children:[e.jsxs("p",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"font-bold",children:"Total capital"}),e.jsx("span",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(s)})]}),e.jsxs("p",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"font-bold",children:"Requested discount"}),e.jsx("span",{children:Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(t.total_discount||0)})]})]})]})]})},Wc=()=>{const{isOpen:t,closeModal:s,openModal:a}=de(),[r,l]=h.useState(void 0),[c,n]=h.useState("details");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex h-screen w-screen flex-row",children:[e.jsx(et,{}),e.jsx("div",{className:"flex max-h-full w-full flex-col gap-4 overflow-y-auto p-6 pt-12 text-slate-700",children:e.jsxs("div",{className:"mx-auto w-full max-w-[1024px] space-y-6",children:[e.jsx("div",{className:"flex w-full flex-row items-start justify-between",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Pending Invoices"})}),e.jsx("div",{className:"rounded-md bg-white",children:e.jsx(ma,{openModal:a,setSelectedInvoice:l,setModalAction:n})})]})})]}),e.jsx(ue,{title:c==="details"?"Invoice Details":c==="approve"?"Approve Invoice":"",isOpen:t,onClose:s,closeOnOverlayClick:!1,children:c==="approve"?e.jsx(ua,{selectedInvoice:r,closeModal:s}):c==="details"?e.jsx(ha,{selectedInvoice:r}):e.jsx(e.Fragment,{})})]})},Oc=()=>{const{openModal:t,isOpen:s,closeModal:a}=de(),[r,l]=h.useState(void 0),[c,n]=h.useState("details"),{data:i,isFetching:o,refetch:x}=vs({queryKey:["pending-invoices"],queryFn:lc,refetchOnWindowFocus:!1});return e.jsx(e.Fragment,{children:e.jsxs(ae,{title:"Pending Invoice",children:[e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl border border-black/10 bg-white p-4",children:[e.jsx("div",{className:"ml-auto flex flex-none flex-row items-center space-x-4",children:e.jsx(F,{disabled:o,onClick:()=>x(),children:o?"Loading...":"Refresh"})}),e.jsx("div",{className:"max-h-[calc(100%-3rem)] w-full flex-1 rounded-md border",children:e.jsx(ma,{data:i,isLoading:o,openModal:t,setSelectedInvoice:l,setModalAction:n})})]}),e.jsx(ue,{title:c==="details"?"Invoice Details":c==="approve"?"Approve Invoice":"",isOpen:s,onClose:a,closeOnOverlayClick:!1,children:c==="approve"?e.jsx(ua,{selectedInvoice:r,closeModal:a}):c==="details"?e.jsx(ha,{selectedInvoice:r}):e.jsx(e.Fragment,{})})]})})};export{Ac as Customers,Fc as ExpensesPage,Cc as Inventory,kc as InventoryItemsPage,hc as Invoice,pc as InvoiceItems,Kc as Login,zc as PendingInventoryProduct,Oc as PendingInvoices,Dc as PendingProductPrice,Tc as PendingReturn,wc as PendingTransfer,vc as PointOfSalePage,Wc as PosPendingInvoices,Pc as PosReturnsPage,Nc as ProductPrices,gc as Products,Ic as Reports,Mc as ReturnItems,Ec as Returns,Sc as RolePermissions,jc as Supplier,bc as Transaction,yc as Transfer,fc as UserInfo,_c as UserSales,uc as Warehouse};
